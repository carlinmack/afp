<div id="Topology">
<div class="head">
<h1>Theory Topology</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:      Topology.thy
    Author:     Stefan Friedrich
    Maintainer: Stefan Friedrich
    License:    LGPL
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹A bit of general topology›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Topology
<span class="keyword2"><span class="keyword">imports</span></span> <span class="quoted">"<a href="../../HOL/HOL-Library/FuncSet.html">HOL-Library.FuncSet</a>"</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹
  This theory gives a formal account of basic notions of general
  topology as they can be found in various textbooks, e.g. in
  \cite{mccarty67:_topol} or in \cite{querenburg01:_mengen_topol}.
  The development includes open and closed sets, neighbourhoods, as
  well as closure, open core, frontier, and adherent points of a set,
  dense sets, continuous functions, filters, ultra filters,
  convergence, and various separation axioms.
›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We use the theory on ``Pi and Function Sets'' by Florian
Kammueller and Lawrence C Paulson.›</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Preliminaries›</span></span>

<span class="keyword1" id="Topology-seteqI"><span class="command">lemma</span></span> seteqI<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">A</span> <span class="main">⟹</span> <span class="bound">x</span><span class="main">∈</span><span class="free">B</span><span class="main">;</span> <span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">B</span> <span class="main">⟹</span> <span class="bound">x</span><span class="main">∈</span><span class="free">A</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">=</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Topology-subset_mono"><span class="command">lemma</span></span> subset_mono<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">M</span> <span class="main">⊆</span> <span class="free">A</span> <span class="main">⟶</span> <span class="free">M</span> <span class="main">⊆</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Topology-diff_diff"><span class="command">lemma</span></span> diff_diff<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">-</span> <span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="free">C</span> <span class="main">∩</span> <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Topology-diff_diff_inter"><span class="command">lemma</span></span> diff_diff_inter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">B</span> <span class="main">⊆</span> <span class="free">A</span><span class="main">;</span> <span class="free">B</span> <span class="main">⊆</span> <span class="free">X</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">X</span> <span class="main">-</span> <span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">=</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemmas</span></span> diffsimps <span class="main">=</span> double_diff Diff_Un vimage_Diff
  Diff_Int_distrib Diff_Int

<span class="keyword1" id="Topology-vimage_comp"><span class="command">lemma</span></span> vimage_comp<span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span> <span class="free">A</span> <span class="main">→</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">∩</span> <span class="main">(</span><span class="free">f</span> <span class="main">-`</span> <span class="free">B</span> <span class="main">∩</span> <span class="free">f</span> <span class="main">-`</span> <span class="free">g</span> <span class="main">-`</span> <span class="free">m</span><span class="main">)</span><span class="main">=</span> <span class="free">A</span> <span class="main">∩</span> <span class="main">(</span><span class="free">g</span> <span class="main">∘</span> <span class="free">f</span><span class="main">)</span> <span class="main">-`</span> <span class="free">m</span> "</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> funcset_mem<span class="main">)</span>

<span class="keyword1" id="Topology-funcset_comp"><span class="command">lemma</span></span> funcset_comp<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">f</span> <span class="main">:</span> <span class="free">A</span> <span class="main">→</span> <span class="free">B</span><span class="main">;</span> <span class="free">g</span> <span class="main">:</span> <span class="free">B</span> <span class="main">→</span> <span class="free">C</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">g</span> <span class="main">∘</span> <span class="free">f</span> <span class="main">:</span> <span class="free">A</span> <span class="main">→</span> <span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> funcsetI <span class="quasi_keyword">dest</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> funcset_mem<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Definition›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A topology is defined by a set of sets (the open sets)
that is closed under finite intersections and infinite unions.›</span></span>


<span class="keyword1"><span class="command">type_synonym</span></span> <span class="tfree">'a</span> top <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set set"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">carr</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'a</span> set"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">carrier</span>ı"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">carr</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">=</span> <span class="main">⋃</span><span class="free"><span class="bound"><span class="entity">T</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">is_open</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'a</span> set <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="quoted">"_ <span class="keyword1">open</span>ı"</span> <span class="main">[</span>50<span class="main">]</span> 50<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">is_open</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="main">⟷</span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span>"</span></span>


<span class="keyword1"><span class="command">locale</span></span> carrier <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> openI<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="free">T</span> <span class="main">⟹</span> <span class="free">m</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> is_open_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> openE<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">m</span> <span class="keyword1">open</span><span class="main">;</span> <span class="free">m</span> <span class="main">∈</span> <span class="free">T</span> <span class="main">⟹</span> <span class="free">R</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span> 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> is_open_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> carrierI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">t</span> <span class="keyword1">open</span><span class="main">;</span> <span class="free">x</span> <span class="main">∈</span> <span class="free">t</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> is_open_def carr_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> carrierE <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
 <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">;</span>
   <span class="main">⋀</span><span class="bound">t</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">t</span> <span class="keyword1">open</span><span class="main">;</span> <span class="free">x</span> <span class="main">∈</span> <span class="bound">t</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>
  <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> is_open_def carr_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> subM<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">t</span> <span class="main">∈</span> <span class="free">M</span><span class="main">;</span> <span class="free">M</span> <span class="main">⊆</span> <span class="free">T</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">t</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> is_open_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> topeqI <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">S</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">⋀</span><span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="bound">m</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span><span class="main">;</span>
           <span class="main">⋀</span><span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="bound">m</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">⟧</span>
         <span class="main">⟹</span> <span class="free">T</span> <span class="main">=</span> <span class="free">S</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> is_open_def<span class="main">)</span>

<span class="keyword1"><span class="command">locale</span></span> topology <span class="main">=</span> carrier <span class="quoted"><span class="free">T</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Int_open <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span><span class="main">:</span>   <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">x</span> <span class="keyword1">open</span><span class="main">;</span> <span class="free">y</span> <span class="keyword1">open</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">∩</span> <span class="free">y</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     union_open <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">m</span> <span class="main">∈</span> <span class="free">M</span><span class="main">.</span> <span class="bound">m</span> <span class="keyword1">open</span> <span class="main">⟹</span> <span class="main">⋃</span> <span class="free">M</span> <span class="keyword1">open</span>"</span></span>

<span class="keyword1" id="Topology-topologyI"><span class="command">lemma</span></span> topologyI<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">⋀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">⟦</span> is_open <span class="free">T</span> <span class="bound">x</span><span class="main">;</span> is_open <span class="free">T</span> <span class="bound">y</span><span class="main">⟧</span> <span class="main">⟹</span> is_open <span class="free">T</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∩</span> <span class="bound">y</span><span class="main">)</span><span class="main">;</span>
     <span class="main">⋀</span> <span class="bound">M</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">m</span> <span class="main">∈</span> <span class="bound">M</span><span class="main">.</span> is_open <span class="free">T</span> <span class="bound">m</span> <span class="main">⟹</span> is_open <span class="free">T</span> <span class="main">(</span><span class="main">⋃</span> <span class="bound">M</span><span class="main">)</span>
   <span class="main">⟧</span> <span class="main">⟹</span> topology <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> topology_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> Un_open <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> abopen<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">open</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∪</span> <span class="free">B</span> <span class="keyword1">open</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="free">A</span><span class="main">,</span> <span class="free">B</span><span class="main">}</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> abopen
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Common definitions of topological spaces require that the empty
set and the carrier set of the space be open. With our definition,
however, the carrier is implicitly given as the union of all open
sets; therefore it is trivially open. The empty set is open by the
laws of HOLs typed set theory.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> empty_open <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="keyword1">open</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{}</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> carrier_open <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> carr_def <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> openI<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> open_kriterion<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> t_contains_open<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">t</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">t'</span><span class="main">.</span> <span class="bound">t'</span> <span class="keyword1">open</span> <span class="main">∧</span> <span class="bound">x</span><span class="main">∈</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">⊆</span><span class="free">t</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="keyword1">open</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?M</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="bound">x</span><span class="main">∈</span><span class="free">t</span><span class="main">.</span> <span class="main">{</span><span class="bound">t'</span><span class="main">.</span> <span class="bound">t'</span> <span class="keyword1">open</span> <span class="main">∧</span> <span class="bound">x</span><span class="main">∈</span><span class="bound">t'</span> <span class="main">∧</span> <span class="bound">t'</span><span class="main">⊆</span><span class="free">t</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">m</span> <span class="main">∈</span> <span class="var">?M</span><span class="main">.</span> <span class="bound">m</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="var">?M</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">=</span> <span class="main">⋃</span><span class="var">?M</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> t_contains_open<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can obtain a topology from a set of basic open sets by
closing the set under finite intersections and arbitrary unions.›</span></span>


<span class="keyword1"><span class="command">inductive_set</span></span>
  <span class="entity">topo</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set set <span class="main">⇒</span> <span class="tfree">'a</span> top"</span></span>
  <span class="keyword2"><span class="keyword">for</span></span> <span class="entity">B</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set set"</span></span>
<span class="keyword2"><span class="keyword">where</span></span>
  basic <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∈</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∈</span> <span class="free">topo</span> <span class="free">B</span>"</span></span>
<span class="main">|</span> inter <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∈</span> <span class="free">topo</span> <span class="free">B</span><span class="main">;</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">∈</span> <span class="free">topo</span> <span class="free">B</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∩</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">∈</span> <span class="free">topo</span> <span class="free">B</span>"</span></span>
<span class="main">|</span> union <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="main">⟹</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">topo</span> <span class="free">B</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">⋃</span><span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="main">∈</span> <span class="free">topo</span> <span class="free">B</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> topobase <span class="main">=</span> carrier <span class="quoted"><span class="free">T</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">B</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="main">+</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">≡</span> topo <span class="free">B</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topobase<span class="main">)</span> topo_open<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="keyword1">open</span> <span class="main">=</span> <span class="main">(</span><span class="free">t</span> <span class="main">∈</span> topo <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> T_def is_open_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topobase<span class="main">)</span>
  basic <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">∈</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">t</span> <span class="keyword1">open</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  inter <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">x</span> <span class="keyword1">open</span><span class="main">;</span> <span class="free">y</span> <span class="keyword1">open</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">x</span> <span class="main">∩</span> <span class="free">y</span><span class="main">)</span> <span class="keyword1">open</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  union <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span><span class="main">∈</span><span class="free">M</span> <span class="main">⟹</span> <span class="bound">t</span> <span class="keyword1">open</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">⋃</span><span class="free">M</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> topo_open<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topobase<span class="main">)</span> topo_induct
  <span class="main">[</span><span class="operator">case_names</span> basic inter union<span class="main">,</span> <span class="operator">induct</span> <span class="quasi_keyword"><span class="quasi_keyword">set</span></span><span class="main"><span class="main"><span class="main">:</span></span></span> topo<span class="main">,</span> <span class="operator">consumes</span> 1<span class="main">]</span><span class="main">:</span>
    <span class="keyword2"><span class="keyword">assumes</span></span> opn<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">open</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> bas<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">P</span> <span class="bound">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> int<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">⟦</span><span class="bound">x</span> <span class="keyword1">open</span><span class="main">;</span> <span class="free">P</span> <span class="bound">x</span><span class="main">;</span> <span class="bound">y</span> <span class="keyword1">open</span><span class="main">;</span> <span class="free">P</span> <span class="bound">y</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">P</span> <span class="main">(</span><span class="bound">x</span> <span class="main">∩</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> uni<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">M</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">t</span><span class="main">∈</span><span class="bound">M</span><span class="main">.</span> <span class="bound">t</span> <span class="keyword1">open</span> <span class="main">∧</span> <span class="free">P</span> <span class="bound">t</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">P</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">M</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> opn <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> topo <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> topo_open<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">induct</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> bas int <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>uni <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> topo_open<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1" id="Topology-topo_topology"><span class="command">lemma</span></span> topo_topology <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"topology <span class="main">(</span>topo <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> union topologyI <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> is_open_def<span class="main">)</span>

<span class="keyword1" id="Topology-topo_mono"><span class="command">lemma</span></span> topo_mono<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> asubb<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"topo <span class="free">A</span> <span class="main">⊆</span> topo <span class="free">B</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> <span class="keyword3"><span class="command">assume</span></span> mintopoa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∈</span> topo <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="free">B</span> <span class="main">⟶</span> <span class="skolem">m</span> <span class="main">∈</span> topo <span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> topo.induct<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> asubb <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∈</span> topo <span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Topology-topo_open_imp"><span class="command">lemma</span></span> topo_open_imp<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">≡</span> topo <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">B</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">≡</span> topo <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">A</span> <span class="main">⊆</span> <span class="free">B</span><span class="main">;</span> <span class="free">x</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">x</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">PROP</span> <span class="var">?P</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> A_S<span class="main">:</span> topobase <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="free">S</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword1"><span class="command">interpret</span></span> topobase <span class="quoted"><span class="free">B</span></span> <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">PROP</span> <span class="var">?P</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> topo_mono <span class="quasi_keyword">iff</span><span class="main"><span class="main">:</span></span> A_S.topo_open topo_open<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topobase<span class="main">)</span> carrier_topo<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">=</span> <span class="main">⋃</span><span class="free">B</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">⊆</span> <span class="main">⋃</span><span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="keyword1">open</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">⋃</span><span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">iff</span><span class="main"><span class="main">:</span></span> topo_open<span class="main">)</span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Topological subspace›</span></span>


<span class="keyword1"><span class="command">locale</span></span> subtopology <span class="main">=</span> carrier <span class="quoted"><span class="free">S</span></span> <span class="main">+</span> carrier <span class="quoted"><span class="free">T</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">S</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> subtop<span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="keyword1">open</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="free">s</span> <span class="main">=</span> <span class="bound">t</span> <span class="main">∩</span> <span class="keyword1">carrier</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Topology-subtopologyI"><span class="command">lemma</span></span> subtopologyI<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">S</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">s</span><span class="main">.</span> <span class="bound">s</span> <span class="keyword1">open</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="bound">s</span> <span class="main">=</span> <span class="bound">t</span> <span class="main">∩</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     H2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="bound">t</span> <span class="main">∩</span> <span class="keyword1">carrier</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"subtopology <span class="free">S</span> <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> subtopology_def <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> assms<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> subtopology<span class="main">)</span> subtopologyE <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> major<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     minor<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">t</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">t</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">;</span> <span class="free">s</span> <span class="main">=</span> <span class="bound">t</span> <span class="main">∩</span> <span class="keyword1">carrier</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> subtopology<span class="main">)</span> subtopI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="free">t</span> <span class="main">∩</span> <span class="keyword1">carrier</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> subtopology<span class="main">)</span> carrier_subset<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> subtopology<span class="main">)</span> subtop_sub<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"topology <span class="free">T</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> carrSopen<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> s_open<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> topology <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> subtopology<span class="main">)</span> subtop_topology <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"topology <span class="free">T</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"topology <span class="free">S</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> topology <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> topologyI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">u</span> <span class="skolem">v</span> <span class="keyword3"><span class="command">assume</span></span> uopen<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="keyword1">open</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> vopen<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="keyword1">open</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∩</span> <span class="skolem">v</span> <span class="keyword1">open</span>"</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Int_ac<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">M</span> <span class="keyword3"><span class="command">assume</span></span> msub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">m</span><span class="main">∈</span><span class="skolem">M</span><span class="main">.</span> <span class="bound">m</span> <span class="keyword1">open</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?N</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">∩</span> <span class="keyword1">carrier</span> <span class="main">∈</span> <span class="skolem">M</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="var">?N</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="var">?N</span> <span class="main">∩</span> <span class="keyword1">carrier</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="var">?N</span>  <span class="main">∩</span> <span class="keyword1">carrier</span> <span class="main">=</span> <span class="main">⋃</span><span class="skolem">M</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="skolem">M</span> <span class="main">⊆</span> <span class="main">⋃</span><span class="var">?N</span> <span class="main">∩</span> <span class="keyword1">carrier</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">⋃</span><span class="skolem">M</span>"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">s</span></span> <span class="keyword2"><span class="keyword">where</span></span> sinM<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">∈</span> <span class="skolem">M</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> xins<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="skolem">s</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> msub sinM <span class="keyword1"><span class="command">have</span></span> s_open<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span>
          <span class="keyword2"><span class="keyword">where</span></span> t_open<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> s_inter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">=</span> <span class="skolem">t</span> <span class="main">∩</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> xins <span class="keyword1"><span class="command">have</span></span> xint<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="skolem">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> xpoint<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span>
        <span class="keyword1"><span class="command">from</span></span> t_open s_inter sinM <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">∈</span> <span class="var">?N</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">⋃</span><span class="var">?N</span> <span class="main">∩</span> <span class="keyword1">carrier</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="skolem">M</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Topology-subtop_lemma"><span class="command">lemma</span></span>  subtop_lemma<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">≡</span> topo <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">B</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">≡</span> topo <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span>  Asub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">t</span><span class="main">∈</span><span class="free">B</span><span class="main">.</span> <span class="main">{</span> <span class="bound">t</span> <span class="main">∩</span> <span class="main">⋃</span><span class="free">A</span> <span class="main">}</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"subtopology <span class="free">S</span> <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> A_S<span class="main">:</span> topobase <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="free">S</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword1"><span class="command">interpret</span></span> topobase <span class="quoted"><span class="free">B</span></span> <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> subtopologyI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">s</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="skolem">s</span> <span class="main">=</span> <span class="bound">t</span> <span class="main">∩</span> <span class="keyword1">carrier</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">induct</span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>basic <span class="skolem">s</span><span class="main">)</span> <span class="keyword1"><span class="command">with</span></span> Asub
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> tB<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">∈</span> <span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> stA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">=</span> <span class="skolem">t</span> <span class="main">∩</span> <span class="main">⋃</span><span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> A_S.carrier_topo<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>inter <span class="skolem">s</span> <span class="skolem">t</span><span class="main">)</span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>union <span class="skolem">M</span><span class="main">)</span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?N</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">u</span><span class="main">.</span> <span class="bound">u</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound">m</span><span class="main">∈</span><span class="skolem">M</span><span class="main">.</span> <span class="bound">m</span> <span class="main">=</span> <span class="bound">u</span> <span class="main">∩</span> <span class="keyword1">carrier</span><span class="main">)</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?N</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="skolem">M</span> <span class="main">=</span> <span class="var">?N</span> <span class="main">∩</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> union <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">t</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">∩</span> <span class="keyword1">carrier</span> <span class="keyword1">open</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">induct</span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>basic <span class="skolem">u</span><span class="main">)</span> <span class="keyword1"><span class="command">with</span></span> Asub <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> A_S.carrier_topo<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>inter <span class="skolem">u</span> <span class="skolem">v</span><span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">u</span> <span class="main">∩</span> <span class="keyword1">carrier</span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span><span class="skolem">v</span> <span class="main">∩</span> <span class="keyword1">carrier</span><span class="main">)</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Int_ac<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>union <span class="skolem">M</span><span class="main">)</span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?N</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">s</span><span class="main">.</span> <span class="main">∃</span><span class="bound">m</span><span class="main">∈</span><span class="skolem">M</span><span class="main">.</span> <span class="bound">s</span> <span class="main">=</span> <span class="bound">m</span> <span class="main">∩</span> <span class="keyword1">carrier</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> union <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?N</span> <span class="keyword1">open</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?N</span> <span class="main">=</span> <span class="main">⋃</span><span class="skolem">M</span> <span class="main">∩</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Sample topologies›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">trivial_top</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">trivial_top</span> <span class="main">=</span> <span class="main">{</span><span class="main">{}</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">discrete_top</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> set set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">discrete_top</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">=</span> Pow <span class="free"><span class="bound"><span class="entity">X</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">indiscrete_top</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> set set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">indiscrete_top</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">=</span> <span class="main">{</span><span class="main">{}</span><span class="main">,</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">order_base</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>order<span class="main">)</span> set <span class="main">⇒</span> <span class="tfree">'a</span> set set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">order_base</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">x</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">.</span> <span class="main">{</span><span class="main">{</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="bound">y</span><span class="main">}</span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">order_top</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>order<span class="main">)</span> set <span class="main">⇒</span> <span class="tfree">'a</span> set set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">order_top</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">=</span> topo<span class="main">(</span>order_base <span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> trivial <span class="main">=</span> carrier <span class="main">+</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">≡</span> <span class="main">{</span><span class="main">{}</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> trivial<span class="main">)</span> open_iff <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="keyword1">open</span> <span class="main">=</span> <span class="main">(</span><span class="free">m</span> <span class="main">=</span> <span class="main">{}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> T_def is_open_def<span class="main">)</span>

<span class="keyword1" id="Topology-trivial_topology"><span class="command">lemma</span></span> trivial_topology<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">≡</span> <span class="main">{</span><span class="main">{}</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"topology <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> trivial <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> topologyI<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Topology-empty_carrier_implies_trivial"><span class="command">lemma</span></span> empty_carrier_implies_trivial<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">S</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"topology <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">≡</span> <span class="main">{</span><span class="main">{}</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">S</span> <span class="main">=</span> <span class="free">T</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">PROP</span> <span class="var">?P</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> topology <span class="quoted"><span class="free">S</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword1"><span class="command">interpret</span></span> trivial <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">PROP</span> <span class="var">?P</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">locale</span></span> discrete <span class="main">=</span> carrier <span class="quoted"><span class="free">T</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">X</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="main">+</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">≡</span> discrete_top <span class="free">X</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> discrete<span class="main">)</span> carrier<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">=</span> <span class="free">X</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>carrierI <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>carrierE<span class="main">)</span>
     <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> discrete_top_def T_def is_open_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> discrete<span class="main">)</span> open_iff <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="keyword1">open</span> <span class="main">=</span> <span class="main">(</span><span class="free">t</span> <span class="main">∈</span> Pow <span class="keyword1">carrier</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="keyword1">open</span> <span class="main">=</span> <span class="main">(</span><span class="free">t</span> <span class="main">∈</span> Pow <span class="free">X</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> T_def discrete_top_def is_open_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> carrier<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Topology-discrete_topology"><span class="command">lemma</span></span> discrete_topology<span class="main">:</span> <span class="quoted"><span class="quoted">"topology <span class="main">(</span>discrete_top <span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> topologyI <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> is_open_def discrete_top_def<span class="main">)</span>
   <span class="operator">blast</span>

<span class="keyword1"><span class="command">locale</span></span> indiscrete <span class="main">=</span> carrier <span class="quoted"><span class="free">T</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">X</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="main">+</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">≡</span> indiscrete_top <span class="free">X</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> indiscrete<span class="main">)</span> carrier<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">=</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> carrierI <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> carrierE<span class="main">)</span>
     <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> T_def indiscrete_top_def is_open_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> indiscrete<span class="main">)</span> open_iff <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="keyword1">open</span> <span class="main">=</span> <span class="main">(</span><span class="free">t</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">∨</span> <span class="free">t</span> <span class="main">=</span> <span class="keyword1">carrier</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="keyword1">open</span> <span class="main">=</span> <span class="main">(</span><span class="free">t</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">∨</span> <span class="free">t</span> <span class="main">=</span> <span class="free">X</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> T_def indiscrete_top_def is_open_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> carrier<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1" id="Topology-indiscrete_topology"><span class="command">lemma</span></span> indiscrete_topology<span class="main">:</span> <span class="quoted"><span class="quoted">"topology <span class="main">(</span>indiscrete_top <span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> topologyI<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> is_open_def indiscrete_top_def<span class="main">)</span>

<span class="keyword1"><span class="command">locale</span></span> orderbase <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">X</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">B</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">≡</span> order_base <span class="free">X</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> ordertop1 <span class="main">=</span>  orderbase <span class="quoted"><span class="free">X</span></span> <span class="quoted"><span class="free">B</span></span> <span class="main">+</span> topobase <span class="quoted"><span class="free">B</span></span> <span class="quoted"><span class="free">T</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">X</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">B</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">locale</span></span> ordertop <span class="main">=</span> carrier <span class="quoted"><span class="free">T</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">X</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="main">+</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">≡</span> order_top <span class="free">X</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ordertop<span class="main">)</span> ordertop_open<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="keyword1">open</span> <span class="main">=</span> <span class="main">(</span><span class="free">t</span> <span class="main">∈</span> order_top <span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> T_def is_open_def<span class="main">)</span>

<span class="keyword1" id="Topology-ordertop_topology"><span class="command">lemma</span></span> ordertop_topology <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"topology <span class="main">(</span>order_top <span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> order_top_def<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Neighbourhoods›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">nhd</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> set set"</span></span>  <span class="main">(</span> <span class="quoted">"<span class="keyword1">nhds</span>ı"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">nhd</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="main">{</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span> <span class="main">⊆</span> carr <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">m</span><span class="main">.</span> is_open <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="bound">m</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">∈</span><span class="bound">m</span> <span class="main">∧</span> <span class="bound">m</span> <span class="main">⊆</span> <span class="bound">U</span><span class="main">)</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> nhdI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">U</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="main">;</span> <span class="free">m</span> <span class="keyword1">open</span><span class="main">;</span> <span class="free">x</span> <span class="main">∈</span> <span class="free">m</span><span class="main">;</span> <span class="free">m</span> <span class="main">⊆</span> <span class="free">U</span> <span class="main">⟧</span> <span class="main">⟹</span>  <span class="free">U</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> nhd_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> nhdE <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">U</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span><span class="main">;</span> <span class="main">⋀</span><span class="bound">m</span><span class="main">.</span> <span class="main">⟦</span> <span class="free">U</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="main">;</span> <span class="bound">m</span> <span class="keyword1">open</span><span class="main">;</span> <span class="free">x</span> <span class="main">∈</span> <span class="bound">m</span><span class="main">;</span> <span class="bound">m</span> <span class="main">⊆</span> <span class="free">U</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> nhd_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> elem_in_nhd<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">U</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">∈</span> <span class="free">U</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> carrier_nhd <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span> <span class="main">⟹</span> <span class="keyword1">carrier</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> empty_not_nhd <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∉</span> <span class="keyword1">nhds</span> <span class="free">x</span> "</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> nhds_greater<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">V</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="main">;</span> <span class="free">U</span> <span class="main">⊆</span> <span class="free">V</span><span class="main">;</span>  <span class="free">U</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">V</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">erule</span> nhdE<span class="main">)</span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> nhds_inter<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> nhdU<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">U</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     nhdV<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">V</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">U</span> <span class="main">∩</span> <span class="free">V</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> nhdU <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    Usub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">U</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    uT<span class="main">:</span>   <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="keyword1">open</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    xu<span class="main">:</span>   <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    usub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">⊆</span> <span class="free">U</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
 <span class="keyword1"><span class="command">from</span></span> nhdV <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    Vsub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">V</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    vT<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="keyword1">open</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    xv<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    vsub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">⊆</span> <span class="free">V</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> Usub Vsub <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">U</span> <span class="main">∩</span> <span class="free">V</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> uT vT <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∩</span> <span class="skolem">v</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> xu xv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="skolem">u</span> <span class="main">∩</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> usub vsub <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∩</span> <span class="skolem">v</span> <span class="main">⊆</span> <span class="free">U</span> <span class="main">∩</span> <span class="free">V</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span>  <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> sub_nhd<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">U</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">V</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span><span class="main">.</span> <span class="bound">V</span> <span class="main">⊆</span> <span class="free">U</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">z</span> <span class="main">∈</span> <span class="bound">V</span><span class="main">.</span> <span class="free">U</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="bound">z</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> nhdE<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ordertop1<span class="main">)</span> l1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> mopen<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> xpoint<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> ypoint<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">∈</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> xley<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">y</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> xinm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="free">m</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">∈</span> <span class="free">m</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> mopen xinm
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">induct</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>basic <span class="skolem">U</span><span class="main">)</span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> B_def order_base_def ypoint
        <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> xley <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> order_trans<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ordertop1<span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> xpoint<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ypoint<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">∈</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> xley<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">y</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">nhds</span> <span class="free">x</span> <span class="main">⊆</span> <span class="keyword1">nhds</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">u</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="keyword1">open</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">⊆</span> <span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="skolem">m</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> xpoint ypoint xley
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">y</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> l1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Closed sets›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A set is closed if its complement is open.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">is_closed</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'a</span> set <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="quoted">"_ <span class="keyword1">closed</span>ı"</span> <span class="main">[</span>50<span class="main">]</span> 50<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">is_closed</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="main">⟷</span> is_open <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">(</span>carr <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">-</span> <span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> closedI<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">s</span><span class="main">)</span> <span class="keyword1">open</span> <span class="main">⟹</span> <span class="free">s</span> <span class="keyword1">closed</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> is_closed_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> closedE<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">s</span> <span class="keyword1">closed</span><span class="main">;</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">s</span><span class="main">)</span> <span class="keyword1">open</span> <span class="main">⟹</span> <span class="free">R</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> is_closed_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> empty_closed <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="keyword1">closed</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> closedI<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> carrier_closed <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="keyword1">closed</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> closedI<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> compl_open_closed<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> mopen<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">m</span><span class="main">)</span> <span class="keyword1">closed</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> closedI<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> mopen <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">-</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">m</span><span class="main">)</span> <span class="main">=</span> <span class="free">m</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> double_diff<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">-</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">m</span><span class="main">)</span> <span class="keyword1">open</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> mopen <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> compl_open_closed1<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">m</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="main">;</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">m</span><span class="main">)</span> <span class="keyword1">closed</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">m</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> closedE <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diffsimps<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> compl_closed_iff <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">" <span class="free">m</span> <span class="main">⊆</span> <span class="keyword1">carrier</span> <span class="main">⟹</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">m</span><span class="main">)</span> <span class="keyword1">closed</span> <span class="main">=</span> <span class="main">(</span><span class="free">m</span> <span class="keyword1">open</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> compl_open_closed1 <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> compl_open_closed<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> Un_closed <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">x</span> <span class="keyword1">closed</span><span class="main">;</span> <span class="free">y</span> <span class="keyword1">closed</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">∪</span> <span class="free">y</span> <span class="keyword1">closed</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>Diff_Un <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> closedE <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> closedI<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> inter_closed<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> xsclosed<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">S</span> <span class="main">⟹</span> <span class="bound">x</span> <span class="keyword1">closed</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋂</span><span class="free">S</span> <span class="keyword1">closed</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> closedI<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?M</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">m</span><span class="main">.</span> <span class="main">∃</span><span class="bound">x</span><span class="main">∈</span><span class="free">S</span><span class="main">.</span> <span class="bound">m</span> <span class="main">=</span> <span class="keyword1">carrier</span> <span class="main">-</span> <span class="bound">x</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">m</span> <span class="main">∈</span> <span class="var">?M</span><span class="main">.</span> <span class="bound">m</span> <span class="keyword1">open</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> xsclosed <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> closedE<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span> <span class="var">?M</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span> <span class="var">?M</span> <span class="main">=</span> <span class="keyword1">carrier</span> <span class="main">-</span> <span class="main">⋂</span><span class="free">S</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">-</span> <span class="main">⋂</span><span class="free">S</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> Int_closed <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
 <span class="keyword2"><span class="keyword">assumes</span></span> abclosed<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">closed</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="keyword1">closed</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∩</span> <span class="free">B</span> <span class="keyword1">closed</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋂</span><span class="main">{</span><span class="free">A</span><span class="main">,</span> <span class="free">B</span><span class="main">}</span> <span class="keyword1">closed</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> inter_closed<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> closed_diff_open<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> aclosed<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">closed</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>   bopen<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">-</span> <span class="free">B</span> <span class="keyword1">closed</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> closedI<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> aclosed <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span> <span class="keyword1">open</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> closedE<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> bopen <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">∩</span> <span class="free">B</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">∩</span> <span class="free">B</span><span class="main">)</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">-</span> <span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> diff_diff<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> open_diff_closed<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> aclosed<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">closed</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>   bopen<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">-</span> <span class="free">A</span> <span class="keyword1">open</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> aclosed <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span> <span class="keyword1">open</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> closedE<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">∩</span> <span class="free">B</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> bopen <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> bopen <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">∩</span> <span class="free">B</span> <span class="main">=</span> <span class="free">B</span> <span class="main">-</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">-</span> <span class="free">A</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Core, closure, and frontier of a set›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">cor</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> set"</span></span>          <span class="main">(</span><span class="quoted">"<span class="keyword1">core</span>ı"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">cor</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">⋃</span><span class="main">{</span><span class="bound">m</span><span class="main">.</span> is_open <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="bound">m</span> <span class="main">∧</span> <span class="bound">m</span> <span class="main">⊆</span> <span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">clsr</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> set"</span></span>          <span class="main">(</span><span class="quoted">"<span class="keyword1">closure</span>ı"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">clsr</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">⋂</span><span class="main">{</span><span class="bound">c</span><span class="main">.</span> is_closed <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="bound">c</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="main">⊆</span> <span class="bound">c</span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">frt</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> set"</span></span>          <span class="main">(</span><span class="quoted">"<span class="keyword1">frontier</span>ı"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">frt</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="main">=</span> clsr <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="main">-</span> cor <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">s</span></span></span>"</span></span>


<span class="keyword1"><span class="command">subsubsection</span></span><span class="quoted"><span class="plain_text">‹Core›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> coreI<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">m</span> <span class="keyword1">open</span><span class="main">;</span> <span class="free">m</span> <span class="main">⊆</span> <span class="free">s</span><span class="main">;</span> <span class="free">x</span> <span class="main">∈</span> <span class="free">m</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">∈</span> <span class="keyword1">core</span> <span class="free">s</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cor_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> coreE<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">x</span> <span class="main">∈</span> <span class="keyword1">core</span> <span class="free">s</span><span class="main">;</span> <span class="main">⋀</span><span class="bound">m</span><span class="main">.</span> <span class="main">⟦</span><span class="bound">m</span> <span class="keyword1">open</span><span class="main">;</span> <span class="bound">m</span> <span class="main">⊆</span> <span class="free">s</span><span class="main">;</span> <span class="free">x</span> <span class="main">∈</span> <span class="bound">m</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cor_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> core_open <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">core</span> <span class="free">a</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cor_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> core_subset<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">core</span> <span class="free">a</span> <span class="main">⊆</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cor_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemmas</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> core_subsetD <span class="main">=</span> subsetD <span class="main">[</span><span class="operator">OF</span> core_subset<span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> core_greatest<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">m</span> <span class="keyword1">open</span><span class="main">;</span> <span class="free">m</span> <span class="main">⊆</span> <span class="free">a</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">m</span> <span class="main">⊆</span> <span class="keyword1">core</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cor_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> core_idem <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">core</span> <span class="main">(</span><span class="keyword1">core</span> <span class="free">a</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">core</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span>  <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cor_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> open_core_eq <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">open</span> <span class="main">⟹</span> <span class="keyword1">core</span> <span class="free">a</span> <span class="main">=</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cor_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> core_eq_open<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">core</span> <span class="free">a</span> <span class="main">=</span> <span class="free">a</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> subst<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> core_iff<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">open</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">core</span> <span class="free">a</span> <span class="main">=</span> <span class="free">a</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> core_eq_open<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> core_mono<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">⊆</span> <span class="free">b</span> <span class="main">⟹</span> <span class="keyword1">core</span> <span class="free">a</span> <span class="main">⊆</span> <span class="keyword1">core</span> <span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cor_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> core_Int <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="keyword1">core</span> <span class="main">(</span><span class="free">a</span> <span class="main">∩</span> <span class="free">b</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">core</span> <span class="free">a</span> <span class="main">∩</span> <span class="keyword1">core</span> <span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cor_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> core_nhds<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">U</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="main">;</span> <span class="free">x</span> <span class="main">∈</span> <span class="keyword1">core</span> <span class="free">U</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">U</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> coreE<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> nhds_core<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">U</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">∈</span> <span class="keyword1">core</span> <span class="free">U</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> coreI<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> core_nhds_iff<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">U</span> <span class="main">⊆</span> <span class="keyword1">carrier</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">x</span> <span class="main">∈</span> <span class="keyword1">core</span> <span class="free">U</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">U</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> core_nhds nhds_core<span class="main">)</span>  

<span class="keyword1"><span class="command">subsubsection</span></span><span class="quoted"><span class="plain_text">‹Closure›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> closureI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span><span class="bound">c</span><span class="main">.</span> <span class="main">⟦</span><span class="bound">c</span> <span class="keyword1">closed</span><span class="main">;</span> <span class="free">a</span> <span class="main">⊆</span> <span class="bound">c</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">∈</span> <span class="bound">c</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">∈</span> <span class="keyword1">closure</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> clsr_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> closureE <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">x</span> <span class="main">∈</span> <span class="keyword1">closure</span> <span class="free">a</span><span class="main">;</span> <span class="main">¬</span> <span class="free">c</span> <span class="keyword1">closed</span> <span class="main">⟹</span> <span class="free">R</span><span class="main">;</span>  <span class="main">¬</span> <span class="free">a</span> <span class="main">⊆</span> <span class="free">c</span> <span class="main">⟹</span> <span class="free">R</span><span class="main">;</span>  <span class="free">x</span> <span class="main">∈</span> <span class="free">c</span> <span class="main">⟹</span> <span class="free">R</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> clsr_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> closure_least<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="keyword1">closed</span> <span class="main">⟹</span> <span class="keyword1">closure</span> <span class="free">s</span> <span class="main">⊆</span> <span class="free">s</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> subset_closure<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">⊆</span> <span class="keyword1">closure</span> <span class="free">s</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> closure_carrier <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">closure</span> <span class="keyword1">carrier</span> <span class="main">=</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> closure_subset<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span> <span class="main">⟹</span> <span class="keyword1">closure</span> <span class="free">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> closure_closed <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">closure</span> <span class="free">a</span> <span class="keyword1">closed</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> clsr_def <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> inter_closed<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> closure_idem <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">closure</span> <span class="main">(</span><span class="keyword1">closure</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">closure</span> <span class="free">s</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> clsr_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> closed_closure_eq <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">closed</span> <span class="main">⟹</span> <span class="keyword1">closure</span> <span class="free">a</span> <span class="main">=</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> clsr_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> closure_eq_closed<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">closure</span> <span class="free">a</span> <span class="main">=</span> <span class="free">a</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">closed</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">erule</span> subst<span class="main">)</span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> closure_iff<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">closed</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">closure</span> <span class="free">a</span> <span class="main">=</span> <span class="free">a</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> closure_eq_closed<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> closure_mono1<span class="main">:</span>
  <span class="quoted"><span class="quoted">"mono <span class="main">(</span><span class="keyword1">closure</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> clsr_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> closure_mono<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">⊆</span> <span class="free">b</span> <span class="main">⟹</span> <span class="keyword1">closure</span> <span class="free">a</span> <span class="main">⊆</span> <span class="keyword1">closure</span> <span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> clsr_def<span class="main">)</span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> closure_Un <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="keyword1">closure</span> <span class="main">(</span><span class="free">a</span> <span class="main">∪</span> <span class="free">b</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">closure</span> <span class="free">a</span> <span class="main">∪</span> <span class="keyword1">closure</span> <span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> clsr_def<span class="main">)</span>


<span class="keyword1"><span class="command">subsubsection</span></span><span class="quoted"><span class="plain_text">‹Frontier›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> frontierI<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">x</span> <span class="main">∈</span> <span class="keyword1">closure</span> <span class="free">s</span><span class="main">;</span> <span class="free">x</span> <span class="main">∈</span> <span class="keyword1">core</span> <span class="free">s</span> <span class="main">⟹</span> False<span class="main">⟧</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">∈</span> <span class="keyword1">frontier</span> <span class="free">s</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> frt_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> frontierE<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">x</span> <span class="main">∈</span> <span class="keyword1">frontier</span> <span class="free">s</span><span class="main">;</span> <span class="main">⟦</span><span class="free">x</span> <span class="main">∈</span> <span class="keyword1">closure</span> <span class="free">s</span><span class="main">;</span> <span class="free">x</span> <span class="main">∈</span> <span class="keyword1">core</span> <span class="free">s</span> <span class="main">⟹</span> False<span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> frt_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> frontier_closed <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">frontier</span> <span class="free">s</span> <span class="keyword1">closed</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> frt_def<span class="main">)</span>
<span class="main">(</span><span class="operator">intro</span> closure_closed core_open closed_diff_open<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> frontier_Un_core<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">frontier</span> <span class="free">s</span> <span class="main">∪</span> <span class="keyword1">core</span> <span class="free">s</span> <span class="main">=</span> <span class="keyword1">closure</span> <span class="free">s</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> subsetD <span class="main"><span class="main">[</span></span><span class="operator">OF</span> core_subset<span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> frt_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> frontier_Int_core<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">frontier</span> <span class="free">s</span> <span class="main">∩</span> <span class="keyword1">core</span> <span class="free">s</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> frt_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> closure_frontier <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">closure</span> <span class="main">(</span><span class="keyword1">frontier</span> <span class="free">a</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">frontier</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> frontier_carrier <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">frontier</span> <span class="keyword1">carrier</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> frt_def<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Hence frontier is not monotone. Also <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">prop</span></span> <span class="quoted"><span class="quoted">"cor <span class="free"><span class="free">T</span></span> <span class="main"><span class="main">(</span></span>frt <span class="free"><span class="free">T</span></span> <span class="free"><span class="free">A</span></span><span class="main"><span class="main">)</span></span> <span class="main"><span class="main">=</span></span>
<span class="main"><span class="main">{}</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is not a theorem as illustrated by the following counter
example. By the way: could the counter example be prooved using an
instantiation?›</span></span>

<span class="keyword1" id="Topology-counter_example_core_frontier"><span class="command">lemma</span></span> counter_example_core_frontier<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">X</span> <span class="keyword2"><span class="keyword">defines</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">≡</span> <span class="main">(</span>UNIV<span class="main">::</span>nat set<span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">≡</span> indiscrete_top <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">core</span> <span class="main">(</span><span class="keyword1">frontier</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> indiscrete <span class="quoted"><span class="free">X</span></span> <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">core</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> carrier <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> cor_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">closure</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span> <span class="main">=</span> UNIV"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> clsr_def carrier <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> is_closed_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">frontier</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span> <span class="main">=</span> UNIV"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> frt_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cor_def carrier <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsubsection</span></span><span class="quoted"><span class="plain_text">‹Adherent points›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">adhs</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> set <span class="main">⇒</span> bool"</span></span>     <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">adh</span>ı"</span> 50<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">adhs</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">U</span> <span class="main">∈</span> nhd <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">.</span> <span class="bound">U</span> <span class="main">∩</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">≠</span> <span class="main">{}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> adhCE <span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main">?</span></span></span><span class="main">]</span><span class="main">:</span>
<span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">x</span> <span class="keyword1">adh</span> <span class="free">A</span><span class="main">;</span>  <span class="free">U</span> <span class="main">∉</span> <span class="keyword1">nhds</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">R</span><span class="main">;</span> <span class="free">U</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span>  <span class="main">⟹</span> <span class="free">R</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> adhs_def<span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> adhI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span> <span class="main">⟹</span> <span class="bound">U</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">x</span> <span class="keyword1">adh</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> adhs_def<span class="main">)</span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> closure_imp_adh<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> asub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> closure<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">closure</span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">adh</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">U</span> <span class="keyword3"><span class="command">assume</span></span> unhd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> UA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> unhd <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">V</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="keyword1">open</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="skolem">V</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> VU<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">⊆</span> <span class="skolem">U</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> UA VU <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">using</span></span> asub closure
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span>  <span class="quasi_keyword">dest</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> compl_open_closed <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> clsr_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> adh_imp_closure<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> xpoint<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>   adh<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">adh</span> <span class="free">A</span>"</span></span>  
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">closure</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> notclosure<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∉</span> <span class="keyword1">closure</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">C</span></span>
    <span class="keyword2"><span class="keyword">where</span></span> closed<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="keyword1">closed</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span>   asubc<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="skolem">C</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span>   xnotinc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∉</span> <span class="skolem">C</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> clsr_def<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> closed <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">-</span> <span class="skolem">C</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> closedE<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> xpoint xnotinc <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span> <span class="main">-</span> <span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">-</span> <span class="skolem">C</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> adh <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="skolem">C</span><span class="main">)</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> adhCE<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> asubc <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> closed_adh<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Asub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">closed</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">.</span> <span class="bound">x</span> <span class="keyword1">adh</span> <span class="free">A</span> <span class="main">⟶</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">closed</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> AA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">closure</span> <span class="free">A</span> <span class="main">=</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">.</span> <span class="bound">x</span> <span class="keyword1">adh</span> <span class="free">A</span> <span class="main">⟶</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">fast</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> adh_imp_closure<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">assume</span></span> adhA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">.</span> <span class="bound">x</span> <span class="keyword1">adh</span> <span class="free">A</span> <span class="main">⟶</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">closure</span> <span class="free">A</span> <span class="main">⊆</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> xclosure<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">closure</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Asub <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> closure_subset<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> xclosure <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Asub adhA
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> closure_imp_adh<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">closed</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> closure_eq_closed<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> adh_closure_iff<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="main">;</span> <span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">adh</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">∈</span> <span class="keyword1">closure</span> <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> adh_imp_closure closure_imp_adh<span class="main">)</span>


<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹More about closure and core›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> closure_complement <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"<span class="keyword1">closure</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">carrier</span> <span class="main">-</span> <span class="keyword1">core</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="keyword1">closure</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> closure_subset<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">closure</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">∩</span> <span class="keyword1">core</span> <span class="free">A</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> seteqI<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarsimp</span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> xclosure<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">closure</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> xadh<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="keyword1">adh</span> <span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> closure_imp_adh<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> xcore<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">core</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">core</span> <span class="free">A</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">core</span> <span class="free">A</span> <span class="main">∩</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> adhCE<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> core_subsetD<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">closure</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">⊆</span> <span class="keyword1">carrier</span> <span class="main">-</span> <span class="keyword1">core</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">-</span> <span class="keyword1">core</span> <span class="free">A</span> <span class="main">⊆</span> <span class="keyword1">closure</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cor_def clsr_def is_closed_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> core_complement <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> asub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"<span class="keyword1">core</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">carrier</span> <span class="main">-</span> <span class="keyword1">closure</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">-</span> <span class="keyword1">closure</span> <span class="free">A</span> <span class="main">⊆</span> <span class="keyword1">core</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cor_def clsr_def is_closed_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">core</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> coreE<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="keyword1">core</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">∩</span> <span class="keyword1">closure</span> <span class="free">A</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">core</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">iff</span><span class="main"><span class="main">:</span></span> core_nhds_iff<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">closure</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∩</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> asub
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> closure_imp_adh <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> adhCE<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">core</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">⊆</span> <span class="keyword1">carrier</span> <span class="main">-</span> <span class="keyword1">closure</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> core_closure_diff_empty <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> asub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">core</span> <span class="main">(</span><span class="keyword1">closure</span> <span class="free">A</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">core</span> <span class="main">(</span><span class="keyword1">closure</span> <span class="free">A</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    mopen<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="keyword1">open</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    xinm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="skolem">m</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    msub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">⊆</span> <span class="keyword1">closure</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    minter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> coreE<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> xinm msub <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="keyword1">adh</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> asub
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> closure_imp_adh<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> xinm mopen <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> adhCE<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> minter <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Dense sets›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">is_densein</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> set <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">densein</span>ı"</span> 50<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">is_densein</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">⟷</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">⊆</span> clsr <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">is_dense</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'a</span> set <span class="main">⇒</span> bool"</span></span>             <span class="main">(</span><span class="quoted">"_ <span class="keyword1">dense</span>ı"</span> <span class="main">[</span>50<span class="main">]</span> 50<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">is_dense</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">=</span> is_densein <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">(</span>carr <span class="free"><span class="bound"><span class="entity">T</span></span></span><span class="main">)</span>"</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> densinI <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">⊆</span> <span class="keyword1">closure</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">A</span> <span class="keyword1">densein</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> is_densein_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> denseinE <span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">A</span> <span class="keyword1">densein</span> <span class="free">B</span><span class="main">;</span> <span class="free">B</span> <span class="main">⊆</span> <span class="keyword1">closure</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">R</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> is_densein_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> denseI <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">⊆</span> <span class="keyword1">closure</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">A</span> <span class="keyword1">dense</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> is_dense_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> denseE <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">A</span> <span class="keyword1">dense</span><span class="main">;</span> <span class="keyword1">carrier</span> <span class="main">⊆</span> <span class="keyword1">closure</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">R</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> is_dense_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> dense_closure_eq <span class="main">[</span><span class="operator">dest</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">A</span> <span class="keyword1">dense</span><span class="main">;</span> <span class="free">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="keyword1">closure</span> <span class="free">A</span> <span class="main">=</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> closure_subset<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> dense_lemma<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span> <span class="main">⟹</span> <span class="keyword1">carrier</span> <span class="main">-</span> <span class="main">(</span><span class="keyword1">closure</span> <span class="free">A</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="keyword1">dense</span>"</span></span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> ex_dense_closure_inter<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> ssub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">D</span> <span class="bound">C</span><span class="main">.</span> <span class="bound">D</span> <span class="keyword1">dense</span> <span class="main">∧</span> <span class="bound">C</span> <span class="keyword1">closed</span> <span class="main">∧</span> <span class="free">S</span> <span class="main">=</span> <span class="bound">D</span> <span class="main">∩</span> <span class="bound">C</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?D</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">-</span> <span class="main">(</span><span class="keyword1">closure</span> <span class="free">S</span> <span class="main">-</span> <span class="free">S</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="keyword1">closure</span> <span class="free">S</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> ssub <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?D</span> <span class="keyword1">dense</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?C</span> <span class="keyword1">closed</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> ssub
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="main">(</span><span class="keyword1">closure</span> <span class="free">S</span> <span class="main">-</span> <span class="free">S</span><span class="main">)</span><span class="main">)</span> <span class="main">∩</span> <span class="keyword1">closure</span> <span class="free">S</span> <span class="main">=</span> <span class="free">S</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> diff_diff_inter subset_closure<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> ex_dense_closure_interE<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> ssub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> H<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">D</span> <span class="bound">C</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">D</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="main">;</span> <span class="bound">C</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="main">;</span> <span class="bound">D</span> <span class="keyword1">dense</span><span class="main">;</span> <span class="bound">C</span> <span class="keyword1">closed</span><span class="main">;</span> <span class="free">S</span> <span class="main">=</span> <span class="bound">D</span> <span class="main">∩</span> <span class="bound">C</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?D</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="main">(</span><span class="keyword1">closure</span> <span class="free">S</span> <span class="main">-</span> <span class="free">S</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="keyword1">closure</span> <span class="free">S</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?D</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?C</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> closure_subset<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?D</span> <span class="keyword1">dense</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?C</span> <span class="keyword1">closed</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> ssub <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">=</span> <span class="var">?D</span> <span class="main">∩</span> <span class="var">?C</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> diff_diff_inter subset_closure<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> H<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Continuous functions›</span></span>


<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">INJ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'b</span> set <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'b</span><span class="main">)</span> set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">INJ</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">=</span> <span class="main">{</span><span class="bound">f</span><span class="main">.</span> <span class="bound">f</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">→</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">∧</span> inj_on <span class="bound">f</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">SUR</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'b</span> set <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'b</span><span class="main">)</span> set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">SUR</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">=</span> <span class="main">{</span><span class="bound">f</span><span class="main">.</span> <span class="bound">f</span> <span class="main">:</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">→</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">y</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">.</span> <span class="main">∃</span> <span class="bound">x</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">.</span> <span class="bound">y</span> <span class="main">=</span> <span class="bound">f</span> <span class="bound">x</span><span class="main">)</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">BIJ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'b</span> set <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'b</span><span class="main">)</span> set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">BIJ</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">=</span> INJ <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">∩</span> SUR <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">cnt</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'b</span> top <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'b</span><span class="main">)</span> set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">cnt</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">=</span> <span class="main">{</span><span class="bound">f</span><span class="main">.</span> <span class="bound">f</span> <span class="main">:</span> carr <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">→</span> carr <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">∧</span>
                <span class="main">(</span><span class="main">∀</span> <span class="bound">m</span><span class="main">.</span> is_open <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="bound">m</span> <span class="main">⟶</span> is_open <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">(</span>carr <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∩</span> <span class="main">(</span><span class="bound">f</span> <span class="main">-`</span> <span class="bound">m</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">HOM</span> <span class="main">::</span> <span class="quoted"><span class="quoted">" <span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'b</span> top <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'b</span><span class="main">)</span> set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">HOM</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">=</span> <span class="main">{</span><span class="bound">f</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> cnt <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">∧</span> inv <span class="bound">f</span> <span class="main">∈</span> cnt <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∧</span> <span class="bound">f</span> <span class="main">∈</span> BIJ <span class="main">(</span>carr <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span> <span class="main">(</span>carr <span class="free"><span class="bound"><span class="entity">T</span></span></span><span class="main">)</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">homeo</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'b</span> top <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">homeo</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">h</span> <span class="main">∈</span> BIJ <span class="main">(</span>carr <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span> <span class="main">(</span>carr <span class="free"><span class="bound"><span class="entity">T</span></span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span> <span class="main">∈</span> cnt <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">∧</span> inv <span class="bound">h</span> <span class="main">∈</span> cnt <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">fimg</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'b</span> top <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'b</span><span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'a</span> set set <span class="main">⇒</span> <span class="tfree">'b</span> set set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">fimg</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">=</span> <span class="main">{</span><span class="bound">v</span><span class="main">.</span> <span class="bound">v</span> <span class="main">⊆</span> carr <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">`</span><span class="bound">u</span> <span class="main">⊆</span> <span class="bound">v</span><span class="main">)</span><span class="main">}</span>"</span></span>


<span class="keyword1" id="Topology-domain_subset_vimage"><span class="command">lemma</span></span> domain_subset_vimage<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">:</span> <span class="free">A</span> <span class="main">→</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">⊆</span> <span class="free">f</span><span class="main">-`</span><span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> funcset_mem<span class="main">)</span>

<span class="keyword1" id="Topology-domain_inter_vimage"><span class="command">lemma</span></span> domain_inter_vimage<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">:</span> <span class="free">A</span> <span class="main">→</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">∩</span> <span class="free">f</span><span class="main">-`</span><span class="free">B</span> <span class="main">=</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> funcset_mem<span class="main">)</span>

<span class="keyword1" id="Topology-funcset_vimage_diff"><span class="command">lemma</span></span> funcset_vimage_diff<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">:</span> <span class="free">A</span> <span class="main">→</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">-</span> <span class="free">f</span><span class="main">-`</span><span class="main">(</span><span class="free">B</span> <span class="main">-</span> <span class="free">C</span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span> <span class="main">∩</span> <span class="free">f</span><span class="main">-`</span><span class="free">C</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> funcset_mem<span class="main">)</span>

<span class="keyword1"><span class="command">locale</span></span> func <span class="main">=</span> S<span class="main">?</span><span class="main">:</span> carrier <span class="quoted"><span class="free">S</span></span> <span class="main">+</span> T<span class="main">?</span><span class="main">:</span> carrier <span class="quoted"><span class="free">T</span></span>
  <span class="keyword2"><span class="keyword">for</span></span> <span class="free">f</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fimage</span> <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> func <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">:</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">fimage</span> <span class="main">≡</span> fimg <span class="free">T</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">notes</span></span> func_mem <span class="main">[</span><span class="operator">simp</span><span class="main">,</span> <span class="operator">intro</span><span class="main">]</span> <span class="main">=</span> funcset_mem <span class="main">[</span><span class="operator">OF</span> func<span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span>   domain_subset_vimage <span class="main">[</span><span class="operator">iff</span><span class="main">]</span> <span class="main">=</span> domain_subset_vimage <span class="main">[</span><span class="operator">OF</span> func<span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span>   domain_inter_vimage  <span class="main">[</span><span class="operator">simp</span><span class="main">]</span> <span class="main">=</span> domain_inter_vimage <span class="main">[</span><span class="operator">OF</span> func<span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span>   vimage_diff          <span class="main">[</span><span class="operator">simp</span><span class="main">]</span> <span class="main">=</span> funcset_vimage_diff <span class="main">[</span><span class="operator">OF</span> func<span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> func<span class="main">)</span> fimageI <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">v</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">;</span> <span class="free">u</span> <span class="main">∈</span> <span class="free">F</span><span class="main">;</span> <span class="free">f</span><span class="main">`</span><span class="free">u</span> <span class="main">⊆</span> <span class="free">v</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">v</span> <span class="main">∈</span> <span class="free">fimage</span> <span class="free">F</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fimg_def fimage_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> func<span class="main">)</span> fimageE <span class="main">[</span><span class="operator">elim</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">v</span> <span class="main">∈</span> <span class="free">fimage</span> <span class="free">F</span><span class="main">;</span> <span class="main">⋀</span><span class="bound">u</span><span class="main">.</span> <span class="main">⟦</span> <span class="free">v</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">;</span> <span class="bound">u</span><span class="main">∈</span><span class="free">F</span><span class="main">;</span> <span class="free">f</span><span class="main">`</span><span class="bound">u</span> <span class="main">⊆</span> <span class="free">v</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> fimage_def fimg_def<span class="main">)</span>

<span class="keyword1" id="Topology-cntI"><span class="command">lemma</span></span> cntI<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">f</span> <span class="main">:</span> carr <span class="free">S</span> <span class="main">→</span> carr <span class="free">T</span><span class="main">;</span> 
    <span class="main">(</span><span class="main">⋀</span><span class="bound">m</span><span class="main">.</span> is_open <span class="free">T</span> <span class="bound">m</span> <span class="main">⟹</span> is_open <span class="free">S</span> <span class="main">(</span>carr <span class="free">S</span> <span class="main">∩</span> <span class="main">(</span><span class="free">f</span> <span class="main">-`</span> <span class="bound">m</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⟧</span>
  <span class="main">⟹</span> <span class="free">f</span> <span class="main">∈</span> cnt <span class="free">S</span> <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cnt_def<span class="main">)</span>

<span class="keyword1" id="Topology-cntE"><span class="command">lemma</span></span> cntE<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">f</span> <span class="main">∈</span> cnt <span class="free">S</span> <span class="free">T</span><span class="main">;</span>
     <span class="main">⟦</span> <span class="free">f</span> <span class="main">:</span> carr <span class="free">S</span> <span class="main">→</span> carr <span class="free">T</span><span class="main">;</span>
      <span class="main">∀</span><span class="bound">m</span><span class="main">.</span> is_open <span class="free">T</span> <span class="bound">m</span> <span class="main">⟶</span> is_open <span class="free">S</span> <span class="main">(</span>carr <span class="free">S</span> <span class="main">∩</span> <span class="main">(</span><span class="free">f</span> <span class="main">-`</span> <span class="bound">m</span><span class="main">)</span><span class="main">)</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">P</span>
   <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cnt_def<span class="main">)</span>

<span class="keyword1" id="Topology-cntCE"><span class="command">lemma</span></span> cntCE<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">f</span> <span class="main">∈</span> cnt <span class="free">S</span> <span class="free">T</span><span class="main">;</span>
     <span class="main">⟦</span> <span class="main">¬</span> is_open <span class="free">T</span> <span class="free">m</span><span class="main">;</span> <span class="free">f</span> <span class="main">:</span> carr <span class="free">S</span> <span class="main">→</span> carr <span class="free">T</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">P</span><span class="main">;</span>
     <span class="main">⟦</span> is_open <span class="free">S</span> <span class="main">(</span>carr <span class="free">S</span> <span class="main">∩</span> <span class="main">(</span><span class="free">f</span> <span class="main">-`</span> <span class="free">m</span><span class="main">)</span><span class="main">)</span><span class="main">;</span> <span class="free">f</span> <span class="main">:</span> carr <span class="free">S</span> <span class="main">→</span> carr <span class="free">T</span> <span class="main">⟧</span>  <span class="main">⟹</span> <span class="free">P</span>
   <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cnt_def<span class="main">)</span>

<span class="keyword1" id="Topology-cnt_fun"><span class="command">lemma</span></span> cnt_fun<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> cnt <span class="free">S</span> <span class="free">T</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">:</span> carr <span class="free">S</span> <span class="main">→</span> carr <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cnt_def<span class="main">)</span>

<span class="keyword1" id="Topology-cntD1"><span class="command">lemma</span></span> cntD1<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">f</span> <span class="main">∈</span> cnt <span class="free">S</span> <span class="free">T</span><span class="main">;</span> <span class="free">x</span> <span class="main">∈</span> carr <span class="free">S</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">f</span> <span class="free">x</span> <span class="main">∈</span> carr <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cnt_def <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> funcset_mem<span class="main">)</span>

<span class="keyword1" id="Topology-cntD2"><span class="command">lemma</span></span> cntD2<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">f</span> <span class="main">∈</span> cnt <span class="free">S</span> <span class="free">T</span><span class="main">;</span> is_open <span class="free">T</span> <span class="free">m</span> <span class="main">⟧</span> <span class="main">⟹</span> is_open <span class="free">S</span> <span class="main">(</span>carr <span class="free">S</span> <span class="main">∩</span> <span class="main">(</span><span class="free">f</span> <span class="main">-`</span> <span class="free">m</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cnt_def<span class="main">)</span>


<span class="keyword1"><span class="command">locale</span></span> continuous <span class="main">=</span> func <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> continuous <span class="main">[</span><span class="operator">dest</span><span class="main">,</span> <span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="keyword1">carrier</span> <span class="main">∩</span> <span class="main">(</span><span class="free">f</span> <span class="main">-`</span> <span class="free">m</span><span class="main">)</span> <span class="keyword1">open</span>"</span></span>

<span class="keyword1" id="Topology-continuousI"><span class="command">lemma</span></span> continuousI<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">S</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">:</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
           <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="keyword1">carrier</span> <span class="main">∩</span> <span class="main">(</span><span class="free">f</span> <span class="main">-`</span> <span class="bound">m</span><span class="main">)</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"continuous <span class="free">f</span> <span class="free">S</span> <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> continuous_def func_def continuous_axioms_def<span class="main">)</span>

<span class="keyword1" id="Topology-continuousE"><span class="command">lemma</span></span> continuousE<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">S</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> continuous <span class="free">f</span> <span class="free">S</span> <span class="free">T</span><span class="main">;</span>
     <span class="main">⟦</span> <span class="free">f</span> <span class="main">:</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">;</span>
      <span class="main">∀</span><span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">⟶</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span> <span class="main">∩</span> <span class="main">(</span><span class="free">f</span> <span class="main">-`</span> <span class="bound">m</span><span class="main">)</span> <span class="keyword1">open</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">P</span>
   <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> continuous_def func_def continuous_axioms_def<span class="main">)</span>

<span class="keyword1" id="Topology-continuousCE"><span class="command">lemma</span></span> continuousCE<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">S</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> continuous <span class="free">f</span> <span class="free">S</span> <span class="free">T</span><span class="main">;</span>
     <span class="main">⟦</span> <span class="main">¬</span> <span class="free">m</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">;</span> <span class="free">f</span> <span class="main">:</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">P</span><span class="main">;</span>
     <span class="main">⟦</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span> <span class="main">∩</span> <span class="main">(</span><span class="free">f</span> <span class="main">-`</span> <span class="free">m</span><span class="main">)</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span><span class="main">;</span> <span class="free">f</span> <span class="main">:</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">⟧</span>  <span class="main">⟹</span> <span class="free">P</span>
   <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> continuous_def func_def continuous_axioms_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> continuous<span class="main">)</span> closed_vimage <span class="main">[</span><span class="operator">intro</span><span class="main">,</span> <span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> csubset<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> cclosed<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="keyword1">closed</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">-`</span> <span class="free">c</span> <span class="keyword1">closed</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> cclosed <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">-</span> <span class="free">c</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> closedE<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">∩</span> <span class="free">f</span> <span class="main">-`</span> <span class="main">(</span><span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">f</span> <span class="main">-`</span> <span class="free">c</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> diffsimps<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">-`</span> <span class="free">c</span> <span class="keyword1">closed</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> S.closedI<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Topology-continuousI2"><span class="command">lemma</span></span> continuousI2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">S</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> func<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">:</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span> <span class="main">→</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> R<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">c</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">c</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span><span class="main">;</span> <span class="bound">c</span> <span class="keyword1">closed</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">-`</span> <span class="bound">c</span> <span class="keyword1">closed</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"continuous <span class="free">f</span> <span class="free">S</span> <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> continuous.intro<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> func <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"func <span class="free">f</span> <span class="free">S</span> <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> func_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">interpret</span></span> S<span class="main">:</span> carrier <span class="quoted"><span class="free">S</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">interpret</span></span> T<span class="main">:</span> carrier <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"continuous_axioms <span class="free">f</span> <span class="free">S</span> <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> continuous_axioms.intro<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?c</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">-</span> <span class="skolem">m</span>"</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> csubset<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?c</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> cclosed<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?c</span> <span class="keyword1">closed</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">-`</span> <span class="var">?c</span> <span class="keyword1">closed</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> R<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">f</span> <span class="main">-`</span> <span class="var">?c</span> <span class="keyword1">open</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> S.closedE<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">∩</span> <span class="free">f</span> <span class="main">-`</span> <span class="skolem">m</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> funcset_vimage_diff <span class="main"><span class="main">[</span></span><span class="operator">OF</span> func<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1" id="Topology-cnt_compose"><span class="command">lemma</span></span> cnt_compose<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">f</span> <span class="main">∈</span> cnt <span class="free">S</span> <span class="free">T</span><span class="main">;</span> <span class="free">g</span> <span class="main">∈</span> cnt <span class="free">T</span> <span class="free">U</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">g</span> <span class="main">∘</span> <span class="free">f</span><span class="main">)</span> <span class="main">∈</span> cnt <span class="free">S</span> <span class="free">U</span> "</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> cntI funcset_comp <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> cntE <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vimage_comp<span class="main">)</span>

<span class="keyword1" id="Topology-continuous_compose"><span class="command">lemma</span></span> continuous_compose<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> continuous <span class="free">f</span> <span class="free">S</span> <span class="free">T</span><span class="main">;</span> continuous <span class="free">g</span> <span class="free">T</span> <span class="free">U</span> <span class="main">⟧</span> <span class="main">⟹</span> continuous <span class="main">(</span><span class="free">g</span> <span class="main">∘</span> <span class="free">f</span><span class="main">)</span> <span class="free">S</span> <span class="free">U</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> continuousI funcset_comp
       <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> continuousE <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vimage_comp<span class="main">)</span>


<span class="keyword1" id="Topology-id_continuous"><span class="command">lemma</span></span> id_continuous<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"continuous id <span class="free">T</span> <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> continuousI<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"id <span class="main">∈</span> <span class="keyword1">carrier</span> <span class="main">→</span> <span class="keyword1">carrier</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> funcsetI<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">interpret</span></span> T<span class="main">:</span> carrier <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> <span class="keyword3"><span class="command">assume</span></span> mopen<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">∩</span> <span class="skolem">m</span> <span class="main">=</span> <span class="skolem">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"carr <span class="free">T</span> <span class="main">∩</span> id <span class="main">-`</span> <span class="skolem">m</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> mopen
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> discrete<span class="main">)</span> continuous<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fimage</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"func <span class="free">f</span> <span class="free">T</span> <span class="free">S</span>"</span></span> <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">fimage</span> <span class="main">≡</span> fimg <span class="free">S</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"continuous <span class="free">f</span> <span class="free">T</span> <span class="free">S</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> func <span class="quoted"><span class="free">f</span></span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="free">S</span></span> <span class="quoted"><span class="free">fimage</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span> <span class="operator">fact</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> continuousI<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> indiscrete<span class="main">)</span> continuous<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">S</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"topology <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fimage</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"func <span class="free">f</span> <span class="free">S</span> <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">fimage</span> <span class="main">≡</span> fimg <span class="free">T</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"continuous <span class="free">f</span> <span class="free">S</span> <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> S<span class="main">:</span> topology <span class="quoted"><span class="free">S</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword1"><span class="command">interpret</span></span> func <span class="quoted"><span class="free">f</span></span> <span class="quoted"><span class="free">S</span></span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="free">fimage</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span> <span class="operator">fact</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> S.Int_open <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> continuousI<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Filters›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">fbas</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'a</span> set set <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">fbase</span>ı"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">fbas</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">⟷</span> <span class="main">{}</span> <span class="main">∉</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">∧</span>
              <span class="main">(</span><span class="main">∀</span> <span class="bound">a</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">.</span> <span class="main">∀</span> <span class="bound">b</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">.</span> <span class="main">∃</span> <span class="bound">c</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">.</span> <span class="bound">c</span> <span class="main">⊆</span> <span class="bound">a</span> <span class="main">∩</span> <span class="bound">b</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">filters</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'a</span> set set set"</span></span>      <span class="main">(</span><span class="quoted">"<span class="keyword1">Filters</span>ı"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">filters</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">=</span> <span class="main">{</span> <span class="bound">F</span><span class="main">.</span> <span class="main">{}</span> <span class="main">∉</span> <span class="bound">F</span> <span class="main">∧</span> <span class="main">⋃</span><span class="bound">F</span> <span class="main">⊆</span> carr <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">∧</span>
                <span class="main">(</span><span class="main">∀</span> <span class="bound">A</span> <span class="bound">B</span><span class="main">.</span> <span class="bound">A</span><span class="main">∈</span><span class="bound">F</span> <span class="main">∧</span> <span class="bound">B</span><span class="main">∈</span><span class="bound">F</span> <span class="main">⟶</span> <span class="bound">A</span><span class="main">∩</span><span class="bound">B</span> <span class="main">∈</span> <span class="bound">F</span><span class="main">)</span> <span class="main">∧</span>
                <span class="main">(</span><span class="main">∀</span> <span class="bound">A</span> <span class="bound">B</span><span class="main">.</span> <span class="bound">A</span><span class="main">∈</span><span class="bound">F</span> <span class="main">∧</span> <span class="bound">A</span><span class="main">⊆</span><span class="bound">B</span> <span class="main">∧</span> <span class="bound">B</span> <span class="main">⊆</span> carr <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">⟶</span> <span class="bound">B</span> <span class="main">∈</span> <span class="bound">F</span><span class="main">)</span> <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">ultr</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'a</span> set set <span class="main">⇒</span> bool"</span></span>      <span class="main">(</span><span class="quoted">"<span class="keyword1">ultra</span>ı"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ultr</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">A</span><span class="main">.</span> <span class="bound">A</span> <span class="main">⊆</span> carr <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">⟶</span> <span class="bound">A</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">∨</span> <span class="main">(</span>carr <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">-</span> <span class="bound">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Topology-filtersI"><span class="command">lemma</span></span> filtersI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> a1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∉</span> <span class="free">F</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> a2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="free">F</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> a3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">A</span> <span class="bound">B</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">A</span> <span class="main">∈</span> <span class="free">F</span><span class="main">;</span> <span class="bound">B</span> <span class="main">∈</span> <span class="free">F</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="bound">A</span> <span class="main">∩</span> <span class="bound">B</span> <span class="main">∈</span> <span class="free">F</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> a4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">A</span> <span class="bound">B</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">A</span> <span class="main">∈</span> <span class="free">F</span><span class="main">;</span> <span class="bound">A</span> <span class="main">⊆</span> <span class="bound">B</span><span class="main">;</span> <span class="bound">B</span> <span class="main">⊆</span> <span class="keyword1">carrier</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="bound">B</span> <span class="main">∈</span> <span class="free">F</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> a1 a2
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> filters_def <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> a3 a4<span class="main">)</span>


<span class="keyword1" id="Topology-filtersE"><span class="command">lemma</span></span> filtersE<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> a1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">∈</span> filters <span class="free">T</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">{}</span> <span class="main">∉</span> <span class="free">F</span><span class="main">;</span>
            <span class="main">⋃</span><span class="free">F</span> <span class="main">⊆</span> carr <span class="free">T</span><span class="main">;</span>
            <span class="main">∀</span> <span class="bound">A</span> <span class="bound">B</span><span class="main">.</span> <span class="bound">A</span><span class="main">∈</span><span class="free">F</span> <span class="main">∧</span>  <span class="bound">B</span><span class="main">∈</span><span class="free">F</span> <span class="main">⟶</span> <span class="bound">A</span><span class="main">∩</span><span class="bound">B</span> <span class="main">∈</span> <span class="free">F</span><span class="main">;</span>
            <span class="main">∀</span> <span class="bound">A</span> <span class="bound">B</span><span class="main">.</span> <span class="bound">A</span><span class="main">∈</span><span class="free">F</span> <span class="main">∧</span> <span class="bound">A</span><span class="main">⊆</span><span class="bound">B</span> <span class="main">∧</span> <span class="bound">B</span><span class="main">⊆</span> carr <span class="free">T</span> <span class="main">⟶</span> <span class="bound">B</span> <span class="main">∈</span> <span class="free">F</span>
          <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> a1
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> filters_def<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> R<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="main">(</span><span class="operator">erule</span> conjE<span class="main">)</span><span class="main"><span class="keyword3">+</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">assumption</span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>


<span class="keyword1" id="Topology-filtersD1"><span class="command">lemma</span></span> filtersD1<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">∈</span> filters <span class="free">T</span> <span class="main">⟹</span> <span class="main">{}</span> <span class="main">∉</span> <span class="free">F</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">erule</span> filtersE<span class="main">)</span>


<span class="keyword1" id="Topology-filtersD2"><span class="command">lemma</span></span> filtersD2<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">∈</span> filters <span class="free">T</span> <span class="main">⟹</span> <span class="main">⋃</span><span class="free">F</span> <span class="main">⊆</span> carr <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">erule</span> filtersE<span class="main">)</span>


<span class="keyword1" id="Topology-filtersD3"><span class="command">lemma</span></span> filtersD3<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">F</span> <span class="main">∈</span> filters <span class="free">T</span><span class="main">;</span> <span class="free">A</span><span class="main">∈</span><span class="free">F</span><span class="main">;</span>  <span class="free">B</span><span class="main">∈</span><span class="free">F</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">∩</span> <span class="free">B</span> <span class="main">∈</span> <span class="free">F</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> filtersE<span class="main">)</span>


<span class="keyword1" id="Topology-filtersD4"><span class="command">lemma</span></span> filtersD4<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">F</span> <span class="main">∈</span> filters <span class="free">T</span><span class="main">;</span> <span class="free">A</span> <span class="main">⊆</span> <span class="free">B</span><span class="main">;</span> <span class="free">B</span> <span class="main">⊆</span> carr <span class="free">T</span><span class="main">;</span> <span class="free">A</span><span class="main">∈</span><span class="free">F</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">B</span> <span class="main">∈</span> <span class="free">F</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> filtersE<span class="main">)</span>

<span class="keyword1"><span class="command">locale</span></span> filter <span class="main">=</span> carrier <span class="quoted"><span class="free">T</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">F</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> F_filter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span>
  <span class="keyword2"><span class="keyword">notes</span></span> not_empty <span class="main">[</span><span class="operator">iff</span><span class="main">]</span>       <span class="main">=</span> filtersD1 <span class="main">[</span><span class="operator">OF</span> F_filter<span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span>   union_carr <span class="main">[</span><span class="operator">iff</span><span class="main">]</span>      <span class="main">=</span> filtersD2 <span class="main">[</span><span class="operator">OF</span> F_filter<span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span>   filter_inter <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">,</span> <span class="operator">simp</span><span class="main">]</span> <span class="main">=</span> filtersD3 <span class="main">[</span><span class="operator">OF</span> F_filter<span class="main">]</span>
  <span class="keyword2"><span class="keyword">and</span></span>   filter_greater <span class="main">[</span><span class="operator">dest</span><span class="main">]</span> <span class="main">=</span> filtersD4 <span class="main">[</span><span class="operator">OF</span> F_filter<span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> filter<span class="main">)</span> elem_carrier <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="free">F</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> R<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="main">;</span> <span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="free">F</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> A <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> R<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1" id="Topology-empty_filter"><span class="command">lemma</span></span> empty_filter <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∈</span> filters <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> filter<span class="main">)</span> contains_carrier <span class="main">[</span><span class="operator">intro</span><span class="main">,</span> <span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> F_not_empty<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">≠</span><span class="main">{}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">∈</span> <span class="free">F</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> F_not_empty <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="free">F</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Topology-nonempty_filter_implies_nonempty_carrier"><span class="command">lemma</span></span> nonempty_filter_implies_nonempty_carrier<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> F_filter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> F_not_empty<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">∈</span> <span class="free">F</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> filter.contains_carrier <span class="main"><span class="main">[</span></span><span class="operator">OF</span> filter.intro<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> F_filter
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> filtersD1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Topology-carrier_singleton_filter"><span class="command">lemma</span></span> carrier_singleton_filter<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="main">{</span><span class="keyword1">carrier</span><span class="main">}</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> nhds_filter<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">nhds</span> <span class="free">x</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> nhds_greater <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> filtersI nhds_inter<span class="main">)</span>

<span class="keyword1" id="Topology-fimage_filter"><span class="command">lemma</span></span> fimage_filter<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fimage</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"func <span class="free">f</span> <span class="free">S</span> <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">fimage</span> <span class="main">≡</span> fimg <span class="free">T</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">F</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"filter <span class="free">F</span> <span class="free">S</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">fimage</span> <span class="free">F</span> <span class="main">∈</span> <span class="keyword1">Filters</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> func <span class="quoted"><span class="free">f</span></span> <span class="quoted"><span class="free">S</span></span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="free">fimage</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span> <span class="operator">fact</span>
  <span class="keyword1"><span class="command">interpret</span></span> filter <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="free">S</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="skolem">B</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="free">fimage</span> <span class="free">F</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> <span class="free">fimage</span> <span class="free">F</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="keyword2"><span class="keyword">where</span></span>
      AY<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">⊆</span><span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> aF<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="free">F</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> fa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">`</span> <span class="skolem">a</span> <span class="main">⊆</span> <span class="skolem">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      BY<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">⊆</span><span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> bF<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span><span class="free">F</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> fb<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">`</span> <span class="skolem">b</span> <span class="main">⊆</span> <span class="skolem">B</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> AY BY <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">∩</span><span class="skolem">B</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> aF bF <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∩</span> <span class="skolem">b</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> aF bF fa fb <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">a</span> <span class="main">∩</span> <span class="skolem">b</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">A</span> <span class="main">∩</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">∩</span><span class="skolem">B</span> <span class="main">∈</span> <span class="free">fimage</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Topology-Int_filters"><span class="command">lemma</span></span> Int_filters<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">F</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"filter <span class="free">F</span> <span class="free">T</span>"</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">E</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"filter <span class="free">E</span> <span class="free">T</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">∩</span> <span class="free">E</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> filter <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword1"><span class="command">interpret</span></span> filter <span class="quoted"><span class="free">E</span></span> <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Topology-ultraCI"><span class="command">lemma</span></span> ultraCI <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">!</span></span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span><span class="bound">A</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="main">;</span> <span class="keyword1">carrier</span> <span class="main">-</span> <span class="bound">A</span> <span class="main">∉</span> <span class="free">F</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="bound">A</span> <span class="main">∈</span> <span class="free">F</span><span class="main">)</span> <span class="main">⟹</span> <span class="keyword1">ultra</span> <span class="free">F</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> ultr_def<span class="main">)</span>


<span class="keyword1" id="Topology-ultraE"><span class="command">lemma</span></span> ultraE<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="keyword1">ultra</span> <span class="free">F</span><span class="main">;</span> <span class="free">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="main">;</span>
     <span class="free">A</span> <span class="main">∈</span> <span class="free">F</span> <span class="main">⟹</span> <span class="free">R</span><span class="main">;</span>
     <span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span> <span class="main">∈</span> <span class="free">F</span> <span class="main">⟹</span> <span class="free">R</span>
  <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> ultr_def<span class="main">)</span>

<span class="keyword1" id="Topology-ultraD"><span class="command">lemma</span></span> ultraD<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="keyword1">ultra</span> <span class="free">F</span><span class="main">;</span> <span class="free">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="main">;</span> <span class="free">A</span> <span class="main">∉</span> <span class="free">F</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">F</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">erule</span> ultraE<span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">locale</span></span> ultra_filter <span class="main">=</span> filter <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> ultra<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">ultra</span> <span class="free">F</span>"</span></span>
  <span class="keyword2"><span class="keyword">notes</span></span> ultraD <span class="main">=</span> ultraD <span class="main">[</span><span class="operator">OF</span> ultra<span class="main">]</span>
  <span class="keyword2"><span class="keyword">notes</span></span> ultraE <span class="main">[</span><span class="operator">elim</span><span class="main">]</span> <span class="main">=</span> ultraE <span class="main">[</span><span class="operator">OF</span> ultra<span class="main">]</span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ultra_filter<span class="main">)</span> max<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">E</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"filter <span class="free">E</span> <span class="free">T</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> fsube<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">⊆</span> <span class="free">E</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">E</span> <span class="main">⊆</span> <span class="free">F</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> filter <span class="quoted"><span class="free">E</span></span> <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> xinE<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">E</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">F</span> <span class="main">∨</span> <span class="keyword1">carrier</span> <span class="main">-</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">F</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">clarify</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">-</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="free">F</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">-</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="free">E</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fsube <span class="keyword1"><span class="command">..</span></span>
      <span class="keyword1"><span class="command">with</span></span> xinE <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∩</span> <span class="main">(</span><span class="keyword1">carrier</span> <span class="main">-</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">E</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> filter<span class="main">)</span> max_ultra<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> carrier_not_empty<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> fmax<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">E</span> <span class="main">∈</span> <span class="keyword1">Filters</span><span class="main">.</span> <span class="free">F</span> <span class="main">⊆</span> <span class="bound">E</span> <span class="main">⟶</span> <span class="free">F</span> <span class="main">=</span> <span class="bound">E</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">ultra</span> <span class="free">F</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>

  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?CA</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">-</span> <span class="skolem">A</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A_subset_carrier<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
     <span class="keyword2"><span class="keyword">and</span></span> CA_notin_F<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?CA</span> <span class="main">∉</span> <span class="free">F</span>"</span></span>

  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?E</span></span></span>  <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">V</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">U</span><span class="main">∈</span><span class="free">F</span><span class="main">.</span> <span class="bound">V</span> <span class="main">⊆</span> <span class="keyword1">carrier</span> <span class="main">∧</span> <span class="skolem">A</span> <span class="main">∩</span> <span class="bound">U</span> <span class="main">⊆</span> <span class="bound">V</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?E</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∉</span> <span class="var">?E</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">clarify</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">U</span> <span class="keyword3"><span class="command">assume</span></span> U_in_F<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∩</span> <span class="skolem">U</span> <span class="main">⊆</span> <span class="main">{}</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">⊆</span> <span class="var">?CA</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> U_in_F <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?CA</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> CA_notin_F <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="var">?E</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> props<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∩</span> <span class="skolem">u</span> <span class="main">⊆</span> <span class="skolem">a</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∩</span> <span class="skolem">v</span> <span class="main">⊆</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">u</span> <span class="main">∩</span> <span class="skolem">v</span><span class="main">)</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∩</span> <span class="skolem">b</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∩</span> <span class="main">(</span><span class="skolem">u</span> <span class="main">∩</span> <span class="skolem">v</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">a</span> <span class="main">∩</span> <span class="skolem">b</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∩</span> <span class="skolem">b</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> asub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">⊆</span> <span class="skolem">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> bsub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">⊆</span> <span class="var">?E</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> carrier_not_empty
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="keyword1">carrier</span><span class="main">}</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fmax <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> A_subset_carrier <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fmax <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Topology-filter_chain_lemma"><span class="command">lemma</span></span> filter_chain_lemma<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">F</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"filter <span class="free">F</span> <span class="free">T</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> C_chain<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">∈</span> chains <span class="main">{</span><span class="bound">V</span><span class="main">.</span> <span class="bound">V</span> <span class="main">∈</span> <span class="keyword1">Filters</span> <span class="main">∧</span> <span class="free">F</span> <span class="main">⊆</span> <span class="bound">V</span><span class="main">}</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">∈</span> chains <span class="var">?FF</span>"</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">(</span><span class="free">C</span> <span class="main">∪</span> <span class="main">{</span><span class="free">F</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?E</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> filter <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword1"><span class="command">from</span></span> C_chain <span class="keyword1"><span class="command">have</span></span> C_subset_FF<span class="main">[</span><span class="operator">dest</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">C</span> <span class="main">⟹</span> <span class="bound">x</span> <span class="main">∈</span> <span class="var">?FF</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    C_ordered<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">A</span> <span class="main">∈</span> <span class="free">C</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">B</span> <span class="main">∈</span> <span class="free">C</span><span class="main">.</span> <span class="bound">A</span> <span class="main">⊆</span> <span class="bound">B</span> <span class="main">∨</span> <span class="bound">B</span> <span class="main">⊆</span> <span class="bound">A</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> chains_def chain_subset_def<span class="main">)</span>

  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span>    
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∉</span> <span class="var">?E</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> filtersD1<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="var">?E</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> filtersD2<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> a_in_E<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> a_subset_b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">⊆</span> <span class="skolem">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> b_subset_carrier<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> filtersD4<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> a_in_E<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b_in_E<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> A_in_chain<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="free">C</span> <span class="main">∪</span> <span class="main">{</span><span class="free">F</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> B_in_chain<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> <span class="free">C</span> <span class="main">∪</span> <span class="main">{</span><span class="free">F</span><span class="main">}</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> a_in_A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b_in_B<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">∈</span> <span class="skolem">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A_filter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> B_filter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> C_ordered <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">⊆</span> <span class="skolem">B</span> <span class="main">∨</span> <span class="skolem">B</span> <span class="main">⊆</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∩</span><span class="skolem">b</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">⊆</span> <span class="skolem">B</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> a_in_A <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∈</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
      <span class="keyword1"><span class="command">with</span></span> B_filter b_in_B <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∩</span><span class="skolem">b</span> <span class="main">∈</span> <span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> filtersD3<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> B_in_chain <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">⊆</span> <span class="skolem">A</span>"</span></span> <span class="comment1">― ‹Symmetric case›</span>
      <span class="keyword1"><span class="command">with</span></span>  b_in_B A_filter a_in_A A_in_chain
      <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> filtersD3<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Topology-expand_filter_ultra"><span class="command">lemma</span></span> expand_filter_ultra<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> carrier_not_empty<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     F_filter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     R<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">U</span><span class="main">.</span>  <span class="main">⟦</span> <span class="bound">U</span> <span class="main">∈</span> <span class="keyword1">Filters</span><span class="main">;</span>  <span class="free">F</span> <span class="main">⊆</span> <span class="bound">U</span><span class="main">;</span> <span class="keyword1">ultra</span> <span class="bound">U</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?FF</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">V</span><span class="main">.</span> <span class="bound">V</span> <span class="main">∈</span> <span class="keyword1">Filters</span> <span class="main">∧</span> <span class="free">F</span> <span class="main">⊆</span> <span class="bound">V</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">C</span> <span class="main">∈</span> chains <span class="var">?FF</span><span class="main">.</span> <span class="main">∃</span><span class="bound">y</span> <span class="main">∈</span> <span class="var">?FF</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span> <span class="main">∈</span> <span class="bound">C</span><span class="main">.</span> <span class="bound">x</span> <span class="main">⊆</span> <span class="bound">y</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">clarify</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">C</span> <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?M</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">(</span><span class="skolem">C</span> <span class="main">∪</span> <span class="main">{</span><span class="free">F</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">assume</span></span> C_in_chain<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> chains <span class="var">?FF</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?M</span> <span class="main">∈</span> <span class="var">?FF</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> F_filter
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> filter_chain_lemma <span class="main"><span class="main">[</span></span><span class="operator">OF</span> filter.intro<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="skolem">C</span><span class="main">.</span> <span class="bound">x</span> <span class="main">⊆</span> <span class="var">?M</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> C_in_chain
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> chain_def<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">y</span><span class="main">∈</span><span class="var">?FF</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="skolem">C</span><span class="main">.</span> <span class="bound">x</span> <span class="main">⊆</span> <span class="bound">y</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">U</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    U_FFilter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">∈</span> <span class="var">?FF</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> U_max<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">V</span> <span class="main">∈</span> <span class="var">?FF</span><span class="main">.</span> <span class="skolem">U</span> <span class="main">⊆</span> <span class="bound">V</span> <span class="main">⟶</span> <span class="bound">V</span> <span class="main">=</span> <span class="skolem">U</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> Zorn_Lemma2<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> U_filter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> F_subset_U<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">⊆</span> <span class="skolem">U</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> U_filter carrier_not_empty <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">ultra</span> <span class="skolem">U</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> filter.max_ultra <span class="main"><span class="main">[</span></span><span class="operator">OF</span> filter.intro<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">clarify</span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">E</span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">E</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  U_subset_E<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">⊆</span> <span class="skolem">E</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x_in_E<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="skolem">E</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> F_subset_U <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">E</span> <span class="main">∈</span> <span class="var">?FF</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">with</span></span> U_subset_E x_in_E U_max <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="skolem">U</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> R<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Convergence›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">converges</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'a</span> set set <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword3">(</span>_ <span class="keyword1">⤏</span>ı _<span class="keyword3">)</span>"</span> <span class="main">[</span>55<span class="main">,</span> 55<span class="main">]</span> 55<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">converges</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⟷</span> nhd <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⊆</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span>"</span></span>

<span class="keyword1"><span class="command">notation</span></span>
  converges  <span class="main">(</span><span class="quoted">"<span class="keyword3">(</span>_ <span class="keyword1">⊢</span> _ <span class="keyword1">⟶</span> _<span class="keyword3">)</span>"</span> <span class="main">[</span>55<span class="main">,</span> 55<span class="main">,</span> 55<span class="main">]</span> 55<span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">cnvgnt</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'a</span> set set <span class="main">⇒</span> bool"</span></span> <span class="main">(</span><span class="quoted">"_ <span class="keyword1">convergent</span>ı"</span> <span class="main">[</span>50<span class="main">]</span> 50<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">cnvgnt</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">x</span> <span class="main">∈</span> carr <span class="free"><span class="bound"><span class="entity">T</span></span></span><span class="main">.</span> converges <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="bound">x</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">limites</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'a</span> set set <span class="main">⇒</span> <span class="tfree">'a</span> set"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">lims</span>ı"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">limites</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">=</span> <span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> carr <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">⟶</span> <span class="bound">x</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">limes</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> top <span class="main">⇒</span> <span class="tfree">'a</span> set set <span class="main">⇒</span> <span class="tfree">'a</span>"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword1">lim</span>ı"</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">limes</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">THE</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> carr <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">T</span></span></span> <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">⟶</span> <span class="bound">x</span><span class="main">)</span>"</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> convergesI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">nhds</span> <span class="free">x</span> <span class="main">⊆</span> <span class="free">F</span> <span class="main">⟹</span> <span class="free">F</span> <span class="main">⤏</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> converges_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> convergesE <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">F</span> <span class="main">⤏</span> <span class="free">x</span><span class="main">;</span> <span class="keyword1">nhds</span> <span class="free">x</span> <span class="main">⊆</span> <span class="free">F</span> <span class="main">⟹</span> <span class="free">R</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> converges_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> convergentI <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">?</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">F</span> <span class="main">⤏</span> <span class="free">x</span><span class="main">;</span> <span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">F</span> <span class="keyword1">convergent</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cnvgnt_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> carrier<span class="main">)</span> convergentE <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
   <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">F</span> <span class="keyword1">convergent</span><span class="main">;</span>
     <span class="main">⋀</span> <span class="bound">x</span><span class="main">.</span> <span class="main">⟦</span> <span class="free">F</span> <span class="main">⤏</span> <span class="bound">x</span><span class="main">;</span> <span class="bound">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>
    <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> cnvgnt_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> continuous<span class="main">)</span> fimage_converges<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span>   xpoint<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>       conv<span class="main">:</span>   <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">⤏</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>    <span class="quoted"><span class="quoted">"<span class="free">fimage</span> <span class="free">F</span> <span class="main">⤏</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">v</span> <span class="keyword3"><span class="command">assume</span></span> vnhd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">f</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span> v_subset_carrier<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">⊆</span> <span class="keyword1">carrier</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> m_open<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="keyword1">open</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> m_subset_v<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">⊆</span> <span class="skolem">v</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> fx_in_m<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="free">x</span> <span class="main">∈</span> <span class="skolem">m</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?m'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">∩</span> <span class="free">f</span><span class="main">-`</span><span class="skolem">m</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> fx_in_m xpoint <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="var">?m'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> m_open <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?m'</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> conv <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?m'</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> m_subset_v <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="var">?m'</span> <span class="main">⊆</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> <span class="free">fimage</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> v_subset_carrier <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> continuous<span class="main">)</span> fimage_convergent <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="keyword1">convergent</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="free">fimage</span> <span class="free">F</span> <span class="keyword1">convergent</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> convergentI fimage_converges<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> closure_convergent_filter<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> xclosure<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">closure</span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> xpoint<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> asub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> H<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">F</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">F</span> <span class="main">∈</span> <span class="keyword1">Filters</span><span class="main">;</span> <span class="bound">F</span> <span class="main">⤏</span> <span class="free">x</span><span class="main">;</span> <span class="free">A</span> <span class="main">∈</span> <span class="bound">F</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">v</span><span class="main">.</span> <span class="bound">v</span> <span class="main">⊆</span> <span class="keyword1">carrier</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span><span class="main">.</span> <span class="bound">u</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">⊆</span> <span class="bound">v</span><span class="main">)</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?F</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword1"><span class="command">from</span></span> asub xclosure <span class="keyword1"><span class="command">have</span></span> adhx<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">adh</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> closure_imp_adh<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∉</span> <span class="var">?F</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> adhCE<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="var">?F</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> aF<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∈</span> <span class="var">?F</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> bF<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">∈</span> <span class="var">?F</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span>
      aT<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> bT<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      ux<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> vx<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      uA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">⊆</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> vA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">⊆</span> <span class="skolem">b</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> ux vx <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∩</span> <span class="skolem">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> nhds_inter<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> uA vA <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">u</span> <span class="main">∩</span> <span class="skolem">v</span><span class="main">)</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">⊆</span> <span class="skolem">a</span> <span class="main">∩</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∩</span> <span class="skolem">b</span> <span class="main">∈</span> <span class="var">?F</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> aF<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∈</span> <span class="var">?F</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ab<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">⊆</span> <span class="skolem">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> bT<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span>
      <span class="keyword2"><span class="keyword">where</span></span> at<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ux<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  uA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">⊆</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> ux bT <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∪</span> <span class="skolem">b</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> nhds_greater<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> uA ab <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">u</span> <span class="main">∪</span> <span class="skolem">b</span><span class="main">)</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">⊆</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">∈</span> <span class="var">?F</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?F</span> <span class="main">⤏</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> asub xpoint <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="var">?F</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> H<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1" id="Topology-convergent_filter_closure"><span class="command">lemma</span></span> convergent_filter_closure<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">F</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"filter <span class="free">F</span> <span class="free">T</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> converge<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">⤏</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>   xpoint<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>   AF<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> <span class="free">F</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">closure</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> filter <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">adh</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">u</span> <span class="keyword3"><span class="command">assume</span></span> unhd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> converge <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> AF <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∩</span> <span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> xpoint <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> adh_imp_closure<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Separation›</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span><span class="quoted"><span class="plain_text">‹T0 spaces›</span></span>

<span class="keyword1"><span class="command">locale</span></span> T0 <span class="main">=</span> topology <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> T0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="bound">y</span> <span class="main">⟶</span>
               <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">y</span> <span class="main">∉</span> <span class="bound">u</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∉</span> <span class="bound">v</span><span class="main">)</span>"</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> T0<span class="main">)</span> T0_eqI<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> points<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">u</span><span class="main">.</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">y</span> <span class="main">∈</span> <span class="bound">u</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">v</span><span class="main">.</span> <span class="bound">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">y</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">∈</span> <span class="bound">v</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> T0 points
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> R1 R2<span class="main">)</span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> T0<span class="main">)</span> T0_neqE <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> x_neq_y<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="free">y</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> points<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">u</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span><span class="main">;</span> <span class="free">y</span> <span class="main">∉</span> <span class="bound">u</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">v</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">y</span><span class="main">;</span> <span class="free">x</span> <span class="main">∉</span> <span class="bound">v</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> T0 points x_neq_y
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> R1 R2<span class="main">)</span>

<span class="keyword1"><span class="command">subsubsection</span></span><span class="quoted"><span class="plain_text">‹T1 spaces›</span></span>

<span class="keyword1"><span class="command">locale</span></span> T1 <span class="main">=</span> T0 <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> DT01<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="bound">y</span> <span class="main">⟶</span>
               <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">y</span> <span class="main">∉</span> <span class="bound">u</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∉</span> <span class="bound">v</span><span class="main">)</span>"</span></span>


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> T1<span class="main">)</span> T1_neqE <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> x_neq_y<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="free">y</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> points<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R <span class="main">[</span><span class="operator">intro</span><span class="main">]</span> <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span><span class="main">;</span> <span class="bound">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">y</span><span class="main">;</span> <span class="free">y</span> <span class="main">∉</span> <span class="bound">u</span><span class="main">;</span> <span class="free">x</span> <span class="main">∉</span> <span class="bound">v</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> DT01 x_neq_y points
  <span class="keyword1"><span class="command">have</span></span> nhd_iff<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span> <span class="bound">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">y</span><span class="main">.</span> <span class="free">x</span> <span class="main">∉</span> <span class="bound">v</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span><span class="main">.</span> <span class="free">y</span> <span class="main">∉</span> <span class="bound">u</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">from</span></span> x_neq_y points <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">u</span> <span class="keyword3"><span class="command">assume</span></span> u_nhd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> y_notin_u<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">∉</span> <span class="skolem">u</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> nhd_iff <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∉</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> u_nhd y_notin_u <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">v</span> <span class="keyword3"><span class="command">assume</span></span> v_nhd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x_notin_v<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∉</span> <span class="skolem">v</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> nhd_iff <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">∉</span> <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> v_nhd x_notin_v <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">declare</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> T1<span class="main">)</span> T0_neqE <span class="main">[</span><span class="operator">rule</span> <span class="quasi_keyword">del</span><span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> T1<span class="main">)</span> T1_eqI<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> points<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span><span class="main">;</span> <span class="bound">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">y</span><span class="main">;</span> <span class="free">y</span> <span class="main">∉</span> <span class="bound">u</span> <span class="main">⟧</span> <span class="main">⟹</span>  <span class="free">x</span> <span class="main">∈</span> <span class="bound">v</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="free">y</span>"</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> points
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> R1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> T1<span class="main">)</span> singleton_closed <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="keyword1">closed</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> False <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">-</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">=</span> <span class="keyword1">carrier</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">clarsimp</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> closedI<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>  
  <span class="keyword3"><span class="command">case</span></span> True <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> closedI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> open_kriterion<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span> <span class="main">-</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> True <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">y</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∉</span> <span class="skolem">v</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">elim</span> T1_neqE<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="keyword1">open</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">∈</span><span class="skolem">m</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">⊆</span> <span class="keyword1">carrier</span> <span class="main">-</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> nhdE<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">m</span><span class="main">.</span> <span class="bound">m</span> <span class="keyword1">open</span> <span class="main">∧</span> <span class="skolem">y</span> <span class="main">∈</span> <span class="bound">m</span> <span class="main">∧</span> <span class="bound">m</span> <span class="main">⊆</span> <span class="keyword1">carrier</span> <span class="main">-</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> T1<span class="main">)</span> finite_closed<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> finite<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">closed</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> finite
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">induct</span>
  <span class="keyword3"><span class="command">case</span></span> empty <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">..</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>insert <span class="skolem">x</span> <span class="skolem">F</span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">∪</span> <span class="skolem">F</span> <span class="keyword1">closed</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span><span class="quoted"><span class="plain_text">‹T2 spaces (Hausdorff spaces)›</span></span>

<span class="keyword1"><span class="command">locale</span></span> T2 <span class="main">=</span> T1 <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> T2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="bound">y</span>
  <span class="main">⟶</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">u</span> <span class="main">∩</span> <span class="bound">v</span> <span class="main">=</span> <span class="main">{}</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Topology-T2_axiomsI"><span class="command">lemma</span></span> T2_axiomsI<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋀</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">;</span> <span class="bound">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">;</span> <span class="bound">x</span> <span class="main">≠</span> <span class="bound">y</span> <span class="main">⟧</span> <span class="main">⟹</span> 
           <span class="main">∃</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">u</span> <span class="main">∩</span> <span class="bound">v</span> <span class="main">=</span> <span class="main">{}</span><span class="main">)</span>
   <span class="main">⟹</span> T2_axioms <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> T2_axioms_def<span class="main">)</span>

<span class="keyword1"><span class="command">declare</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> T2<span class="main">)</span> T1_neqE <span class="main">[</span><span class="operator">rule</span> <span class="quasi_keyword">del</span><span class="main">]</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> T2<span class="main">)</span> neqE <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> neq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="free">y</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> points<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span><span class="main">;</span> <span class="bound">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">y</span><span class="main">;</span> <span class="bound">u</span> <span class="main">∩</span> <span class="bound">v</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="free">R</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> T2 points neq <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">y</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∩</span> <span class="skolem">v</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="free">R</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> R<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> T2<span class="main">)</span> neqE2 <span class="main">[</span><span class="operator">elim</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> neq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="free">y</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> points<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">u</span> <span class="bound">v</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span><span class="main">;</span> <span class="bound">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">y</span><span class="main">;</span> <span class="free">z</span> <span class="main">∉</span> <span class="bound">u</span> <span class="main">∨</span> <span class="free">z</span> <span class="main">∉</span> <span class="bound">v</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="free">R</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> T2 points neq <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">y</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∩</span> <span class="skolem">v</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="free">R</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> R<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Topology-T2_axiom_implies_T1_axiom"><span class="command">lemma</span></span> T2_axiom_implies_T1_axiom<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> T2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="bound">y</span>
  <span class="main">⟶</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">u</span> <span class="main">∩</span> <span class="bound">v</span> <span class="main">=</span> <span class="main">{}</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"T1_axioms <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> T1_axioms.intro<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarify</span><span class="main">)</span>
  <span class="keyword1"><span class="command">interpret</span></span> carrier <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> neq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≠</span> <span class="skolem">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    points<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> T2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span>
    <span class="keyword2"><span class="keyword">where</span></span> unhd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    vnhd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> Int_empty<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∩</span> <span class="skolem">v</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">u</span><span class="main">∈</span><span class="keyword1">nhds</span> <span class="skolem">x</span><span class="main">.</span> <span class="skolem">y</span> <span class="main">∉</span> <span class="bound">u</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span><span class="bound">v</span><span class="main">∈</span><span class="keyword1">nhds</span> <span class="skolem">y</span><span class="main">.</span> <span class="skolem">x</span> <span class="main">∉</span> <span class="bound">v</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">safe</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">v</span><span class="main">∈</span><span class="keyword1">nhds</span> <span class="skolem">y</span><span class="main">.</span> <span class="skolem">x</span> <span class="main">∉</span> <span class="bound">v</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword1"><span class="command">from</span></span> unhd <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> Int_empty <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∉</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span> <span class="main">(</span><span class="operator">rule</span> vnhd<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">u</span><span class="main">∈</span><span class="keyword1">nhds</span> <span class="skolem">x</span><span class="main">.</span> <span class="skolem">y</span> <span class="main">∉</span> <span class="bound">u</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword1"><span class="command">from</span></span> vnhd <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> Int_empty <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∉</span> <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span> <span class="main">(</span><span class="operator">rule</span> unhd<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Topology-T2_axiom_implies_T0_axiom"><span class="command">lemma</span></span> T2_axiom_implies_T0_axiom<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> T2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="bound">y</span>
  <span class="main">⟶</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">u</span> <span class="main">∩</span> <span class="bound">v</span> <span class="main">=</span> <span class="main">{}</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"T0_axioms <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> T0_axioms.intro<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarify</span><span class="main">)</span>
  <span class="keyword1"><span class="command">interpret</span></span> carrier <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> neq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≠</span> <span class="skolem">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    points<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> T2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span>
    <span class="keyword2"><span class="keyword">where</span></span> unhd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    vnhd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> Int_empty<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∩</span> <span class="skolem">v</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">u</span><span class="main">∈</span><span class="keyword1">nhds</span> <span class="skolem">x</span><span class="main">.</span> <span class="skolem">y</span> <span class="main">∉</span> <span class="bound">u</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword1"><span class="command">from</span></span> vnhd <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> Int_empty <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∉</span> <span class="skolem">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span> <span class="main">(</span><span class="operator">rule</span> unhd<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1" id="Topology-T2I"><span class="command">lemma</span></span> T2I<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"topology <span class="free">T</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">;</span> <span class="bound">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">;</span> <span class="bound">x</span> <span class="main">≠</span> <span class="bound">y</span> <span class="main">⟧</span> <span class="main">⟹</span> 
           <span class="main">∃</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">u</span> <span class="main">∩</span> <span class="bound">v</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"T2 <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> topology <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">intro_locales</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> T2_axiom_implies_T0_axiom<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> I <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> T2_axiom_implies_T1_axiom<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> I <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">unfold_locales</span>
    <span class="keyword1"><span class="command">using</span></span> I <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> T2E <span class="main">=</span> T2.neqE
<span class="keyword1"><span class="command">lemmas</span></span> T2E2 <span class="main">=</span> T2.neqE2

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> T2<span class="main">)</span> unique_convergence<span class="main">:</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">F</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"filter <span class="free">F</span> <span class="free">T</span>"</span></span>
<span class="keyword2"><span class="keyword">assumes</span></span> points<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>   Fx<span class="main">:</span>    <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">⤏</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>   Fy<span class="main">:</span>    <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">⤏</span> <span class="free">y</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> filter <span class="quoted"><span class="free">F</span></span> <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span>
      <span class="keyword2"><span class="keyword">where</span></span> unhdx<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span>   vnhdy<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">y</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span>   inter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∩</span> <span class="skolem">v</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> points <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Fx Fy <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∩</span> <span class="skolem">v</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">with</span></span> inter <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> topology<span class="main">)</span> unique_convergence_implies_T2 <span class="main">[</span><span class="operator">rule_format</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> unique_convergence<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">x</span> <span class="bound">y</span> <span class="bound">F</span><span class="main">.</span><span class="main">⟦</span> <span class="bound">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">;</span> <span class="bound">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">;</span> <span class="bound">F</span><span class="main">∈</span><span class="keyword1">Filters</span><span class="main">;</span> 
    <span class="bound">F</span> <span class="main">⤏</span> <span class="bound">x</span><span class="main">;</span> <span class="bound">F</span> <span class="main">⤏</span> <span class="bound">y</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">y</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"T2 <span class="free">T</span>"</span></span>

<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> T2I<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"topology <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> points<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> neq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≠</span> <span class="skolem">y</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">u</span><span class="main">∈</span><span class="keyword1">nhds</span> <span class="skolem">x</span><span class="main">.</span> <span class="main">∃</span><span class="bound">v</span><span class="main">∈</span><span class="keyword1">nhds</span> <span class="skolem">y</span><span class="main">.</span> <span class="bound">u</span> <span class="main">∩</span> <span class="bound">v</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> non_empty_Int<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">u</span><span class="main">∈</span><span class="keyword1">nhds</span> <span class="skolem">x</span><span class="main">.</span> <span class="main">∀</span><span class="bound">v</span><span class="main">∈</span><span class="keyword1">nhds</span> <span class="skolem">y</span><span class="main">.</span> <span class="bound">u</span> <span class="main">∩</span> <span class="bound">v</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?E</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">w</span><span class="main">.</span> <span class="bound">w</span><span class="main">⊆</span><span class="keyword1">carrier</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">y</span><span class="main">.</span> <span class="bound">u</span><span class="main">∩</span><span class="bound">v</span> <span class="main">⊆</span> <span class="bound">w</span><span class="main">)</span><span class="main">}</span>"</span></span>

    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?E</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">rule</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">∉</span> <span class="var">?E</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> non_empty_Int <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="var">?E</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ua</span></span> <span class="skolem"><span class="skolem">va</span></span> <span class="skolem"><span class="skolem">ub</span></span> <span class="skolem"><span class="skolem">vb</span></span>
        <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ua</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">va</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">y</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ua</span> <span class="main">∩</span> <span class="skolem">va</span> <span class="main">⊆</span> <span class="skolem">a</span>"</span></span>
              <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ub</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">vb</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">y</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ub</span> <span class="main">∩</span> <span class="skolem">vb</span> <span class="main">⊆</span> <span class="skolem">b</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∩</span><span class="skolem">b</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ua</span> <span class="main">∩</span> <span class="skolem">ub</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">va</span> <span class="main">∩</span> <span class="skolem">vb</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">y</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">ua</span> <span class="main">∩</span> <span class="skolem">ub</span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span><span class="skolem">va</span> <span class="main">∩</span> <span class="skolem">vb</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">a</span> <span class="main">∩</span> <span class="skolem">b</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> nhds_inter <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Int_ac<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∩</span> <span class="skolem">b</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> a_sub_b<span class="main">:</span>
        <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">⊆</span> <span class="skolem">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b_sub_carrier<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span>
        <span class="keyword2"><span class="keyword">where</span></span> u_int_v<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∩</span> <span class="skolem">v</span> <span class="main">⊆</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> nhds<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">y</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> u_int_v a_sub_b <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∩</span> <span class="skolem">v</span> <span class="main">⊆</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> b_sub_carrier nhds <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>

    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?E</span> <span class="main">⤏</span> <span class="skolem">x</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">w</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span>›</span></span> <span class="keyword1"><span class="command">..</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">∩</span> <span class="keyword1">carrier</span> <span class="main">⊆</span> <span class="skolem">w</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>

    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?E</span> <span class="main">⤏</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span><span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">w</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>›</span></span> <span class="keyword1"><span class="command">..</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">∩</span> <span class="keyword1">carrier</span> <span class="main">⊆</span> <span class="skolem">w</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>

    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> points
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>  unique_convergence<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> neq <span class="keyword1"><span class="command">by</span></span> <span class="operator">contradiction</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> T2<span class="main">)</span> limI <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> filter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>      point<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>  converges<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">⤏</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">lim</span> <span class="free">F</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> filter converges point
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> limes_def <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> unique_convergence <span class="main"><span class="main">[</span></span><span class="operator">OF</span> filter.intro<span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> T2<span class="main">)</span> convergent_limE<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> convergent<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="keyword1">convergent</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> filter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">∈</span> <span class="keyword1">Filters</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span>  <span class="keyword1">lim</span> <span class="free">F</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">;</span> <span class="free">F</span> <span class="main">⤏</span> <span class="keyword1">lim</span> <span class="free">F</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> convergent filter
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> R<span class="main">)</span>

<span class="keyword1" id="Topology-image_lim_subset_lim_fimage"><span class="command">lemma</span></span> image_lim_subset_lim_fimage<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">fimage</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">fimage</span> <span class="main">≡</span> fimg <span class="free">T</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"continuous <span class="free">f</span> <span class="free">S</span> <span class="free">T</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">∈</span> <span class="keyword1">Filters</span><span class="hidden">⇘</span><sub><span class="free">S</span></sub><span class="hidden">⇙</span> <span class="main">⟹</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="keyword1">lims</span> <span class="free">F</span><span class="main">)</span> <span class="main">⊆</span> <span class="keyword1">lims</span><span class="hidden">⇘</span><sub><span class="free">T</span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">fimage</span> <span class="free">F</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> continuous <span class="quoted"><span class="free">f</span></span> <span class="quoted"><span class="free">S</span></span> <span class="quoted"><span class="free">T</span></span> <span class="quoted"><span class="free">fimage</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span> <span class="operator">fact</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> limites_def <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> fimage_converges<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsubsection</span></span><span class="quoted"><span class="plain_text">‹T3 axiom and regular spaces›</span></span>


<span class="keyword1"><span class="command">locale</span></span> T3 <span class="main">=</span> topology <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> T3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">A</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span> <span class="main">-</span> <span class="bound">A</span><span class="main">.</span> <span class="bound">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span> <span class="main">∧</span> <span class="bound">A</span> <span class="keyword1">closed</span> <span class="main">⟶</span> 
               <span class="main">(</span><span class="main">∃</span> <span class="bound">B</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">U</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">B</span> <span class="keyword1">open</span> <span class="main">∧</span> <span class="bound">A</span> <span class="main">⊆</span> <span class="bound">B</span> <span class="main">∧</span> <span class="bound">B</span> <span class="main">∩</span> <span class="bound">U</span> <span class="main">=</span> <span class="main">{}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> T3<span class="main">)</span> T3E<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">closed</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∉</span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>     R<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">B</span> <span class="bound">U</span><span class="main">.</span> <span class="main">⟦</span> <span class="free">A</span> <span class="main">⊆</span> <span class="bound">B</span><span class="main">;</span> <span class="bound">B</span> <span class="keyword1">open</span><span class="main">;</span> <span class="bound">U</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span><span class="main">;</span> <span class="bound">B</span> <span class="main">∩</span> <span class="bound">U</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> T3 H
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> R<span class="main">)</span>

<span class="keyword1"><span class="command">locale</span></span> regular <span class="main">=</span> T1 <span class="main">+</span> T3

<span class="keyword1" id="Topology-regular_implies_T2"><span class="command">lemma</span></span> regular_implies_T2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">T</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"T2 <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> T2I<span class="main">)</span>
  <span class="keyword1"><span class="command">interpret</span></span> regular <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"topology <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">interpret</span></span> regular <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≠</span> <span class="skolem">y</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">y</span><span class="main">}</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">y</span><span class="main">}</span> <span class="keyword1">closed</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∉</span> <span class="main">{</span><span class="skolem">y</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="skolem"><span class="skolem">U</span></span> <span class="keyword2"><span class="keyword">where</span></span> B<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">y</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">B</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="keyword1">open</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> U<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∩</span> <span class="skolem">U</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">elim</span> T3E<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> B <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">u</span><span class="main">∈</span><span class="keyword1">nhds</span> <span class="skolem">x</span><span class="main">.</span> <span class="main">∃</span><span class="bound">v</span><span class="main">∈</span><span class="keyword1">nhds</span> <span class="skolem">y</span><span class="main">.</span> <span class="bound">u</span> <span class="main">∩</span> <span class="bound">v</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> U
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsubsection</span></span><span class="quoted"><span class="plain_text">‹T4 axiom and normal spaces›</span></span> 

<span class="keyword1"><span class="command">locale</span></span> T4 <span class="main">=</span> topology <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> T4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">A</span> <span class="bound">B</span><span class="main">.</span> <span class="bound">A</span> <span class="keyword1">closed</span> <span class="main">∧</span> <span class="bound">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span> <span class="main">∧</span> <span class="bound">B</span> <span class="keyword1">closed</span> <span class="main">∧</span> <span class="bound">B</span> <span class="main">⊆</span> <span class="keyword1">carrier</span> <span class="main">∧</span>
  <span class="bound">A</span> <span class="main">∩</span> <span class="bound">B</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">U</span> <span class="bound">V</span><span class="main">.</span> <span class="bound">U</span> <span class="keyword1">open</span> <span class="main">∧</span> <span class="bound">A</span> <span class="main">⊆</span> <span class="bound">U</span> <span class="main">∧</span> <span class="bound">V</span> <span class="keyword1">open</span> <span class="main">∧</span> <span class="bound">B</span> <span class="main">⊆</span> <span class="bound">V</span> <span class="main">∧</span> <span class="bound">U</span> <span class="main">∩</span> <span class="bound">V</span> <span class="main">=</span> <span class="main">{}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> T4<span class="main">)</span> T4E<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">closed</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="keyword1">closed</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">∩</span><span class="free">B</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> R<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="bound">U</span> <span class="bound">V</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">U</span> <span class="keyword1">open</span><span class="main">;</span> <span class="free">A</span> <span class="main">⊆</span> <span class="bound">U</span><span class="main">;</span> <span class="bound">V</span> <span class="keyword1">open</span><span class="main">;</span> <span class="free">B</span> <span class="main">⊆</span> <span class="bound">V</span><span class="main">;</span> <span class="bound">U</span> <span class="main">∩</span> <span class="bound">V</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> H T4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span> <span class="bound">U</span> <span class="bound">V</span><span class="main">.</span> <span class="bound">U</span> <span class="keyword1">open</span> <span class="main">∧</span> <span class="free">A</span> <span class="main">⊆</span> <span class="bound">U</span> <span class="main">∧</span> <span class="bound">V</span> <span class="keyword1">open</span> <span class="main">∧</span> <span class="free">B</span> <span class="main">⊆</span> <span class="bound">V</span> <span class="main">∧</span> <span class="bound">U</span> <span class="main">∩</span> <span class="bound">V</span> <span class="main">=</span> <span class="main">{}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">U</span></span> <span class="skolem"><span class="skolem">V</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="keyword1">open</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="skolem">U</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="keyword1">open</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">⊆</span> <span class="skolem">V</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">∩</span> <span class="skolem">V</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> R<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
     

<span class="keyword1"><span class="command">locale</span></span> normal <span class="main">=</span> T1 <span class="main">+</span> T4

<span class="keyword1" id="Topology-normal_implies_regular"><span class="command">lemma</span></span> normal_implies_regular<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"normal <span class="free">T</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"regular <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> normal <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">intro_locales</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"T3_axioms <span class="free">T</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> T3_axioms.intro<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarify</span><span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∉</span> <span class="skolem">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="keyword1">closed</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> x <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="keyword1">closed</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∩</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> A <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">U</span></span> <span class="skolem"><span class="skolem">V</span></span>
        <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="keyword1">open</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">⊆</span> <span class="skolem">U</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span> <span class="keyword1">open</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">V</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">∩</span> <span class="skolem">V</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> T4E<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">B</span><span class="main">.</span> <span class="main">∃</span><span class="bound">U</span><span class="main">∈</span><span class="keyword1">nhds</span> <span class="skolem">x</span><span class="main">.</span> <span class="bound">B</span> <span class="keyword1">open</span> <span class="main">∧</span> <span class="skolem">A</span> <span class="main">⊆</span> <span class="bound">B</span> <span class="main">∧</span> <span class="bound">B</span> <span class="main">∩</span> <span class="bound">U</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(*

subsection{*Compactness*}

definition
  covers :: "'a top ⇒ 'a set set ⇒ bool" ("_ coveringı" [50] 50) where
  "covers T D = (⋃D = carr T)"

definition
  card_le :: "'a set ⇒ 'b set ⇒ bool" (infix "cardle" 50) where
  "A cardle B ⟷ (∃f. f ∈ SUR B A)"

definition
  countable :: "'a set ⇒ bool" where
  "countable A = A cardle Nat"

lemma cardle_refl: "A cardle A"
proof-
  have "id : A → A" by (auto intro: funcsetI)
  moreover have "∀ y∈A. ∃x∈A. y = id x" by auto
  ultimately show ?thesis
    by (auto simp add: card_le_def SUR_def)
qed

locale quasicompact = topology +
  assumes quasi: "∀ C. C covering ∧ (∀ m∈C. m open) ⟶
  (∃ D. D covering ∧ finite D ∧ D ⊆ C)"
*)</span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="LList_Topology">
<div class="head">
<h1>Theory LList_Topology</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:      LList_Topology.thy
    Author:     Stefan Friedrich
    Maintainer: Stefan Friedrich
    License:    LGPL
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹The topology of llists›</span></span>

<span class="keyword1"><span class="command">theory</span></span> LList_Topology
<span class="keyword2"><span class="keyword">imports</span></span> <a href="Topology.html">Topology</a> <span class="quoted">"<a href="../Lazy-Lists-II/LList2.html">Lazy-Lists-II.LList2</a>"</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹The topology of all llists›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹
  This theory introduces the topologies of all llists, of infinite
  llists, and of the non-empty llists. For all three cases it is
  proved that safety properties are closed sets and that liveness
  properties are dense sets. Finally, we prove in each of the the
  three different topologies the respective theorem of Alpern and
  Schneider \cite{alpern85:_defin_liven}, which states that every
  property can be represented as an intersection of a safety property
  and a liveness property.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">ttop</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> llist top"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ttop</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">=</span> topo <span class="main">(</span><span class="main">⋃</span> <span class="bound">s</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">.</span> <span class="main">{</span>suff <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="bound">s</span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="LList_Topology-ttop_topology"><span class="command">lemma</span></span> ttop_topology <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"topology <span class="main">(</span>ttop <span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> ttop_def<span class="main">)</span>


<span class="keyword1"><span class="command">locale</span></span> suffixes <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">B</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">≡</span> <span class="main">(</span><span class="main">⋃</span> <span class="bound">s</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">.</span> <span class="main">{</span>suff <span class="free">A</span> <span class="bound">s</span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> trace_top <span class="main">=</span> suffixes <span class="main">+</span> topobase


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> trace_top<span class="main">)</span> open_iff <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="keyword1">open</span> <span class="main">=</span> <span class="main">(</span><span class="free">m</span> <span class="main">∈</span> topo <span class="main">(</span><span class="main">⋃</span> <span class="bound">s</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">.</span> <span class="main">{</span>suff <span class="free">A</span> <span class="bound">s</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> T_def is_open_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> trace_top<span class="main">)</span> suff_open <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⟹</span> suff <span class="free">A</span> <span class="free">r</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> trace_top<span class="main">)</span> ttop_carrier<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span> <span class="main">=</span> <span class="keyword1">carrier</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> carrier_topo suff_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> trace_top<span class="main">)</span> suff_nhd_base<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> unhd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">t</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> H<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">r</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">t</span><span class="main">;</span> suff <span class="free">A</span> <span class="bound">r</span> <span class="main">⊆</span> <span class="free">u</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> unhd <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    uA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">⊆</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    mopen<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="keyword1">open</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    tm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">∈</span> <span class="skolem">m</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    mu<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">⊆</span> <span class="free">u</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> ttop_carrier <span class="main"><span class="main">[</span></span><span class="operator">THEN</span> sym<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> mopen tm <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">t</span><span class="main">.</span> suff <span class="free">A</span> <span class="bound">r</span> <span class="main">⊆</span> <span class="skolem">m</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>basic <span class="skolem">a</span><span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">s</span></span> <span class="keyword2"><span class="keyword">where</span></span> sA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> as<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> suff <span class="free">A</span> <span class="skolem">s</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ta<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">∈</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> sA as ta <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> suff_finpref<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> as <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>inter <span class="skolem">a</span> <span class="skolem">b</span><span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="skolem"><span class="skolem">r'</span></span> <span class="keyword2"><span class="keyword">where</span></span>
      rt<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ra<span class="main">:</span> <span class="quoted"><span class="quoted">"suff <span class="free">A</span> <span class="skolem">r</span> <span class="main">⊆</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      r't<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r'</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> r'b<span class="main">:</span> <span class="quoted"><span class="quoted">"suff <span class="free">A</span> <span class="skolem">r'</span> <span class="main">⊆</span> <span class="skolem">b</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> rt r't <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">≤</span> <span class="skolem">r'</span> <span class="main">∨</span> <span class="skolem">r'</span> <span class="main">≤</span> <span class="skolem">r</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> finpref_def <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> pref_locally_linear<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">≤</span> <span class="skolem">r'</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"suff <span class="free">A</span> <span class="skolem">r'</span> <span class="main">⊆</span> suff <span class="free">A</span> <span class="skolem">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> suff_mono2<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> r't ra r'b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r'</span> <span class="main">≤</span> <span class="skolem">r</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"suff <span class="free">A</span> <span class="skolem">r</span> <span class="main">⊆</span> suff <span class="free">A</span> <span class="skolem">r'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> suff_mono2<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> rt r'b ra <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>union <span class="skolem">M</span><span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">∈</span> <span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> vM<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> <span class="skolem">M</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∈</span>finpref <span class="free">A</span> <span class="free">t</span>"</span></span> <span class="quoted"><span class="quoted">"suff <span class="free">A</span> <span class="skolem">r</span> <span class="main">⊆</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> union
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> vM <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> mu <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> H<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> trace_top<span class="main">)</span> nhds_LNil <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">nhds</span> LNil <span class="main">=</span> <span class="main">{</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">nhds</span> LNil <span class="main">⊆</span> <span class="main">{</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">clarify</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> xnhd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">nhds</span> LNil"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span>
      <span class="keyword2"><span class="keyword">where</span></span> rfinpref<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> finpref <span class="free">A</span> LNil"</span></span> <span class="keyword2"><span class="keyword">and</span></span> suffsub<span class="main">:</span> <span class="quoted"><span class="quoted">"suff <span class="free">A</span> <span class="skolem">r</span> <span class="main">⊆</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> suff_nhd_base<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> rfinpref <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">=</span> LNil"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"suff <span class="free">A</span> <span class="skolem">r</span> <span class="main">=</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> suffsub <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span> <span class="main">⊆</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> xnhd <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">⊆</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> ttop_carrier <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> nhdE<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span><span class="main">}</span> <span class="main">⊆</span> <span class="keyword1">nhds</span> LNil"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> ttop_carrier<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> trace_top<span class="main">)</span> adh_lemma<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> xpoint<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>  PA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">⊆</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="keyword1">adh</span> <span class="free">P</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span><span class="main">.</span> <span class="bound">r</span> <span class="main">@@</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> PA <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">r</span><span class="main">.</span> <span class="bound">r</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span><span class="main">.</span> <span class="bound">r</span> <span class="main">@@</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span> <span class="main">=</span>
        <span class="main">(</span><span class="main">∃</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="bound">r</span> <span class="main">≤</span> <span class="bound">s</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> llist_le_def <span class="quasi_keyword">iff</span><span class="main"><span class="main">:</span></span> lapp_allT_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span> <span class="bound">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span><span class="main">.</span> <span class="bound">r</span> <span class="main">@@</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span> <span class="main">=</span>
        <span class="main">(</span><span class="main">∀</span> <span class="bound">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="bound">r</span> <span class="main">≤</span> <span class="bound">s</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> finpref_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">x</span><span class="main">.</span> suff <span class="free">A</span> <span class="bound">r</span> <span class="main">∩</span> <span class="free">P</span> <span class="main">≠</span> <span class="main">{}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">r</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">s</span><span class="main">∈</span><span class="free">P</span><span class="main">.</span> <span class="bound">r</span> <span class="main">≤</span> <span class="bound">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">{</span><span class="bound">ra</span><span class="main">.</span> <span class="bound">ra</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span> <span class="main">∧</span> <span class="bound">r</span> <span class="main">≤</span> <span class="bound">ra</span><span class="main">}</span> <span class="main">∩</span> <span class="free">P</span> <span class="main">≠</span> <span class="main">{}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> PA
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> suff_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span><span class="main">.</span> <span class="bound">u</span> <span class="main">∩</span> <span class="free">P</span> <span class="main">≠</span> <span class="main">{}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">safe</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">r</span> <span class="keyword3"><span class="command">assume</span></span> uP<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">u</span><span class="main">∈</span><span class="keyword1">nhds</span> <span class="free">x</span><span class="main">.</span> <span class="bound">u</span> <span class="main">∩</span> <span class="free">P</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      rfinpref<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> rP<span class="main">:</span> <span class="quoted"><span class="quoted">"suff <span class="free">A</span> <span class="skolem">r</span> <span class="main">∩</span> <span class="free">P</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> rfinpref <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"suff <span class="free">A</span> <span class="skolem">r</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> finpref_fin<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"suff <span class="free">A</span> <span class="skolem">r</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> xpoint rfinpref
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> uP rP <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">u</span> <span class="keyword3"><span class="command">assume</span></span>
      inter<span class="main">:</span>     <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">r</span><span class="main">∈</span>finpref <span class="free">A</span> <span class="free">x</span><span class="main">.</span> suff <span class="free">A</span> <span class="bound">r</span> <span class="main">∩</span> <span class="free">P</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      unhd<span class="main">:</span>   <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      uinter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∩</span> <span class="free">P</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> unhd <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"suff <span class="free">A</span> <span class="skolem">r</span> <span class="main">⊆</span> <span class="skolem">u</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> suff_nhd_base<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> inter uinter <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> adhs_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> trace_top<span class="main">)</span> topology <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"topology <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> T_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> trace_top<span class="main">)</span> safety_closed_iff<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">⊆</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span> <span class="main">⟹</span>  safety <span class="free">A</span> <span class="free">P</span> <span class="main">=</span> <span class="main">(</span><span class="free">P</span> <span class="keyword1">closed</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> safety_def topology.closed_adh adh_lemma ttop_carrier<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> trace_top<span class="main">)</span> liveness_dense_iff<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> P<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">⊆</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"liveness <span class="free">A</span> <span class="free">P</span> <span class="main">=</span> <span class="main">(</span><span class="free">P</span> <span class="keyword1">dense</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"liveness <span class="free">A</span> <span class="free">P</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound">r</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">.</span> <span class="main">∃</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span><span class="main">.</span> <span class="bound">r</span> <span class="main">@@</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> liveness_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span><span class="main">.</span> <span class="main">∀</span> <span class="bound">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span><span class="main">.</span> <span class="bound">r</span> <span class="main">@@</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> finpref_def <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> finsubsetall<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span><span class="main">.</span> <span class="bound">x</span> <span class="keyword1">adh</span> <span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> P
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> adh_lemma<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span> <span class="main">⊆</span> <span class="keyword1">closure</span> <span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> P
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> adh_closure_iff ttop_carrier<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="free">P</span> <span class="keyword1">dense</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> liveness_def is_dense_def is_densein_def ttop_carrier<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> trace_top<span class="main">)</span> LNil_safety<span class="main">:</span> <span class="quoted"><span class="quoted">"safety <span class="free">A</span> <span class="main">{</span>LNil<span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> safety_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarify</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">t</span>
  <span class="keyword3"><span class="command">assume</span></span> adh<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">r</span><span class="main">∈</span>finpref <span class="free">A</span> <span class="skolem">t</span><span class="main">.</span> <span class="main">∃</span><span class="bound">s</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span><span class="main">.</span> <span class="bound">r</span> <span class="main">@@</span> <span class="bound">s</span> <span class="main">∈</span> <span class="main">{</span>LNil<span class="main">}</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">=</span> LNil"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">t</span></span><span class="main">)</span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> finpref_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> trace_top<span class="main">)</span> LNil_closed<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span>LNil<span class="main">}</span> <span class="keyword1">closed</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> iffD1 <span class="main"><span class="main">[</span></span><span class="operator">OF</span> safety_closed_iff<span class="main"><span class="main">]</span></span> LNil_safety<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> trace_top<span class="main">)</span> alpern_schneider<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> Psub<span class="main">:</span>     <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">⊆</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">S</span> <span class="bound">L</span><span class="main">.</span> safety <span class="free">A</span> <span class="bound">S</span> <span class="main">∧</span> liveness <span class="free">A</span> <span class="bound">L</span> <span class="main">∧</span> <span class="free">P</span> <span class="main">=</span> <span class="bound">S</span> <span class="main">∩</span> <span class="bound">L</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> Psub <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ttop_carrier<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> <span class="skolem"><span class="skolem">S</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    Lsub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    Ssub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">S</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    Sclosed<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">S</span> <span class="keyword1">closed</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    Ldense<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="keyword1">dense</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    Pinter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">=</span> <span class="skolem">S</span> <span class="main">∩</span> <span class="skolem">L</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> topology.ex_dense_closure_interE <span class="main"><span class="main">[</span></span><span class="operator">OF</span> topology<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> Ssub Sclosed <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"safety <span class="free">A</span> <span class="skolem">S</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> safety_closed_iff ttop_carrier<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> Lsub Ldense <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"liveness <span class="free">A</span> <span class="skolem">L</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> liveness_dense_iff ttop_carrier<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> Pinter
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹The topology of infinite llists›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">itop</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> llist top"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">itop</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">=</span> topo <span class="main">(</span><span class="main">⋃</span> <span class="bound">s</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">.</span> <span class="main">{</span>infsuff <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="bound">s</span><span class="main">}</span><span class="main">)</span>"</span></span>


<span class="keyword1"><span class="command">locale</span></span> infsuffixes <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">B</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">≡</span> <span class="main">(</span><span class="main">⋃</span> <span class="bound">s</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">.</span> <span class="main">{</span>infsuff <span class="free">A</span> <span class="bound">s</span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> itrace_top <span class="main">=</span> infsuffixes <span class="main">+</span> topobase


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> itrace_top<span class="main">)</span> open_iff <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="keyword1">open</span> <span class="main">=</span> <span class="main">(</span><span class="free">m</span> <span class="main">∈</span> topo <span class="main">(</span><span class="main">⋃</span> <span class="bound">s</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">.</span> <span class="main">{</span>infsuff <span class="free">A</span> <span class="bound">s</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> T_def is_open_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> itrace_top<span class="main">)</span> topology <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"topology <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> T_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> itrace_top<span class="main">)</span> infsuff_open <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⟹</span> infsuff <span class="free">A</span> <span class="free">r</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> itrace_top<span class="main">)</span> itop_carrier<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">=</span> <span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> carrier_topo infsuff_def<span class="main">)</span>

<span class="keyword1" id="LList_Topology-itop_sub_ttop_base"><span class="command">lemma</span></span> itop_sub_ttop_base<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">B</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> llist set set"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">C</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> llist set set"</span></span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">≡</span> <span class="main">⋃</span><span class="bound">s</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">.</span> <span class="main">{</span>suff <span class="free">A</span> <span class="bound">s</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">≡</span> <span class="main">⋃</span><span class="bound">s</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">.</span> <span class="main">{</span>infsuff <span class="free">A</span> <span class="bound">s</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">=</span> <span class="main">(</span><span class="main">⋃</span> <span class="bound">t</span><span class="main">∈</span><span class="free">B</span><span class="main">.</span> <span class="main">{</span><span class="bound">t</span> <span class="main">∩</span> <span class="main">⋃</span><span class="free">C</span><span class="main">}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> infsuff_def suff_def<span class="main">)</span>

<span class="keyword1" id="LList_Topology-itop_sub_ttop"><span class="command">lemma</span></span> itop_sub_ttop <span class="main">[</span><span class="operator">folded</span> ttop_def itop_def<span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">C</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">S</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">≡</span> <span class="main">⋃</span><span class="bound">s</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">.</span> <span class="main">{</span>infsuff <span class="free">A</span> <span class="bound">s</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">≡</span> topo <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">B</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">≡</span> <span class="main">⋃</span><span class="bound">s</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">.</span> <span class="main">{</span>suff <span class="free">A</span> <span class="bound">s</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">≡</span> topo <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"subtopology <span class="free">S</span> <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> itrace_top <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="free">C</span></span> <span class="quoted"><span class="free">S</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">interpret</span></span> trace_top <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="free">B</span></span> <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> itop_sub_ttop_base <span class="main"><span class="main">[</span></span><span class="operator">THEN</span> subtop_lemma<span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> S_def T_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> itrace_top<span class="main">)</span> infsuff_nhd_base<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> unhd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">t</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> H<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">r</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">t</span><span class="main">;</span> infsuff <span class="free">A</span> <span class="bound">r</span> <span class="main">⊆</span> <span class="free">u</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> unhd <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    uA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">⊆</span> <span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    mopen<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="keyword1">open</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    tm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">∈</span> <span class="skolem">m</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    mu<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">⊆</span> <span class="free">u</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> itop_carrier<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> mopen tm <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">t</span><span class="main">.</span> infsuff <span class="free">A</span> <span class="bound">r</span> <span class="main">⊆</span> <span class="skolem">m</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>basic <span class="skolem">a</span><span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">s</span></span> <span class="keyword2"><span class="keyword">where</span></span> sA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> as<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> infsuff <span class="free">A</span> <span class="skolem">s</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ta<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">∈</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> sA as ta <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> infsuff_finpref<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> as <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>inter <span class="skolem">a</span> <span class="skolem">b</span><span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="skolem"><span class="skolem">r'</span></span> <span class="keyword2"><span class="keyword">where</span></span>
      rt<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ra<span class="main">:</span> <span class="quoted"><span class="quoted">"infsuff <span class="free">A</span> <span class="skolem">r</span> <span class="main">⊆</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      r't<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r'</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> r'b<span class="main">:</span> <span class="quoted"><span class="quoted">"infsuff <span class="free">A</span> <span class="skolem">r'</span> <span class="main">⊆</span> <span class="skolem">b</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> rt r't <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">≤</span> <span class="skolem">r'</span> <span class="main">∨</span> <span class="skolem">r'</span> <span class="main">≤</span> <span class="skolem">r</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> finpref_def <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> pref_locally_linear<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">≤</span> <span class="skolem">r'</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"infsuff <span class="free">A</span> <span class="skolem">r'</span> <span class="main">⊆</span> infsuff <span class="free">A</span> <span class="skolem">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> infsuff_mono2<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> r't ra r'b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r'</span> <span class="main">≤</span> <span class="skolem">r</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"infsuff <span class="free">A</span> <span class="skolem">r</span> <span class="main">⊆</span> infsuff <span class="free">A</span> <span class="skolem">r'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> infsuff_mono2<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> rt r'b ra <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>union <span class="skolem">M</span><span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">∈</span> <span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> vM<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> <span class="skolem">M</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∈</span>finpref <span class="free">A</span> <span class="free">t</span>"</span></span> <span class="quoted"><span class="quoted">"infsuff <span class="free">A</span> <span class="skolem">r</span> <span class="main">⊆</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> union
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> vM <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> mu <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> H<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> itrace_top<span class="main">)</span> hausdorff <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"T2 <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> T2I<span class="main"><span class="keyword3">,</span></span> <span class="operator">clarify</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> xpoint<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> ypoint<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> neq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≠</span> <span class="skolem">y</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> xpoint ypoint <span class="keyword1"><span class="command">have</span></span> xA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> yA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> itop_carrier<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">s</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    sA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> sx<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">≤</span> <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> sy<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="skolem">s</span> <span class="main">≤</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> neq
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> inf_neqE<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> neq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">≠</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">with</span></span> yA xA <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    tA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ty<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">≤</span> <span class="skolem">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tx<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="skolem">t</span> <span class="main">≤</span> <span class="skolem">x</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> inf_neqE<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?u</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"infsuff <span class="free">A</span> <span class="skolem">s</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="var"><span class="quoted"><span class="var">?v</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"infsuff <span class="free">A</span> <span class="skolem">t</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> inter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?u</span> <span class="main">∩</span> <span class="var">?v</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="var">?u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> <span class="var">?v</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">≤</span> <span class="skolem">z</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">≤</span> <span class="skolem">z</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> infsuff_def<span class="main">)</span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">≤</span> <span class="skolem">t</span> <span class="main">∨</span> <span class="skolem">t</span> <span class="main">≤</span> <span class="skolem">s</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pref_locally_linear<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> sx sy tx ty <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> llist_le_trans<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword1"><span class="command">from</span></span> sA tA <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?u</span> <span class="keyword1">open</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?v</span> <span class="keyword1">open</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> xA yA sx ty <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="var">?u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="var">?v</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> infsuff_def<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"infsuff <span class="free">A</span> <span class="skolem">s</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      <span class="quoted"><span class="quoted">"infsuff <span class="free">A</span> <span class="skolem">t</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">v</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="skolem">y</span><span class="main">.</span> <span class="bound">u</span> <span class="main">∩</span> <span class="bound">v</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> itrace_top<span class="main">)</span> unique_convergence<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">x</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">;</span>
     <span class="free">y</span> <span class="main">∈</span> <span class="keyword1">carrier</span><span class="main">;</span>
     <span class="free">F</span> <span class="main">∈</span> <span class="keyword1">Filters</span> <span class="main">;</span>
     <span class="free">F</span> <span class="main">⤏</span> <span class="free">x</span><span class="main">;</span>
     <span class="free">F</span> <span class="main">⤏</span> <span class="free">y</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">=</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> T2.unique_convergence<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">prefer</span></span></span></span> 2
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> filter.intro<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="comment1">(*
lemma safty_closed:
  fixes   A :: "'a set"
  defines "T ≡ itop A"
  assumes P: "P ⊆ A<span class="hidden">⇧</span><sup>ω</sup>"
  and safety: "safety A P"
  shows "P iscl T"
proof-
  have istopT [iff]: "istop T" by (simp add: T_def)
  have carrT [simp]: "carr T = A<span class="hidden">⇧</span><sup>ω</sup>" by (simp add: T_def itop_carr)
  show ?thesis
  proof (rule closure_eq_closed, auto)
    fix x assume xclos: "x ∈ clos T P"
    with P have "x ∈ carr T"
      by (intro subsetD [OF closure_subset]) auto
    hence xA: "x ∈ A<span class="hidden">⇧</span><sup>ω</sup>" by simp
    moreover 
    from P xclos have adhx: "adh T P x" by (auto intro!: closure_imp_adh)
    have "∀ r ∈ finpref A x. ∃ s ∈ A<span class="hidden">⇧</span><sup>ω</sup>. r @@ s ∈ P"
    proof
      fix r assume "r ∈ finpref A x"
      hence "x ∈ infsuff A r" and rA: "r ∈ A<span class="hidden">⇧</span><sup>⋆</sup>" using xA
        by (auto simp: finpref_def infsuff_def)
      hence "infsuff A r ∈ nhds T x" by (auto simp: T_def)
      with adhx have  "infsuff A r ∩ P ≠ {}" by (elim adhCE) auto
      then obtain t where "t ∈ infsuff A r" and tP: "t ∈ P" by auto
      then obtain s where "s ∈ A<span class="hidden">⇧</span><sup>ω</sup>" and "t = r @@ s" using rA
        by (auto elim!: infsuff_appE)
      thus "∃ s ∈ A<span class="hidden">⇧</span><sup>ω</sup>. r @@ s ∈ P" using tP by auto
    qed
    ultimately show "x ∈ P" using safety
      by (auto elim: safetyE)
  qed
qed
*)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> itrace_top<span class="main">)</span> adh_lemma<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> xpoint<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>  PA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">⊆</span> <span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">adh</span> <span class="free">P</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span><span class="main">.</span> <span class="bound">r</span> <span class="main">@@</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> PA <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">r</span><span class="main">.</span> <span class="bound">r</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span><span class="main">.</span> <span class="bound">r</span> <span class="main">@@</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span> <span class="main">=</span>
        <span class="main">(</span><span class="main">∃</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="bound">r</span> <span class="main">≤</span> <span class="bound">s</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> llist_le_def <span class="quasi_keyword">iff</span><span class="main"><span class="main">:</span></span> lapp_infT<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span> <span class="bound">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span><span class="main">.</span> <span class="bound">r</span> <span class="main">@@</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span> <span class="main">=</span>
        <span class="main">(</span><span class="main">∀</span> <span class="bound">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="bound">r</span> <span class="main">≤</span> <span class="bound">s</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> finpref_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">x</span><span class="main">.</span> infsuff <span class="free">A</span> <span class="bound">r</span> <span class="main">∩</span> <span class="free">P</span> <span class="main">≠</span> <span class="main">{}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">r</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">s</span><span class="main">∈</span><span class="free">P</span><span class="main">.</span> <span class="bound">r</span> <span class="main">≤</span> <span class="bound">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">{</span><span class="bound">ra</span><span class="main">.</span> <span class="bound">ra</span> <span class="main">∈</span> <span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span> <span class="main">∧</span> <span class="bound">r</span> <span class="main">≤</span> <span class="bound">ra</span><span class="main">}</span> <span class="main">∩</span> <span class="free">P</span> <span class="main">≠</span> <span class="main">{}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> PA
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> infsuff_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span><span class="main">.</span> <span class="bound">u</span> <span class="main">∩</span> <span class="free">P</span> <span class="main">≠</span> <span class="main">{}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">safe</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">r</span> <span class="keyword3"><span class="command">assume</span></span> uP<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span><span class="main">.</span> <span class="bound">u</span> <span class="main">∩</span> <span class="free">P</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      rfinpref<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> rP<span class="main">:</span> <span class="quoted"><span class="quoted">"infsuff <span class="free">A</span> <span class="skolem">r</span> <span class="main">∩</span> <span class="free">P</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> rfinpref <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"infsuff <span class="free">A</span> <span class="skolem">r</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> finpref_fin<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"infsuff <span class="free">A</span> <span class="skolem">r</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> xpoint rfinpref
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> uP rP <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">u</span> <span class="keyword3"><span class="command">assume</span></span>
      inter<span class="main">:</span>     <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">r</span><span class="main">∈</span>finpref <span class="free">A</span> <span class="free">x</span><span class="main">.</span> infsuff <span class="free">A</span> <span class="bound">r</span> <span class="main">∩</span> <span class="free">P</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      unhd<span class="main">:</span>   <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      uinter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">∩</span> <span class="free">P</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> unhd <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"infsuff <span class="free">A</span> <span class="skolem">r</span> <span class="main">⊆</span> <span class="skolem">u</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> infsuff_nhd_base<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> inter uinter <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> adhs_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> itrace_top<span class="main">)</span> infsafety_closed_iff<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">⊆</span> <span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span> <span class="main">⟹</span>  infsafety <span class="free">A</span> <span class="free">P</span> <span class="main">=</span> <span class="main">(</span><span class="free">P</span> <span class="keyword1">closed</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> infsafety_def topology.closed_adh adh_lemma itop_carrier<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> itrace_top<span class="main">)</span> empty<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="free">T</span> <span class="main">=</span> <span class="main">{</span><span class="main">{}</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> T_def<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∈</span> topo <span class="main">{</span><span class="main">{}</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  xm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="skolem">m</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">m</span></span><span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="LList_Topology-itop_empty"><span class="command">lemma</span></span> itop_empty<span class="main">:</span> <span class="quoted"><span class="quoted">"itop <span class="main">{}</span> <span class="main">=</span> <span class="main">{</span><span class="main">{}</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> itop_def<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∈</span> topo <span class="main">{</span><span class="main">{}</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  xm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="skolem">m</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">m</span></span><span class="main">)</span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="LList_Topology-infliveness_empty"><span class="command">lemma</span></span> infliveness_empty<span class="main">:</span>
  <span class="quoted"><span class="quoted">"infliveness <span class="main">{}</span> <span class="free">P</span> <span class="main">⟹</span> False"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> infliveness_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> trivial<span class="main">)</span> dense<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">dense</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> itrace_top<span class="main">)</span> infliveness_dense_iff<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> notempty<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> P<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">⊆</span> <span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"infliveness <span class="free">A</span> <span class="free">P</span> <span class="main">=</span> <span class="main">(</span><span class="free">P</span> <span class="keyword1">dense</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"infliveness <span class="free">A</span> <span class="free">P</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound">r</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">.</span> <span class="main">∃</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span><span class="main">.</span> <span class="bound">r</span> <span class="main">@@</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> infliveness_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span><span class="main">.</span> <span class="main">∀</span> <span class="bound">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span><span class="main">.</span> <span class="bound">r</span> <span class="main">@@</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> notempty <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> lc<span class="main">:</span> <span class="quoted"><span class="quoted">"lconst <span class="skolem">a</span> <span class="main">∈</span> <span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> lconstT<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">P</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span><span class="main">.</span> <span class="main">∀</span><span class="bound">r</span><span class="main">∈</span>finpref <span class="free">A</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">P</span> <span class="bound">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">r</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">.</span> <span class="bound">P</span> <span class="bound">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> finpref_fin<span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">P</span> <span class="skolem">r</span>  <span class="keyword3"><span class="command">assume</span></span> lc<span class="main">:</span> <span class="quoted"><span class="quoted">"lconst <span class="skolem">a</span> <span class="main">∈</span> <span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> Pr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span><span class="main">.</span> <span class="main">∀</span><span class="bound">r</span><span class="main">∈</span>finpref <span class="free">A</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">P</span> <span class="bound">r</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> rA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> rA lc <span class="keyword1"><span class="command">have</span></span> rlc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">@@</span> lconst <span class="skolem">a</span> <span class="main">∈</span> <span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> lapp_fin_infT<span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> rA rlc <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> finpref <span class="free">A</span> <span class="main">(</span><span class="skolem">r</span> <span class="main">@@</span> lconst <span class="skolem">a</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> finpref_def llist_le_def<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="skolem">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Pr <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span><span class="main">.</span> <span class="bound">x</span> <span class="keyword1">adh</span> <span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> P
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> adh_lemma<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span> <span class="main">⊆</span> <span class="keyword1">closure</span> <span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> P
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> adh_closure_iff itop_carrier<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="free">P</span> <span class="keyword1">dense</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> infliveness_def is_dense_def is_densein_def itop_carrier<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> itrace_top<span class="main">)</span> alpern_schneider<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> notempty<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>   Psub<span class="main">:</span>     <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">⊆</span> <span class="free">A</span><span class="keyword1"><span class="hidden">⇧</span><sup>ω</sup></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">S</span> <span class="bound">L</span><span class="main">.</span> infsafety <span class="free">A</span> <span class="bound">S</span> <span class="main">∧</span> infliveness <span class="free">A</span> <span class="bound">L</span> <span class="main">∧</span> <span class="free">P</span> <span class="main">=</span> <span class="bound">S</span> <span class="main">∩</span> <span class="bound">L</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> Psub <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> itop_carrier <span class="main"><span class="main">[</span></span><span class="operator">THEN</span> sym<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> <span class="skolem"><span class="skolem">S</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    Lsub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    Ssub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">S</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    Sclosed<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">S</span> <span class="keyword1">closed</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    Ldense<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="keyword1">dense</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    Pinter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">=</span> <span class="skolem">S</span> <span class="main">∩</span> <span class="skolem">L</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> topology.ex_dense_closure_interE <span class="main"><span class="main">[</span></span><span class="operator">OF</span> topology<span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> Ssub Sclosed <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"infsafety <span class="free">A</span> <span class="skolem">S</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> infsafety_closed_iff itop_carrier<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> notempty Lsub Ldense <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"infliveness <span class="free">A</span> <span class="skolem">L</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> infliveness_dense_iff itop_carrier<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> Pinter
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹The topology of non-empty llists›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">ptop</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> llist top"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ptop</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">≡</span> topo <span class="main">(</span><span class="main">⋃</span> <span class="bound">s</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main"><span class="hidden">⇧</span><sup>♣</sup></span><span class="main">.</span> <span class="main">{</span>suff <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="bound">s</span><span class="main">}</span><span class="main">)</span>"</span></span>


<span class="keyword1"><span class="command">locale</span></span> possuffixes <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">B</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">≡</span> <span class="main">(</span><span class="main">⋃</span> <span class="bound">s</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>♣</sup></span><span class="main">.</span> <span class="main">{</span>suff <span class="free">A</span> <span class="bound">s</span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">locale</span></span> ptrace_top <span class="main">=</span> possuffixes <span class="main">+</span> topobase


<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ptrace_top<span class="main">)</span> open_iff <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="keyword1">open</span> <span class="main">=</span> <span class="main">(</span><span class="free">m</span> <span class="main">∈</span> topo <span class="main">(</span><span class="main">⋃</span> <span class="bound">s</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>♣</sup></span><span class="main">.</span> <span class="main">{</span>suff <span class="free">A</span> <span class="bound">s</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> T_def is_open_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ptrace_top<span class="main">)</span> topology <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"topology <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> T_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ptrace_top<span class="main">)</span> ptop_carrier<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">carrier</span> <span class="main">=</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>♠</sup></span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> carrier_topo suff_def<span class="main">)</span>
   <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> alllsts.cases<span class="main">)</span>

<span class="keyword1" id="LList_Topology-pptop_subtop_ttop"><span class="command">lemma</span></span> pptop_subtop_ttop<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">S</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">B</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">≡</span> <span class="main">⋃</span><span class="bound">s</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">.</span> <span class="main">{</span>suff <span class="free">A</span> <span class="bound">s</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">≡</span> topo <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">≡</span> <span class="main">⋃</span> <span class="bound">t</span> <span class="main">∈</span> <span class="free">T</span><span class="main">.</span> <span class="main">{</span><span class="bound">t</span> <span class="main">-</span> <span class="main">{</span>LNil<span class="main">}</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"subtopology <span class="free">S</span> <span class="free">T</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> subtopology.intro<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> is_open_def S_def carr_def<span class="main">)</span>
  
<span class="keyword1" id="LList_Topology-pptop_top"><span class="command">lemma</span></span> pptop_top<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">S</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">B</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">T</span> <span class="main">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">≡</span> <span class="main">⋃</span><span class="bound">s</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">.</span> <span class="main">{</span>suff <span class="free">A</span> <span class="bound">s</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">T</span> <span class="main">≡</span> topo <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">≡</span> <span class="main">⋃</span> <span class="bound">t</span> <span class="main">∈</span> <span class="free">T</span><span class="main">.</span> <span class="main">{</span><span class="bound">t</span> <span class="main">-</span> <span class="main">{</span>LNil<span class="main">}</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"topology <span class="main">(</span><span class="main">⋃</span> <span class="bound">t</span> <span class="main">∈</span> <span class="free">T</span><span class="main">.</span> <span class="main">{</span><span class="bound">t</span> <span class="main">-</span> <span class="main">{</span>LNil<span class="main">}</span><span class="main">}</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> trace_top <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="free">B</span></span> <span class="quoted"><span class="free">T</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> subtopology.subtop_topology <span class="main"><span class="main">[</span></span><span class="operator">OF</span> pptop_subtop_ttop<span class="main"><span class="main">]</span></span>
      trace_top.topology <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> T_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(*
lemma
  includes ptrace_top A B S
  includes trace_top  A C T
  fixes S' (structure)
  defines  "S' ≡ (⋃ t ∈ T. {t - {LNil}})" 
  shows "S = S'"
proof-
  have [iff]: "⋀ m. m open<span class="hidden">⇩</span><sub>3</sub> = (∃t. t open<span class="hidden">⇩</span><sub>2</sub> ∧ m = t - {LNil})"
    by (auto simp add: S'_def is_open_def)
  show ?thesis
  proof
    fix m assume "m open"
    thus "m open<span class="hidden">⇩</span><sub>3</sub>"
    proof (induct m)
      case (basic m) thus ?case by auto
    next case (inter u v) thus ?case
        by (blast intro: topology.Int_open [OF pptop_top])
    next case (union M) thus ?case
        by (auto intro!: topology.union_open [OF pptop_top] simp: S'_def T_def)
    qed
  next
    fix m assume "m open<span class="hidden">⇩</span><sub>3</sub>"
    then obtain t where "t open<span class="hidden">⇩</span><sub>2</sub>" and mt: "m = t - {LNil}" by auto
    hence "t - {LNil} open<span class="hidden">⇩</span><sub>1</sub>"
    proof (induct t)
      case (basic x)
      then obtain s where sfin: "s ∈ A<span class="hidden">⇧</span><sup>⋆</sup>" and
        ms: "x = suff A s"
        by auto
      thus ?case
      proof (cases s)
        case LNil_fin with ms
        have "x - {LNil} = carrier" by (auto simp: ptop_carrier)
        thus ?thesis by (auto intro!: topology.carrier_open [OF pptop_top])
      next
        case (LCons_fin a l) with ms show ?thesis
          by (auto simp: ptop_def)
      qed
    next case (inter u v)
      hence "(u - {LNil}) ∩ (v - {LNil}) ∈ ptop A" by auto
      moreover have "(u - {LNil}) ∩ (v - {LNil}) = (u ∩ v) - {LNil}"
        by auto
      ultimately show ?case by auto
    next case (union M)
      hence "⋃{u. ∃x∈M. u = x - {LNil}} ∈ ptop A" by auto
      moreover have "⋃{u. ∃x∈M. u = x - {LNil}} = ⋃M - {LNil}" by auto
      ultimately show ?case by auto
    qed
    thus "x ∈ ptop A" using xt by auto
  qed
qed
*)</span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ptrace_top<span class="main">)</span> suff_open <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main">!</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>♣</sup></span> <span class="main">⟹</span> suff <span class="free">A</span> <span class="free">r</span> <span class="keyword1">open</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ptrace_top<span class="main">)</span> suff_ptop_nhd_base<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> unhd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">t</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> H<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">r</span><span class="main">.</span> <span class="main">⟦</span> <span class="bound">r</span> <span class="main">∈</span> pfinpref <span class="free">A</span> <span class="free">t</span><span class="main">;</span> suff <span class="free">A</span> <span class="bound">r</span> <span class="main">⊆</span> <span class="free">u</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> unhd <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    uA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">⊆</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>♠</sup></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    mopen<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="keyword1">open</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    tm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">∈</span> <span class="skolem">m</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    mu<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">⊆</span> <span class="free">u</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> ptop_carrier<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> mopen tm <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">r</span> <span class="main">∈</span> pfinpref <span class="free">A</span> <span class="free">t</span><span class="main">.</span> suff <span class="free">A</span> <span class="bound">r</span> <span class="main">⊆</span> <span class="skolem">m</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>basic <span class="skolem">a</span><span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">s</span></span> <span class="keyword2"><span class="keyword">where</span></span> sA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>♣</sup></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> as<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> suff <span class="free">A</span> <span class="skolem">s</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ta<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">∈</span> <span class="skolem">a</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> sA as ta <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">∈</span> pfinpref <span class="free">A</span> <span class="free">t</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> pfinpref_def <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> suff_finpref<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> as <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>inter <span class="skolem">a</span> <span class="skolem">b</span><span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="skolem"><span class="skolem">r'</span></span> <span class="keyword2"><span class="keyword">where</span></span>
      rt<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> pfinpref <span class="free">A</span> <span class="free">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ra<span class="main">:</span> <span class="quoted"><span class="quoted">"suff <span class="free">A</span> <span class="skolem">r</span> <span class="main">⊆</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      r't<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r'</span> <span class="main">∈</span> pfinpref <span class="free">A</span> <span class="free">t</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> r'b<span class="main">:</span> <span class="quoted"><span class="quoted">"suff <span class="free">A</span> <span class="skolem">r'</span> <span class="main">⊆</span> <span class="skolem">b</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> rt r't <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">≤</span> <span class="skolem">r'</span> <span class="main">∨</span> <span class="skolem">r'</span> <span class="main">≤</span> <span class="skolem">r</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> pfinpref_def finpref_def <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> pref_locally_linear<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">≤</span> <span class="skolem">r'</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"suff <span class="free">A</span> <span class="skolem">r'</span> <span class="main">⊆</span> suff <span class="free">A</span> <span class="skolem">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> suff_mono2<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> r't ra r'b <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r'</span> <span class="main">≤</span> <span class="skolem">r</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"suff <span class="free">A</span> <span class="skolem">r</span> <span class="main">⊆</span> suff <span class="free">A</span> <span class="skolem">r'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> suff_mono2<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> rt r'b ra <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>union <span class="skolem">M</span><span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">v</span></span> <span class="keyword2"><span class="keyword">where</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">t</span> <span class="main">∈</span> <span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> vM<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">∈</span> <span class="skolem">M</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∈</span>pfinpref <span class="free">A</span> <span class="free">t</span>"</span></span> <span class="quoted"><span class="quoted">"suff <span class="free">A</span> <span class="skolem">r</span> <span class="main">⊆</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> union
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> vM <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">with</span></span> mu <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> H<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="LList_Topology-pfinpref_LNil"><span class="command">lemma</span></span> pfinpref_LNil <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"pfinpref <span class="free">A</span> LNil <span class="main">=</span> <span class="main">{}</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> pfinpref_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ptrace_top<span class="main">)</span> adh_lemma<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> xpoint<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>♠</sup></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span>  P_subset_A<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">⊆</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>♠</sup></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">adh</span> <span class="free">P</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">r</span> <span class="main">∈</span> pfinpref <span class="free">A</span> <span class="free">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span><span class="main">.</span> <span class="bound">r</span> <span class="main">@@</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> adh_x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">adh</span> <span class="free">P</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">r</span><span class="main">∈</span>pfinpref <span class="free">A</span> <span class="free">x</span><span class="main">.</span> <span class="main">∃</span><span class="bound">s</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span><span class="main">.</span> <span class="bound">r</span> <span class="main">@@</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">r</span> <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?u</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"suff <span class="free">A</span> <span class="skolem">r</span>"</span></span>
    <span class="keyword3"><span class="command">assume</span></span> r_pfinpref_x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> pfinpref <span class="free">A</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> r_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>♣</sup></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> finpref_fin<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?u</span> <span class="keyword1">open</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?u</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> xpoint r_pfinpref_x
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> adh_x <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="var">?u</span> <span class="main">∩</span> <span class="free">P</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span>adhCE<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> tu<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">∈</span> <span class="var">?u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> tP<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> tu <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">s</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">=</span> <span class="skolem">r</span> <span class="main">@@</span> <span class="skolem">s</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> r_pos
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> suff_appE<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> tP <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">s</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span><span class="main">.</span> <span class="skolem">r</span> <span class="main">@@</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> P_subset_A r_pos
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">iff</span><span class="main"><span class="main">:</span></span> lapp_allT_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> H<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">r</span><span class="main">∈</span>pfinpref <span class="free">A</span> <span class="free">x</span><span class="main">.</span> <span class="main">∃</span><span class="bound">s</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span><span class="main">.</span> <span class="bound">r</span> <span class="main">@@</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">adh</span> <span class="free">P</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">U</span> <span class="keyword3"><span class="command">assume</span></span> unhd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">∈</span> <span class="keyword1">nhds</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> r_pfinpref_x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> pfinpref <span class="free">A</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      suff_subset_U<span class="main">:</span> <span class="quoted"><span class="quoted">"suff <span class="free">A</span> <span class="skolem">r</span> <span class="main">⊆</span> <span class="skolem">U</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">elim</span> suff_ptop_nhd_base<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> r_pfinpref_x <span class="keyword1"><span class="command">have</span></span> rpos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>♣</sup></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> finpref_fin<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">∩</span> <span class="free">P</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> rpos
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">r</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>LCons <span class="skolem">a</span> <span class="skolem">l</span><span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> r_pfinpref_x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> pfinpref <span class="free">A</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> r_pfinpref_x
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> H <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">s</span></span> <span class="keyword2"><span class="keyword">where</span></span> sA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> asP<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">@@</span><span class="skolem">s</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span>  <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">@@</span> <span class="skolem">s</span> <span class="main">∈</span> suff <span class="free">A</span> <span class="skolem">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> sA rpos
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> suff_def <span class="quasi_keyword">iff</span><span class="main"><span class="main">:</span></span> lapp_allT_iff<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> suff_subset_U <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ptrace_top<span class="main">)</span> possafety_closed_iff<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">⊆</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>♠</sup></span> <span class="main">⟹</span>  possafety <span class="free">A</span> <span class="free">P</span> <span class="main">=</span> <span class="main">(</span><span class="free">P</span> <span class="keyword1">closed</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> possafety_def topology.closed_adh ptop_carrier adh_lemma<span class="main">)</span>
<span class="comment1">(*
lemma ptop_empty: "ptop {} = {{}}"
proof (auto simp: ptop_def intro!: topobase.basic)
  fix m x assume "m ∈ topo {}" and  xm: "x ∈ m"
  thus False
    by (induct m) auto
qed

lemma posliveness_empty:
  "posliveness {} P"
  by (auto simp: posliveness_def)
*)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ptrace_top<span class="main">)</span> posliveness_dense_iff<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> P<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">⊆</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>♠</sup></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"posliveness <span class="free">A</span> <span class="free">P</span> <span class="main">=</span> <span class="main">(</span><span class="free">P</span> <span class="keyword1">dense</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"posliveness <span class="free">A</span> <span class="free">P</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound">r</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>♣</sup></span><span class="main">.</span> <span class="main">∃</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span><span class="main">.</span> <span class="bound">r</span> <span class="main">@@</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> posliveness_def<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>♠</sup></span><span class="main">.</span> <span class="main">∀</span> <span class="bound">r</span> <span class="main">∈</span> pfinpref <span class="free">A</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>∞</sup></span><span class="main">.</span> <span class="bound">r</span> <span class="main">@@</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> pfinpref_def finpref_def <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> finsubsetall<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>♠</sup></span><span class="main">.</span> <span class="bound">x</span> <span class="keyword1">adh</span> <span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> P
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> adh_lemma <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> poslsts_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>♠</sup></span> <span class="main">⊆</span> <span class="keyword1">closure</span> <span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> P
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> adh_closure_iff ptop_carrier <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> poslsts_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="free">P</span> <span class="keyword1">dense</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> posliveness_def is_dense_def is_densein_def ptop_carrier<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ptrace_top<span class="main">)</span> alpern_schneider<span class="main">:</span>
<span class="keyword2"><span class="keyword">assumes</span></span> Psub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">⊆</span> <span class="free">A</span><span class="main"><span class="hidden">⇧</span><sup>♠</sup></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">S</span> <span class="bound">L</span><span class="main">.</span> possafety <span class="free">A</span> <span class="bound">S</span> <span class="main">∧</span> posliveness <span class="free">A</span> <span class="bound">L</span> <span class="main">∧</span> <span class="free">P</span> <span class="main">=</span> <span class="bound">S</span> <span class="main">∩</span> <span class="bound">L</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> Psub <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ptop_carrier<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> <span class="skolem"><span class="skolem">S</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    Lsub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    Ssub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">S</span> <span class="main">⊆</span> <span class="keyword1">carrier</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    Sclosed<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">S</span> <span class="keyword1">closed</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    Ldense<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="keyword1">dense</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    Pinter<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">=</span> <span class="skolem">S</span> <span class="main">∩</span> <span class="skolem">L</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> topology.ex_dense_closure_interE <span class="main"><span class="main">[</span></span><span class="operator">OF</span> topology<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> Ssub Sclosed <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"possafety <span class="free">A</span> <span class="skolem">S</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> possafety_closed_iff ptop_carrier<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> Lsub Ldense <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"posliveness <span class="free">A</span> <span class="skolem">L</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> posliveness_dense_iff ptop_carrier<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> Pinter
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div>
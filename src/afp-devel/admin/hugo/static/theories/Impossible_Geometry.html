<div id="Impossible_Geometry">
<div class="head">
<h1>Theory Impossible_Geometry</h1>
</div>
<pre class="source"><span class="comment1">(* Title:       Proving the impossibility of trisecting an angle and doubling the cube
   Authors:     Ralph Romanos &lt;ralph.romanos at student.ecp.fr&gt; (2012),
                Lawrence Paulson &lt;lp15 at cam.ac.uk&gt; (2012)
   Maintainer:  Ralph Romanos &lt;ralph.romanos at student.ecp.fr&gt;
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Proving the impossibility of trisecting an angle and doubling the cube›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Impossible_Geometry
<span class="keyword2"><span class="keyword">imports</span></span> <a href="../../HOL/HOL/Complex_Main.html">Complex_Main</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Formal Proof›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Definition of the set of Points›</span></span>

<span class="keyword1"><span class="command">datatype</span></span> point <span class="main">=</span> Point <span class="quoted">real</span> <span class="quoted">real</span>

<span class="keyword1"><span class="command">definition</span></span> points_def<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">points</span> <span class="main">=</span> <span class="main">{</span><span class="bound">M</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">ℝ</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">y</span> <span class="main">∈</span> <span class="main">ℝ</span><span class="main">.</span> <span class="main">(</span><span class="bound">M</span> <span class="main">=</span> Point <span class="bound">x</span> <span class="bound">y</span><span class="main">)</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">abscissa</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"point <span class="main">=&gt;</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> abscissa<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">abscissa</span> <span class="main">(</span>Point <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">ordinate</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"point <span class="main">=&gt;</span> real"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> ordinate<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">ordinate</span> <span class="main">(</span>Point <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span>"</span></span>

<span class="keyword1" id="Impossible_Geometry-point_surj"><span class="command">lemma</span></span> point_surj <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"Point <span class="main">(</span>abscissa <span class="free">M</span><span class="main">)</span> <span class="main">(</span>ordinate <span class="free">M</span><span class="main">)</span> <span class="main">=</span> <span class="free">M</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">M</span></span><span class="main">)</span> <span class="operator">simp</span>

<span class="keyword1" id="Impossible_Geometry-point_eqI"><span class="command">lemma</span></span> point_eqI <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main"><span class="main"><span class="main">?</span></span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span>abscissa <span class="free">M</span> <span class="main">=</span> abscissa <span class="free">N</span><span class="main">;</span> ordinate <span class="free">M</span> <span class="main">=</span> ordinate <span class="free">N</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">M</span> <span class="main">=</span> <span class="free">N</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">M</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">induct</span> <span class="quoted"><span class="free">N</span></span><span class="main">)</span> <span class="operator">simp</span>

<span class="keyword1" id="Impossible_Geometry-point_eq_iff"><span class="command">lemma</span></span> point_eq_iff<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">=</span> <span class="free">N</span> <span class="main">⟷</span> abscissa <span class="free">M</span> <span class="main">=</span> abscissa <span class="free">N</span> <span class="main">∧</span> ordinate <span class="free">M</span> <span class="main">=</span> ordinate <span class="free">N</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">M</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">induct</span> <span class="quoted"><span class="free">N</span></span><span class="main">)</span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Subtraction›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Datatype point has a structure of abelian group›</span></span>

<span class="keyword1"><span class="command">instantiation</span></span> point <span class="main">::</span> <span class="quoted">ab_group_add</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">definition</span></span> point_zero_def<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">=</span> Point <span class="main">0</span> <span class="main">0</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> point_one_def<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">point_one</span> <span class="main">=</span> Point <span class="main">1</span> <span class="main">0</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> point_add_def<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">+</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">=</span> Point <span class="main">(</span>abscissa <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">+</span> abscissa <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">(</span>ordinate <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">+</span> ordinate <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> point_minus_def<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">=</span> Point <span class="main">(</span><span class="main">-</span> abscissa <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">(</span><span class="main">-</span> ordinate <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> point_diff_def<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">-</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">::</span>point<span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">+</span> <span class="main">-</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span>"</span></span>

<span class="keyword1" id="Impossible_Geometry-Point_eq_0"><span class="command">lemma</span></span> Point_eq_0 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"Point <span class="free">xA</span> <span class="free">yA</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟷</span> <span class="main">(</span><span class="free">xA</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∧</span> <span class="free">yA</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> point_zero_def<span class="main">)</span>

<span class="keyword1" id="Impossible_Geometry-point_abscissa_zero"><span class="command">lemma</span></span> point_abscissa_zero <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"abscissa <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> point_zero_def<span class="main">)</span>

<span class="keyword1" id="Impossible_Geometry-point_ordinate_zero"><span class="command">lemma</span></span> point_ordinate_zero <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"ordinate <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> point_zero_def<span class="main">)</span>

<span class="keyword1" id="Impossible_Geometry-point_add"><span class="command">lemma</span></span> point_add <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"Point <span class="free">xA</span> <span class="free">yA</span> <span class="main">+</span> Point <span class="free">xB</span> <span class="free">yB</span> <span class="main">=</span> Point <span class="main">(</span><span class="free">xA</span> <span class="main">+</span> <span class="free">xB</span><span class="main">)</span> <span class="main">(</span><span class="free">yA</span> <span class="main">+</span> <span class="free">yB</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> point_add_def<span class="main">)</span>

<span class="keyword1" id="Impossible_Geometry-point_abscissa_add"><span class="command">lemma</span></span> point_abscissa_add <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"abscissa <span class="main">(</span><span class="free">A</span> <span class="main">+</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> abscissa <span class="free">A</span> <span class="main">+</span> abscissa <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> point_add_def<span class="main">)</span>

<span class="keyword1" id="Impossible_Geometry-point_ordinate_add"><span class="command">lemma</span></span> point_ordinate_add <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"ordinate <span class="main">(</span><span class="free">A</span> <span class="main">+</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> ordinate <span class="free">A</span> <span class="main">+</span> ordinate <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> point_add_def<span class="main">)</span>

<span class="keyword1" id="Impossible_Geometry-point_minus"><span class="command">lemma</span></span> point_minus <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="main">(</span>Point <span class="free">xA</span> <span class="free">yA</span><span class="main">)</span> <span class="main">=</span> Point <span class="main">(</span><span class="main">-</span> <span class="free">xA</span><span class="main">)</span> <span class="main">(</span><span class="main">-</span> <span class="free">yA</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> point_minus_def<span class="main">)</span>

<span class="keyword1" id="Impossible_Geometry-point_abscissa_minus"><span class="command">lemma</span></span> point_abscissa_minus <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"abscissa <span class="main">(</span><span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">-</span> abscissa <span class="main">(</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> point_minus_def<span class="main">)</span>

<span class="keyword1" id="Impossible_Geometry-point_ordinate_minus"><span class="command">lemma</span></span> point_ordinate_minus <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"ordinate <span class="main">(</span><span class="main">-</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">-</span> ordinate <span class="main">(</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> point_minus_def<span class="main">)</span>

<span class="keyword1" id="Impossible_Geometry-point_diff"><span class="command">lemma</span></span> point_diff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"Point <span class="free">xA</span> <span class="free">yA</span> <span class="main">-</span> Point <span class="free">xB</span> <span class="free">yB</span> <span class="main">=</span> Point <span class="main">(</span><span class="free">xA</span> <span class="main">-</span> <span class="free">xB</span><span class="main">)</span> <span class="main">(</span><span class="free">yA</span> <span class="main">-</span> <span class="free">yB</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> point_diff_def<span class="main">)</span>

<span class="keyword1" id="Impossible_Geometry-point_abscissa_diff"><span class="command">lemma</span></span> point_abscissa_diff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"abscissa <span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> abscissa <span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">-</span> abscissa <span class="main">(</span><span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> point_diff_def<span class="main">)</span>

<span class="keyword1" id="Impossible_Geometry-point_ordinate_diff"><span class="command">lemma</span></span> point_ordinate_diff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"ordinate <span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> ordinate <span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">-</span> ordinate <span class="main">(</span><span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> point_diff_def<span class="main">)</span>

<span class="keyword1"><span class="command">instance</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">intro_classes</span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> point_add_def point_diff_def<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Metric Space›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We can also define a distance, hence point is also a metric space›</span></span>

<span class="keyword1"><span class="command">instantiation</span></span> point <span class="main">::</span> <span class="quoted">metric_space</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">definition</span></span> point_dist_def<span class="main">:</span>
  <span class="quoted"><span class="quoted">"dist <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">=</span>  sqrt <span class="main">(</span><span class="main">(</span>abscissa <span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">-</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">-</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span>uniformity <span class="main">::</span> <span class="main">(</span>point <span class="main">×</span> point<span class="main">)</span> filter<span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">INF</span> <span class="bound">e</span><span class="main">∈</span><span class="main">{</span><span class="main">0</span> <span class="main">&lt;..}</span><span class="main">.</span> principal <span class="main">{</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span> <span class="bound">y</span><span class="main">)</span><span class="main">.</span> dist <span class="bound">x</span> <span class="bound">y</span> <span class="main">&lt;</span> <span class="bound">e</span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"open <span class="main">(</span><span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">::</span> point set<span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">.</span> <span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="main">(</span><span class="bound">x'</span><span class="main">,</span> <span class="bound">y</span><span class="main">)</span> <span class="keyword1">in</span> uniformity<span class="main">.</span> <span class="bound">x'</span> <span class="main">=</span> <span class="bound">x</span> <span class="main">⟶</span> <span class="bound">y</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Impossible_Geometry-point_dist"><span class="command">lemma</span></span> point_dist <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"dist <span class="main">(</span>Point <span class="free">xA</span> <span class="free">yA</span><span class="main">)</span> <span class="main">(</span>Point <span class="free">xB</span> <span class="free">yB</span><span class="main">)</span> <span class="main">=</span>  sqrt <span class="main">(</span><span class="main">(</span><span class="free">xA</span> <span class="main">-</span> <span class="free">xB</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="free">yA</span> <span class="main">-</span> <span class="free">yB</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> point_dist_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Impossible_Geometry-real_sqrt_diff_squares_triangle_ineq"><span class="command">lemma</span></span> real_sqrt_diff_squares_triangle_ineq<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="free">d</span> <span class="main">::</span> <span class="quoted">real</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="main">(</span><span class="main">(</span><span class="free">a</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="free">b</span> <span class="main">-</span> <span class="free">d</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">≤</span> sqrt <span class="main">(</span><span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">+</span> sqrt <span class="main">(</span><span class="free">c</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">d</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="main">(</span><span class="main">(</span><span class="free">a</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="free">b</span> <span class="main">-</span> <span class="free">d</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">≤</span> sqrt <span class="main">(</span><span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">+</span> sqrt <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="free">c</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="main">-</span><span class="free">d</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> diff_conv_add_uminus real_sqrt_sum_squares_triangle_ineq<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> sqrt <span class="main">(</span><span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">+</span> sqrt <span class="main">(</span><span class="free">c</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">d</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">instance</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="skolem">B</span> <span class="skolem">C</span> <span class="main">::</span> <span class="quoted">point</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">S</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"point set"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>dist <span class="skolem">A</span> <span class="skolem">B</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">A</span> <span class="main">=</span> <span class="skolem">B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">A</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">induct</span> <span class="quoted"><span class="skolem">B</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> point_dist_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>dist <span class="skolem">A</span> <span class="skolem">B</span><span class="main">)</span> <span class="main">≤</span> <span class="main">(</span>dist <span class="skolem">A</span> <span class="skolem">C</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>dist <span class="skolem">B</span> <span class="skolem">C</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="main">(</span><span class="main">(</span>abscissa <span class="main">(</span><span class="skolem">A</span> <span class="main">-</span> <span class="skolem">B</span><span class="main">)</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="main">(</span><span class="skolem">A</span> <span class="main">-</span> <span class="skolem">B</span><span class="main">)</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">≤</span>
          sqrt <span class="main">(</span><span class="main">(</span>abscissa <span class="main">(</span><span class="skolem">A</span> <span class="main">-</span> <span class="skolem">C</span><span class="main">)</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="main">(</span><span class="skolem">A</span> <span class="main">-</span> <span class="skolem">C</span><span class="main">)</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">+</span>
          sqrt <span class="main">(</span><span class="main">(</span>abscissa <span class="main">(</span><span class="skolem">B</span> <span class="main">-</span> <span class="skolem">C</span><span class="main">)</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="main">(</span><span class="skolem">B</span> <span class="main">-</span> <span class="skolem">C</span><span class="main">)</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> real_sqrt_diff_squares_triangle_ineq
             <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"abscissa <span class="main">(</span><span class="skolem">A</span><span class="main">)</span> <span class="main">-</span> abscissa <span class="main">(</span><span class="skolem">C</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"abscissa <span class="main">(</span><span class="skolem">B</span><span class="main">)</span> <span class="main">-</span> abscissa <span class="main">(</span><span class="skolem">C</span><span class="main">)</span>"</span></span>
                 <span class="quoted"><span class="quoted">"ordinate <span class="main">(</span><span class="skolem">A</span><span class="main">)</span> <span class="main">-</span> ordinate <span class="main">(</span><span class="skolem">C</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"ordinate <span class="main">(</span><span class="skolem">B</span><span class="main">)</span> <span class="main">-</span> ordinate <span class="main">(</span><span class="skolem">C</span><span class="main">)</span>"</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> point_diff_def<span class="main">)</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> point_dist_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span> <span class="main">(</span><span class="operator">rule</span> uniformity_point_def open_point_def<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Geometric Definitions›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹These geometric definitions will later be used to define
constructible points›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The distance between two points is defined with the distance
of the metric space point›</span></span>
<span class="keyword1"><span class="command">definition</span></span> distance_def<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">distance</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">=</span> dist <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">parallel</span></span> <span class="free"><span class="free">A</span></span> <span class="free"><span class="free">B</span></span> <span class="free"><span class="free">C</span></span> <span class="free"><span class="free">D</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is true if the lines <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="main">(</span></span><span class="free"><span class="free">AB</span></span><span class="main"><span class="main">)</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="main">(</span></span><span class="free"><span class="free">CD</span></span><span class="main"><span class="main">)</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> are parallel. If not it is false.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> parallel_def<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">parallel</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">D</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>abscissa <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">-</span> abscissa <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>ordinate <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">-</span> ordinate <span class="free"><span class="bound"><span class="entity">D</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>ordinate <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">-</span> ordinate <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>abscissa <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">-</span> abscissa <span class="free"><span class="bound"><span class="entity">D</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Three points <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">A</span></span> <span class="free"><span class="free">B</span></span> <span class="free"><span class="free">C</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> are collinear if and only if the
lines <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="main">(</span></span><span class="free"><span class="free">AB</span></span><span class="main"><span class="main">)</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="main">(</span></span><span class="free"><span class="free">AC</span></span><span class="main"><span class="main">)</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> are parallel›</span></span>

<span class="keyword1"><span class="command">definition</span></span> collinear_def<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">collinear</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">=</span> parallel <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The point <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">M</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is the intersection of two lines <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span>
<span class="quoted"><span class="quoted">"<span class="main"><span class="main">(</span></span><span class="free"><span class="free">AB</span></span><span class="main"><span class="main">)</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="main">(</span></span><span class="free"><span class="free">CD</span></span><span class="main"><span class="main">)</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> if and only if the points <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">A</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span>
<span class="quoted"><span class="free"><span class="quoted"><span class="free">M</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">B</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> are collinear and the points <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">C</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">M</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">D</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> are also collinear›</span></span>

<span class="keyword1"><span class="command">definition</span></span> is_intersection_def<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">is_intersection</span> <span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">D</span></span></span> <span class="main">=</span> <span class="main">(</span>collinear <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">∧</span> collinear <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="free"><span class="bound"><span class="entity">D</span></span></span><span class="main">)</span>"</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Reals definable with square roots›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The inductive set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">radical_sqrt</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> defines the reals
that can be defined with square roots. If <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is in the
following set, then it depends only upon rational expressions and
square roots. For example, suppose <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is of the form : $x =
(\sqrt{a + \sqrt{b}} + \sqrt{c + \sqrt{d*e +f}}) / (\sqrt{a} +
\sqrt{b}) + (a + \sqrt{b}) / \sqrt{g}$, where <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>,
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">c</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">d</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">e</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">f</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">g</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> are
rationals. Then <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">radical_sqrt</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> because it is
only defined with rationals and square roots of radicals.›</span></span>

<span class="keyword1"><span class="command">inductive_set</span></span> <span class="entity">radical_sqrt</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real set"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∈</span> <span class="main">ℚ</span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∈</span> <span class="free">radical_sqrt</span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∈</span> <span class="free">radical_sqrt</span> <span class="main">⟹</span> <span class="main">-</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∈</span> <span class="free">radical_sqrt</span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∈</span> <span class="free">radical_sqrt</span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> <span class="main">1</span><span class="main">/</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∈</span> <span class="free">radical_sqrt</span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∈</span> <span class="free">radical_sqrt</span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">∈</span> <span class="free">radical_sqrt</span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">+</span><span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">∈</span> <span class="free">radical_sqrt</span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∈</span> <span class="free">radical_sqrt</span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">∈</span> <span class="free">radical_sqrt</span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">*</span><span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">∈</span> <span class="free">radical_sqrt</span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∈</span> <span class="free">radical_sqrt</span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≥</span> <span class="main">0</span> <span class="main">⟹</span> sqrt <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∈</span> <span class="free">radical_sqrt</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Here, we list some rules that will be used to prove that a
given real is in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"radical_sqrt"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Given two reals in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"radical_sqrt"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span>
<span class="quoted"><span class="free"><span class="quoted"><span class="free">y</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, the subtraction $x - y$ is also in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"radical_sqrt"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.›</span></span>

<span class="keyword1" id="Impossible_Geometry-radical_sqrt_rule_subtraction"><span class="command">lemma</span></span> radical_sqrt_rule_subtraction<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> radical_sqrt <span class="main">⟹</span> <span class="free">y</span> <span class="main">∈</span> radical_sqrt <span class="main">⟹</span> <span class="free">x</span><span class="main">-</span><span class="free">y</span> <span class="main">∈</span> radical_sqrt"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> diff_conv_add_uminus radical_sqrt.intros<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Given two reals in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"radical_sqrt"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span>
<span class="quoted"><span class="free"><span class="quoted"><span class="free">y</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, and $y \neq 0$, the division $x / y$ is also in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span>
<span class="quoted"><span class="quoted">"radical_sqrt"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.›</span></span>

<span class="keyword1" id="Impossible_Geometry-radical_sqrt_rule_division"><span class="command">lemma</span></span> radical_sqrt_rule_division<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> radical_sqrt <span class="main">⟹</span> <span class="free">y</span> <span class="main">∈</span> radical_sqrt <span class="main">⟹</span> <span class="free">y</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">x</span><span class="main">/</span><span class="free">y</span> <span class="main">∈</span> radical_sqrt"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> divide_real_def radical_sqrt.intros<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span> real_scaleR_def real_vector.scale_one<span class="main">)</span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Given a positive real <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"radical_sqrt"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, its
square $x^2$ is also in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"radical_sqrt"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.›</span></span>

<span class="keyword1" id="Impossible_Geometry-radical_sqrt_rule_power2"><span class="command">lemma</span></span> radical_sqrt_rule_power2<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> radical_sqrt <span class="main">⟹</span> <span class="free">x</span> <span class="main">≥</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">∈</span> radical_sqrt"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> power2_eq_square radical_sqrt.intros<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span><span class="main">)</span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Given a positive real <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"radical_sqrt"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, its
cube $x^3$ is also in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"radical_sqrt"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.›</span></span>

<span class="keyword1" id="Impossible_Geometry-radical_sqrt_rule_power3"><span class="command">lemma</span></span> radical_sqrt_rule_power3<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> radical_sqrt <span class="main">⟹</span> <span class="free">x</span> <span class="main">≥</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">∈</span> radical_sqrt"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> power3_eq_cube radical_sqrt.intros<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Introduction of the datatype expr which represents radical expressions›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹An expression expr is either a rational constant: Const or the
negation of an expression or the inverse of an expression or the
addition of two expressions or the multiplication of two expressions
or the square root of an expression.›</span></span>

<span class="keyword1"><span class="command">datatype</span></span> expr <span class="main">=</span> Const <span class="quoted">rat</span> <span class="main">|</span> Negation <span class="quoted">expr</span> <span class="main">|</span> Inverse <span class="quoted">expr</span> <span class="main">|</span> Addition <span class="quoted">expr</span> <span class="quoted">expr</span> <span class="main">|</span> Multiplication <span class="quoted">expr</span> <span class="quoted">expr</span> <span class="main">|</span> Sqrt <span class="quoted">expr</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The function <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">translation</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> translates a given
expression into its equivalent real.›</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">translation</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"expr <span class="main">=&gt;</span> real"</span></span> <span class="main">(</span><span class="quoted">"<span class="keyword3">(2</span><span class="keyword1">⦃</span>_<span class="keyword1">⦄</span><span class="keyword3">)</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">translation</span> <span class="main">(</span>Const <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> of_rat <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">translation</span> <span class="main">(</span>Negation <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">-</span> <span class="free">translation</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">translation</span> <span class="main">(</span>Inverse <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>real<span class="main">)</span> <span class="main">/</span> <span class="free">translation</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">translation</span> <span class="main">(</span>Addition <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free">translation</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="main">+</span> <span class="free">translation</span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">translation</span> <span class="main">(</span>Multiplication <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free">translation</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="main">*</span> <span class="free">translation</span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">translation</span> <span class="main">(</span>Sqrt <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="free">translation</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="main">&lt;</span> <span class="main">0</span> <span class="keyword1">then</span> <span class="main">0</span> <span class="keyword1">else</span> sqrt <span class="main">(</span><span class="free">translation</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Define the set of all the radicals of a given expression. For
example, suppose <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">expr</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is of the form : expr = Addition (Sqrt
(Addition (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>) Sqrt (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>))) (Sqrt (Addition
(Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">c</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>) (Sqrt (Sqrt (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">d</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>))))), where <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>,
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">c</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">d</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> are rationals. This can be
translated as follows: <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>⦃expr⦄ =›</span></span></span></span>~$\sqrt{a + \sqrt{b}} +
\sqrt{c + \sqrt{\sqrt{d}}}$. Moreover, the set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">radicals</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> of
this expression is : <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>⦃›</span></span></span></span>Addition (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>) (Sqrt
(Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>)), Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, Addition (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">c</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>) (Sqrt
(Sqrt (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">d</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>))), Sqrt (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">d</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>), Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span>
<span class="quoted"><span class="free"><span class="quoted"><span class="free">d</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span><span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>⦄›</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">radicals</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"expr <span class="main">=&gt;</span> expr set"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">radicals</span> <span class="main">(</span>Const <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">radicals</span> <span class="main">(</span>Negation <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">radicals</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">radicals</span> <span class="main">(</span>Inverse <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">radicals</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">radicals</span> <span class="main">(</span>Addition <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">radicals</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="free">radicals</span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">radicals</span> <span class="main">(</span>Multiplication <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">radicals</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="free">radicals</span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">radicals</span> <span class="main">(</span>Sqrt <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="main">⦃</span><span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">⦄</span> <span class="main">&lt;</span> <span class="main">0</span> <span class="keyword1">then</span> <span class="free">radicals</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span> <span class="keyword1">else</span> <span class="main">{</span><span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">}</span> <span class="main">∪</span> <span class="main">(</span><span class="free">radicals</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹If <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">r</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"radicals"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">e</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> then the
set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"radical_sqrt"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">r</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is a subset (strictly
speaking) of the set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"radicals"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">e</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.›</span></span>

<span class="keyword1" id="Impossible_Geometry-radicals_expr_subset"><span class="command">lemma</span></span> radicals_expr_subset<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> radicals <span class="free">e</span> <span class="main">⟹</span> radicals <span class="free">r</span> <span class="main">⊂</span> radicals <span class="free">e</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">e</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> if_split_asm<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹If <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"radical_sqrt"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> then there exists a
radical expression <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">e</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> which translation is <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> (it is
important to notice that this expression is not necessarily
unique).›</span></span>

<span class="keyword1" id="Impossible_Geometry-radical_sqrt_correct_expr"><span class="command">lemma</span></span> radical_sqrt_correct_expr<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> radical_sqrt <span class="main">⟹</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">e</span><span class="main">.</span> <span class="main">⦃</span><span class="bound">e</span><span class="main">⦄</span> <span class="main">=</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> radical_sqrt.induct<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">erule</span> Rats_induct<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> translation.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> translation.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> translation.simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> translation.simps<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> translation.simps<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> linorder_not_less translation.simps<span class="main"><span class="main">(</span></span>6<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The order of an expression is the maximum number of radicals
one over another occurring in a given expression. Using the example
above, suppose <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">expr</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is of the form : expr = Addition (Sqrt
(Addition (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>) Sqrt (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>))) (Sqrt (Addition
(Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">c</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>) (Sqrt (Sqrt (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">d</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>))))), where <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>,
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">c</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">d</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> are rationals and which can be
translated as follows: <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>⦃expr⦄ =›</span></span></span></span>~$\sqrt{a + \sqrt{b} +
\sqrt{c + \sqrt{\sqrt{d}}}}$. The order of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">expr</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is $max (2,3)
= 3$.›</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">order</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"expr <span class="main">=&gt;</span> nat"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">order</span> <span class="main">(</span>Const <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">order</span> <span class="main">(</span>Negation <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free">order</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">order</span> <span class="main">(</span>Inverse <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free">order</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">order</span> <span class="main">(</span>Addition <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span><span class="main">)</span> <span class="main">=</span> max <span class="main">(</span><span class="free">order</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span><span class="main">)</span> <span class="main">(</span><span class="free">order</span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span><span class="main">)</span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">order</span> <span class="main">(</span>Multiplication <span class="free"><span class="bound"><span class="entity">e1</span></span></span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span><span class="main">)</span> <span class="main">=</span> max <span class="main">(</span><span class="free">order</span> <span class="free"><span class="bound"><span class="entity">e1</span></span></span><span class="main">)</span> <span class="main">(</span><span class="free">order</span> <span class="free"><span class="bound"><span class="entity">e2</span></span></span><span class="main">)</span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="free">order</span> <span class="main">(</span>Sqrt <span class="free"><span class="bound"><span class="entity">e</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="free">order</span> <span class="free"><span class="bound"><span class="entity">e</span></span></span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹If an expression <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">s</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is one of the radicals (or in
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"radicals"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>) of the expression <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">r</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, then its order is
smaller (strictly speaking) then the order of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">r</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.›</span></span>

<span class="keyword1" id="Impossible_Geometry-in_radicals_smaller_order"><span class="command">lemma</span></span> in_radicals_smaller_order<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">∈</span> radicals <span class="free">r</span> <span class="main">⟹</span> <span class="main">(</span>order <span class="free">s</span><span class="main">)</span> <span class="main">&lt;</span> <span class="main">(</span>order <span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">r</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> insert_iff insert_is_Un less_Suc_eq<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The following theorem is the converse of the previous lemma.›</span></span>

<span class="keyword1" id="Impossible_Geometry-in_radicals_smaller_order_contrap"><span class="command">lemma</span></span> in_radicals_smaller_order_contrap<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span>order <span class="free">s</span><span class="main">)</span> <span class="main">≥</span> <span class="main">(</span>order <span class="free">r</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">¬</span> <span class="main">(</span><span class="free">s</span> <span class="main">∈</span> radicals <span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> in_radicals_smaller_order leD<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹An expression <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">r</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> cannot be one of its own radicals.›</span></span>

<span class="keyword1" id="Impossible_Geometry-not_in_own_radicals"><span class="command">lemma</span></span> not_in_own_radicals<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">r</span> <span class="main">∈</span> radicals <span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> in_radicals_smaller_order order_less_irrefl<span class="main">)</span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹If an expression <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">e</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is a radical expression and it has
no radicals then its translation is a rational.›</span></span>

<span class="keyword1" id="Impossible_Geometry-radicals_empty_rational"><span class="command">lemma</span></span> radicals_empty_rational<span class="main">:</span> <span class="quoted"><span class="quoted">"radicals <span class="free">e</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="main">⦃</span><span class="free">e</span><span class="main">⦄</span> <span class="main">∈</span> <span class="main">ℚ</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">e</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹A finite non-empty set of natural numbers has necessarily a
maximum.›</span></span>

<span class="keyword1" id="Impossible_Geometry-finite_set_has_max"><span class="command">lemma</span></span> finite_set_has_max<span class="main">:</span>
  <span class="quoted"><span class="quoted">"finite <span class="main">(</span><span class="free">s</span><span class="main">::</span> nat set<span class="main">)</span> <span class="main">⟹</span> <span class="free">s</span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">k</span> <span class="main">∈</span> <span class="free">s</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">p</span> <span class="main">∈</span> <span class="free">s</span><span class="main">.</span> <span class="bound">p</span> <span class="main">≤</span> <span class="bound">k</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Max_ge Max_in<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹There is a finite number of radicals in an expression.›</span></span>

<span class="keyword1" id="Impossible_Geometry-finite_radicals"><span class="command">lemma</span></span> finite_radicals<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>radicals <span class="free">e</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">e</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We define here a new set corresponding to the orders of each
element in the set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"radicals"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> of an expression <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span>
<span class="quoted"><span class="free"><span class="quoted"><span class="free">expr</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>. Using the example above, suppose <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">expr</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is of the form :
expr = Addition (Sqrt (Addition (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>) Sqrt (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span>
<span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>))) (Sqrt (Addition (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">c</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>) (Sqrt (Sqrt (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span>
<span class="quoted"><span class="free"><span class="quoted"><span class="free">d</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>))))), where <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">c</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">d</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> are
rationals and which can be translated as follows: <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>⦃expr⦄
=›</span></span></span></span>~$\sqrt{a + \sqrt{b}} + \sqrt{c + \sqrt{\sqrt{d}}}$. The set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span>
<span class="quoted"><span class="quoted">"radicals"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">expr</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is $\{$Addition (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>) Sqrt
(Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>), Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, Addition (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">c</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>) (Sqrt
(Sqrt (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">d</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>))), Sqrt (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">d</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>), Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span>
<span class="quoted"><span class="free"><span class="quoted"><span class="free">d</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>$\}$; therefore, the set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="free">order_radicals</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> of this set is
$\{1,0,2,1,0\}$.›</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">order_radicals</span><span class="main">::</span> <span class="quoted"><span class="quoted">"expr set <span class="main">=&gt;</span> nat set"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">order_radicals</span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="main">=</span> <span class="main">{</span><span class="bound">y</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main">.</span> <span class="bound">y</span> <span class="main">=</span> order <span class="bound">x</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹If the set of radicals of an expression <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">e</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is not empty
and is finite then the set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"order_radicals"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> of the set of
radicals of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">e</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is not empty and is also finite.›</span></span>

<span class="keyword1" id="Impossible_Geometry-finite_order_radicals"><span class="command">lemma</span></span> finite_order_radicals<span class="main">:</span>
  <span class="quoted"><span class="quoted">"radicals <span class="free">e</span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">⟹</span> finite <span class="main">(</span>radicals <span class="free">e</span><span class="main">)</span> <span class="main">⟹</span>
   order_radicals <span class="main">(</span>radicals <span class="free">e</span><span class="main">)</span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">∧</span> finite <span class="main">(</span>order_radicals <span class="main">(</span>radicals <span class="free">e</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="main">(</span><span class="operator">metis</span> equals0I<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The following lemma states that given an expression <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">e</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>,
if the set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"order_radicals"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> of the set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"radicals <span class="free"><span class="free">e</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is
not empty and is finite, then there exists a radical <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">r</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> of
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">e</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> which is of highest order among the radicals of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">e</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.
›</span></span>

<span class="keyword1" id="Impossible_Geometry-finite_order_radicals_has_max"><span class="command">lemma</span></span> finite_order_radicals_has_max<span class="main">:</span>
  <span class="quoted"><span class="quoted">"order_radicals <span class="main">(</span>radicals <span class="free">e</span><span class="main">)</span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">⟹</span>
   finite <span class="main">(</span>order_radicals <span class="main">(</span>radicals <span class="free">e</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span>
   <span class="main">∃</span> <span class="bound">r</span><span class="main">.</span> <span class="main">(</span><span class="bound">r</span> <span class="main">∈</span> radicals <span class="free">e</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">s</span> <span class="main">∈</span> <span class="main">(</span>radicals <span class="free">e</span><span class="main">)</span><span class="main">.</span> <span class="main">(</span>order <span class="bound">r</span> <span class="main">≥</span> order <span class="bound">s</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> finite_set_has_max <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"order_radicals <span class="main">(</span>radicals <span class="free">e</span><span class="main">)</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹This important lemma states that in an expression that has at
least one radical, we can find an upmost radical <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">r</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> which is
not radical of any other term of the expression <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">e</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>. It is also
important to notice that this upmost radical is not necessarily unique
and is not the term of highest order of the expression <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span>
<span class="quoted"><span class="free"><span class="quoted"><span class="free">e</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>. Using the example above, suppose <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">e</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is of the form : <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span>
<span class="quoted"><span class="free"><span class="quoted"><span class="free">e</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> = Addition (Sqrt (Addition (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>) Sqrt (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span>
<span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>))) (Sqrt (Addition (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">c</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>) (Sqrt (Sqrt (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span>
<span class="quoted"><span class="free"><span class="quoted"><span class="free">d</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>))))), where <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">c</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">d</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> are
rationals and which can be translated as follows: <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>⦃e⦄
=›</span></span></span></span>~$\sqrt{a + \sqrt{b}} + \sqrt{c + \sqrt{\sqrt{d}}}$. The possible
upmost radicals in this expression are Addition (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>)
(Sqrt (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>)) or Addition (Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">c</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>) (Sqrt (Sqrt
(Const <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">d</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>))).›</span></span>


<span class="keyword1" id="Impossible_Geometry-upmost_radical_sqrt2"><span class="command">lemma</span></span> upmost_radical_sqrt2<span class="main">:</span>
  <span class="quoted"><span class="quoted">"radicals <span class="free">e</span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">⟹</span>
   <span class="main">∃</span> <span class="bound">r</span> <span class="main">∈</span> radicals <span class="free">e</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">s</span> <span class="main">∈</span> radicals <span class="free">e</span><span class="main">.</span> <span class="bound">r</span> <span class="main">∉</span> radicals <span class="bound">s</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> in_radicals_smaller_order_contrap <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">r</span></span> <span class="quoted"><span class="free">s</span></span><span class="main">]</span>  finite_radicals <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">e</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> finite_order_radicals finite_order_radicals_has_max in_radicals_smaller_order_contrap<span class="main">)</span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The following 7 lemmas are used to prove the main lemma <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span>
<span class="quoted"><span class="quoted">"<span class="free"><span class="free">radical_sqrt_normal_form</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> which states that if an expression <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span>
<span class="quoted"><span class="free"><span class="quoted"><span class="free">e</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> has at least one radical then it can be written in a normal
form. This means that there exist three radical expressions <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>,
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">r</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> such that <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>⦃e⦄ = ⦃a⦄ + ⦃b⦄ *
\&lt;sqrt&gt;⦃r⦄›</span></span></span></span> and the radicals of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> are radicals of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">e</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
but are not <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">r</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, and the same goes for the radicals of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">r</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>. It is important to notice that <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">r</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> are not unique and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">"Sqrt <span class="free"><span class="free">r</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is not necessarily the
term of highest order.›</span></span>

<span class="keyword1" id="Impossible_Geometry-radical_sqrt_normal_form_sublemma"><span class="command">lemma</span></span> radical_sqrt_normal_form_sublemma<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">a</span><span class="main">::</span>real<span class="main">)</span> <span class="main">-</span> <span class="free">b</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="main">+</span> <span class="free">b</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span> <span class="main">*</span> <span class="free">a</span> <span class="main">-</span> <span class="free">b</span> <span class="main">*</span> <span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>

<span class="keyword1" id="Impossible_Geometry-eq_sqrt_squared"><span class="command">lemma</span></span> eq_sqrt_squared<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span> <span class="main">≥</span> <span class="main">0</span> <span class="main">⟹</span> <span class="main">(</span>sqrt <span class="free">x</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>sqrt <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> abs_of_nonneg real_sqrt_abs2 real_sqrt_mult<span class="main">)</span>

<span class="keyword1" id="Impossible_Geometry-radical_sqrt_normal_form_lemma4"><span class="command">lemma</span></span> radical_sqrt_normal_form_lemma4<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="free">y</span> <span class="main">*</span> sqrt <span class="free">z</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>
   <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="free">y</span> <span class="main">*</span> sqrt <span class="free">z</span><span class="main">)</span> <span class="main">=</span>
    <span class="free">x</span> <span class="main">/</span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">x</span> <span class="main">-</span> <span class="free">y</span> <span class="main">*</span> <span class="free">y</span> <span class="main">*</span> <span class="free">z</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="free">y</span> <span class="main">*</span> sqrt <span class="free">z</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">x</span> <span class="main">-</span> <span class="free">y</span> <span class="main">*</span> <span class="free">y</span> <span class="main">*</span> <span class="free">z</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="free">y</span> <span class="main">*</span> sqrt <span class="free">z</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="free">y</span> <span class="main">*</span> sqrt <span class="free">z</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="free">y</span> <span class="main">*</span> sqrt <span class="free">z</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="free">y</span> <span class="main">*</span> sqrt <span class="free">z</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eq_divide_imp assms<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">x</span> <span class="main">/</span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">x</span> <span class="main">-</span> <span class="free">y</span> <span class="main">*</span> <span class="free">y</span> <span class="main">*</span> <span class="free">z</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="free">y</span> <span class="main">*</span> sqrt <span class="free">z</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">x</span> <span class="main">-</span> <span class="free">y</span> <span class="main">*</span> <span class="free">y</span> <span class="main">*</span> <span class="free">z</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span> eq_sqrt_squared diff_divide_distrib assms<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Impossible_Geometry-radical_sqrt_normal_form_lemma"><span class="command">lemma</span></span> radical_sqrt_normal_form_lemma<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">e</span><span class="main">::</span><span class="quoted">expr</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"radicals <span class="free">e</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">s</span> <span class="main">∈</span> radicals <span class="free">e</span><span class="main">.</span> <span class="free">r</span> <span class="main">∉</span> radicals <span class="bound">s</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">:</span> radicals <span class="free">e</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="main">0</span> <span class="main">≤</span> <span class="main">⦃</span><span class="free">r</span><span class="main">⦄</span> <span class="main">&amp;</span> <span class="main">⦃</span><span class="free">e</span><span class="main">⦄</span> <span class="main">=</span> <span class="main">⦃</span><span class="bound">a</span><span class="main">⦄</span> <span class="main">+</span> <span class="main">⦃</span><span class="bound">b</span><span class="main">⦄</span> <span class="main">*</span> sqrt <span class="main">⦃</span><span class="free">r</span><span class="main">⦄</span> <span class="main">&amp;</span>
          radicals <span class="bound">a</span> <span class="main">∪</span> radicals <span class="bound">b</span> <span class="main">∪</span> radicals <span class="free">r</span> <span class="main">⊆</span> radicals <span class="free">e</span> <span class="main">&amp;</span>
          <span class="free">r</span> <span class="main">∉</span> radicals <span class="bound">a</span> <span class="main">∪</span> radicals <span class="bound">b</span>"</span></span>
       <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="var">?concl</span> <span class="free">e</span> <span class="bound">a</span> <span class="bound">b</span>"</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">e</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Const <span class="skolem">rat</span><span class="main">)</span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Negation <span class="skolem">e</span><span class="main">)</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="skolem"><span class="skolem">b</span></span>
    <span class="keyword2"><span class="keyword">where</span></span> a2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?concl</span> <span class="skolem">e</span> <span class="skolem">a</span> <span class="skolem">b</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Negation radicals.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⦃</span>Negation <span class="skolem">e</span><span class="main">⦄</span> <span class="main">=</span> <span class="main">⦃</span>Negation <span class="skolem">a</span><span class="main">⦄</span> <span class="main">+</span> <span class="main">⦃</span>Negation <span class="skolem">b</span><span class="main">⦄</span> <span class="main">*</span> sqrt <span class="main">⦃</span><span class="free">r</span><span class="main">⦄</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> a2
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> radicals.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Inverse <span class="skolem">e</span><span class="main">)</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="skolem"><span class="skolem">b</span></span>
    <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="var">?concl</span> <span class="skolem">e</span> <span class="skolem">a</span> <span class="skolem">b</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Inverse radicals.simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">case_tac</span> <span class="quoted"><span class="quoted">"<span class="main">⦃</span><span class="skolem">b</span><span class="main">⦄</span> <span class="main">*</span> sqrt <span class="main">⦃</span><span class="free">r</span><span class="main">⦄</span> <span class="main">=</span> <span class="main">⦃</span><span class="skolem">a</span><span class="main">⦄</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">case_tac</span> <span class="quoted"><span class="quoted">"<span class="main">⦃</span><span class="skolem">a</span><span class="main">⦄</span> <span class="main">=</span> <span class="main">0</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> add_0_right div_by_0 mult_zero_right<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Multiplication <span class="main">(</span>Const <span class="main">1</span><span class="main">)</span> <span class="main">(</span>Inverse <span class="main">(</span>Multiplication <span class="main">(</span>Const <span class="numeral">2</span><span class="main">)</span> <span class="skolem">a</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Const <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Multiplication <span class="skolem">a</span> <span class="main">(</span>Inverse <span class="main">(</span>Addition <span class="main">(</span>Multiplication <span class="skolem">a</span> <span class="skolem">a</span><span class="main">)</span> <span class="main">(</span>Negation <span class="main">(</span>Multiplication <span class="main">(</span>Multiplication <span class="skolem">b</span> <span class="skolem">b</span><span class="main">)</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Negation <span class="main">(</span>Multiplication <span class="skolem">b</span> <span class="main">(</span>Inverse <span class="main">(</span>Addition <span class="main">(</span>Multiplication <span class="skolem">a</span> <span class="skolem">a</span><span class="main">)</span> <span class="main">(</span>Negation <span class="main">(</span>Multiplication <span class="main">(</span>Multiplication <span class="skolem">b</span> <span class="skolem">b</span><span class="main">)</span> <span class="free">r</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span> not_in_own_radicals eq_diff_eq' radical_sqrt_normal_form_lemma4<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Addition <span class="skolem">e1</span> <span class="skolem">e2</span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> d1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">s</span> <span class="main">∈</span> radicals <span class="skolem">e1</span> <span class="main">∪</span> radicals <span class="skolem">e2</span><span class="main">.</span> <span class="free">r</span> <span class="main">∉</span> radicals <span class="bound">s</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> radicals.simps<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">:</span> radicals <span class="skolem">e1</span> <span class="main">&amp;</span> <span class="free">r</span> <span class="main">:</span> radicals <span class="skolem">e2</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a1</span></span> <span class="skolem"><span class="skolem">b1</span></span> <span class="skolem"><span class="skolem">a2</span></span> <span class="skolem"><span class="skolem">b2</span></span>
      <span class="keyword2"><span class="keyword">where</span></span> ab<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?concl</span> <span class="skolem">e1</span> <span class="skolem">a1</span> <span class="skolem">b1</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> bb<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?concl</span> <span class="skolem">e2</span> <span class="skolem">a2</span> <span class="skolem">b2</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Addition.hyps
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> d1<span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> True empty_iff<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Addition <span class="skolem">a1</span> <span class="skolem">a2</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Addition <span class="skolem">b1</span> <span class="skolem">b2</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comm_semiring_class.distrib<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">:</span> radicals <span class="skolem">e1</span>"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> True
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a1</span></span> <span class="skolem"><span class="skolem">b1</span></span>
      <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="main">⦃</span><span class="free">r</span><span class="main">⦄</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="var">?concl</span> <span class="skolem">e1</span> <span class="skolem">a1</span> <span class="skolem">b1</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> Addition.hyps
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> d1<span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> True empty_iff<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Addition <span class="skolem">a1</span> <span class="skolem">e2</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b1</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>    <span class="keyword1"><span class="command">using</span></span> False True
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> False
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a2</span></span> <span class="skolem"><span class="skolem">b2</span></span>
        <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="main">⦃</span><span class="free">r</span><span class="main">⦄</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="var">?concl</span> <span class="skolem">e2</span> <span class="skolem">a2</span> <span class="skolem">b2</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> Addition d1
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> False Un_iff empty_iff radicals.simps<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Addition <span class="skolem">a2</span> <span class="skolem">e1</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b2</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>    <span class="keyword1"><span class="command">using</span></span> False
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Multiplication <span class="skolem">e1</span> <span class="skolem">e2</span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">:</span> radicals <span class="skolem">e1</span> <span class="main">&amp;</span> <span class="free">r</span> <span class="main">:</span> radicals <span class="skolem">e2</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a1</span></span> <span class="skolem"><span class="skolem">b1</span></span> <span class="skolem"><span class="skolem">a2</span></span> <span class="skolem"><span class="skolem">b2</span></span>
      <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="var">?concl</span> <span class="skolem">e1</span> <span class="skolem">a1</span> <span class="skolem">b1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="var">?concl</span> <span class="skolem">e2</span> <span class="skolem">a2</span> <span class="skolem">b2</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Multiplication
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="main">(</span><span class="operator">metis</span> True empty_iff<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Addition <span class="main">(</span>Multiplication <span class="skolem">a1</span> <span class="skolem">a2</span><span class="main">)</span> <span class="main">(</span>Multiplication <span class="free">r</span> <span class="main">(</span>Multiplication <span class="skolem">b1</span> <span class="skolem">b2</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Addition <span class="main">(</span>Multiplication <span class="skolem">a1</span> <span class="skolem">b2</span><span class="main">)</span> <span class="main">(</span>Multiplication <span class="skolem">a2</span> <span class="skolem">b1</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> not_in_own_radicals <span class="dynamic"><span class="dynamic">algebra_simps</span></span> eq_sqrt_squared<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">:</span> radicals <span class="skolem">e1</span>"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> True
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a1</span></span> <span class="skolem"><span class="skolem">b1</span></span>
      <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="var">?concl</span> <span class="skolem">e1</span> <span class="skolem">a1</span> <span class="skolem">b1</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> Multiplication.hyps Multiplication<span class="main">(</span>4<span class="main">)</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> True empty_iff<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Multiplication <span class="skolem">a1</span> <span class="skolem">e2</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Multiplication <span class="skolem">b1</span> <span class="skolem">e2</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> False True le_supI1 radicals.simps<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> False
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a2</span></span> <span class="skolem"><span class="skolem">b2</span></span>
        <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="var">?concl</span> <span class="skolem">e2</span> <span class="skolem">a2</span> <span class="skolem">b2</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> Multiplication.hyps Multiplication<span class="main">(</span>4<span class="main">)</span> Multiplication<span class="main">(</span>5<span class="main">)</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Multiplication <span class="skolem">a2</span> <span class="skolem">e1</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Multiplication <span class="skolem">b2</span> <span class="skolem">e1</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> False le_supI2<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Sqrt <span class="skolem">e</span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="main">⦃</span><span class="skolem">e</span><span class="main">⦄</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> Sqrt
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Const <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Const <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Const <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"Const <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>   <span class="keyword1"><span class="command">using</span></span> Sqrt
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> linorder_not_less<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹This main lemma is essential for the remaining part of the proof.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> radical_sqrt_normal_form<span class="main">:</span>
  <span class="quoted"><span class="quoted">"radicals <span class="free">e</span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">⟹</span>
   <span class="main">∃</span> <span class="bound">r</span> <span class="main">∈</span> radicals <span class="free">e</span><span class="main">.</span>
        <span class="main">∃</span> <span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="main">⦃</span><span class="free">e</span><span class="main">⦄</span> <span class="main">=</span> <span class="main">⦃</span>Addition <span class="bound">a</span> <span class="main">(</span>Multiplication <span class="bound">b</span> <span class="main">(</span>Sqrt <span class="bound">r</span><span class="main">)</span><span class="main">)</span><span class="main">⦄</span> <span class="main">∧</span> <span class="main">⦃</span><span class="bound">r</span><span class="main">⦄</span> <span class="main">≥</span> <span class="main">0</span> <span class="main">∧</span>
               radicals <span class="bound">a</span> <span class="main">∪</span> radicals <span class="bound">b</span> <span class="main">∪</span> radicals <span class="bound">r</span> <span class="main">⊆</span> radicals <span class="free">e</span> <span class="main">&amp;</span>
               <span class="bound">r</span> <span class="main">∉</span> radicals <span class="bound">a</span> <span class="main">∪</span> radicals <span class="bound">b</span> <span class="main">∪</span> radicals <span class="bound">r</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> upmost_radical_sqrt2 <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">e</span></span><span class="main">]</span> radical_sqrt_normal_form_lemma
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> all_not_in_conv leD<span class="main">)</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Important properties of the roots of a cubic equation›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The following 7 lemmas are used to prove a main result about
the properties of the roots of a cubic equation (<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span>
<span class="quoted"><span class="quoted">"<span class="free"><span class="free">cubic_root_radical_sqrt_rational</span></span>"</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>) which states that assuming that
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">c</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> are rationals and that <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is
a radical satisfying $x^3 + a x^2 + b x + c = 0$ then there exists a
rational root. This lemma will be used in the proof of the
impossibility of trisection an angle and of duplicating a cube.›</span></span>


<span class="keyword1" id="Impossible_Geometry-cubic_root_radical_sqrt_steplemma"><span class="command">lemma</span></span> cubic_root_radical_sqrt_steplemma<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">P</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real set"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Nats <span class="main">[</span><span class="operator">THEN</span> subsetD<span class="main">,</span> <span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"Nats <span class="main">⊆</span> <span class="free">P</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Neg<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="main">-</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Inv<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟶</span> <span class="main">1</span><span class="main">/</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Add<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="bound">x</span><span class="main">+</span><span class="bound">y</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Mult<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="bound">x</span><span class="main">*</span><span class="bound">y</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">b</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">c</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> eq0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">z</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="free">z</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">z</span> <span class="main">+</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> u<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">u</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> v<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">v</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> s<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">s</span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> z<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">z</span> <span class="main">=</span> <span class="free">u</span> <span class="main">+</span> <span class="free">v</span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">w</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="bound">w</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="bound">w</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="bound">w</span> <span class="main">+</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">*</span> <span class="free">s</span> <span class="main">=</span> <span class="main">0</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> True
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eq0 u z add_0_iff<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">hence</span></span> sl0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult_eq_0_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> Add Neg <span class="keyword1"><span class="command">have</span></span> Minus<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="bound">x</span> <span class="main">-</span> <span class="bound">y</span> <span class="main">∈</span> <span class="free">P</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> diff_conv_add_uminus<span class="main">)</span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> l2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">u</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="free">v</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">u</span> <span class="main">+</span> <span class="free">c</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">v</span><span class="main">^</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="free">s</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> eq0 z
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">algebra</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">v</span><span class="main">^</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">v</span> <span class="main">≠</span> <span class="main">0</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">hence</span></span>  <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">v</span><span class="main">^</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span> <span class="main">(</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">v</span><span class="main">^</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">=</span> <span class="main">-</span> <span class="main">(</span><span class="free">u</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="free">v</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">u</span> <span class="main">+</span> <span class="free">c</span><span class="main">)</span><span class="main">*</span> <span class="main">(</span><span class="main">1</span><span class="main">/</span> <span class="main">(</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">v</span><span class="main">^</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> l2
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">algebra</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">v</span><span class="main">^</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span> <span class="main">/</span>
                <span class="main">(</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">v</span><span class="main">^</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span><span class="main">)</span>
           <span class="main">=</span> <span class="main">-</span> <span class="main">(</span><span class="free">u</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="free">v</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">u</span> <span class="main">+</span> <span class="free">c</span><span class="main">)</span> <span class="main">*</span>
               <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">v</span><span class="main">^</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">=</span> <span class="main">-</span> <span class="main">(</span><span class="free">u</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="free">v</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">u</span> <span class="main">+</span> <span class="free">c</span><span class="main">)</span> <span class="main">*</span>
               <span class="main">(</span><span class="main">1</span> <span class="main">/</span><span class="main">(</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">v</span><span class="main">^</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult_1_right True divide_self_if<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> l10<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">=</span> <span class="main">-</span> <span class="main">(</span><span class="free">u</span> <span class="main">*</span><span class="free">u</span> <span class="main">*</span><span class="free">u</span>  <span class="main">+</span> <span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">*</span><span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">s</span><span class="main">*</span><span class="free">s</span><span class="main">)</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span><span class="free">u</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="free">v</span><span class="main">*</span><span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">s</span> <span class="main">*</span><span class="free">s</span><span class="main">)</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">u</span> <span class="main">+</span> <span class="free">c</span><span class="main">)</span> <span class="main">*</span>
                <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span><span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">v</span> <span class="main">*</span><span class="free">v</span><span class="main">*</span><span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">s</span> <span class="main">*</span><span class="free">s</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span> power2_eq_square power3_eq_cube<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">3</span><span class="main">*</span><span class="free">u</span><span class="main">*</span><span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">v</span><span class="main">*</span><span class="free">v</span><span class="main">*</span><span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">s</span> <span class="main">*</span><span class="free">s</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> a b u v s Nats Mult Add
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> l103<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span><span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">v</span> <span class="main">*</span><span class="free">v</span><span class="main">*</span><span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">s</span> <span class="main">*</span><span class="free">s</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Inv True
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="main">(</span><span class="free">u</span><span class="main">*</span><span class="free">u</span><span class="main">*</span><span class="free">u</span> <span class="main">+</span> <span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">*</span><span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">s</span><span class="main">*</span><span class="free">s</span><span class="main">)</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span><span class="free">u</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="free">v</span><span class="main">*</span><span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">s</span> <span class="main">*</span><span class="free">s</span><span class="main">)</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">u</span> <span class="main">+</span> <span class="free">c</span><span class="main">)</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> a b c u v s Mult Add Neg Minus Nats
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="main">(</span><span class="free">u</span> <span class="main">*</span><span class="free">u</span> <span class="main">*</span><span class="free">u</span>  <span class="main">+</span> <span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">*</span><span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">s</span><span class="main">*</span><span class="free">s</span><span class="main">)</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span><span class="free">u</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="free">v</span><span class="main">*</span><span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">s</span> <span class="main">*</span><span class="free">s</span><span class="main">)</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">u</span> <span class="main">+</span> <span class="free">c</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span><span class="main">(</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span><span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">v</span> <span class="main">*</span><span class="free">v</span><span class="main">*</span><span class="free">v</span> <span class="main">*</span> <span class="main">(</span><span class="free">s</span> <span class="main">*</span><span class="free">s</span><span class="main">)</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">v</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> l103 Mult
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> l10
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> z u v Mult Add
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> eq0
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span> <span class="free">a</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">u</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span> <span class="free">a</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">u</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="main">(</span> <span class="main">-</span> <span class="free">a</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">u</span><span class="main">)</span> <span class="main">+</span> <span class="free">c</span> <span class="main">=</span>
          <span class="main">(</span><span class="main">-</span> <span class="free">a</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">u</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span> <span class="free">a</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">u</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="main">-</span> <span class="main">(</span><span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">v</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span>
          <span class="main">(</span> <span class="main">-</span> <span class="free">a</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">u</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="main">-</span> <span class="main">(</span><span class="free">u</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">-</span> <span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span> <span class="main">*</span> <span class="free">v</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">a</span> <span class="main">*</span> <span class="free">v</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">3</span> <span class="main">*</span> <span class="free">u</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">v</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">s</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">u</span> <span class="main">+</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">a</span> <span class="main">*</span> <span class="free">u</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> l2 False sl0
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">algebra</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span> power_def<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> a u Add Neg diff_conv_add_uminus mult_2<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Impossible_Geometry-cubic_root_radical_sqrt_steplemma_sqrt"><span class="command">lemma</span></span> cubic_root_radical_sqrt_steplemma_sqrt<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Nats <span class="main">[</span><span class="operator">THEN</span> subsetD<span class="main">,</span> <span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"Nats <span class="main">⊆</span> <span class="free">P</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Neg<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="main">-</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Inv<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟶</span> <span class="main">1</span><span class="main">/</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Add<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="bound">x</span><span class="main">+</span><span class="bound">y</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Mult<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="bound">x</span><span class="main">*</span><span class="bound">y</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">b</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">c</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> eq0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">z</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="free">z</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">z</span> <span class="main">+</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> u<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">u</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> v<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">v</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> s<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">s</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> sPositive<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> z<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">z</span> <span class="main">=</span> <span class="free">u</span> <span class="main">+</span> <span class="free">v</span> <span class="main">*</span> sqrt <span class="free">s</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">w</span> <span class="main">∈</span> <span class="free">P</span><span class="main">.</span> <span class="bound">w</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="bound">w</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="bound">w</span> <span class="main">+</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>sqrt <span class="free">s</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>sqrt <span class="free">s</span><span class="main">)</span> <span class="main">∈</span> <span class="free">P</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eq_sqrt_squared s sPositive<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> cubic_root_radical_sqrt_steplemma <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">P</span></span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">b</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">z</span></span> <span class="quoted"><span class="free">u</span></span> <span class="quoted"><span class="free">v</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="free">s</span>"</span></span><span class="main">]</span>
          Neg Add Mult Inv a b c u v s eq0 z
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Impossible_Geometry-cubic_root_radical_sqrt_lemma"><span class="command">lemma</span></span> cubic_root_radical_sqrt_lemma<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">e</span><span class="main">::</span><span class="quoted">expr</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="main">ℚ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> <span class="main">ℚ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">∈</span> <span class="main">ℚ</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> notEmpty<span class="main">:</span> <span class="quoted"><span class="quoted">"radicals <span class="free">e</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> eq0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⦃</span><span class="free">e</span><span class="main">⦄</span><span class="main">^</span> <span class="numeral">3</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="main">⦃</span><span class="free">e</span><span class="main">⦄</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="main">⦃</span><span class="free">e</span><span class="main">⦄</span> <span class="main">+</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">e1</span><span class="main">.</span> radicals <span class="bound">e1</span> <span class="main">⊂</span> radicals <span class="free">e</span> <span class="main">&amp;</span> <span class="main">(</span><span class="main">⦃</span><span class="bound">e1</span><span class="main">⦄</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="main">⦃</span><span class="bound">e1</span><span class="main">⦄</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="main">⦃</span><span class="bound">e1</span><span class="main">⦄</span> <span class="main">+</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">v</span></span>
    <span class="keyword2"><span class="keyword">where</span></span> hypsruv<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⦃</span><span class="skolem">r</span><span class="main">⦄</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> radicals <span class="free">e</span>"</span></span>
                   <span class="quoted"><span class="quoted">"<span class="main">⦃</span><span class="free">e</span><span class="main">⦄</span> <span class="main">=</span> <span class="main">⦃</span>Addition <span class="skolem">u</span> <span class="main">(</span>Multiplication <span class="skolem">v</span> <span class="main">(</span>Sqrt <span class="skolem">r</span><span class="main">)</span><span class="main">)</span><span class="main">⦄</span>"</span></span>
                    <span class="quoted"><span class="quoted">"radicals <span class="skolem">u</span> <span class="main">∪</span> radicals <span class="skolem">v</span> <span class="main">∪</span> radicals <span class="skolem">r</span> <span class="main">⊆</span> radicals <span class="free">e</span>"</span></span>
                    <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∉</span> radicals <span class="skolem">u</span> <span class="main">∪</span> radicals <span class="skolem">v</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∉</span> radicals <span class="skolem">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> notEmpty radical_sqrt_normal_form <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">e</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?E</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">x</span><span class="main">.</span> <span class="main">∃</span> <span class="bound">ex</span><span class="main">.</span> <span class="main">(</span><span class="main">⦃</span><span class="bound">ex</span><span class="main">⦄</span> <span class="main">=</span> <span class="bound">x</span><span class="main">)</span> <span class="main">&amp;</span> <span class="main">(</span><span class="main">(</span>radicals <span class="bound">ex</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span>radicals <span class="free">e</span><span class="main">)</span><span class="main">)</span> <span class="main">&amp;</span> <span class="main">(</span><span class="skolem">r</span> <span class="main">∉</span> <span class="main">(</span>radicals <span class="bound">ex</span><span class="main">)</span><span class="main">)</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> NatsE<span class="main">:</span> <span class="quoted"><span class="quoted">"Nats <span class="main">⊆</span> <span class="var">?E</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> Nats_cases <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted">"Const <span class="main">(</span>rat_of_nat <span class="skolem">n</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">for</span></span></span></span> <span class="skolem">n</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> negE<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="main">∈</span> <span class="var">?E</span><span class="main">.</span> <span class="main">-</span><span class="bound">x</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> hypsruv <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted">"Negation <span class="skolem">ex</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">for</span></span></span></span> <span class="skolem">ex</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> invE<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="main">∈</span> <span class="var">?E</span><span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">--&gt;</span> <span class="main">1</span><span class="main">/</span><span class="bound">x</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> hypsruv <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted">"Inverse <span class="skolem">ex</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">for</span></span></span></span> <span class="skolem">ex</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> addE<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="main">∈</span> <span class="var">?E</span><span class="main">.</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">∈</span> <span class="var">?E</span><span class="main">.</span> <span class="bound">x</span><span class="main">+</span><span class="bound">y</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> hypsruv <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted">"Addition <span class="skolem">ex1</span> <span class="skolem">ex2</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">for</span></span></span></span> <span class="skolem">ex1</span> <span class="skolem">ex2</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> multE<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="main">∈</span> <span class="var">?E</span><span class="main">.</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">∈</span> <span class="var">?E</span><span class="main">.</span> <span class="bound">x</span><span class="main">*</span><span class="bound">y</span> <span class="main">∈</span> <span class="var">?E</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> hypsruv <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted">"Multiplication <span class="skolem">ex1</span> <span class="skolem">ex2</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">for</span></span></span></span> <span class="skolem">ex1</span> <span class="skolem">ex2</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ra</span></span> <span class="skolem"><span class="skolem">rb</span></span> <span class="skolem"><span class="skolem">rc</span></span>
    <span class="keyword2"><span class="keyword">where</span></span> hypsra<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> of_rat <span class="skolem">ra</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> hypsrb<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">=</span> of_rat <span class="skolem">rb</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> hypsrc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">=</span> of_rat <span class="skolem">rc</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> Rats_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Rats_cases a b c<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="var">?E</span> <span class="main">&amp;</span> <span class="free">b</span> <span class="main">∈</span> <span class="var">?E</span> <span class="main">&amp;</span> <span class="free">c</span> <span class="main">∈</span> <span class="var">?E</span> <span class="main">&amp;</span> <span class="main">⦃</span><span class="skolem">u</span><span class="main">⦄</span> <span class="main">∈</span> <span class="var">?E</span> <span class="main">&amp;</span> <span class="main">⦃</span><span class="skolem">v</span><span class="main">⦄</span> <span class="main">∈</span> <span class="var">?E</span> <span class="main">&amp;</span> <span class="main">⦃</span><span class="skolem">r</span><span class="main">⦄</span> <span class="main">∈</span> <span class="var">?E</span> <span class="main">&amp;</span> <span class="main">⦃</span><span class="skolem">r</span><span class="main">⦄</span> <span class="main">≥</span> <span class="main">0</span> <span class="main">&amp;</span> <span class="main">⦃</span><span class="free">e</span><span class="main">⦄</span> <span class="main">=</span> <span class="main">⦃</span><span class="skolem">u</span><span class="main">⦄</span> <span class="main">+</span> <span class="main">⦃</span><span class="skolem">v</span><span class="main">⦄</span> <span class="main">*</span> sqrt <span class="main">⦃</span><span class="skolem">r</span><span class="main">⦄</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> a b c notEmpty hypsruv hypsra hypsrb hypsrc
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted">"Const <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">for</span></span></span></span> <span class="skolem">x</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> eq0 hypsruv NatsE negE invE addE multE
      cubic_root_radical_sqrt_steplemma_sqrt <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="var">?E</span>"</span></span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">b</span></span> <span class="quoted"><span class="free">c</span></span><span class="quoted"><span class="quoted">"<span class="main">⦃</span><span class="free">e</span><span class="main">⦄</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">⦃</span><span class="skolem">u</span><span class="main">⦄</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">⦃</span><span class="skolem">v</span><span class="main">⦄</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">⦃</span><span class="skolem">r</span><span class="main">⦄</span>"</span></span><span class="main">]</span>
   <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">w</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">∈</span> <span class="var">?E</span> <span class="main">&amp;</span> <span class="main">(</span><span class="skolem">w</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="skolem">w</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="skolem">w</span> <span class="main">+</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
     <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">e2</span></span>
     <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">⦃</span><span class="skolem">e2</span><span class="main">⦄</span> <span class="main">=</span> <span class="skolem">w</span>"</span></span> <span class="quoted"><span class="quoted">"radicals <span class="skolem">e2</span> <span class="main">⊆</span> radicals <span class="free">e</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∉</span> radicals <span class="skolem">e2</span>"</span></span>
           <span class="quoted"><span class="quoted">"<span class="main">⦃</span><span class="skolem">e2</span><span class="main">⦄</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="main">⦃</span><span class="skolem">e2</span><span class="main">⦄</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="main">⦃</span><span class="skolem">e2</span><span class="main">⦄</span> <span class="main">+</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
     <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">with</span></span> hypsruv <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> subset_iff_psubset_eq<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Impossible_Geometry-cubic_root_radical_sqrt"><span class="command">lemma</span></span> cubic_root_radical_sqrt<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> abc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="main">ℚ</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> <span class="main">ℚ</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">∈</span> <span class="main">ℚ</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>radicals <span class="free">e</span><span class="main">)</span> <span class="main">=</span> <span class="free">n</span> <span class="main">⟹</span> <span class="main">⦃</span><span class="free">e</span><span class="main">⦄</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="main">⦃</span><span class="free">e</span><span class="main">⦄</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="main">⦃</span><span class="free">e</span><span class="main">⦄</span> <span class="main">+</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟹</span>
         <span class="main">∃</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">ℚ</span><span class="main">.</span> <span class="bound">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">+</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">n</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">e</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> less_induct<span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>less <span class="skolem">n</span><span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> n<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> less.prems radicals_empty_rational <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">e</span></span><span class="main">]</span> finite_radicals <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">e</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> card_eq_0_iff n<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>radicals <span class="skolem">e</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> less.prems <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"radicals <span class="skolem">e</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> card.empty<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">e1</span><span class="main">.</span> radicals <span class="bound">e1</span> <span class="main">⊂</span> radicals <span class="skolem">e</span> <span class="main">&amp;</span> <span class="main">(</span><span class="main">⦃</span><span class="bound">e1</span><span class="main">⦄</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="main">⦃</span><span class="bound">e1</span><span class="main">⦄</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="main">⦃</span><span class="bound">e1</span><span class="main">⦄</span> <span class="main">+</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> abc less.prems cubic_root_radical_sqrt_lemma <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">e</span>"</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">e1</span></span>
      <span class="keyword2"><span class="keyword">where</span></span> hypse1<span class="main">:</span> <span class="quoted"><span class="quoted">"radicals <span class="skolem">e1</span> <span class="main">⊂</span> radicals <span class="skolem">e</span> <span class="main">&amp;</span> <span class="main">(</span><span class="main">⦃</span><span class="skolem">e1</span><span class="main">⦄</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="main">⦃</span><span class="skolem">e1</span><span class="main">⦄</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="main">⦃</span><span class="skolem">e1</span><span class="main">⦄</span> <span class="main">+</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>radicals <span class="skolem">e1</span><span class="main">)</span> <span class="main">&lt;</span> card <span class="main">(</span>radicals <span class="skolem">e</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> finite_radicals psubset_card_mono<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>radicals <span class="skolem">e1</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">n</span> <span class="main">&amp;</span> <span class="free">a</span> <span class="main">:</span> Rats <span class="main">&amp;</span> <span class="free">b</span> <span class="main">:</span> Rats <span class="main">&amp;</span> <span class="free">c</span> <span class="main">:</span> Rats <span class="main">&amp;</span> <span class="main">⦃</span><span class="skolem">e1</span><span class="main">⦄</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="main">⦃</span><span class="skolem">e1</span><span class="main">⦄</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="main">⦃</span><span class="skolem">e1</span><span class="main">⦄</span> <span class="main">+</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> hypse1 less.prems abc
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> less.hyps <span class="main">[</span><span class="operator">of</span> <span class="main">_</span> <span class="quoted"><span class="skolem">e1</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Now we can prove the final result about the properties of the
roots of a cubic equation.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> cubic_root_radical_sqrt_rational<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="main">ℚ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> <span class="main">ℚ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">∈</span> <span class="main">ℚ</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> radical_sqrt"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> x_eqn<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="free">x</span> <span class="main">+</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">x</span> <span class="main">∈</span> <span class="main">ℚ</span><span class="main">.</span> <span class="bound">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">+</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
   <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">e</span></span> <span class="skolem"><span class="skolem">n</span></span>
    <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">⦃</span><span class="skolem">e</span><span class="main">⦄</span> <span class="main">=</span> <span class="free">x</span> <span class="main">&amp;</span> <span class="main">(</span><span class="main">⦃</span><span class="skolem">e</span><span class="main">⦄</span><span class="main">^</span> <span class="numeral">3</span> <span class="main">+</span> <span class="free">a</span> <span class="main">*</span> <span class="main">⦃</span><span class="skolem">e</span><span class="main">⦄</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">b</span> <span class="main">*</span> <span class="main">⦃</span><span class="skolem">e</span><span class="main">⦄</span> <span class="main">+</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> card <span class="main">(</span>radicals <span class="skolem">e</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> x x_eqn radical_sqrt_correct_expr <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> cubic_root_radical_sqrt <span class="main">[</span><span class="operator">OF</span> a b c<span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Important properties of radicals›</span></span>

<span class="keyword1" id="Impossible_Geometry-sqrt_roots"><span class="command">lemma</span></span> sqrt_roots<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">y</span><span class="main">^</span><span class="numeral">2</span><span class="main">=</span><span class="free">x</span> <span class="main">⟹</span> <span class="free">x</span><span class="main">≥</span><span class="main">0</span> <span class="main">&amp;</span> <span class="main">(</span>sqrt <span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">y</span> <span class="main">|</span> sqrt <span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">-</span><span class="free">y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power_def<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> abs_of_nonneg abs_of_nonpos real_sqrt_abs2 zero_le_mult_iff zero_le_square<span class="main">)</span>

<span class="keyword1" id="Impossible_Geometry-radical_sqrt_linear_equation"><span class="command">lemma</span></span> radical_sqrt_linear_equation<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> radical_sqrt"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> radical_sqrt"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> abNotNull<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">a</span> <span class="main">=</span> <span class="main">0</span> <span class="main">&amp;</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> eq0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">*</span> <span class="free">x</span> <span class="main">+</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> radical_sqrt"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="main">0</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> True
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> abNotNull eq0
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">hence</span></span> l0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="main">-</span> <span class="free">b</span> <span class="main">/</span><span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> eq0 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> a b radical_sqrt.simps l0
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> radical_sqrt_rule_division<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1" id="Impossible_Geometry-radical_sqrt_simultaneous_linear_equation"><span class="command">lemma</span></span> radical_sqrt_simultaneous_linear_equation<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> radical_sqrt"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> radical_sqrt"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">∈</span> radical_sqrt"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> d<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">∈</span> radical_sqrt"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> e<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">∈</span> radical_sqrt"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> radical_sqrt"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> NotNull<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">a</span><span class="main">*</span><span class="free">e</span> <span class="main">-</span> <span class="free">b</span><span class="main">*</span><span class="free">d</span> <span class="main">=</span><span class="main">0</span> <span class="main">&amp;</span> <span class="free">a</span><span class="main">*</span><span class="free">f</span> <span class="main">-</span> <span class="free">c</span><span class="main">*</span><span class="free">d</span> <span class="main">=</span> <span class="main">0</span> <span class="main">&amp;</span> <span class="free">e</span><span class="main">*</span><span class="free">c</span> <span class="main">=</span> <span class="free">b</span><span class="main">*</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> eq0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="free">b</span><span class="main">*</span><span class="free">y</span> <span class="main">=</span> <span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> eq1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="free">e</span><span class="main">*</span><span class="free">y</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> radical_sqrt <span class="main">&amp;</span> <span class="free">y</span> <span class="main">∈</span> radical_sqrt"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">*</span><span class="free">e</span> <span class="main">-</span> <span class="free">b</span><span class="main">*</span><span class="free">d</span> <span class="main">=</span><span class="main">0</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main">*</span><span class="free">e</span><span class="main">-</span><span class="free">b</span><span class="main">*</span><span class="free">d</span><span class="main">)</span> <span class="main">*</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">e</span><span class="main">*</span><span class="free">c</span><span class="main">-</span><span class="free">b</span><span class="main">*</span><span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eq0 eq1
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">algebra</span>
  <span class="keyword1"><span class="command">hence</span></span> x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">e</span><span class="main">*</span><span class="free">c</span><span class="main">-</span><span class="free">b</span><span class="main">*</span><span class="free">f</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="free">a</span><span class="main">*</span><span class="free">e</span><span class="main">-</span><span class="free">b</span><span class="main">*</span><span class="free">d</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> False <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main">*</span><span class="free">e</span><span class="main">-</span><span class="free">b</span><span class="main">*</span><span class="free">d</span><span class="main">)</span> <span class="main">*</span> <span class="free">y</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span><span class="main">*</span><span class="free">f</span> <span class="main">-</span> <span class="free">d</span><span class="main">*</span><span class="free">c</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eq0 eq1
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">algebra</span>
  <span class="keyword1"><span class="command">hence</span></span> y<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span><span class="main">*</span><span class="free">f</span><span class="main">-</span><span class="free">d</span><span class="main">*</span><span class="free">c</span><span class="main">)</span><span class="main">/</span><span class="main">(</span><span class="free">a</span><span class="main">*</span><span class="free">e</span><span class="main">-</span><span class="free">b</span><span class="main">*</span><span class="free">d</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> False <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> ae_rad<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main">*</span><span class="free">e</span> <span class="main">-</span><span class="free">b</span><span class="main">*</span><span class="free">d</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> a e b d radical_sqrt.simps
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span> radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">e</span><span class="main">*</span><span class="free">c</span><span class="main">-</span><span class="free">b</span><span class="main">*</span><span class="free">f</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="free">a</span><span class="main">*</span><span class="free">e</span><span class="main">-</span><span class="free">b</span><span class="main">*</span><span class="free">d</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">a</span><span class="main">*</span><span class="free">f</span><span class="main">-</span><span class="free">d</span><span class="main">*</span><span class="free">c</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="free">a</span><span class="main">*</span><span class="free">e</span><span class="main">-</span><span class="free">b</span><span class="main">*</span><span class="free">d</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> False a b c d e f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span> radical_sqrt_rule_division radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> x y<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> True
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main">*</span><span class="free">e</span><span class="main">-</span><span class="free">b</span><span class="main">*</span><span class="free">d</span><span class="main">)</span> <span class="main">*</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">e</span><span class="main">*</span><span class="free">c</span><span class="main">-</span><span class="free">b</span><span class="main">*</span><span class="free">f</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main">*</span><span class="free">e</span><span class="main">-</span><span class="free">b</span><span class="main">*</span><span class="free">d</span><span class="main">)</span> <span class="main">*</span> <span class="free">y</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span><span class="main">*</span><span class="free">f</span> <span class="main">-</span> <span class="free">d</span><span class="main">*</span><span class="free">c</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eq0 eq1
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">algebra</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> NotNull True
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1" id="Impossible_Geometry-radical_sqrt_quadratic_equation"><span class="command">lemma</span></span> radical_sqrt_quadratic_equation<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> eq0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">*</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span><span class="main">+</span><span class="free">b</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="free">c</span> <span class="main">=</span><span class="main">0</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> NotNull<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">a</span> <span class="main">=</span> <span class="main">0</span> <span class="main">&amp;</span> <span class="free">b</span> <span class="main">=</span> <span class="main">0</span> <span class="main">&amp;</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> radical_sqrt"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="main">0</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> True
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">b</span> <span class="main">=</span> <span class="main">0</span> <span class="main">&amp;</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> True NotNull<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> b c radical_sqrt_linear_equation <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">b</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> True add_0 eq0 mult_zero_left<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="free">b</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">=</span> <span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="main">(</span><span class="main">-</span> <span class="free">c</span><span class="main">)</span><span class="main">+</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eq0
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">algebra</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">c</span><span class="main">)</span><span class="main">≥</span><span class="main">0</span> <span class="main">&amp;</span> <span class="main">(</span>sqrt <span class="main">(</span><span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">c</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="free">b</span><span class="main">)</span> <span class="main">|</span> sqrt <span class="main">(</span><span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">c</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">-</span><span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="free">b</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> sqrt_roots <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="free">b</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">c</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> l12<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">c</span> <span class="main">≥</span> <span class="main">0</span> <span class="main">&amp;</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="free">b</span> <span class="main">+</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">c</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span> <span class="main">|</span>
                                 <span class="main">(</span><span class="main">-</span><span class="free">b</span> <span class="main">-</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">c</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> False
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">c</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> a c radical_sqrt.simps
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Rats_number_of radical_sqrt.intros<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">c</span> <span class="main">∈</span> radical_sqrt"</span></span> <span class="keyword1"><span class="command">using</span></span> a b c
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> power2_eq_square radical_sqrt.intros<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span> radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> l22<span class="main">:</span> <span class="quoted"><span class="quoted">"sqrt <span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">c</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> l12
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>6<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> l23<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span><span class="free">b</span> <span class="main">+</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">c</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> b a False
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> radical_sqrt_rule_division radical_sqrt_rule_subtraction double_zero_sym mult_2_right mult_2_right radical_sqrt.intros<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span><span class="free">b</span> <span class="main">-</span> sqrt <span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">4</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">c</span><span class="main">)</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> a b False l22
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> div_by_0 mult_2 radical_sqrt.intros<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> radical_sqrt_rule_division radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> l12 l23<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1" id="Impossible_Geometry-radical_sqrt_simultaneous_linear_quadratic"><span class="command">lemma</span></span> radical_sqrt_simultaneous_linear_quadratic<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> d<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> e<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> NotNull<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="free">d</span><span class="main">=</span><span class="main">0</span> <span class="main">&amp;</span> <span class="free">e</span><span class="main">=</span><span class="main">0</span> <span class="main">&amp;</span> <span class="free">f</span><span class="main">=</span><span class="main">0</span><span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> eq0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span><span class="main">-</span><span class="free">a</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="free">y</span><span class="main">-</span><span class="free">b</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">=</span> <span class="free">c</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> eq1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="main">*</span><span class="free">x</span><span class="main">+</span><span class="free">e</span><span class="main">*</span><span class="free">y</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> radical_sqrt <span class="main">&amp;</span> <span class="free">y</span> <span class="main">∈</span> radical_sqrt"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="main">=</span><span class="main">0</span> <span class="main">&amp;</span> <span class="free">e</span><span class="main">=</span><span class="main">0</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> True
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add_0 eq1 mult_zero_left NotNull<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">hence</span></span> l10<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">d</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">*</span> <span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">e</span><span class="main">*</span><span class="free">b</span><span class="main">*</span><span class="free">d</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">d</span><span class="main">*</span><span class="free">f</span><span class="main">)</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="main">(</span><span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">f</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span> <span class="free">e</span> <span class="main">*</span><span class="free">b</span><span class="main">*</span> <span class="free">f</span> <span class="main">+</span> <span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span><span class="free">c</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> eq0 eq1
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">algebra</span>
  <span class="keyword1"><span class="command">have</span></span> l12<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span><span class="free">d</span><span class="main">^</span><span class="numeral">2</span> <span class="main">=</span> <span class="main">0</span> <span class="main">&amp;</span> <span class="numeral">2</span><span class="main">*</span><span class="free">e</span><span class="main">*</span><span class="free">b</span><span class="main">*</span><span class="free">d</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">d</span><span class="main">*</span><span class="free">f</span> <span class="main">=</span> <span class="main">0</span> <span class="main">&amp;</span> <span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">f</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span> <span class="free">e</span> <span class="main">*</span><span class="free">b</span><span class="main">*</span> <span class="free">f</span> <span class="main">+</span> <span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span><span class="free">c</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> False power_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> l13<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span><span class="free">d</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> e d
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> power2_eq_square radical_sqrt.intros<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> radical_sqrt.intros<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> sl1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">e</span><span class="main">*</span><span class="free">b</span><span class="main">*</span><span class="free">d</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> e b d
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>lifting<span class="main"><span class="main">)</span></span> mult_2 radical_sqrt.intros<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> sl2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">e</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span> <span class="keyword1"><span class="command">using</span></span> radical_sqrt.intros
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> mult_2 power2_eq_square a e<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">d</span><span class="main">*</span><span class="free">f</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span> <span class="keyword1"><span class="command">using</span></span> radical_sqrt.intros
    <span class="keyword1"><span class="command">using</span></span> d f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> radical_sqrt.intros <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power2_eq_square<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> sl4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">e</span><span class="main">*</span><span class="free">b</span><span class="main">*</span><span class="free">d</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">e</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">d</span><span class="main">*</span><span class="free">f</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> sl1 sl2
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> sl5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span><span class="main">*</span><span class="free">e</span><span class="main">*</span><span class="free">b</span><span class="main">*</span><span class="free">d</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">d</span><span class="main">*</span><span class="free">f</span> <span class="main">=</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">e</span><span class="main">*</span><span class="free">b</span><span class="main">*</span><span class="free">d</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">e</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">d</span><span class="main">*</span><span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> l14<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">e</span><span class="main">*</span><span class="free">b</span><span class="main">*</span><span class="free">d</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">d</span><span class="main">*</span><span class="free">f</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> sl4
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">have</span></span> sl6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> a e <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> radical_sqrt.intros <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power2_eq_square<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> sl7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> radical_sqrt.intros <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power2_eq_square<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> sl8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span><span class="free">b</span><span class="main">*</span> <span class="free">f</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> e b f 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> radical_sqrt.intros <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power2_eq_square<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> sl9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> b e <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> radical_sqrt.intros <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power2_eq_square<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> sl10<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span> <span class="free">c</span><span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> c e <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> radical_sqrt.intros <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power2_eq_square<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> sl6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">f</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="main">-</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span><span class="free">b</span><span class="main">*</span> <span class="free">f</span><span class="main">)</span> <span class="main">+</span> <span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="main">-</span> <span class="free">c</span><span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> a e f b c sl6 sl7 sl8 sl9 sl10
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>hide_lams<span class="main"><span class="main">,</span></span> no_types<span class="main"><span class="main">)</span></span> power2_eq_square radical_sqrt.intros<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">f</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span> <span class="free">e</span> <span class="main">*</span><span class="free">b</span><span class="main">*</span> <span class="free">f</span> <span class="main">+</span> <span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span><span class="free">c</span> <span class="main">=</span> <span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">f</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="main">-</span> <span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span> <span class="main">*</span><span class="free">b</span><span class="main">*</span> <span class="free">f</span><span class="main">)</span> <span class="main">+</span> <span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="main">-</span> <span class="free">c</span><span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">f</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span> <span class="free">e</span> <span class="main">*</span><span class="free">b</span><span class="main">*</span> <span class="free">f</span> <span class="main">+</span> <span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span><span class="free">c</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> sl6
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">hence</span></span> x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> radical_sqrt_quadratic_equation <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span><span class="free">d</span><span class="main">^</span><span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span><span class="main">*</span><span class="free">e</span><span class="main">*</span><span class="free">b</span><span class="main">*</span><span class="free">d</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">d</span><span class="main">*</span><span class="free">f</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">f</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span> <span class="free">e</span> <span class="main">*</span><span class="free">b</span><span class="main">*</span> <span class="free">f</span> <span class="main">+</span> <span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span><span class="free">c</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span>"</span></span><span class="main">]</span> l13 l14 l12 l10
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> l18<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">e</span><span class="main">*</span><span class="free">y</span> <span class="main">+</span> <span class="main">(</span><span class="free">d</span><span class="main">*</span><span class="free">x</span> <span class="main">-</span> <span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> eq1
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> y<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> e d f x False
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">=</span> <span class="main">0</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">hence</span></span> l22<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">*</span> <span class="free">y</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="main">-</span> <span class="numeral">2</span><span class="main">*</span> <span class="free">b</span><span class="main">)</span> <span class="main">*</span> <span class="free">y</span> <span class="main">+</span> <span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span> <span class="main">=</span><span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> eq0
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">algebra</span>
    <span class="keyword1"><span class="command">have</span></span> l24<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Rats_1 radical_sqrt.intros<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> l25<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span> <span class="numeral">2</span><span class="main">*</span> <span class="free">b</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword1"><span class="command">using</span></span> b
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> minus_mult_commute mult_2 radical_sqrt.intros<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> l26<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword1"><span class="command">using</span></span> a b c x
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> radical_sqrt.intros radical_sqrt_rule_subtraction <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power2_eq_square<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> radical_sqrt_quadratic_equation <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">::</span>real"</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="numeral">2</span><span class="main">*</span> <span class="free">b</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">c</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span>"</span></span><span class="main">]</span> l22 l24 l25 l26
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword1"><span class="command">hence</span></span> l29<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">e</span><span class="main">=</span><span class="main">0</span> <span class="main">&amp;</span> <span class="free">d</span><span class="main">*</span><span class="free">x</span><span class="main">-</span><span class="free">f</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">d</span><span class="main">*</span><span class="free">x</span> <span class="main">-</span> <span class="free">f</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword1"><span class="command">using</span></span> d f x
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span> radical_sqrt_rule_subtraction<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> radical_sqrt_linear_equation <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">e</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="main">*</span><span class="free">x</span> <span class="main">-</span> <span class="free">f</span>"</span></span> <span class="quoted"><span class="free">y</span></span><span class="main">]</span> e d f l18 l29
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> x y<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Impossible_Geometry-radical_sqrt_simultaneous_quadratic_quadratic"><span class="command">lemma</span></span> radical_sqrt_simultaneous_quadratic_quadratic<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> d<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> e<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> f<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> NotEqual<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">a</span> <span class="main">=</span> <span class="free">d</span> <span class="main">&amp;</span> <span class="free">b</span> <span class="main">=</span> <span class="free">e</span> <span class="main">&amp;</span> <span class="free">c</span> <span class="main">=</span> <span class="free">f</span><span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> eq0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="free">y</span> <span class="main">-</span> <span class="free">b</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">=</span> <span class="free">c</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> eq1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="free">d</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span><span class="free">y</span> <span class="main">-</span> <span class="free">e</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> radical_sqrt <span class="main">&amp;</span> <span class="free">y</span> <span class="main">∈</span> radical_sqrt"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">y</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">y</span><span class="main">*</span><span class="free">b</span> <span class="main">+</span> <span class="free">b</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="free">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">d</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="free">d</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">y</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">y</span><span class="main">*</span><span class="free">e</span> <span class="main">+</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">c</span> <span class="main">-</span> <span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> eq0 eq1
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span> power_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> l4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">d</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">)</span><span class="main">*</span><span class="free">x</span> <span class="main">+</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">e</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">b</span><span class="main">)</span><span class="main">*</span><span class="free">y</span> <span class="main">+</span><span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">d</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="free">f</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">algebra</span>
  <span class="keyword1"><span class="command">hence</span></span> l6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">d</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="main">&amp;</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">e</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">b</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="main">&amp;</span> <span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">d</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">f</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> NotEqual
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">algebra</span>
  <span class="keyword1"><span class="command">have</span></span> l7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">d</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> a d mult_2 radical_sqrt.intros<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> l8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">e</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">b</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> b e mult_2 radical_sqrt.intros<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> be_rad<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> b e power2_eq_square radical_sqrt.intros<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span> radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> ad_rad<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">d</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> a d power2_eq_square radical_sqrt.intros<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span> radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> f c
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="main">(</span><span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">d</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">f</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> radical_sqrt.intros
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> be_rad ad_rad<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> radical_sqrt_simultaneous_linear_quadratic <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">d</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">a</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">e</span> <span class="main">-</span> <span class="numeral">2</span><span class="main">*</span><span class="free">b</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="main">(</span><span class="main">(</span><span class="free">b</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">e</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="free">d</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span><span class="free">f</span> <span class="main">-</span> <span class="free">c</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span>"</span></span><span class="main">]</span> l7 l8 l6 l4 a b c d e f NotEqual eq0 eq1
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Important properties of geometrical points which coordinates are radicals›</span></span>

<span class="keyword1" id="Impossible_Geometry-radical_sqrt_line_line_intersection"><span class="command">lemma</span></span> radical_sqrt_line_line_intersection<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> absA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> ordA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">A</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> absB<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> ordB<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> absC<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">C</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> ordC<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">C</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> absD<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">D</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> ordD<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">D</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> notParallel<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>parallel <span class="free">A</span> <span class="free">B</span> <span class="free">C</span> <span class="free">D</span><span class="main">)</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> isIntersec<span class="main">:</span> <span class="quoted"><span class="quoted">"is_intersection <span class="free">X</span> <span class="free">A</span> <span class="free">B</span> <span class="free">C</span> <span class="free">D</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">X</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt <span class="main">&amp;</span> <span class="main">(</span>ordinate <span class="free">X</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> l2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">A</span> <span class="main">-</span> abscissa <span class="free">X</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>ordinate <span class="free">A</span> <span class="main">-</span> ordinate <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>ordinate <span class="free">A</span> <span class="main">-</span> ordinate <span class="free">X</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>abscissa <span class="free">A</span> <span class="main">-</span> abscissa <span class="free">B</span><span class="main">)</span> <span class="main">&amp;</span> <span class="main">(</span>abscissa <span class="free">C</span> <span class="main">-</span> abscissa <span class="free">X</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>ordinate <span class="free">C</span> <span class="main">-</span> ordinate <span class="free">D</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>ordinate <span class="free">C</span> <span class="main">-</span> ordinate <span class="free">X</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>abscissa <span class="free">C</span> <span class="main">-</span> abscissa <span class="free">D</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> isIntersec is_intersection_def collinear_def parallel_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> l4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span> <span class="main">(</span>ordinate <span class="free">A</span> <span class="main">-</span> ordinate <span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> abscissa <span class="free">X</span> <span class="main">+</span> <span class="main">(</span>abscissa <span class="free">A</span> <span class="main">-</span> abscissa <span class="free">B</span><span class="main">)</span> <span class="main">*</span> ordinate <span class="free">X</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span> abscissa <span class="free">A</span> <span class="main">*</span> <span class="main">(</span>ordinate <span class="free">A</span> <span class="main">-</span> ordinate <span class="free">B</span><span class="main">)</span> <span class="main">+</span> ordinate <span class="free">A</span> <span class="main">*</span> <span class="main">(</span>abscissa <span class="free">A</span> <span class="main">-</span> abscissa <span class="free">B</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> l6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span> <span class="main">(</span>ordinate <span class="free">C</span> <span class="main">-</span> ordinate <span class="free">D</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> abscissa <span class="free">X</span> <span class="main">+</span> <span class="main">(</span>abscissa <span class="free">C</span> <span class="main">-</span> abscissa <span class="free">D</span><span class="main">)</span> <span class="main">*</span> ordinate <span class="free">X</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span> abscissa <span class="free">C</span> <span class="main">*</span> <span class="main">(</span>ordinate <span class="free">C</span> <span class="main">-</span> ordinate <span class="free">D</span><span class="main">)</span> <span class="main">+</span> ordinate <span class="free">C</span> <span class="main">*</span> <span class="main">(</span>abscissa <span class="free">C</span> <span class="main">-</span> abscissa <span class="free">D</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> l2
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> sl1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span> <span class="main">(</span>ordinate <span class="free">A</span> <span class="main">-</span> ordinate <span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ordA ordB minus_diff_eq radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> sl2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">A</span> <span class="main">-</span> abscissa <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> absA absB radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> sl3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span> abscissa <span class="free">A</span> <span class="main">*</span> <span class="main">(</span>ordinate <span class="free">A</span> <span class="main">-</span> ordinate <span class="free">B</span><span class="main">)</span> <span class="main">+</span> ordinate <span class="free">A</span> <span class="main">*</span> <span class="main">(</span>abscissa <span class="free">A</span> <span class="main">-</span> abscissa <span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> absA ordA ordB absB
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> diff_conv_add_uminus radical_sqrt.intros<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> sl4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span> <span class="main">(</span>ordinate <span class="free">C</span> <span class="main">-</span> ordinate <span class="free">D</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ordC ordD minus_diff_eq radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> sl5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">C</span> <span class="main">-</span> abscissa <span class="free">D</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> absC absD radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> sl6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span> abscissa <span class="free">C</span> <span class="main">*</span> <span class="main">(</span>ordinate <span class="free">C</span> <span class="main">-</span> ordinate <span class="free">D</span><span class="main">)</span> <span class="main">+</span> ordinate <span class="free">C</span> <span class="main">*</span> <span class="main">(</span>abscissa <span class="free">C</span> <span class="main">-</span> abscissa <span class="free">D</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">using</span></span> absC ordC absD ordD
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> diff_conv_add_uminus radical_sqrt.intros<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span> <span class="main">(</span>ordinate <span class="free">A</span> <span class="main">-</span> ordinate <span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>abscissa <span class="free">C</span> <span class="main">-</span> abscissa <span class="free">D</span><span class="main">)</span> <span class="main">≠</span> <span class="main">(</span>abscissa <span class="free">A</span> <span class="main">-</span> abscissa <span class="free">B</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">-</span> <span class="main">(</span>ordinate <span class="free">C</span> <span class="main">-</span> ordinate <span class="free">D</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> notParallel parallel_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> radical_sqrt_simultaneous_linear_equation <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="main">(</span>ordinate <span class="free">A</span> <span class="main">-</span> ordinate <span class="free">B</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">A</span> <span class="main">-</span> abscissa <span class="free">B</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span> abscissa <span class="free">A</span> <span class="main">*</span> <span class="main">(</span>ordinate <span class="free">A</span> <span class="main">-</span> ordinate <span class="free">B</span><span class="main">)</span> <span class="main">+</span> ordinate <span class="free">A</span> <span class="main">*</span> <span class="main">(</span>abscissa <span class="free">A</span> <span class="main">-</span> abscissa <span class="free">B</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="main">(</span>ordinate <span class="free">C</span> <span class="main">-</span> ordinate <span class="free">D</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"abscissa <span class="free">C</span> <span class="main">-</span> abscissa <span class="free">D</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span> abscissa <span class="free">C</span> <span class="main">*</span> <span class="main">(</span>ordinate <span class="free">C</span> <span class="main">-</span> ordinate <span class="free">D</span><span class="main">)</span> <span class="main">+</span> ordinate <span class="free">C</span> <span class="main">*</span> <span class="main">(</span>abscissa <span class="free">C</span> <span class="main">-</span> abscissa <span class="free">D</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"abscissa <span class="free">X</span>"</span></span> <span class="quoted"><span class="quoted">"ordinate <span class="free">X</span>"</span></span><span class="main">]</span> absA ordA absB ordB absC ordC absD ordD l4 sl1 sl2 sl3 sl4 sl5 sl6 l6
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1" id="Impossible_Geometry-radical_sqrt_line_circle_intersection"><span class="command">lemma</span></span> radical_sqrt_line_circle_intersection<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> absA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">A</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ordA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">A</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> absB<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ordB<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> absC<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">C</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ordC<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">C</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> absD<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">D</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ordD<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">D</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> absE<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">E</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ordE<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">E</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> notEqual<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="free">B</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> colin<span class="main">:</span> <span class="quoted"><span class="quoted">"collinear <span class="free">A</span> <span class="free">X</span> <span class="free">B</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> eqDist<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>distance <span class="free">C</span> <span class="free">X</span> <span class="main">=</span> distance <span class="free">D</span> <span class="free">E</span><span class="main">)</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">X</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt <span class="main">&amp;</span> <span class="main">(</span>ordinate <span class="free">X</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> l3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span> <span class="main">(</span>ordinate <span class="free">A</span> <span class="main">-</span> ordinate <span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> abscissa <span class="free">X</span> <span class="main">+</span> <span class="main">(</span>abscissa <span class="free">A</span> <span class="main">-</span> abscissa <span class="free">B</span><span class="main">)</span> <span class="main">*</span> ordinate <span class="free">X</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span> abscissa <span class="free">A</span> <span class="main">*</span> <span class="main">(</span>ordinate <span class="free">A</span> <span class="main">-</span> ordinate <span class="free">B</span><span class="main">)</span> <span class="main">+</span> ordinate <span class="free">A</span> <span class="main">*</span> <span class="main">(</span>abscissa <span class="free">A</span> <span class="main">-</span> abscissa <span class="free">B</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> colin  <span class="keyword1"><span class="command">unfolding</span></span> collinear_def parallel_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">algebra</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="main">(</span><span class="main">(</span>abscissa <span class="free">X</span> <span class="main">-</span> abscissa <span class="free">C</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">X</span> <span class="main">-</span> ordinate <span class="free">C</span><span class="main">)</span> <span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">=</span> sqrt <span class="main">(</span><span class="main">(</span>abscissa <span class="free">D</span> <span class="main">-</span> abscissa <span class="free">E</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">D</span> <span class="main">-</span> ordinate <span class="free">E</span><span class="main">)</span> <span class="main">^</span><span class="numeral">2</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> eqDist distance_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">)</span></span> minus_diff_eq point_abscissa_diff point_dist_def point_ordinate_diff power2_minus<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> l6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">X</span> <span class="main">-</span> abscissa <span class="free">C</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">X</span> <span class="main">-</span> ordinate <span class="free">C</span><span class="main">)</span> <span class="main">^</span><span class="numeral">2</span> <span class="main">=</span> <span class="main">(</span>abscissa <span class="free">D</span> <span class="main">-</span> abscissa <span class="free">E</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">D</span> <span class="main">-</span> ordinate <span class="free">E</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> l8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">-</span> <span class="main">(</span>ordinate <span class="free">A</span> <span class="main">-</span> ordinate <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="main">&amp;</span> <span class="main">(</span>abscissa <span class="free">A</span> <span class="main">-</span> abscissa <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="main">&amp;</span> <span class="main">(</span><span class="main">-</span> abscissa <span class="free">A</span> <span class="main">*</span> <span class="main">(</span>ordinate <span class="free">A</span> <span class="main">-</span> ordinate <span class="free">B</span><span class="main">)</span> <span class="main">+</span> ordinate <span class="free">A</span> <span class="main">*</span> <span class="main">(</span>abscissa <span class="free">A</span> <span class="main">-</span> abscissa <span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> notEqual  <span class="keyword1"><span class="command">unfolding</span></span> point_eq_iff
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> sl1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span> <span class="main">(</span>ordinate <span class="free">A</span> <span class="main">-</span> ordinate <span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ordA ordB minus_diff_eq radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> sl2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">A</span> <span class="main">-</span> abscissa <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> absA absB radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> sl3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span> abscissa <span class="free">A</span> <span class="main">*</span> <span class="main">(</span>ordinate <span class="free">A</span> <span class="main">-</span> ordinate <span class="free">B</span><span class="main">)</span> <span class="main">+</span> ordinate <span class="free">A</span> <span class="main">*</span> <span class="main">(</span>abscissa <span class="free">A</span> <span class="main">-</span> abscissa <span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> absA ordA absB ordB diff_conv_add_uminus radical_sqrt.intros<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">D</span> <span class="main">-</span> abscissa <span class="free">E</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">D</span> <span class="main">-</span> ordinate <span class="free">E</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> power2_eq_square
             absD absE ordD ordE radical_sqrt_rule_subtraction radical_sqrt.intros<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> <span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> radical_sqrt_simultaneous_linear_quadratic
            <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"abscissa <span class="free">C</span>"</span></span> <span class="quoted"><span class="quoted">"ordinate <span class="free">C</span>"</span></span>
                <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">D</span> <span class="main">-</span> abscissa <span class="free">E</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">D</span> <span class="main">-</span> ordinate <span class="free">E</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span>"</span></span>
                <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="main">(</span>ordinate <span class="free">A</span> <span class="main">-</span> ordinate <span class="free">B</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"abscissa <span class="free">A</span> <span class="main">-</span> abscissa <span class="free">B</span>"</span></span>
                <span class="quoted"><span class="quoted">"<span class="main">-</span> abscissa <span class="free">A</span> <span class="main">*</span> <span class="main">(</span>ordinate <span class="free">A</span> <span class="main">-</span> ordinate <span class="free">B</span><span class="main">)</span> <span class="main">+</span> ordinate <span class="free">A</span> <span class="main">*</span> <span class="main">(</span>abscissa <span class="free">A</span> <span class="main">-</span> abscissa <span class="free">B</span><span class="main">)</span>"</span></span>
                <span class="quoted"><span class="quoted">"abscissa <span class="free">X</span>"</span></span> <span class="quoted"><span class="quoted">"ordinate <span class="free">X</span>"</span></span><span class="main">]</span>
       l3 absC ordC sl1 sl2 sl3 l6 l8
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1" id="Impossible_Geometry-radical_sqrt_circle_circle_intersection"><span class="command">lemma</span></span> radical_sqrt_circle_circle_intersection<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> absA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">A</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ordA<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">A</span><span class="main">)</span>  <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> absB<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ordB<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">B</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> absC<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">C</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ordC<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">C</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> absD<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">D</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ordD<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">D</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> absE<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">E</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ordE<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">E</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> absF<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">F</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ordF<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">F</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> eqDist0<span class="main">:</span> <span class="quoted"><span class="quoted">"distance <span class="free">A</span> <span class="free">X</span> <span class="main">=</span> distance <span class="free">B</span> <span class="free">C</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> eqDist1<span class="main">:</span> <span class="quoted"><span class="quoted">"distance <span class="free">D</span> <span class="free">X</span> <span class="main">=</span> distance <span class="free">E</span> <span class="free">F</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> notEqual<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">A</span> <span class="main">=</span> <span class="free">D</span> <span class="main">&amp;</span> distance <span class="free">B</span> <span class="free">C</span> <span class="main">=</span> distance <span class="free">E</span> <span class="free">F</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">X</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt <span class="main">&amp;</span> <span class="main">(</span>ordinate <span class="free">X</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="main">(</span><span class="main">(</span>abscissa <span class="free">X</span> <span class="main">-</span> abscissa <span class="free">A</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">X</span> <span class="main">-</span> ordinate <span class="free">A</span><span class="main">)</span> <span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">=</span> sqrt <span class="main">(</span><span class="main">(</span>abscissa <span class="free">B</span> <span class="main">-</span> abscissa <span class="free">C</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">B</span> <span class="main">-</span> ordinate <span class="free">C</span><span class="main">)</span> <span class="main">^</span><span class="numeral">2</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">)</span></span> eqDist0 distance_def minus_diff_eq point_abscissa_diff point_dist_def point_ordinate_diff power2_minus<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>sqrt <span class="main">(</span><span class="main">(</span>abscissa <span class="free">X</span> <span class="main">-</span> abscissa <span class="free">A</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">X</span> <span class="main">-</span> ordinate <span class="free">A</span><span class="main">)</span> <span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">=</span> <span class="main">(</span>sqrt <span class="main">(</span><span class="main">(</span>abscissa <span class="free">B</span> <span class="main">-</span> abscissa <span class="free">C</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">B</span> <span class="main">-</span> ordinate <span class="free">C</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span><span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> l3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">X</span> <span class="main">-</span> abscissa <span class="free">A</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">X</span> <span class="main">-</span> ordinate <span class="free">A</span><span class="main">)</span> <span class="main">^</span><span class="numeral">2</span> <span class="main">=</span> <span class="main">(</span>abscissa <span class="free">B</span> <span class="main">-</span> abscissa <span class="free">C</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">B</span> <span class="main">-</span> ordinate <span class="free">C</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"sqrt <span class="main">(</span><span class="main">(</span>abscissa <span class="free">X</span> <span class="main">-</span> abscissa <span class="free">D</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">X</span> <span class="main">-</span> ordinate <span class="free">D</span><span class="main">)</span> <span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">=</span> sqrt <span class="main">(</span><span class="main">(</span>abscissa <span class="free">E</span> <span class="main">-</span> abscissa <span class="free">F</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">E</span> <span class="main">-</span> ordinate <span class="free">F</span><span class="main">)</span> <span class="main">^</span><span class="numeral">2</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">)</span></span> eqDist1 distance_def minus_diff_eq point_abscissa_diff point_dist_def point_ordinate_diff power2_minus<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> l3bis<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">X</span> <span class="main">-</span> abscissa <span class="free">D</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">X</span> <span class="main">-</span> ordinate <span class="free">D</span><span class="main">)</span> <span class="main">^</span><span class="numeral">2</span> <span class="main">=</span> <span class="main">(</span>abscissa <span class="free">E</span> <span class="main">-</span> abscissa <span class="free">F</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">E</span> <span class="main">-</span> ordinate <span class="free">F</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> l4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>abscissa <span class="free">A</span> <span class="main">=</span> abscissa <span class="free">D</span> <span class="main">&amp;</span> ordinate <span class="free">A</span> <span class="main">=</span> ordinate <span class="free">D</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> point_eq_iff notEqual eqDist0 eqDist1<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">B</span> <span class="main">-</span> abscissa <span class="free">C</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> absB absC radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> sl1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>abscissa <span class="free">B</span> <span class="main">-</span> abscissa <span class="free">C</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> radical_sqrt.intros <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power2_eq_square<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">B</span> <span class="main">-</span> ordinate <span class="free">C</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ordB ordC radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">B</span> <span class="main">-</span> ordinate <span class="free">C</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> radical_sqrt.intros <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power2_eq_square<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> sl3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>abscissa <span class="free">B</span> <span class="main">-</span> abscissa <span class="free">C</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">B</span> <span class="main">-</span> ordinate <span class="free">C</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> sl1<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">E</span> <span class="main">-</span> abscissa <span class="free">F</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> absE absF radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> sl4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>abscissa <span class="free">E</span> <span class="main">-</span> abscissa <span class="free">F</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> radical_sqrt.intros <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power2_eq_square<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">E</span> <span class="main">-</span> ordinate <span class="free">F</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ordE ordF radical_sqrt_rule_subtraction<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>ordinate <span class="free">E</span> <span class="main">-</span> ordinate <span class="free">F</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> radical_sqrt.intros <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power2_eq_square<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>abscissa <span class="free">E</span> <span class="main">-</span> abscissa <span class="free">F</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">E</span> <span class="main">-</span> ordinate <span class="free">F</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> sl4<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> radical_sqrt_simultaneous_quadratic_quadratic
            <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"abscissa <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"ordinate <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">B</span> <span class="main">-</span> abscissa <span class="free">C</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">B</span> <span class="main">-</span> ordinate <span class="free">C</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span>"</span></span>
                <span class="quoted"><span class="quoted">"abscissa <span class="free">D</span>"</span></span> <span class="quoted"><span class="quoted">"ordinate <span class="free">D</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">E</span> <span class="main">-</span> abscissa <span class="free">F</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>ordinate <span class="free">E</span> <span class="main">-</span> ordinate <span class="free">F</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span>"</span></span>
                <span class="quoted"><span class="quoted">"abscissa <span class="free">X</span>"</span></span> <span class="quoted"><span class="quoted">"ordinate <span class="free">X</span>"</span></span><span class="main">]</span>
          absA ordA absD ordD l3 l3bis l4 sl3
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Definition of the set of contructible points›</span></span>

<span class="keyword1"><span class="command">inductive_set</span></span> <span class="entity">constructible</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"point set"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="main">∈</span> points <span class="main">∧</span> <span class="main">(</span>abscissa <span class="free"><span class="bound"><span class="entity">M</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="main">ℚ</span> <span class="main">∧</span> <span class="main">(</span>ordinate <span class="free"><span class="bound"><span class="entity">M</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="main">ℚ</span><span class="main">)</span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="main">∈</span> <span class="free">constructible</span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∈</span> <span class="free">constructible</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">∈</span> <span class="free">constructible</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">∈</span> <span class="free">constructible</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">D</span></span></span> <span class="main">∈</span> <span class="free">constructible</span> <span class="main">∧</span> <span class="main">¬</span> parallel <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">D</span></span></span> <span class="main">∧</span> is_intersection <span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">D</span></span></span><span class="main">)</span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="main">∈</span> <span class="free">constructible</span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∈</span> <span class="free">constructible</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">∈</span> <span class="free">constructible</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">∈</span> <span class="free">constructible</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">D</span></span></span> <span class="main">∈</span> <span class="free">constructible</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="main">∈</span> <span class="free">constructible</span> <span class="main">∧</span> <span class="main">¬</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">∧</span> collinear <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">∧</span> distance <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="main">=</span> distance <span class="free"><span class="bound"><span class="entity">D</span></span></span> <span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main">)</span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="main">∈</span> <span class="free">constructible</span>"</span></span><span class="main">|</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∈</span> <span class="free">constructible</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">∈</span> <span class="free">constructible</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">∈</span> <span class="free">constructible</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">D</span></span></span> <span class="main">∈</span> <span class="free">constructible</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="main">∈</span> <span class="free">constructible</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="main">∈</span> <span class="free">constructible</span> <span class="main">∧</span> <span class="main">¬</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">D</span></span></span> <span class="main">∧</span> distance <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">=</span> distance <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span> <span class="main">∧</span> distance <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="main">=</span> distance <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">∧</span> distance <span class="free"><span class="bound"><span class="entity">D</span></span></span> <span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="main">=</span> distance <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="main">∈</span> <span class="free">constructible</span>"</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹An important property about constructible points: their
coordinates are radicals›</span></span>

<span class="keyword1" id="Impossible_Geometry-constructible_radical_sqrt"><span class="command">lemma</span></span> constructible_radical_sqrt<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> h<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">∈</span> constructible"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>abscissa <span class="free">M</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt <span class="main">&amp;</span> <span class="main">(</span>ordinate <span class="free">M</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> constructible.induct<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> radical_sqrt_line_line_intersection<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> radical_sqrt_line_circle_intersection<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> radical_sqrt_circle_circle_intersection<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Proving the impossibility of duplicating the cube›</span></span>

<span class="keyword1" id="Impossible_Geometry-impossibility_of_doubling_the_cube_lemma"><span class="command">lemma</span></span> impossibility_of_doubling_the_cube_lemma<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> radical_sqrt"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> x_eqn<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted">False</span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">x</span> <span class="main">∈</span> Rats<span class="main">.</span> <span class="bound">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="main">0</span> <span class="main">*</span> <span class="bound">x</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="main">0</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">+</span> <span class="main">(</span><span class="main">-</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">0</span><span class="main">::</span>real<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> x x_eqn cubic_root_radical_sqrt_rational <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="numeral">2</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span><span class="main">::</span><span class="quoted">real</span> <span class="keyword2"><span class="keyword">where</span></span> hypsy<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">:</span> Rats <span class="main">&amp;</span> <span class="skolem">y</span><span class="main">^</span><span class="numeral">3</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> left_minus mult_zero_left add_0_right real_add_minus_iff<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> hypsr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> of_rat <span class="skolem">r</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> Rats_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Rats_cases hypsy<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃!</span> <span class="bound">p</span><span class="main">.</span> <span class="skolem">r</span> <span class="main">=</span> Fract <span class="main">(</span>fst <span class="bound">p</span><span class="main">)</span> <span class="main">(</span>snd <span class="bound">p</span><span class="main">)</span> <span class="main">&amp;</span> snd <span class="bound">p</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">&amp;</span> coprime <span class="main">(</span>fst <span class="bound">p</span><span class="main">)</span> <span class="main">(</span>snd <span class="bound">p</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> quotient_of_unique<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> hypsp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">=</span> Fract <span class="skolem">p</span> <span class="skolem">q</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"coprime <span class="skolem">p</span> <span class="skolem">q</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> l6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">^</span><span class="numeral">3</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>lifting<span class="main"><span class="main">)</span></span> hypsy hypsr of_rat_eq_iff of_rat_numeral_eq of_rat_power<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> l7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">^</span><span class="numeral">3</span>  <span class="main">=</span> Fract <span class="main">(</span><span class="skolem">p</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">(</span><span class="skolem">q</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> hypsp <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power3_eq_cube<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> l8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">^</span> <span class="numeral">3</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">&amp;</span> coprime <span class="main">(</span><span class="skolem">p</span> <span class="main">^</span> <span class="numeral">3</span><span class="main">)</span> <span class="main">(</span><span class="skolem">q</span> <span class="main">^</span> <span class="numeral">3</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> hypsp <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Fract <span class="main">(</span><span class="skolem">p</span> <span class="main">^</span> <span class="numeral">3</span><span class="main">)</span> <span class="main">(</span><span class="skolem">q</span> <span class="main">^</span> <span class="numeral">3</span><span class="main">)</span> <span class="main">=</span> <span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> l6 l7
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"Fract <span class="main">(</span><span class="skolem">p</span> <span class="main">^</span> <span class="numeral">3</span><span class="main">)</span> <span class="main">(</span><span class="skolem">q</span> <span class="main">^</span> <span class="numeral">3</span><span class="main">)</span> <span class="main">=</span> Fract <span class="numeral">2</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> rat_number_expand<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> l12<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">^</span> <span class="numeral">3</span> <span class="main">=</span> <span class="skolem">q</span> <span class="main">^</span> <span class="numeral">3</span> <span class="main">*</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> hypsp
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eq_rat<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"even <span class="main">(</span><span class="skolem">p</span> <span class="main">^</span> <span class="numeral">3</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> dvdI<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"even <span class="skolem">p</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">8</span> <span class="keyword1">dvd</span> <span class="skolem">p</span> <span class="main">^</span> <span class="numeral">3</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dvd_def power_def<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">8</span> <span class="keyword1">dvd</span> <span class="skolem">q</span> <span class="main">^</span> <span class="numeral">3</span> <span class="main">*</span> <span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> l12 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"even <span class="main">(</span><span class="skolem">q</span> <span class="main">^</span> <span class="numeral">3</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dvd_def<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"even <span class="skolem">q</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹even <span class="skolem">p</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span> <span class="keyword1">dvd</span> gcd <span class="skolem">p</span> <span class="skolem">q</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> gcd_greatest<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹coprime <span class="skolem">p</span> <span class="skolem">q</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">theorem</span></span> impossibility_of_doubling_the_cube<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">=</span> <span class="numeral">2</span> <span class="main">⟹</span> <span class="main">(</span>Point <span class="free">x</span> <span class="main">0</span><span class="main">)</span> <span class="main">∉</span> constructible"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> abscissa.simps constructible_radical_sqrt impossibility_of_doubling_the_cube_lemma<span class="main">)</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Proving the impossibility of trisecting an angle›</span></span>

<span class="keyword1" id="Impossible_Geometry-impossibility_of_trisecting_pi_over_3_lemma"><span class="command">lemma</span></span> impossibility_of_trisecting_pi_over_3_lemma<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> radical_sqrt"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> x_eqn<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">-</span> <span class="numeral">3</span> <span class="main">*</span> <span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted">False</span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">x</span> <span class="main">∈</span> Rats<span class="main">.</span> <span class="bound">x</span><span class="main">^</span><span class="numeral">3</span> <span class="main">+</span> <span class="main">(</span><span class="main">-</span> <span class="numeral">3</span><span class="main">)</span> <span class="main">*</span> <span class="bound">x</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>real<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> x_eqn cubic_root_radical_sqrt_rational <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="main">0</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="numeral">3</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="main">1</span>"</span></span><span class="main">]</span> x
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="main">::</span> <span class="quoted">real</span> <span class="keyword2"><span class="keyword">where</span></span> hypsy<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> Rats <span class="main">∧</span> <span class="skolem">y</span> <span class="main">^</span> <span class="numeral">3</span> <span class="main">-</span> <span class="numeral">3</span> <span class="main">*</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> hypsr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> of_rat <span class="skolem">r</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Rats_cases<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> hypsp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">=</span> Fract <span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span> <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span> <span class="main">&amp;</span> snd <span class="skolem">p</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">&amp;</span> coprime <span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span> <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> quotient_of_unique hypsy
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> r3eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">^</span><span class="numeral">3</span> <span class="main">-</span> <span class="numeral">3</span> <span class="main">*</span> <span class="skolem">r</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> hypsy hypsr <span class="main">[</span><span class="main">[</span><span class="operator">hypsubst_thin</span> <span class="main"><span class="main">=</span></span> <span class="quasi_keyword">true</span><span class="main">]</span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>hide_lams<span class="main"><span class="main">,</span></span> no_types<span class="main"><span class="main">)</span></span> of_rat_1 of_rat_diff of_rat_eq_iff of_rat_mult of_rat_numeral_eq of_rat_power<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> l7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span> <span class="main">^</span><span class="numeral">3</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">&amp;</span> coprime <span class="main">(</span><span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> hypsp <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">^</span><span class="numeral">3</span>  <span class="main">=</span> Fract <span class="main">(</span><span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">)</span></span> mult_rat power3_eq_cube hypsp<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Fract <span class="main">(</span><span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span>Fract <span class="main">(</span><span class="numeral">3</span> <span class="main">*</span> <span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> r3eq hypsp
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Fract_of_int_quotient<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> l10<span class="main">:</span> <span class="quoted"><span class="quoted">"Fract <span class="main">(</span><span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">-</span> Fract <span class="main">(</span><span class="numeral">3</span> <span class="main">*</span> <span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">)</span> <span class="main">(</span><span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> hypsp
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power_def <span class="dynamic"><span class="dynamic">algebra_simps</span></span> Fract_of_int_quotient<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Fract <span class="main">(</span><span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">3</span> <span class="main">*</span> <span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">=</span>
        Fract <span class="main">(</span><span class="main">(</span><span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">3</span> <span class="main">*</span> <span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span><span class="main">*</span><span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> l7
        mult_rat_cancel <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span> <span class="main">-</span> <span class="main">(</span><span class="numeral">3</span> <span class="main">*</span> <span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> Fract <span class="main">1</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> l7 l10 one_rat diff_rat mult_neg_pos not_square_less_zero int_distrib<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span> <span class="main">-</span> <span class="numeral">3</span> <span class="main">*</span> <span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">=</span> <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> hypsp
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eq_rat<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">3</span> <span class="main">*</span> <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span> <span class="main">^</span><span class="numeral">2</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span>"</span></span>
        <span class="quoted"><span class="quoted">"<span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">3</span> <span class="main">*</span> <span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span> <span class="main">^</span><span class="numeral">3</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power_def <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span> <span class="keyword1">dvd</span> <span class="main">(</span><span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span> <span class="keyword1">dvd</span> <span class="main">(</span><span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dvd_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">-</span> <span class="numeral">3</span> <span class="main">*</span> <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span> <span class="main">^</span><span class="numeral">2</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule_tac</span> <span class="main"><span class="improper">[</span></span>2<span class="main"><span class="improper">]</span></span> x <span class="main"><span class="main">=</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span><span class="main">^</span><span class="numeral">2</span> <span class="main">+</span> <span class="numeral">3</span> <span class="main">*</span> <span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"coprime <span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span> <span class="main">(</span>snd <span class="skolem">p</span> <span class="main">^</span> <span class="numeral">3</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"coprime <span class="main">(</span>fst <span class="skolem">p</span> <span class="main">^</span> <span class="numeral">3</span><span class="main">)</span> <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> hypsp <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"is_unit <span class="main">(</span>fst <span class="skolem">p</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"is_unit <span class="main">(</span>snd <span class="skolem">p</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> coprime_common_divisor <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"fst <span class="skolem">p</span>"</span></span> <span class="quoted"><span class="quoted">"snd <span class="skolem">p</span> <span class="main">^</span> <span class="numeral">3</span>"</span></span> <span class="quoted"><span class="quoted">"fst <span class="skolem">p</span>"</span></span><span class="main">]</span>
      coprime_common_divisor <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"fst <span class="skolem">p</span> <span class="main">^</span> <span class="numeral">3</span>"</span></span> <span class="quoted"><span class="quoted">"snd <span class="skolem">p</span>"</span></span> <span class="quoted"><span class="quoted">"snd <span class="skolem">p</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> hypsp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"fst <span class="skolem">p</span> <span class="main">=</span> <span class="main">1</span> <span class="main">∨</span> fst <span class="skolem">p</span> <span class="main">=</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="quoted"><span class="quoted">"snd <span class="skolem">p</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> hypsp <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">=</span> <span class="main">1</span> <span class="main">|</span> <span class="skolem">r</span> <span class="main">=</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rat_number_collapse<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> r3eq <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power_def <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">theorem</span></span> impossibility_of_trisecting_angle_pi_over_3<span class="main">:</span>
  <span class="quoted"><span class="quoted">"Point <span class="main">(</span>cos <span class="main">(</span>pi <span class="main">/</span> <span class="numeral">9</span><span class="main">)</span><span class="main">)</span> <span class="main">0</span> <span class="main">∉</span> constructible"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"cos <span class="main">(</span><span class="numeral">3</span> <span class="main">*</span><span class="main">(</span>pi<span class="main">/</span><span class="numeral">9</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="numeral">4</span> <span class="main">*</span> <span class="main">(</span>cos <span class="main">(</span>pi<span class="main">/</span><span class="numeral">9</span><span class="main">)</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span> <span class="main">-</span> <span class="numeral">3</span> <span class="main">*</span> cos <span class="main">(</span>pi<span class="main">/</span><span class="numeral">9</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> cos_treble_cos <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"pi <span class="main">/</span> <span class="numeral">9</span>"</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span><span class="main">/</span><span class="numeral">2</span> <span class="main">=</span> <span class="numeral">4</span> <span class="main">*</span> <span class="main">(</span>cos <span class="main">(</span>pi<span class="main">/</span><span class="numeral">9</span><span class="main">)</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span> <span class="main">-</span> <span class="numeral">3</span> <span class="main">*</span> cos <span class="main">(</span>pi<span class="main">/</span><span class="numeral">9</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cos_60<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">8</span> <span class="main">*</span> <span class="main">(</span>cos <span class="main">(</span>pi<span class="main">/</span><span class="numeral">9</span><span class="main">)</span><span class="main">)</span><span class="main">^</span><span class="numeral">3</span> <span class="main">-</span> <span class="numeral">6</span> <span class="main">*</span> cos <span class="main">(</span>pi<span class="main">/</span><span class="numeral">9</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> cos <span class="main">(</span>pi <span class="main">/</span> <span class="numeral">9</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span><span class="numeral">3</span> <span class="main">-</span> <span class="numeral">3</span> <span class="main">*</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> cos <span class="main">(</span>pi <span class="main">/</span> <span class="numeral">9</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span> power_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> cos <span class="main">(</span>pi <span class="main">/</span> <span class="numeral">9</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> impossibility_of_trisecting_pi_over_3_lemma<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>cos <span class="main">(</span>pi <span class="main">/</span> <span class="numeral">9</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> radical_sqrt"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> divide_self_if mult_zero_right one_add_one radical_sqrt.intros<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> radical_sqrt.intros<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span> radical_sqrt_rule_division<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> abscissa.simps constructible_radical_sqrt<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div>
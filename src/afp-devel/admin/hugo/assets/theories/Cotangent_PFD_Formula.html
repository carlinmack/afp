<div id='Cotangent_PFD_Formula'>ad>


<body>
<div class="head">
<h1>Theory Cotangent_PFD_Formula</h1>
</div>

<pre class="source"><span class="comment1"><span>(</span><span>*</span><span>
  File:     Cotangent_PFD_Formula.thy
  Author:   Manuel Eberl, University of Innsbruck

  A proof of the "partial fraction decomposition"-style sum formula for the contangent function.
</span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The Partial-Fraction Formula for the Cotangent Function</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Cotangent_PFD_Formula</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Complex_Analysis/Complex_Analysis.html"><span>HOL-Complex_Analysis.Complex_Analysis</span></a><span>"</span></span><span> </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Real_Asymp/Real_Asymp.html"><span>HOL-Real_Asymp.Real_Asymp</span></a><span>"</span></span><span> 
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Auxiliary lemmas</span><span>âº</span></span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span> TODO Move </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
  </span><span>The following variant of the comparison test for showing summability allows us to use
</span><span>  a `Big-O' estimate, which works well together with Isabelle's automation for real asymptotics.</span><span>
</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_615..620">lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.summable_comparison_test_bigo|fact"><span class="entity_def" id="Cotangent_PFD_Formula.summable_comparison_test_bigo|thm"><span>summable_comparison_test_bigo</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>summable</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span>norm</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><span>O(</span></span><span class="free"><span>g</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><span>summable</span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><span>O(</span></span><span class="free"><span>g</span></span><span class="main"><span>)</span></span><span>âº</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>C</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span>C</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>norm</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>C</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>norm</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span>at_top</span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>elim</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>landau_o.bigE</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>summable_comparison_test_ev</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>insert</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_615..620"><span>assms</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>summable_mult</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.uniformly_on_image|fact"><span class="entity_def" id="Cotangent_PFD_Formula.uniformly_on_image|thm"><span>uniformly_on_image</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span>uniformly_on</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>filtercomap</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>h</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>h</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>uniformly_on</span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><span>uniformly_on_def</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>filtercomap_INF</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.uniform_limit_image|fact"><span class="entity_def" id="Cotangent_PFD_Formula.uniform_limit_image|thm"><span>uniform_limit_image</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span>uniform_limit</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="free"><span>F</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span>uniform_limit</span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.uniformly_on_image|fact"><span>uniformly_on_image</span></a><span> </span><span>filterlim_filtercomap_iff</span><span> </span><span>o_def</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.Ints_add_iff1|fact"><span class="entity_def" id="Cotangent_PFD_Formula.Ints_add_iff1|thm"><span>Ints_add_iff1</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Ints_add</span><span> </span><span>Ints_diff</span><span> </span><span>add.commute</span><span> </span><span>add_diff_cancel_right'</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.Ints_add_iff2|fact"><span class="entity_def" id="Cotangent_PFD_Formula.Ints_add_iff2|thm"><span>Ints_add_iff2</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Ints_add</span><span> </span><span>Ints_diff</span><span> </span><span>add_diff_cancel_right'</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
  </span><span>If a set is discrete (i.e. the difference between any two points is bounded from below),
</span><span>  it has no limit points:</span><span>
</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1693..1698">lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.discrete_imp_not_islimpt|fact"><span class="entity_def" id="Cotangent_PFD_Formula.discrete_imp_not_islimpt|thm"><span>discrete_imp_not_islimpt</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>e</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>e</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>d</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>.</span></span><span> </span><span>dist</span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>e</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><span>islimpt</span></span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><span>islimpt</span></span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><span>islimpt</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>x</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><span>islimpt_punctured</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_1693..1698"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>closed</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>S</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>x</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>discrete_imp_closed</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span>False</span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><span>closed_limpt</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
  </span><span>In particular, the integers have no limit point:</span><span>
</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.Ints_not_limpt|fact"><span class="entity_def" id="Cotangent_PFD_Formula.Ints_not_limpt|thm"><span>Ints_not_limpt</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>real_normed_algebra_1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>islimpt</span></span><span> </span><span class="main"><span>â¤</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.discrete_imp_not_islimpt|fact"><span>discrete_imp_not_islimpt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="main"><span class="quoted"><span class="main"><span class="quoted"><span class="main"><span>1</span></span></span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>elim</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>Ints_cases</span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>dist_of_int</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
  </span><span>The following lemma allows evaluating telescoping sums of the form
</span><span>  \[\sum\limits_{n=0}^\infty \left(f(n) - f(n + k)\right)\]
</span><span>  where $f(n) \longrightarrow 0$, i.e.\ where all terms except for the first </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>kâº</span></span></span><span> are
</span><span>  cancelled by later summands.</span><span>
</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2533..2538">lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.sums_long_telescope|fact"><span class="entity_def" id="Cotangent_PFD_Formula.sums_long_telescope|thm"><span>sums_long_telescope</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="main"><span>{</span></span><span>topological_group_add</span><span class="main"><span>,</span></span><span> </span><span>topological_comm_monoid_add</span><span class="main"><span>,</span></span><span> </span><span>ab_group_add</span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>lim</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â¢</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>sums</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>_</span></span><span> </span><span class="keyword1"><span>sums</span></span><span> </span><span class="var"><span>?S</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>thm</span></span></span><span> </span><span>tendsto_diff</span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="var"><span>?S</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>N</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¢</span></span><span> </span><span class="var"><span>?S</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span class="dynamic"><span class="dynamic"><span>tendsto_intros</span></span></span><span> </span><span>tendsto_null_sum</span><span> </span><span>filterlim_compose</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_2533..2538"><span>assms</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Real_Asymp/Multiseries_Expansion_Bounds.html#Multiseries_Expansion_Bounds.real_asymp|method"><span class="operator"><span>real_asymp</span></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="var"><span>?S</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>N</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¢</span></span><span> </span><span class="var"><span>?S</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="var"><span>?S</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>N</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="bound"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span>sequentially</span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>eventually_ge_at_top</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>c</span></span></span><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>eventually_elim</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_3128..3132">elim</span><span> </span><span class="skolem"><span>N</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="skolem"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="skolem"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="skolem"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>sum_subtractf</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="skolem"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>âª</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>c</span></span><span class="main"><span>..&lt;</span></span><span class="skolem"><span>N</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_3128..3132"><span>elim</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sum.cong</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="free"><span>c</span></span><span class="main"><span>..&lt;</span></span><span class="skolem"><span>N</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>sum.union_disjoint</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="skolem"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="free"><span>c</span></span><span class="main"><span>..&lt;</span></span><span class="skolem"><span>N</span></span><span class="main"><span>+</span></span><span class="free"><span>c</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_3128..3132"><span>elim</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sum.reindex_bij_witness</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>Î»</span></span></span></span><span class="bound"><span class="bound"><span class="bound"><span>n</span></span></span></span><span class="main"><span class="main"><span class="main"><span>.</span></span></span></span><span> </span><span class="bound"><span class="bound"><span class="bound"><span>n</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>-</span></span></span></span><span> </span><span class="free"><span class="free"><span class="free"><span>c</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>Î»</span></span></span></span><span class="bound"><span class="bound"><span class="bound"><span>n</span></span></span></span><span class="main"><span class="main"><span class="main"><span>.</span></span></span></span><span> </span><span class="bound"><span class="bound"><span class="bound"><span>n</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>+</span></span></span></span><span> </span><span class="free"><span class="free"><span class="free"><span>c</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="free"><span>c</span></span><span class="main"><span>..&lt;</span></span><span class="skolem"><span>N</span></span><span class="main"><span>}</span></span><span class="main"><span>âª</span></span><span class="main"><span>{</span></span><span class="skolem"><span>N</span></span><span class="main"><span>..&lt;</span></span><span class="skolem"><span>N</span></span><span class="main"><span>+</span></span><span class="free"><span>c</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_3128..3132"><span>elim</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sum.cong</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="free"><span>c</span></span><span class="main"><span>..&lt;</span></span><span class="skolem"><span>N</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="skolem"><span>N</span></span><span class="main"><span>..&lt;</span></span><span class="skolem"><span>N</span></span><span class="main"><span>+</span></span><span class="free"><span>c</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>sum.union_disjoint</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="skolem"><span>N</span></span><span class="main"><span>..&lt;</span></span><span class="skolem"><span>N</span></span><span class="main"><span>+</span></span><span class="free"><span>c</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>N</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sum.reindex_bij_witness</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>Î»</span></span></span></span><span class="bound"><span class="bound"><span class="bound"><span>n</span></span></span></span><span class="main"><span class="main"><span class="main"><span>.</span></span></span></span><span> </span><span class="bound"><span class="bound"><span class="bound"><span>n</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>+</span></span></span></span><span> </span><span class="skolem"><span class="skolem"><span class="skolem"><span>N</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>Î»</span></span></span></span><span class="bound"><span class="bound"><span class="bound"><span>n</span></span></span></span><span class="main"><span class="main"><span class="main"><span>.</span></span></span></span><span> </span><span class="bound"><span class="bound"><span class="bound"><span>n</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>-</span></span></span></span><span> </span><span class="skolem"><span class="skolem"><span class="skolem"><span>N</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><span>sums_def</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>Lim_transform_eventually</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Definition of auxiliary function</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
  </span><span>The following function is the infinite sum appearing on the right-hand side of the
</span><span>  cotangent formula. It can be written either as
</span><span>  \[\sum_{n=1}^\infty\left(\frac{1}{x + n} + \frac{1}{x - n}\right)\]
</span><span>  or as
</span><span>  \[2x \sum_{n=1}^\infty \frac{1}{x^2 - n^2}\ .\]</span><span>
</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_def|fact"><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_def|thm"><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="main"><span>{</span></span><span>real_normed_field</span><span class="main"><span>,</span></span><span> </span><span>banach</span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'a</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>cot_pfd</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
  </span><span>The sum in the definition of </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const</span><span class="hidden">&gt;</span></span></span><span>â¹</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span>âº</span></span><span> converges uniformly on compact sets.
</span><span>  This implies, in particular, that </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const</span><span class="hidden">&gt;</span></span></span><span>â¹</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span>âº</span></span><span> is holomorphic (and thus also continuous).</span><span>
</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.uniform_limit_cot_pfd_complex|fact"><span class="entity_def" id="Cotangent_PFD_Formula.uniform_limit_cot_pfd_complex|thm"><span>uniform_limit_cot_pfd_complex</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>R</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><span>uniform_limit</span><span> </span><span class="main"><span>(</span></span><span>cball</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>complex</span><span> </span><span>set</span><span class="main"><span>)</span></span><span>
             </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>N</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="bound"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span>sequentially</span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd_def|fact"><span>cot_pfd_def</span></a><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>Weierstrass_m_test_ev</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>N</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span> </span><span>at_top</span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Real_Asymp/Multiseries_Expansion_Bounds.html#Multiseries_Expansion_Bounds.real_asymp|method"><span class="operator"><span>real_asymp</span></span></a><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="bound"><span>N</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span>sequentially</span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>::</span></span><span>complex</span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span>cball</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>R</span></span><span class="main"><span>.</span></span><span> </span><span>norm</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>N</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>
          </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>N</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>eventually_elim</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_5161..5165">elim</span><span> </span><span class="skolem"><span>N</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>safe</span></span><span>
      </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>complex</span></span><span> </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_5229..5230">x</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>cball</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="skolem"><span>N</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>R</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>norm</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_nat</span><span> </span><span class="skolem"><span>N</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>complex</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>norm</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_5229..5230"><span>x</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>power_mono</span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>norm_power</span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>flip</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>of_nat_Suc</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>norm</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_nat</span><span> </span><span class="skolem"><span>N</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>complex</span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>norm_minus_commute</span><span> </span><span>norm_triangle_ineq2</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>norm</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>N</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>N</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><span>norm_mult</span><span> </span><span>norm_divide</span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>R</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>0</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_5229..5230"><span>x</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_5161..5165"><span>elim</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_mono</span><span> </span><span>frac_le</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>power_strict_mono</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>summable</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>N</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.summable_comparison_test_bigo|fact"><span>summable_comparison_test_bigo</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>N</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><span>O(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>N</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Real_Asymp/Multiseries_Expansion_Bounds.html#Multiseries_Expansion_Bounds.real_asymp|method"><span class="operator"><span>real_asymp</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>summable</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span>norm</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>inverse_power_summable</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="numeral"><span>2</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>field_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.sums_cot_pfd_complex|fact"><span class="entity_def" id="Cotangent_PFD_Formula.sums_cot_pfd_complex|thm"><span>sums_cot_pfd_complex</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>complex</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>sums</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>tendsto_uniform_limitI</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.uniform_limit_cot_pfd_complex|fact"><span>uniform_limit_cot_pfd_complex</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>norm</span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>sums_def</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6351..6356">lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.sums_cot_pfd_complex&apos;|fact"><span class="entity_def" id="Cotangent_PFD_Formula.sums_cot_pfd_complex&apos;|thm"><span>sums_cot_pfd_complex'</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>complex</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>sums</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>sums</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.sums_cot_pfd_complex|fact"><span>sums_cot_pfd_complex</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
             </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6798..6802">neq1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_6351..6356"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Ints_0</span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.Ints_add_iff2|fact"><span>Ints_add_iff2</span></a><span> </span><span>Ints_of_nat</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6900..6904">neq2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_6351..6356"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6967..6971">neq3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
     </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_6351..6356"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Ints_of_nat</span><span> </span><span>eq_iff_diff_eq_0</span><span> </span><span>minus_in_Ints_iff</span><span> </span><span>power2_eq_iff</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="var"><span>?rhs</span></span><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_6798..6802"><span>neq1</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_6900..6904"><span>neq2</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_6967..6971"><span>neq3</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>divide_simps</span></span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>of_nat_Suc</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>power2_eq_square</span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.summable_cot_pfd_complex|fact"><span class="entity_def" id="Cotangent_PFD_Formula.summable_cot_pfd_complex|thm"><span>summable_cot_pfd_complex</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>complex</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>summable</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.sums_cot_pfd_complex|fact"><span>sums_cot_pfd_complex</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>sums_iff</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.summable_cot_pfd_real|fact"><span class="entity_def" id="Cotangent_PFD_Formula.summable_cot_pfd_real|thm"><span>summable_cot_pfd_real</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>real</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>summable</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>summable</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span>complex_of_real</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.summable_cot_pfd_complex|fact"><span>summable_cot_pfd_complex</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>of_real</span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?this</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="var"><span>?thesis</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>summable_of_real_iff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.sums_cot_pfd_real|fact"><span class="entity_def" id="Cotangent_PFD_Formula.sums_cot_pfd_real|thm"><span>sums_cot_pfd_real</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>real</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>sums</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.summable_cot_pfd_real|fact"><span>summable_cot_pfd_real</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd_def|fact"><span>cot_pfd_def</span></a><span> </span><span>sums_iff</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_complex_of_real|fact"><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_complex_of_real|thm"><span>cot_pfd_complex_of_real</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span>complex_of_real</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>of_real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>sums_of_real</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.sums_cot_pfd_real|fact"><span>sums_cot_pfd_real</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>,</span></span><span> </span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> </span><span class="tvar"><span>?'a</span></span><span> </span><span class="main"><span class="main"><span>=</span></span></span><span> </span><span class="quoted"><span>complex</span></span><span class="main"><span>]</span></span><span>
        </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.sums_cot_pfd_complex|fact"><span>sums_cot_pfd_complex</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>of_real</span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span>sums_unique2</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8209..8214">lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.uniform_limit_cot_pfd_real|fact"><span class="entity_def" id="Cotangent_PFD_Formula.uniform_limit_cot_pfd_real|thm"><span>uniform_limit_cot_pfd_real</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>R</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><span>uniform_limit</span><span> </span><span class="main"><span>(</span></span><span>cball</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>real</span><span> </span><span>set</span><span class="main"><span>)</span></span><span>
             </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>N</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="bound"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span>sequentially</span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>uniform_limit</span><span> </span><span class="main"><span>(</span></span><span>cball</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span>
          </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>N</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>Re</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="bound"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>Re</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span>sequentially</span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span class="dynamic"><span class="dynamic"><span>uniform_limit_intros</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.uniform_limit_cot_pfd_complex|fact"><span>uniform_limit_cot_pfd_complex</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_8209..8214"><span>assms</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>uniform_limit</span><span> </span><span class="main"><span>(</span></span><span>of_real</span><span> </span><span class="main"><span>`</span></span><span> </span><span>cball</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span>
          </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>N</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>Re</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="bound"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>Re</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span>sequentially</span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>uniform_limit_on_subset</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.uniform_limit_image|fact"><span>uniform_limit_image</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Holomorphicity and continuity</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.holomorphic_on_cot_pfd|fact"><span class="entity_def" id="Cotangent_PFD_Formula.holomorphic_on_cot_pfd|thm"><span>holomorphic_on_cot_pfd</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>holomorphic_intros</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="main"><span>â¤</span></span><span class="main"><span>-</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="keyword1"><span>holomorphic_on</span></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_9032..9033">*</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>open</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="main"><span>â¤</span></span><span class="main"><span>-</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>complex</span><span> </span><span>set</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>open_Compl</span><span> </span><span>closed_subset_Ints</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_9120..9126">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>f</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>complex</span><span> </span><span class="main"><span>â</span></span><span> </span><span>complex</span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>N</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="bound"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="keyword1"><span>holomorphic_on</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="main"><span>â¤</span></span><span class="main"><span>-</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>holomorphic_uniform_sequence</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_9032..9033"><span>*</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9337..9341">have</span></span></span><span> </span><span class="entity_def" id="offset_9342..9344">**</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="main"><span>â¤</span></span><span class="main"><span>-</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>complex</span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>algebra</span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¨</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>-</span></span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="quasi_keyword"><span>asm</span></span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>eq_commute</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="quasi_keyword"><span>asm</span></span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>power2_eq_iff</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>complex</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>complex</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>Ints_minus</span><span> </span><span>Ints_of_nat</span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span>False</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_9337..9341"><span>that</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>of_nat_Suc</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="keyword1"><span>holomorphic_on</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_9120..9126"><span>f_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span class="dynamic"><span class="dynamic"><span>holomorphic_intros</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_9342..9344"><span>**</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>complex</span></span><span> </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_10009..10010">z</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_9032..9033"><span>*</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_10009..10010"><span>z</span></a><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>r</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_10057..10058">r</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>cball</span><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="main"><span>â¤</span></span><span class="main"><span>-</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>open_contains_cball</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>uniform_limit</span><span> </span><span class="main"><span>(</span></span><span>cball</span><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span>sequentially</span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.uniform_limit_cot_pfd_complex|fact"><span>uniform_limit_cot_pfd_complex</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>norm</span><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>r</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_9120..9126"><span>f_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>uniform_limit_on_subset</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>cball</span><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>cball</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>(</span></span><span>norm</span><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><span>cball_subset_cball_iff</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>dist_norm</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>use</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>âº</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_10057..10058"><span>r</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>d</span></span></span><span class="main"><span>&gt;</span></span><span class="main"><span>0</span></span><span class="main"><span>.</span></span><span> </span><span>cball</span><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span>uniform_limit</span><span> </span><span class="main"><span>(</span></span><span>cball</span><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span>sequentially</span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>holomorphic_on_subset</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>fact</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10632..10637">lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.continuous_on_cot_pfd_complex|fact"><span class="entity_def" id="Cotangent_PFD_Formula.continuous_on_cot_pfd_complex|thm"><span>continuous_on_cot_pfd_complex</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>continuous_intros</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="main"><span>â¤</span></span><span class="main"><span>-</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><span>continuous_on</span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>::</span></span><span> </span><span>complex</span><span> </span><span class="main"><span>â</span></span><span> </span><span>complex</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>holomorphic_on_imp_continuous_on</span><span> </span><span class="dynamic"><span class="dynamic"><span>holomorphic_intros</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_10632..10637"><span>assms</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10845..10850">lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.continuous_on_cot_pfd_real|fact"><span class="entity_def" id="Cotangent_PFD_Formula.continuous_on_cot_pfd_real|thm"><span>continuous_on_cot_pfd_real</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>continuous_intros</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="main"><span>â¤</span></span><span class="main"><span>-</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><span>continuous_on</span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>::</span></span><span> </span><span>real</span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>continuous_on</span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>(</span></span><span>Re</span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>â</span></span><span> </span><span>of_real</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span class="dynamic"><span class="dynamic"><span>continuous_intros</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>use</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_10845..10850"><span>assms</span></a><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Re</span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>â</span></span><span> </span><span>of_real</span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Functional equations</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
  </span><span>In this section, we will show three few functional equations for the function </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const</span><span class="hidden">&gt;</span></span></span><span>â¹</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span>âº</span></span><span>.
</span><span>  The first one is trivial; the other two are a bit tedious and not very insightful, so I
</span><span>  will not comment on them.</span><span>
</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const</span><span class="hidden">&gt;</span></span></span><span>â¹</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span>âº</span></span><span> is an odd function:</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_complex_minus|fact"><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_complex_minus|thm"><span>cot_pfd_complex_minus</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>complex</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>-</span></span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
        </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="keyword1"><span>sums</span></span><span> </span><span class="main"><span>-</span></span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sums_minus</span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.sums_cot_pfd_complex|fact"><span>sums_cot_pfd_complex</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.sums_cot_pfd_complex|fact"><span>sums_cot_pfd_complex</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>-</span></span><span class="free"><span>x</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span>sums_unique2</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_real_minus|fact"><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_real_minus|thm"><span>cot_pfd_real_minus</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>real</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>-</span></span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd_complex_minus|fact"><span>cot_pfd_complex_minus</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>of_real</span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><span>of_real_minus</span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd_complex_of_real|fact"><span>cot_pfd_complex_of_real</span></a><span> </span><span>of_real_eq_iff</span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const</span><span class="hidden">&gt;</span></span></span><span>â¹</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span>âº</span></span><span> is periodic with period 1:</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_12090..12095">lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_plus_1_complex|fact"><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_plus_1_complex|thm"><span>cot_pfd_plus_1_complex</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>complex</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_12221..12225">have</span></span></span><span> </span><span class="entity_def" id="offset_12226..12227">*</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span>of_nat</span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>complex</span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="skolem"><span>n</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_12221..12225"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Ints_of_nat</span><span> </span><span>minus_in_Ints_iff</span><span> </span><span>power2_eq_iff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_12358..12362">have</span></span></span><span> </span><span class="entity_def" id="offset_12363..12365">**</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_nat</span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>complex</span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="skolem"><span>n</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_12358..12362"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Ints_0</span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.Ints_add_iff2|fact"><span>Ints_add_iff2</span></a><span> </span><span>Ints_of_nat</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_12090..12095"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_12090..12095"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_12363..12365"><span>**</span></a><span>"</span></span><span> </span><span>of_nat_1</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_12363..12365"><span>**</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span> </span><span class="quoted"><span class="numeral"><span>2</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_12090..12095"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_12664..12667">lim</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¢</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>tendsto_divide_0</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>tendsto_const</span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>tendsto_add_filterlim_at_infinity</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>tendsto_const</span><span class="main"><span class="main"><span>]</span></span></span><span>
              </span><span>filterlim_compose</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>tendsto_of_nat</span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>filterlim_Suc</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_12880..12884">sum1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>sums</span></span><span>
          </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="numeral"><span>2</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.sums_long_telescope|fact"><span>sums_long_telescope</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_12664..12667"><span>lim</span></a><span class="main"><span>,</span></span><span> </span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="numeral"><span>2</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span>sums</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.sums_cot_pfd_complex|fact"><span>sums_cot_pfd_complex</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sums_diff</span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.sums_cot_pfd_complex|fact"><span>sums_cot_pfd_complex</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><span>sums_Suc_iff</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span> </span><span>power2_eq_square</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span>
                  </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
             </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_12226..12227"><span>*</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_12226..12227"><span>*</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_12363..12365"><span>**</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_12363..12365"><span>**</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_12090..12095"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>ext</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>divide_simps</span></span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>of_nat_add</span><span> </span><span>of_nat_Suc</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span> </span><span>power2_eq_square</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_13960..13964">sum2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>sums</span></span><span>
                         </span><span class="main"><span>(</span></span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
        </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="numeral"><span>2</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_12880..12884"><span>sum1</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_13960..13964"><span>sum2</span></a><span> </span><span>sums_unique2</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>-</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>eval_nat_numeral</span><span> </span><span class="dynamic"><span class="dynamic"><span>divide_simps</span></span></span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>algebra</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>divide_simps</span></span></span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>algebra</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>algebra</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
   
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_14586..14591">lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_plus_1_real|fact"><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_plus_1_real|thm"><span>cot_pfd_plus_1_real</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>real</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span>complex_of_real</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span>of_real</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>of_real</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>of_real</span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd_plus_1_complex|fact"><span>cot_pfd_plus_1_complex</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_14586..14591"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>complex_of_real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd_complex_of_real|fact"><span>cot_pfd_complex_of_real</span></a><span> </span><span>of_real_eq_iff</span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
  </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const</span><span class="hidden">&gt;</span></span></span><span>â¹</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span>âº</span></span><span> satisfies the following functional equation:
</span><span>  \[2 f(x) = f\left(\frac{x}{2}\right) + f\left(\frac{x+1}{2}\right) + \frac{2}{x+1}\]</span><span>
</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_15183..15188">lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_funeq_complex|fact"><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_funeq_complex|thm"><span>cot_pfd_funeq_complex</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>complex</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_15343..15349">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>f</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>complex</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>complex</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_15428..15434">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>g</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>complex</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>complex</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_15513..15519">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>h</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>complex</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>complex</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_15600..15604">have</span></span></span><span> </span><span class="entity_def" id="offset_15605..15609">sums</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>sums</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_15343..15349"><span>f_def</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_15428..15434"><span>g_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.sums_cot_pfd_complex&apos;|fact"><span>sums_cot_pfd_complex'</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_15600..15604"><span>that</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>Ints_mult</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span>False</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_15183..15188"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>Ints_mult</span><span> </span><span>Ints_diff</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span>False</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_15183..15188"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>field_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>sums</span></span><span>
                     </span><span class="main"><span>(</span></span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sums_add</span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_15605..15609"><span>sums</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
             </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
          </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>algebra</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_15343..15349"><span>f_def</span></a><span> </span><span class="dynamic"><span class="dynamic"><span>field_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>g</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_15428..15434"><span>g_def</span></a><span> </span><span class="dynamic"><span class="dynamic"><span>field_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>â¦</span></span><span> </span><span class="main"><span>=</span></span><span>
               </span><span class="skolem"><span>h</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_15513..15519"><span>h_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
                  </span><span class="skolem"><span>h</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17182..17186">sum1</span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>sums</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¢</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_15343..15349"><span>f_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>tendsto_divide_0</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>tendsto_const</span><span class="main"><span class="main"><span>]</span></span></span><span>
              </span><span>tendsto_add_filterlim_at_infinity</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>tendsto_const</span><span class="main"><span class="main"><span>]</span></span></span><span>
              </span><span>filterlim_compose</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>tendsto_of_nat</span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>filterlim_Suc</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>sums</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sums_add</span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_15605..15609"><span>sums</span></a><span> </span><span>sums_mult</span><span> </span><span>telescope_sums</span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_15183..15188"><span>assms</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_15513..15519"><span>h_def</span></a><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span> </span><span>fun_eq_iff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17796..17797">*</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><span>sums</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span>sum</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>..&lt;</span></span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>sums</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>sums_group</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_17796..17797"><span>*</span></a><span class="main"><span>,</span></span><span> </span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="numeral"><span>2</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span>sum</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>n</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>..&lt;</span></span><span class="bound"><span>n</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>mult_ac</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_18094..18098">sum2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>sums</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_17182..17186"><span>sum1</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_18094..18098"><span>sum2</span></a><span> </span><span>sums_unique2</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_15343..15349"><span>f_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>algebra</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_18395..18400">lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_funeq_real|fact"><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_funeq_real|thm"><span>cot_pfd_funeq_real</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>real</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>complex_of_real</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span>complex_of_real</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>complex_of_real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_18395..18400"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd_funeq_complex|fact"><span>cot_pfd_funeq_complex</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>flip</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd_complex_of_real|fact"><span>cot_pfd_complex_of_real</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>of_real_eq_iff</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The limit at 0</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_real_tendsto_0|fact"><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_real_tendsto_0|thm"><span>cot_pfd_real_tendsto_0</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>â</span></span><span class="main"><span>0</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>real</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>filterlim</span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span>nhds</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>at</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>real</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>within</span></span><span> </span><span>ball</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>swap_uniform_limit</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>uniform_limit</span><span> </span><span class="main"><span>(</span></span><span>ball</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>
            </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>N</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="bound"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span>sequentially</span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.uniform_limit_cot_pfd_real|fact"><span>uniform_limit_cot_pfd_real</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><span>zero_le_one</span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>uniform_limit_on_subset</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>at</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="keyword1"><span>within</span></span><span> </span><span>ball</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>n</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>filterlim_mono</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>at</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Real_Asymp/Multiseries_Expansion_Bounds.html#Multiseries_Expansion_Bounds.real_asymp|method"><span class="operator"><span>real_asymp</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Real_Asymp/Multiseries_Expansion.html#Multiseries_Expansion.at_within_le_at|fact"><span>at_within_le_at</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="bound"><span>N</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span>sequentially</span><span class="main"><span>.</span></span><span>
             </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="bound"><span>N</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>at</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="keyword1"><span>within</span></span><span> </span><span>ball</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>always_eventually</span><span> </span><span>allI</span><span> </span><span>tendsto_null_sum</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>at_within_open_NO_MATCH</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Final result</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
  </span><span>To show the final result, we first prove the real case using Herglotz's trick, following
</span><span>  the presentation in `Proofs from {THE BOOK}'.~\cite[Chapter~23]{thebook}.</span><span>
</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_19982..19987">lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_formula_real|fact"><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_formula_real|thm"><span>cot_pfd_formula_real</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span>cot</span><span> </span><span class="main"><span>(</span></span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_20088..20092">have</span></span></span><span> </span><span class="entity_def" id="offset_20093..20103">ev_not_int</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>at</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>filterlim</span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>at</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>at</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>real</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>eventually_compose_filterlim</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> _ </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20088..20092"><span>that</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>at</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.Ints_not_limpt|fact"><span>Ints_not_limpt</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span>islimpt_iff_eventually</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
    </span><span>We define the function $h(z)$ as the difference of the left-hand side and right-hand side.
</span><span>    The left-hand side and right-hand side have singularities at the integers, but we will
</span><span>    later see that these can be removed as </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>hâº</span></span></span><span> tends to </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>0âº</span></span></span><span> there.</span><span>
  </span><span>âº</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_20659..20665">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>f</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span>cot</span><span> </span><span class="main"><span>(</span></span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_20723..20729">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>g</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_20787..20793">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>h</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_20848..20852">have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20848..20852"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20787..20793"><span>h_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
    </span><span>It is easy to see that the left-hand side and the right-hand side, and as a consequence
</span><span>    also our function </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>hâº</span></span></span><span>, are odd and periodic with period 1.</span><span>
  </span><span>âº</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_21100..21105">odd_h</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>-</span></span><span class="skolem"><span>h</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20787..20793"><span>h_def</span></a><span> </span><span>minus_in_Ints_iff</span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20659..20665"><span>f_def</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20723..20729"><span>g_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_21191..21196">per_f</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20659..20665"><span>f_def</span></a><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span> </span><span>cot_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_21271..21275">have</span></span></span><span> </span><span class="entity_def" id="offset_21276..21281">per_g</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_21271..21275"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20723..20729"><span>g_def</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd_plus_1_real|fact"><span>cot_pfd_plus_1_real</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> h</span><span class="main"><span>:</span></span><span> </span><span>periodic_fun_simple'</span><span> </span><span class="quoted"><span class="skolem"><span>h</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_21416..21418">by</span></span></span><span> </span><span class="operator"><span>standard</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20787..20793"><span>h_def</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_21191..21196"><span>per_f</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_21276..21281"><span>per_g</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
    </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>hâº</span></span></span><span> tends to 0 at 0 (and thus at all the integers).</span><span>
  </span><span>âº</span></span></span><span>  
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_21538..21543">h_lim</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>â</span></span><span class="main"><span>0</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>Lim_transform_eventually</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>at</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>real</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20093..20103"><span>ev_not_int</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Real_Asymp/Multiseries_Expansion_Bounds.html#Multiseries_Expansion_Bounds.real_asymp|method"><span class="operator"><span>real_asymp</span></span></a><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>::</span></span><span>real</span><span class="main"><span>.</span></span><span> </span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span>cot</span><span> </span><span class="main"><span>(</span></span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>at</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>eventually_elim</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20787..20793"><span>h_def</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20659..20665"><span>f_def</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20723..20729"><span>g_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>::</span></span><span>real</span><span class="main"><span>.</span></span><span> </span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span>cot</span><span> </span><span class="main"><span>(</span></span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span class="main"><span>0</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><span>cot_def</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Real_Asymp/Multiseries_Expansion_Bounds.html#Multiseries_Expansion_Bounds.real_asymp|method"><span class="operator"><span>real_asymp</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>::</span></span><span>real</span><span class="main"><span>.</span></span><span> </span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span>cot</span><span> </span><span class="main"><span>(</span></span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span class="main"><span>0</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span class="dynamic"><span class="dynamic"><span>tendsto_intros</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd_real_tendsto_0|fact"><span>cot_pfd_real_tendsto_0</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span>cot</span><span> </span><span class="main"><span>(</span></span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span class="main"><span>0</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
    </span><span>This means that our </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>hâº</span></span></span><span> is in fact continuous everywhere:</span><span>
  </span><span>âº</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_22215..22221">cont_h</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>continuous_on</span><span> </span><span class="skolem"><span>A</span></span><span> </span><span class="skolem"><span>h</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>A</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>isCont</span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>n</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>of_int</span><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>elim</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>Ints_cases</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><span>isCont_def</span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>at_to_0</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>use</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_21538..21543"><span>h_lim</span></a><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><span class="quoted"><span>â¹</span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>filterlim_filtermap</span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_21416..21418"><span>h.plus_of_int</span></a><span>âº</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_22561..22566">False</span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>continuous_on</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="main"><span>â¤</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20659..20665"><span>f_def</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20723..20729"><span>g_def</span></a><span> </span><span>sin_times_pi_eq_0</span><span> </span><span>mult.commute</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span>pi</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>continuous_intros</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>isCont</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>continuous_on_interior</span><span class="main"><span>)</span></span><span>
           </span><span class="main"><span>(</span></span><span class="operator"><span>use</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_22561..22566"><span>False</span></a><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><span class="quoted"><span>â¹</span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>interior_open</span><span> </span><span>open_Compl</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>closed_Ints</span><span class="main"><span class="main"><span>]</span></span></span><span>âº</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>â¤</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>nhds</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_22561..22566"><span>False</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>eventually_nhds_in_open</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>nhds</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>eventually_elim</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20787..20793"><span>h_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>isCont</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span>isCont</span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>isCont_cong</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>continuous_at_imp_continuous_on</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>continuous_intros</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>continuous_on_compose2</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_22215..22221"><span>cont_h</span></a><span class="main"><span>]</span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
    </span><span>Through the functional equations of the sine and cosine function, we can derive
</span><span>    the following functional equation for </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>fâº</span></span></span><span> that holds for all non-integer reals:</span><span>
  </span><span>âº</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_23530..23534">have</span></span></span><span> </span><span class="entity_def" id="offset_23535..23539">eq_f</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_23530..23534"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Ints_add</span><span> </span><span>field_sum_of_halves</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_23698..23701">nz1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sin</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span class="main"><span>/</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>pi</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>sin_times_pi_eq_0</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>Ints_mult</span><span> </span><span>Ints_diff</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span>False</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_23530..23534"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>field_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_23990..23993">nz2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sin</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>/</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>pi</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>sin_times_pi_eq_0</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_24070..24073">nz3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sin</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>pi</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_23530..23534"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>sin_times_pi_eq_0</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_24155..24157">eq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sin</span><span> </span><span class="main"><span>(</span></span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sin</span><span> </span><span class="main"><span>(</span></span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>cos</span><span> </span><span class="main"><span>(</span></span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
             </span><span class="quoted"><span class="quoted"><span>"</span><span>cos</span><span> </span><span class="main"><span>(</span></span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>cos</span><span> </span><span class="main"><span>(</span></span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span>sin</span><span> </span><span class="main"><span>(</span></span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>sin_double</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span>cos_double</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_23698..23701"><span>nz1</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_23990..23993"><span>nz2</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_24070..24073"><span>nz3</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20659..20665"><span>f_def</span></a><span> </span><span>cot_def</span><span> </span><span class="dynamic"><span class="dynamic"><span>field_simps</span></span></span><span> </span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>add_divide_distrib</span><span> </span><span>sin_add</span><span> </span><span>cos_add</span><span> </span><span>power2_eq_square</span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_24155..24157"><span>eq</span></a><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
    </span><span>The corresponding functional equation for </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const</span><span class="hidden">&gt;</span></span></span><span>â¹</span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span>âº</span></span><span> that we have already shown
</span><span>    leads to the same functional equation for </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>gâº</span></span></span><span> as we just showed for </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>fâº</span></span></span><span>:</span><span>
  </span><span>âº</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_24743..24747">have</span></span></span><span> </span><span class="entity_def" id="offset_24748..24752">eq_g</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>g</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd_funeq_real|fact"><span>cot_pfd_funeq_real</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_24743..24747"><span>that</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20723..20729"><span>g_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
    </span><span>This then leads to the same functional equation for </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>hâº</span></span></span><span>, and because </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>hâº</span></span></span><span> is continuous
</span><span>    everywhere, we can extend the validity of the equation to the full domain.</span><span>
  </span><span>âº</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_25063..25067">eq_h</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>at</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>at</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
         </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>at</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20093..20103"><span>ev_not_int</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Real_Asymp/Multiseries_Expansion_Bounds.html#Multiseries_Expansion_Bounds.real_asymp|method"><span class="operator"><span>real_asymp</span></span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>at</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>eventually_elim</span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>elim</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_23535..23539"><span>eq_f</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="skolem"><span>x</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_24748..24752"><span>eq_g</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="skolem"><span>x</span></span></span><span class="main"><span>]</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20787..20793"><span>h_def</span></a><span> </span><span class="dynamic"><span class="dynamic"><span>field_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span class="skolem"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>tendsto_eventually</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>continuous_on</span><span> </span><span>UNIV</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>continuous_intros</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><span>LIM_unique</span><span> </span><span>UNIV_I</span><span> </span><span>continuous_on_def</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
    </span><span>Since </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>hâº</span></span></span><span> is periodic with period 1 and continuous, it must attain a global maximum </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>hâº</span></span></span><span> 
</span><span>    somewhere in the interval $[0, 1]$. Let's call this maximum $m$ and let $x_0$ be some point
</span><span>    in the interval $[0, 1]$ such that $h(x_0) = m$.</span><span>
  </span><span>âº</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_26160..26166">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>m</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Sup</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_26160..26166"><span>m_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>closed_contains_Sup</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>compact</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>compact_continuous_image</span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_22215..22221"><span>cont_h</span></a><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>bdd_above</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>closed</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>compact_imp_closed</span><span> </span><span>compact_imp_bounded</span><span> </span><span>bounded_imp_bdd_above</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x0</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_26537..26539">x0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x0</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h</span></span><span> </span><span class="skolem"><span>x0</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>m</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_26587..26593">h_le_m</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>m</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span>frac</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><span>frac_def</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_21416..21418"><span>h.minus_of_int</span></a><span> </span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>m</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_26160..26166"><span>m_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>cSup_upper</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>frac</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>frac_lt_1</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="skolem"><span>x</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span>frac</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>compact</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>compact_continuous_image</span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_22215..22221"><span>cont_h</span></a><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>bdd_above</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>compact_imp_bounded</span><span> </span><span>bounded_imp_bdd_above</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
    </span><span>Through the functional equation for </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>hâº</span></span></span><span>, we can show that if </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>hâº</span></span></span><span> attains its maximum at
</span><span>    some point </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>xâº</span></span></span><span>, it also attains it at $\frac{1}{2} x$. By iterating this, it attains the
</span><span>    maximum at all points of the form $2^{-n} x_0$.</span><span>
  </span><span>âº</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_27394..27398">have</span></span></span><span> </span><span class="entity_def" id="offset_27399..27414">h_eq_m_iter_aux</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>m</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>m</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_25063..25067"><span>eq_h</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="skolem"><span>x</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_27394..27398"><span>that</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_26587..26593"><span>h_le_m</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_26587..26593"><span>h_le_m</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27536..27547">h_eq_m_iter</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x0</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>m</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>n</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="skolem"><span>n</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_27608..27611">Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x0</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x0</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>field_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>m</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_27399..27414"><span>h_eq_m_iter_aux</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>use</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_27608..27611"><span>Suc.IH</span></a><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>use</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_26537..26539"><span>x0</span></a><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
    </span><span>Since the sequence $n \mapsto 2^{-n} x_0$ tends to 0 and </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>hâº</span></span></span><span> is continuous, we derive </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>m = 0âº</span></span></span><span>.</span><span>
  </span><span>âº</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x0</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¢</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>continuous_on_tendsto_compose</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_22215..22221"><span>cont_h</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span>UNIV</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>force</span></span><span> </span><span class="main"><span class="keyword3"><span>|</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Real_Asymp/Multiseries_Expansion_Bounds.html#Multiseries_Expansion_Bounds.real_asymp|method"><span class="operator"><span>real_asymp</span></span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_27536..27547"><span>h_eq_m_iter</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x0</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¢</span></span><span> </span><span class="skolem"><span>m</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>tendsto_unique</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
    </span><span>Since </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>hâº</span></span></span><span> is odd, this means that </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>hâº</span></span></span><span> is identically zero everywhere, and our result follows.</span><span>
  </span><span>âº</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_26587..26593"><span>h_le_m</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_26587..26593"><span>h_le_m</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>-</span></span><span class="free"><span>x</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_21100..21105"><span>odd_h</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_19982..19987"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20787..20793"><span>h_def</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20659..20665"><span>f_def</span></a><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_20723..20729"><span>g_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>
  </span><span>We now lift the result from the domain </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>âââ¤âº</span></span></span><span> to </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>âââ¤âº</span></span></span><span>. We do this by noting that </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>âââ¤âº</span></span></span><span> is
</span><span>  connected and the point $\frac{1}{2}$ is both in </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>âââ¤âº</span></span></span><span> and a limit point of </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>â¹</span></span><span>âââ¤âº</span></span></span><span>.</span><span>
</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.one_half_limit_point_Reals_minus_Ints|fact"><span class="entity_def" id="Cotangent_PFD_Formula.one_half_limit_point_Reals_minus_Ints|thm"><span>one_half_limit_point_Reals_minus_Ints</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>complex</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>islimpt</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>islimptI</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>complex</span><span> </span><span>set</span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>T</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>open</span><span> </span><span class="skolem"><span>T</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>r</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_28854..28855">r</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>ball</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>T</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>open_contains_ball</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_28926..28932">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>min</span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>&lt;..&lt;</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_28854..28855"><span>r</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_28926..28932"><span>y_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>complex_of_real</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>elim</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>Ints_cases</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>complex_of_real</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>complex_of_real</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>complex_of_real</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><span>of_real_eq_iff</span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_28854..28855"><span>r</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span>False</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_28926..28932"><span>y_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>complex_of_real</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>ball</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>r</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_28926..28932"><span>y_def</span></a><span> </span><span>dist_norm</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_28854..28855"><span>r</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>complex_of_real</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>T</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span class="main"><span>â</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>â¤</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_29588..29595">theorem</span></span></span><span> </span><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_formula_complex|fact"><span class="entity_def" id="Cotangent_PFD_Formula.cot_pfd_formula_complex|thm"><span>cot_pfd_formula_complex</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>complex</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>z</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span>cot</span><span> </span><span class="main"><span>(</span></span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>z</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?f</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Î»</span></span><span class="bound"><span>z</span></span><span class="main"><span>::</span></span><span>complex</span><span class="main"><span>.</span></span><span> </span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span>cot</span><span> </span><span class="main"><span>(</span></span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="bound"><span>z</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span>cot</span><span> </span><span class="main"><span>(</span></span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="free"><span>z</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>analytic_continuation</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f </span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span class="quoted"><span class="var"><span>?f</span></span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?f</span></span><span> </span><span class="keyword1"><span>holomorphic_on</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>â¤</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><span>cot_def</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span class="dynamic"><span class="dynamic"><span>holomorphic_intros</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>sin_eq_0</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>open</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>complex</span><span> </span><span>set</span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>connected</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>complex</span><span> </span><span>set</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>path_connected_imp_connected</span><span> </span><span>path_connected_complement_countable</span><span> </span><span>countable_int</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>complex</span><span> </span><span>set</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>complex</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>islimpt</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.one_half_limit_point_Reals_minus_Ints|fact"><span>one_half_limit_point_Reals_minus_Ints</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>complex</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>fraction_not_in_ints</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="numeral"><span>2</span></span></span><span> </span><span class="quoted"><span class="main"><span>1</span></span></span><span class="main"><span>,</span></span><span> </span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> </span><span class="tvar"><span>?'a</span></span><span> </span><span class="main"><span class="main"><span>=</span></span></span><span> </span><span class="quoted"><span>complex</span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>z</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>â¤</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_29588..29595"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_30510..30514">show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?f</span></span><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>â¤</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>z</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>complex_of_real</span><span> </span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span>cot</span><span> </span><span class="main"><span>(</span></span><span>complex_of_real</span><span> </span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="main"><span>=</span></span><span>
            </span><span>complex_of_real</span><span> </span><span class="main"><span>(</span></span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span>cot</span><span> </span><span class="main"><span>(</span></span><span>pi</span><span> </span><span class="main"><span>*</span></span><span> </span><span>Re</span><span> </span><span class="skolem"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>Re</span><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd|const"><span>cot_pfd</span></a><span> </span><span class="main"><span>(</span></span><span>Re</span><span> </span><span class="skolem"><span>z</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_30510..30514"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>elim</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>Reals_cases</span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>cot_of_real</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#Cotangent_PFD_Formula.cot_pfd_formula_real|fact"><span>cot_pfd_formula_real</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>use</span></span><span> </span><a class="entity_ref" href="Cotangent_PFD_Formula.html#offset_30510..30514"><span>that</span></a><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><span class="quoted"><span>â¹</span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>elim</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>Reals_cases</span><span>âº</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>algebra</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span></pre></div>
<div id="FOL_Axiomatic">
<div class="head">
<h1>Theory FOL_Axiomatic</h1>
</div>
<pre class="source"><span class="comment1">(*
  File:      FOL_Axiomatic.thy
  Author:    Asta Halkjær From

  This work is a formalization of the soundness and completeness of an axiomatic system
  for first-order logic. The proof system is based on System Q1 by Smullyan
  and the completeness proof follows his textbook "First-Order Logic" (Springer-Verlag 1968).
  The completeness proof is in the Henkin style where a consistent set
  is extended to a maximal consistent set using Lindenbaum's construction
  and Henkin witnesses are added during the construction to ensure saturation as well.
  The resulting set is a Hintikka set which, by the model existence theorem, is satisfiable
  in the Herbrand universe.
*)</span>

<span class="keyword1"><span class="command">theory</span></span> FOL_Axiomatic <span class="keyword2"><span class="keyword">imports</span></span> <span class="quoted">"<a href="https://www.cl.cam.ac.uk/research/hvg/Isabelle/dist/library/HOL/HOL-Library/Countable.html">HOL-Library.Countable</a>"</span> <span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Syntax›</span></span>

<span class="keyword1"><span class="command">datatype</span></span> <span class="main">(</span>params_tm<span class="main">:</span> <span class="tfree">'f</span><span class="main">)</span> tm
  <span class="main">=</span> Var <span class="quoted">nat</span> <span class="main">(</span><span class="quoted">‹<span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="hidden">❙</span><b>#</b></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>›</span><span class="main">)</span>
  <span class="main">|</span> Fun <span class="tfree"><span class="quoted"><span class="tfree">'f</span></span></span> <span class="quoted"><span class="quoted">‹<span class="tfree">'f</span> tm list›</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="hidden">❙</span><b>†</b></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>›</span><span class="main">)</span>

<span class="keyword1"><span class="command">datatype</span></span> <span class="main">(</span>params_fm<span class="main">:</span> <span class="tfree">'f</span><span class="main">,</span> <span class="tfree">'p</span><span class="main">)</span> fm
  <span class="main">=</span> Falsity <span class="main">(</span><span class="quoted">‹<span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="hidden">❙</span><b>⊥</b></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>›</span><span class="main">)</span>
  <span class="main">|</span> Pre <span class="tfree"><span class="quoted"><span class="tfree">'p</span></span></span> <span class="quoted"><span class="quoted">‹<span class="tfree">'f</span> tm list›</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="hidden">❙</span><b>‡</b></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>›</span><span class="main">)</span>
  <span class="main">|</span> Imp <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'f</span><span class="main">,</span> <span class="tfree">'p</span><span class="main">)</span> fm›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'f</span><span class="main">,</span> <span class="tfree">'p</span><span class="main">)</span> fm›</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">‹<span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="hidden">❙</span><b>⟶</b></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>›</span> 25<span class="main">)</span>
  <span class="main">|</span> Uni <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'f</span><span class="main">,</span> <span class="tfree">'p</span><span class="main">)</span> fm›</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="keyword1"><span class="hidden">❙</span><b>∀</b></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>›</span><span class="main">)</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">Neg</span> <span class="main">(</span><span class="quoted">‹<span class="keyword1"><span class="hidden">❙</span><b>¬</b></span> _›</span> <span class="main">[</span>40<span class="main">]</span> 40<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free"><span class="hidden">❙</span><b>¬</b></span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>

<span class="keyword1"><span class="command">term</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>⊥</b></span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="inner_quoted">''P''</span> <span class="main">[</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="inner_quoted">''f''</span> <span class="main">[</span><span class="main"><span class="hidden">❙</span><b>#</b></span><span class="main">0</span><span class="main">]</span><span class="main">]</span><span class="main">)</span>›</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Semantics›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">shift</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>nat <span class="main">⇒</span> <span class="tfree">'a</span><span class="main">)</span> <span class="main">⇒</span> nat <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> nat <span class="main">⇒</span> <span class="tfree">'a</span>›</span></span>
  <span class="main">(</span><span class="quoted">‹_<span class="keyword1">⟨</span>_<span class="keyword1">:</span>_<span class="keyword1">⟩</span>›</span> <span class="main">[</span>90<span class="main">,</span> 0<span class="main">,</span> 0<span class="main">]</span> 91<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main"><span class="free">⟨</span></span><span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main"><span class="free">:</span></span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main"><span class="free">⟩</span></span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">m</span><span class="main">.</span> <span class="keyword1">if</span> <span class="bound">m</span> <span class="main">&lt;</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="keyword1">then</span> <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="bound">m</span> <span class="keyword1">else</span> <span class="keyword1">if</span> <span class="bound">m</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="keyword1">then</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">else</span> <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="main">(</span><span class="bound">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>›</span></span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">semantics_tm</span> <span class="main">(</span><span class="quoted">‹<span class="keyword1">⦇</span>_<span class="keyword1">,</span> _<span class="keyword1">⦈</span>›</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⦇</span></span><span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main"><span class="free">,</span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main"><span class="free">⦈</span></span><span class="main">(</span><span class="main"><span class="hidden">❙</span><b>#</b></span><span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">E</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⦇</span></span><span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main"><span class="free">,</span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main"><span class="free">⦈</span></span><span class="main">(</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">ts</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span>map <span class="main"><span class="free">⦇</span></span><span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main"><span class="free">,</span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main"><span class="free">⦈</span></span> <span class="free"><span class="bound"><span class="entity">ts</span></span></span><span class="main">)</span>›</span></span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">semantics_fm</span> <span class="main">(</span><span class="quoted">‹<span class="keyword1">⟦</span>_<span class="keyword1">,</span> _<span class="keyword1">,</span> _<span class="keyword1">⟧</span>›</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⟦</span></span><span class="main"><span class="bound"><span class="entity">_</span></span></span><span class="main"><span class="free">,</span></span> <span class="main"><span class="bound"><span class="entity">_</span></span></span><span class="main"><span class="free">,</span></span> <span class="main"><span class="bound"><span class="entity">_</span></span></span><span class="main"><span class="free">⟧</span></span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span> <span class="main">=</span> False›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⟦</span></span><span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main"><span class="free">,</span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main"><span class="free">,</span></span> <span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main"><span class="free">⟧</span></span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="free"><span class="bound"><span class="entity">ts</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="main">(</span>map <span class="main">⦇</span><span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main">,</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">⦈</span> <span class="free"><span class="bound"><span class="entity">ts</span></span></span><span class="main">)</span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⟦</span></span><span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main"><span class="free">,</span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main"><span class="free">,</span></span> <span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main"><span class="free">⟧</span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main"><span class="free">⟦</span></span><span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main"><span class="free">,</span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main"><span class="free">,</span></span> <span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main"><span class="free">⟧</span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">⟶</span> <span class="main"><span class="free">⟦</span></span><span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main"><span class="free">,</span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main"><span class="free">,</span></span> <span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main"><span class="free">⟧</span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⟦</span></span><span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main"><span class="free">,</span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main"><span class="free">,</span></span> <span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main"><span class="free">⟧</span></span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="main"><span class="free">⟦</span></span><span class="free"><span class="bound"><span class="entity">E</span></span></span><span class="main">⟨</span><span class="main">0</span><span class="main">:</span><span class="bound">x</span><span class="main">⟩</span><span class="main"><span class="free">,</span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main"><span class="free">,</span></span> <span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main"><span class="free">⟧</span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span>›</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟦</span><span class="free">E</span><span class="main">,</span> <span class="free">F</span><span class="main">,</span> <span class="free">G</span><span class="main">⟧</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="free">P</span> <span class="main">[</span><span class="main"><span class="hidden">❙</span><b>#</b></span> <span class="main">0</span><span class="main">]</span><span class="main">)</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="free">P</span> <span class="main">[</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="free">a</span> <span class="main">[]</span><span class="main">]</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> shift_def<span class="main">)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Operations›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Shift›</span></span>

<span class="keyword1" id="FOL_Axiomatic-shift_eq"><span class="command">lemma</span></span> shift_eq <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">=</span> <span class="free">m</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">E</span><span class="main">⟨</span><span class="free">n</span><span class="main">:</span><span class="free">x</span><span class="main">⟩</span><span class="main">)</span> <span class="free">m</span> <span class="main">=</span> <span class="free">x</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> shift_def<span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-shift_gt"><span class="command">lemma</span></span> shift_gt <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">E</span><span class="main">⟨</span><span class="free">n</span><span class="main">:</span><span class="free">x</span><span class="main">⟩</span><span class="main">)</span> <span class="free">m</span> <span class="main">=</span> <span class="free">E</span> <span class="free">m</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> shift_def<span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-shift_lt"><span class="command">lemma</span></span> shift_lt <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">n</span> <span class="main">&lt;</span> <span class="free">m</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">E</span><span class="main">⟨</span><span class="free">n</span><span class="main">:</span><span class="free">x</span><span class="main">⟩</span><span class="main">)</span> <span class="free">m</span> <span class="main">=</span> <span class="free">E</span> <span class="main">(</span><span class="free">m</span><span class="main">-</span><span class="main">1</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> shift_def<span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-shift_commute"><span class="command">lemma</span></span> shift_commute <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">E</span><span class="main">⟨</span><span class="free">n</span><span class="main">:</span><span class="free">y</span><span class="main">⟩</span><span class="main">⟨</span><span class="main">0</span><span class="main">:</span><span class="free">x</span><span class="main">⟩</span> <span class="main">=</span> <span class="free">E</span><span class="main">⟨</span><span class="main">0</span><span class="main">:</span><span class="free">x</span><span class="main">⟩</span><span class="main">⟨</span><span class="free">n</span><span class="main">+</span><span class="main">1</span><span class="main">:</span><span class="free">y</span><span class="main">⟩</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">E</span><span class="main">⟨</span><span class="free">n</span><span class="main">:</span><span class="free">y</span><span class="main">⟩</span><span class="main">⟨</span><span class="main">0</span><span class="main">:</span><span class="free">x</span><span class="main">⟩</span><span class="main">)</span> <span class="skolem">m</span> <span class="main">=</span> <span class="main">(</span><span class="free">E</span><span class="main">⟨</span><span class="main">0</span><span class="main">:</span><span class="free">x</span><span class="main">⟩</span><span class="main">⟨</span><span class="free">n</span><span class="main">+</span><span class="main">1</span><span class="main">:</span><span class="free">y</span><span class="main">⟩</span><span class="main">)</span> <span class="skolem">m</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> shift_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">m</span></span><span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Parameters›</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">‹<span class="free">params</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">≡</span> <span class="main">⋃</span><span class="bound">p</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">.</span> params_fm <span class="bound">p</span>›</span></span>

<span class="keyword1" id="FOL_Axiomatic-upd_params_tm"><span class="command">lemma</span></span> upd_params_tm <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">∉</span> params_tm <span class="free">t</span> <span class="main">⟹</span> <span class="main">⦇</span><span class="free">E</span><span class="main">,</span> <span class="free">F</span><span class="main">(</span><span class="free">f</span> <span class="main">:=</span> <span class="free">x</span><span class="main">)</span><span class="main">⦈</span> <span class="free">t</span> <span class="main">=</span> <span class="main">⦇</span><span class="free">E</span><span class="main">,</span> <span class="free">F</span><span class="main">⦈</span> <span class="free">t</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">t</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">cong</span><span class="main"><span class="main">:</span></span> map_cong<span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-upd_params_fm"><span class="command">lemma</span></span> upd_params_fm <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">∉</span> params_fm <span class="free">p</span> <span class="main">⟹</span> <span class="main">⟦</span><span class="free">E</span><span class="main">,</span> <span class="free">F</span><span class="main">(</span><span class="free">f</span> <span class="main">:=</span> <span class="free">x</span><span class="main">)</span><span class="main">,</span> <span class="free">G</span><span class="main">⟧</span> <span class="free">p</span> <span class="main">=</span> <span class="main">⟦</span><span class="free">E</span><span class="main">,</span> <span class="free">F</span><span class="main">,</span> <span class="free">G</span><span class="main">⟧</span> <span class="free">p</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">p</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">E</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">cong</span><span class="main"><span class="main">:</span></span> map_cong<span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-finite_params_tm"><span class="command">lemma</span></span> finite_params_tm <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹finite <span class="main">(</span>params_tm <span class="free">t</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">t</span></span><span class="main">)</span> <span class="operator">simp_all</span>

<span class="keyword1" id="FOL_Axiomatic-finite_params_fm"><span class="command">lemma</span></span> finite_params_fm <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹finite <span class="main">(</span>params_fm <span class="free">p</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">p</span></span><span class="main">)</span> <span class="operator">simp_all</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Instantiation›</span></span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">lift_tm</span> <span class="main">(</span><span class="quoted">‹<span class="keyword1"><span class="hidden">❙</span><b>↑</b></span>›</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="main"><span class="free"><span class="hidden">❙</span><b>↑</b></span></span><span class="main">(</span><span class="main"><span class="hidden">❙</span><b>#</b></span><span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main"><span class="hidden">❙</span><b>#</b></span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">+</span><span class="main">1</span><span class="main">)</span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free"><span class="hidden">❙</span><b>↑</b></span></span><span class="main">(</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">ts</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main"><span class="hidden">❙</span><b>†</b></span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span>map <span class="main"><span class="free"><span class="hidden">❙</span><b>↑</b></span></span> <span class="free"><span class="bound"><span class="entity">ts</span></span></span><span class="main">)</span>›</span></span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">inst_tm</span> <span class="main">(</span><span class="quoted">‹_<span class="keyword1">'⟪</span>_<span class="keyword1">'/</span>_<span class="keyword1">'⟫</span>›</span> <span class="main">[</span>90<span class="main">,</span> 0<span class="main">,</span> 0<span class="main">]</span> 91<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>#</b></span><span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span><span class="main"><span class="free">⟪</span></span><span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main"><span class="free">/</span></span><span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main"><span class="free">⟫</span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">&lt;</span> <span class="free"><span class="bound"><span class="entity">m</span></span></span> <span class="keyword1">then</span> <span class="main"><span class="hidden">❙</span><b>#</b></span><span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="keyword1">else</span> <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">m</span></span></span> <span class="keyword1">then</span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="keyword1">else</span> <span class="main"><span class="hidden">❙</span><b>#</b></span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">ts</span></span></span><span class="main">)</span><span class="main"><span class="free">⟪</span></span><span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main"><span class="free">/</span></span><span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main"><span class="free">⟫</span></span> <span class="main">=</span> <span class="main"><span class="hidden">❙</span><b>†</b></span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span>map <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span><span class="main"><span class="free">⟪</span></span><span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main"><span class="free">/</span></span><span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main"><span class="free">⟫</span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">ts</span></span></span><span class="main">)</span>›</span></span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">inst_fm</span> <span class="main">(</span><span class="quoted">‹_<span class="keyword1">'⟨</span>_<span class="keyword1">'/</span>_<span class="keyword1">'⟩</span>›</span> <span class="main">[</span>90<span class="main">,</span> 0<span class="main">,</span> 0<span class="main">]</span> 91<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="main"><span class="hidden">❙</span><b>⊥</b></span><span class="main"><span class="free">⟨</span></span><span class="main"><span class="bound"><span class="entity">_</span></span></span><span class="main"><span class="free">/</span></span><span class="main"><span class="bound"><span class="entity">_</span></span></span><span class="main"><span class="free">⟩</span></span> <span class="main">=</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="free"><span class="bound"><span class="entity">ts</span></span></span><span class="main">)</span><span class="main"><span class="free">⟨</span></span><span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main"><span class="free">/</span></span><span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main"><span class="free">⟩</span></span> <span class="main">=</span> <span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="main">(</span>map <span class="main">(</span><span class="main">λ</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span><span class="main">⟪</span><span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main">/</span><span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">⟫</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">ts</span></span></span><span class="main">)</span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span><span class="main"><span class="free">⟨</span></span><span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main"><span class="free">/</span></span><span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main"><span class="free">⟩</span></span> <span class="main">=</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main"><span class="free">⟨</span></span><span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main"><span class="free">/</span></span><span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main"><span class="free">⟩</span></span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main"><span class="free">⟨</span></span><span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main"><span class="free">/</span></span><span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span><span class="main"><span class="free">⟨</span></span><span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main"><span class="free">/</span></span><span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main"><span class="free">⟩</span></span> <span class="main">=</span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main"><span class="free">⟨</span></span><span class="main"><span class="hidden">❙</span><b>↑</b></span><span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main"><span class="free">/</span></span><span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">+</span><span class="main">1</span><span class="main"><span class="free">⟩</span></span><span class="main">)</span>›</span></span>

<span class="keyword1" id="FOL_Axiomatic-lift_lemma"><span class="command">lemma</span></span> lift_lemma <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">⦇</span><span class="free">E</span><span class="main">⟨</span><span class="main">0</span><span class="main">:</span><span class="free">x</span><span class="main">⟩</span><span class="main">,</span> <span class="free">F</span><span class="main">⦈</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>↑</b></span><span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="main">⦇</span><span class="free">E</span><span class="main">,</span> <span class="free">F</span><span class="main">⦈</span> <span class="free">t</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">t</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">cong</span><span class="main"><span class="main">:</span></span> map_cong<span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-inst_tm_semantics"><span class="command">lemma</span></span> inst_tm_semantics <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">⦇</span><span class="free">E</span><span class="main">,</span> <span class="free">F</span><span class="main">⦈</span> <span class="main">(</span><span class="free">t</span><span class="main">⟪</span><span class="free">s</span><span class="main">/</span><span class="free">m</span><span class="main">⟫</span><span class="main">)</span> <span class="main">=</span> <span class="main">⦇</span><span class="free">E</span><span class="main">⟨</span><span class="free">m</span><span class="main">:</span><span class="main">⦇</span><span class="free">E</span><span class="main">,</span> <span class="free">F</span><span class="main">⦈</span> <span class="free">s</span><span class="main">⟩</span><span class="main">,</span> <span class="free">F</span><span class="main">⦈</span> <span class="free">t</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">t</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">cong</span><span class="main"><span class="main">:</span></span> map_cong<span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-inst_fm_semantics"><span class="command">lemma</span></span> inst_fm_semantics <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">⟦</span><span class="free">E</span><span class="main">,</span> <span class="free">F</span><span class="main">,</span> <span class="free">G</span><span class="main">⟧</span> <span class="main">(</span><span class="free">p</span><span class="main">⟨</span><span class="free">t</span><span class="main">/</span><span class="free">m</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> <span class="main">⟦</span><span class="free">E</span><span class="main">⟨</span><span class="free">m</span><span class="main">:</span><span class="main">⦇</span><span class="free">E</span><span class="main">,</span> <span class="free">F</span><span class="main">⦈</span> <span class="free">t</span><span class="main">⟩</span><span class="main">,</span> <span class="free">F</span><span class="main">,</span> <span class="free">G</span><span class="main">⟧</span> <span class="free">p</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">p</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">E</span></span> <span class="quoted"><span class="free">m</span></span> <span class="quoted"><span class="free">t</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">cong</span><span class="main"><span class="main">:</span></span> map_cong<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Size›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The built-in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>size›</span></span></span></span> is not invariant under substitution.›</span></span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">size_fm</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">size_fm</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span> <span class="main">=</span> <span class="main">1</span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="free">size_fm</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="main"><span class="bound"><span class="entity">_</span></span></span> <span class="main"><span class="bound"><span class="entity">_</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="free">size_fm</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="free">size_fm</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">+</span> <span class="free">size_fm</span> <span class="free"><span class="bound"><span class="entity">q</span></span></span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="free">size_fm</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span> <span class="main">+</span> <span class="free">size_fm</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span>›</span></span>

<span class="keyword1" id="FOL_Axiomatic-size_inst_fm"><span class="command">lemma</span></span> size_inst_fm <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">‹size_fm <span class="main">(</span><span class="free">p</span><span class="main">⟨</span><span class="free">t</span><span class="main">/</span><span class="free">m</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> size_fm <span class="free">p</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">p</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">m</span></span> <span class="quoted"><span class="free">t</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Propositional Semantics›</span></span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">boolean</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">boolean</span> <span class="main"><span class="bound"><span class="entity">_</span></span></span> <span class="main"><span class="bound"><span class="entity">_</span></span></span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span> <span class="main">=</span> False›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="free">boolean</span> <span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="main"><span class="bound"><span class="entity">_</span></span></span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="free"><span class="bound"><span class="entity">ts</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="free"><span class="bound"><span class="entity">ts</span></span></span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="free">boolean</span> <span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">boolean</span> <span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">⟶</span> <span class="free">boolean</span> <span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="free">boolean</span> <span class="main"><span class="bound"><span class="entity">_</span></span></span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span>›</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">‹<span class="free">tautology</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">G</span> <span class="bound">H</span><span class="main">.</span> boolean <span class="bound">G</span> <span class="bound">H</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span>›</span></span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">‹tautology <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="free">P</span> <span class="main">[</span><span class="main"><span class="hidden">❙</span><b>#</b></span><span class="main">0</span><span class="main">]</span><span class="main">)</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="free">P</span> <span class="main">[</span><span class="main"><span class="hidden">❙</span><b>#</b></span><span class="main">0</span><span class="main">]</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="FOL_Axiomatic-boolean_semantics"><span class="command">lemma</span></span> boolean_semantics<span class="main">:</span> <span class="quoted"><span class="quoted">‹boolean <span class="main">(</span><span class="main">λ</span><span class="bound">a</span><span class="main">.</span> <span class="free">G</span> <span class="bound">a</span> <span class="main">∘</span> map <span class="main">⦇</span><span class="free">E</span><span class="main">,</span> <span class="free">F</span><span class="main">⦈</span><span class="main">)</span> <span class="main">⟦</span><span class="free">E</span><span class="main">,</span> <span class="free">F</span><span class="main">,</span> <span class="free">G</span><span class="main">⟧</span> <span class="main">=</span> <span class="main">⟦</span><span class="free">E</span><span class="main">,</span> <span class="free">F</span><span class="main">,</span> <span class="free">G</span><span class="main">⟧</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹boolean <span class="main">(</span><span class="main">λ</span><span class="bound">a</span><span class="main">.</span> <span class="free">G</span> <span class="bound">a</span> <span class="main">∘</span> map <span class="main">⦇</span><span class="free">E</span><span class="main">,</span> <span class="free">F</span><span class="main">⦈</span><span class="main">)</span> <span class="main">⟦</span><span class="free">E</span><span class="main">,</span> <span class="free">F</span><span class="main">,</span> <span class="free">G</span><span class="main">⟧</span> <span class="skolem">p</span> <span class="main">=</span> <span class="main">⟦</span><span class="free">E</span><span class="main">,</span> <span class="free">F</span><span class="main">,</span> <span class="free">G</span><span class="main">⟧</span> <span class="skolem">p</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">p</span></span><span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="FOL_Axiomatic-tautology"><span class="command">lemma</span></span> tautology<span class="main">:</span> <span class="quoted"><span class="quoted">‹tautology <span class="free">p</span> <span class="main">⟹</span> <span class="main">⟦</span><span class="free">E</span><span class="main">,</span> <span class="free">F</span><span class="main">,</span> <span class="free">G</span><span class="main">⟧</span> <span class="free">p</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> boolean_semantics <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>

<span class="keyword1"><span class="command">proposition</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">p</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">E</span> <span class="bound">F</span> <span class="bound">G</span><span class="main">.</span> <span class="main">⟦</span><span class="bound">E</span><span class="main">,</span> <span class="bound">F</span><span class="main">,</span> <span class="bound">G</span><span class="main">⟧</span> <span class="bound">p</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¬</span> tautology <span class="bound">p</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> boolean.simps<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> fm.simps<span class="main"><span class="main">(</span></span>36<span class="main"><span class="main">)</span></span> semantics_fm.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>3<span class="main"><span class="main">,</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Calculus›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Adapted from System Q1 by Smullyan in First-Order Logic (1968)›</span></span>

<span class="keyword1"><span class="command">inductive</span></span> <span class="entity">Axiomatic</span> <span class="main">(</span><span class="quoted">‹<span class="keyword1">⊢</span> _›</span> <span class="main">[</span>20<span class="main">]</span> 20<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  TA<span class="main">:</span> <span class="quoted"><span class="quoted">‹tautology <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">⟹</span> <span class="main"><span class="free">⊢</span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span>›</span></span>
<span class="main">|</span> IA<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊢</span></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">⟨</span><span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span>›</span></span>
<span class="main">|</span> MP<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊢</span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="main">⟹</span> <span class="main"><span class="free">⊢</span></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">⟹</span> <span class="main"><span class="free">⊢</span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span>›</span></span>
<span class="main">|</span> GR<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊢</span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">⟨</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="main">[]</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span> <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="main">∉</span> params <span class="main">{</span><span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">,</span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">}</span> <span class="main">⟹</span> <span class="main"><span class="free">⊢</span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span>›</span></span>

<span class="keyword1"><span class="command">lemmas</span></span>
  TA<span class="main">[</span><span class="operator">simp</span><span class="main">]</span>
  MP<span class="main">[</span><span class="operator">trans</span><span class="main">,</span> <span class="operator">dest</span><span class="main">]</span>
  GR<span class="main">[</span><span class="operator">intro</span><span class="main">]</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We simulate assumptions on the lhs of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>⊢›</span></span></span></span> with a chain of implications on the rhs.›</span></span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">imply</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">‹<span class="keyword1"><span class="hidden">❙</span><b>↝</b></span>›</span> 26<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">[]</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>↝</b></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">q</span></span></span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">#</span> <span class="free"><span class="bound"><span class="entity">ps</span></span></span> <span class="main"><span class="free"><span class="hidden">❙</span><b>↝</b></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free"><span class="bound"><span class="entity">ps</span></span></span> <span class="main"><span class="free"><span class="hidden">❙</span><b>↝</b></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">)</span>›</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">Axiomatic_assms</span> <span class="main">(</span><span class="quoted">‹_ <span class="keyword1">⊢</span> _›</span> <span class="main">[</span>20<span class="main">,</span> 20<span class="main">]</span> 20<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free"><span class="bound"><span class="entity">ps</span></span></span> <span class="main"><span class="free">⊢</span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="main">≡</span> <span class="main">⊢</span> <span class="free"><span class="bound"><span class="entity">ps</span></span></span> <span class="main"><span class="hidden">❙</span><b>↝</b></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span>›</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Soundness›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> soundness<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="free">p</span> <span class="main">⟹</span> <span class="main">⟦</span><span class="free">E</span><span class="main">,</span> <span class="free">F</span><span class="main">,</span> <span class="free">G</span><span class="main">⟧</span> <span class="free">p</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">p</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">F</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> Axiomatic.induct<span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>GR <span class="skolem">q</span> <span class="skolem">p</span> <span class="skolem">a</span><span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> this
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟦</span><span class="free">E</span><span class="main">,</span> <span class="skolem">F</span><span class="main">(</span><span class="skolem">a</span> <span class="main">:=</span> <span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="free">G</span><span class="main">⟧</span> <span class="main">(</span><span class="skolem">q</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="skolem">p</span><span class="main">⟨</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="skolem">a</span> <span class="main">[]</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> tautology<span class="main">)</span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> soundness <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Derived Rules›</span></span>

<span class="keyword1" id="FOL_Axiomatic-AS"><span class="command">lemma</span></span> AS<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">q</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">r</span><span class="main">)</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">q</span><span class="main">)</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">r</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="FOL_Axiomatic-AK"><span class="command">lemma</span></span> AK<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="free">q</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">q</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="FOL_Axiomatic-Neg"><span class="command">lemma</span></span> Neg<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">p</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="FOL_Axiomatic-contraposition"><span class="command">lemma</span></span> contraposition<span class="main">:</span>
  <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">q</span><span class="main">)</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">q</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">p</span>›</span></span>
  <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">q</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">p</span><span class="main">)</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">q</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> TA<span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-GR'"><span class="command">lemma</span></span> GR'<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">p</span><span class="main">⟨</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="free">a</span> <span class="main">[]</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">a</span> <span class="main">∉</span> params <span class="main">{</span><span class="free">p</span><span class="main">,</span> <span class="free">q</span><span class="main">}</span> <span class="main">⟹</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">q</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> *<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">p</span><span class="main">⟨</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="free">a</span> <span class="main">[]</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">q</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">a</span> <span class="main">∉</span> params <span class="main">{</span><span class="free">p</span><span class="main">,</span> <span class="free">q</span><span class="main">}</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">q</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">p</span><span class="main">⟨</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="free">a</span> <span class="main">[]</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> * contraposition<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">q</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">p</span><span class="main">⟨</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="free">a</span> <span class="main">[]</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AK AS MP Neg<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">q</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free">p</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">q</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> contraposition<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AK AS MP Neg<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="FOL_Axiomatic-Imp3"><span class="command">lemma</span></span> Imp3<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">q</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">r</span><span class="main">)</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="main">(</span><span class="main">(</span><span class="free">s</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">p</span><span class="main">)</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="main">(</span><span class="free">s</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">q</span><span class="main">)</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">s</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">r</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="FOL_Axiomatic-imply_ImpE"><span class="command">lemma</span></span> imply_ImpE<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="free">ps</span> <span class="main"><span class="hidden">❙</span><b>↝</b></span> <span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">ps</span> <span class="main"><span class="hidden">❙</span><b>↝</b></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">q</span><span class="main">)</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">ps</span> <span class="main"><span class="hidden">❙</span><b>↝</b></span> <span class="free">q</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">ps</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> Imp3 MP<span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-MP'"><span class="command">lemma</span></span> MP' <span class="main">[</span><span class="operator">trans</span><span class="main">,</span> <span class="operator">dest</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">ps</span> <span class="main">⊢</span> <span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">ps</span> <span class="main">⊢</span> <span class="free">p</span> <span class="main">⟹</span> <span class="free">ps</span> <span class="main">⊢</span> <span class="free">q</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> imply_ImpE <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>

<span class="keyword1" id="FOL_Axiomatic-imply_Cons"><span class="command">lemma</span></span> imply_Cons <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">ps</span> <span class="main">⊢</span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">p</span> <span class="main">#</span> <span class="free">ps</span> <span class="main">⊢</span> <span class="free">q</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> MP AK<span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-imply_head"><span class="command">lemma</span></span> imply_head <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">p</span> <span class="main">#</span> <span class="free">ps</span> <span class="main">⊢</span> <span class="free">p</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">ps</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Cons <span class="skolem">q</span> <span class="skolem">ps</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AK MP' imply.simps<span class="main"><span class="main">(</span></span>1-2<span class="main"><span class="main">)</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="operator">auto</span>

<span class="keyword1" id="FOL_Axiomatic-imply_lift_Imp"><span class="command">lemma</span></span> imply_lift_Imp <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">q</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">ps</span> <span class="main"><span class="hidden">❙</span><b>↝</b></span> <span class="free">q</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms MP MP' imply_head <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> imply.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-add_imply"><span class="command">lemma</span></span> add_imply <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">ps</span> <span class="main">⊢</span> <span class="free">q</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> MP imply_head <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> TA<span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-imply_mem"><span class="command">lemma</span></span> imply_mem <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">p</span> <span class="main">∈</span> set <span class="free">ps</span> <span class="main">⟹</span> <span class="free">ps</span> <span class="main">⊢</span> <span class="free">p</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">ps</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Cons <span class="skolem">q</span> <span class="skolem">ps</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> imply_Cons imply_head set_ConsD<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="operator">simp</span>

<span class="keyword1" id="FOL_Axiomatic-deduct1"><span class="command">lemma</span></span> deduct1<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">ps</span> <span class="main">⊢</span> <span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">p</span> <span class="main">#</span> <span class="free">ps</span> <span class="main">⊢</span> <span class="free">q</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> MP' imply_Cons imply_head<span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-imply_append"><span class="command">lemma</span></span> imply_append <span class="main">[</span><span class="operator">iff</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">ps</span> <span class="main">@</span> <span class="free">qs</span> <span class="main"><span class="hidden">❙</span><b>↝</b></span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">ps</span> <span class="main"><span class="hidden">❙</span><b>↝</b></span> <span class="free">qs</span> <span class="main"><span class="hidden">❙</span><b>↝</b></span> <span class="free">r</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">ps</span></span><span class="main">)</span> <span class="operator">simp_all</span>

<span class="keyword1" id="FOL_Axiomatic-imply_swap_append"><span class="command">lemma</span></span> imply_swap_append<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">ps</span> <span class="main">@</span> <span class="free">qs</span> <span class="main">⊢</span> <span class="free">r</span> <span class="main">⟹</span> <span class="free">qs</span> <span class="main">@</span> <span class="free">ps</span> <span class="main">⊢</span> <span class="free">r</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">qs</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">ps</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Cons <span class="skolem">q</span> <span class="skolem">qs</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> deduct1 imply.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> imply_append<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="operator">simp</span>

<span class="keyword1" id="FOL_Axiomatic-deduct2"><span class="command">lemma</span></span> deduct2<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">p</span> <span class="main">#</span> <span class="free">ps</span> <span class="main">⊢</span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">ps</span> <span class="main">⊢</span> <span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">q</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> imply.simps<span class="main"><span class="main">(</span></span>1-2<span class="main"><span class="main">)</span></span> imply_append imply_swap_append<span class="main">)</span>

<span class="keyword1"><span class="command">lemmas</span></span> deduct <span class="main">[</span><span class="operator">iff</span><span class="main">]</span> <span class="main">=</span> deduct1 deduct2

<span class="keyword1" id="FOL_Axiomatic-cut"><span class="command">lemma</span></span> cut <span class="main">[</span><span class="operator">trans</span><span class="main">,</span> <span class="operator">dest</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">p</span> <span class="main">#</span> <span class="free">ps</span> <span class="main">⊢</span> <span class="free">r</span> <span class="main">⟹</span> <span class="free">q</span> <span class="main">#</span> <span class="free">ps</span> <span class="main">⊢</span> <span class="free">p</span> <span class="main">⟹</span> <span class="free">q</span> <span class="main">#</span> <span class="free">ps</span> <span class="main">⊢</span> <span class="free">r</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> MP' deduct<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> imply_Cons<span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-Boole"><span class="command">lemma</span></span> Boole<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">p</span><span class="main">)</span> <span class="main">#</span> <span class="free">ps</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span> <span class="main">⟹</span> <span class="free">ps</span> <span class="main">⊢</span> <span class="free">p</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> MP' Neg add_imply deduct<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-imply_weaken"><span class="command">lemma</span></span> imply_weaken<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">ps</span> <span class="main">⊢</span> <span class="free">q</span> <span class="main">⟹</span> set <span class="free">ps</span> <span class="main">⊆</span> set <span class="free">ps'</span> <span class="main">⟹</span> <span class="free">ps'</span> <span class="main">⊢</span> <span class="free">q</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">ps</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">q</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Cons <span class="skolem">p</span> <span class="skolem">ps</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> MP' deduct<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> imply_mem insert_subset list.simps<span class="main"><span class="main">(</span></span>15<span class="main"><span class="main">)</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Consistent›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">‹<span class="free">consistent</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">≡</span> <span class="main">∄</span><span class="bound">S'</span><span class="main">.</span> set <span class="bound">S'</span> <span class="main">⊆</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">∧</span> <span class="main">(</span><span class="bound">S'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span><span class="main">)</span>›</span></span>

<span class="keyword1" id="FOL_Axiomatic-UN_finite_bound"><span class="command">lemma</span></span> UN_finite_bound<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹finite <span class="free">A</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">⊆</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">n</span><span class="main">.</span> <span class="free">f</span> <span class="bound">n</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">m</span> <span class="main">::</span> nat<span class="main">.</span> <span class="free">A</span> <span class="main">⊆</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">n</span> <span class="main">≤</span> <span class="bound">m</span><span class="main">.</span> <span class="free">f</span> <span class="bound">n</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> finite_induct<span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>insert <span class="skolem">x</span> <span class="skolem">A</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">⊆</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">n</span> <span class="main">≤</span> <span class="skolem">m</span><span class="main">.</span> <span class="free">f</span> <span class="bound">n</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">⊆</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">n</span> <span class="main">≤</span> <span class="main">(</span><span class="skolem">m</span> <span class="main">+</span> <span class="skolem">k</span><span class="main">)</span><span class="main">.</span> <span class="free">f</span> <span class="bound">n</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">k</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="free">f</span> <span class="skolem">m'</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> insert<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">∪</span> <span class="skolem">A</span> <span class="main">⊆</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">n</span> <span class="main">≤</span> <span class="skolem">m</span> <span class="main">+</span> <span class="skolem">m'</span><span class="main">.</span> <span class="free">f</span> <span class="bound">n</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="operator">simp</span>

<span class="keyword1" id="FOL_Axiomatic-split_list"><span class="command">lemma</span></span> split_list<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">x</span> <span class="main">∈</span> set <span class="free">A</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹set <span class="main">(</span><span class="free">x</span> <span class="main">#</span> removeAll <span class="free">x</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> set <span class="free">A</span> <span class="main">∧</span> <span class="free">x</span> <span class="main">∉</span> set <span class="main">(</span>removeAll <span class="free">x</span> <span class="free">A</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="FOL_Axiomatic-imply_params_fm"><span class="command">lemma</span></span> imply_params_fm<span class="main">:</span> <span class="quoted"><span class="quoted">‹params_fm <span class="main">(</span><span class="free">ps</span> <span class="main"><span class="hidden">❙</span><b>↝</b></span> <span class="free">q</span><span class="main">)</span> <span class="main">=</span> params_fm <span class="free">q</span> <span class="main">∪</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">p</span> <span class="main">∈</span> set <span class="free">ps</span><span class="main">.</span> params_fm <span class="bound">p</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">ps</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1" id="FOL_Axiomatic-inconsistent_fm"><span class="command">lemma</span></span> inconsistent_fm<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> consistent <span class="main">(</span><span class="main">{</span><span class="free">p</span><span class="main">}</span> <span class="main">∪</span> <span class="free">S</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">obtains</span></span> <span class="free">S'</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹set <span class="free">S'</span> <span class="main">⊆</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">p</span> <span class="main">#</span> <span class="free">S'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">S'</span></span> <span class="keyword2"><span class="keyword">where</span></span> S'<span class="main">:</span> <span class="quoted"><span class="quoted">‹set <span class="skolem">S'</span> <span class="main">⊆</span> <span class="main">{</span><span class="free">p</span><span class="main">}</span> <span class="main">∪</span> <span class="free">S</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">p</span> <span class="main">∈</span> set <span class="skolem">S'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">S'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> consistent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">S''</span></span> <span class="keyword2"><span class="keyword">where</span></span> S''<span class="main">:</span> <span class="quoted"><span class="quoted">‹set <span class="main">(</span><span class="free">p</span> <span class="main">#</span> <span class="skolem">S''</span><span class="main">)</span> <span class="main">=</span> set <span class="skolem">S'</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">p</span> <span class="main">∉</span> set <span class="skolem">S''</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> split_list <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">p</span> <span class="main">#</span> <span class="skolem">S''</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">S'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span> imply_weaken <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> that S'' S'<span class="main">(</span>1<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Diff_insert_absorb Diff_subset_conv list.simps<span class="main"><span class="main">(</span></span>15<span class="main"><span class="main">)</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="FOL_Axiomatic-consistent_add_witness"><span class="command">lemma</span></span> consistent_add_witness<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free">p</span><span class="main">)</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">a</span> <span class="main">∉</span> params <span class="free">S</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="main">(</span><span class="main">{</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">p</span><span class="main">⟨</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="free">a</span> <span class="main">[]</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span><span class="main">}</span> <span class="main">∪</span> <span class="free">S</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> consistent_def
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">S'</span><span class="main">.</span> set <span class="bound">S'</span> <span class="main">⊆</span> <span class="main">{</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">p</span><span class="main">⟨</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="free">a</span> <span class="main">[]</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span><span class="main">}</span> <span class="main">∪</span> <span class="free">S</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">S'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">S'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹set <span class="skolem">S'</span> <span class="main">⊆</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">p</span><span class="main">⟨</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="free">a</span> <span class="main">[]</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span><span class="main">)</span> <span class="main">#</span> <span class="skolem">S'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms inconsistent_fm <span class="keyword1"><span class="command">unfolding</span></span> consistent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">p</span><span class="main">⟨</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="free">a</span> <span class="main">[]</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="skolem">S'</span> <span class="main"><span class="hidden">❙</span><b>↝</b></span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">a</span> <span class="main">∉</span> params_fm <span class="free">p</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2-3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">p</span> <span class="main">∈</span> set <span class="skolem">S'</span><span class="main">.</span> <span class="free">a</span> <span class="main">∉</span> params_fm <span class="bound">p</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹set <span class="skolem">S'</span> <span class="main">⊆</span> <span class="free">S</span>›</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">a</span> <span class="main">∉</span> params_fm <span class="main">(</span><span class="skolem">S'</span> <span class="main"><span class="hidden">❙</span><b>↝</b></span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> imply_params_fm<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="skolem">S'</span> <span class="main"><span class="hidden">❙</span><b>↝</b></span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> GR' <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free">p</span><span class="main">)</span> <span class="main">#</span> <span class="skolem">S'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹set <span class="main">(</span><span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free">p</span><span class="main">)</span> <span class="main">#</span> <span class="skolem">S'</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">S</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹set <span class="skolem">S'</span> <span class="main">⊆</span> <span class="free">S</span>›</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> consistent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="FOL_Axiomatic-consistent_add_instance"><span class="command">lemma</span></span> consistent_add_instance<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free">p</span> <span class="main">∈</span> <span class="free">S</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="main">(</span><span class="main">{</span><span class="free">p</span><span class="main">⟨</span><span class="free">t</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span><span class="main">}</span> <span class="main">∪</span> <span class="free">S</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> consistent_def
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">S'</span><span class="main">.</span> set <span class="bound">S'</span> <span class="main">⊆</span> <span class="main">{</span><span class="free">p</span><span class="main">⟨</span><span class="free">t</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span><span class="main">}</span> <span class="main">∪</span> <span class="free">S</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">S'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">S'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹set <span class="skolem">S'</span> <span class="main">⊆</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">p</span><span class="main">⟨</span><span class="free">t</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span> <span class="main">#</span> <span class="skolem">S'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms inconsistent_fm <span class="keyword1"><span class="command">unfolding</span></span> consistent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">p</span><span class="main">⟨</span><span class="free">t</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> IA <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free">p</span> <span class="main">#</span> <span class="skolem">S'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> add_imply cut deduct<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹set <span class="main">(</span><span class="main">(</span><span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free">p</span><span class="main">)</span> <span class="main">#</span> <span class="skolem">S'</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">S</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹set <span class="skolem">S'</span> <span class="main">⊆</span> <span class="free">S</span>›</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> consistent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Extension›</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">witness</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">witness</span> <span class="free"><span class="bound"><span class="entity">used</span></span></span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">⟨</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">a</span><span class="main">.</span> <span class="bound">a</span> <span class="main">∉</span> <span class="free"><span class="bound"><span class="entity">used</span></span></span><span class="main">)</span> <span class="main">[]</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span><span class="main">}</span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="free">witness</span> <span class="main"><span class="bound"><span class="entity">_</span></span></span> <span class="main"><span class="bound"><span class="entity">_</span></span></span> <span class="main">=</span> <span class="main">{}</span>›</span></span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">extend</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">extend</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">0</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="free">extend</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span>Suc <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="main">=</span>
   <span class="main">(</span><span class="keyword1">let</span> <span class="bound">Sn</span> <span class="main">=</span> <span class="free">extend</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="keyword1">in</span>
     <span class="keyword1">if</span> consistent <span class="main">(</span><span class="main">{</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">}</span> <span class="main">∪</span> <span class="bound">Sn</span><span class="main">)</span>
     <span class="keyword1">then</span> witness <span class="main">(</span>params <span class="main">(</span><span class="main">{</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">}</span> <span class="main">∪</span> <span class="bound">Sn</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">}</span> <span class="main">∪</span> <span class="bound">Sn</span>
     <span class="keyword1">else</span> <span class="bound">Sn</span><span class="main">)</span>›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Extend</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">≡</span> <span class="main">⋃</span><span class="bound">n</span><span class="main">.</span> extend <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="bound">n</span>›</span></span>

<span class="keyword1" id="FOL_Axiomatic-Extend_subset"><span class="command">lemma</span></span> Extend_subset<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">S</span> <span class="main">⊆</span> Extend <span class="free">S</span> <span class="free">f</span>›</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> Extend_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Union_upper extend.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> range_eqI<span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-extend_bound"><span class="command">lemma</span></span> extend_bound<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋃</span><span class="bound">n</span> <span class="main">≤</span> <span class="free">m</span><span class="main">.</span> extend <span class="free">S</span> <span class="free">f</span> <span class="bound">n</span><span class="main">)</span> <span class="main">=</span> extend <span class="free">S</span> <span class="free">f</span> <span class="free">m</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">m</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> atMost_Suc Let_def<span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-finite_params_witness"><span class="command">lemma</span></span> finite_params_witness <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹finite <span class="main">(</span>params <span class="main">(</span>witness <span class="free">used</span> <span class="free">p</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">used</span></span> <span class="quoted"><span class="free">p</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> witness.induct<span class="main">)</span> <span class="operator">simp_all</span>

<span class="keyword1" id="FOL_Axiomatic-finite_params_extend"><span class="command">lemma</span></span> finite_params_extend <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹finite <span class="main">(</span>params <span class="free">S</span><span class="main">)</span> <span class="main">⟹</span> finite <span class="main">(</span>params <span class="main">(</span>extend <span class="free">S</span> <span class="free">f</span> <span class="free">n</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def<span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-consistent_witness"><span class="command">lemma</span></span> consistent_witness<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">p</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'f</span><span class="main">,</span> <span class="tfree">'p</span><span class="main">)</span> fm›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">p</span> <span class="main">∈</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹params <span class="free">S</span> <span class="main">⊆</span> <span class="free">used</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="free">used</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹infinite <span class="main">(</span>UNIV <span class="main">::</span> <span class="tfree">'f</span> set<span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="main">(</span>witness <span class="free">used</span> <span class="free">p</span> <span class="main">∪</span> <span class="free">S</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">used</span></span> <span class="quoted"><span class="free">p</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> witness.induct<span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>1 <span class="skolem">used</span> <span class="skolem">p</span><span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="bound">a</span> <span class="main">∉</span> <span class="skolem">used</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1<span class="main">(</span>4-<span class="main">)</span> ex_new_if_finite <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> a<span class="main">:</span> <span class="quoted"><span class="quoted">‹witness <span class="skolem">used</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="skolem">p</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="skolem">p</span><span class="main">⟨</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="skolem">a</span> <span class="main">[]</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span><span class="main">}</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">∉</span> <span class="skolem">used</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> someI_ex witness.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">∉</span> params <span class="free">S</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> 1<span class="main">(</span>1-2<span class="main">)</span> a<span class="main">(</span>1<span class="main">)</span> consistent_add_witness <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> assms<span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-consistent_extend"><span class="command">lemma</span></span> consistent_extend<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹nat <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'f</span><span class="main">,</span> <span class="tfree">'p</span><span class="main">)</span> fm›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">(</span>params <span class="free">S</span><span class="main">)</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹infinite <span class="main">(</span>UNIV <span class="main">::</span> <span class="tfree">'f</span> set<span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="main">(</span>extend <span class="free">S</span> <span class="free">f</span> <span class="free">n</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> consistent_witness<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> S<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="free">f</span> <span class="skolem">n</span><span class="main">}</span> <span class="main">∪</span> <span class="main">_</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Let_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="operator">simp</span>

<span class="keyword1" id="FOL_Axiomatic-consistent_Extend"><span class="command">lemma</span></span> consistent_Extend<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹nat <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'f</span><span class="main">,</span> <span class="tfree">'p</span><span class="main">)</span> fm›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">(</span>params <span class="free">S</span><span class="main">)</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹infinite <span class="main">(</span>UNIV <span class="main">::</span> <span class="tfree">'f</span> set<span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="main">(</span>Extend <span class="free">S</span> <span class="free">f</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> consistent <span class="main">(</span>Extend <span class="free">S</span> <span class="free">f</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">S'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">S'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹set <span class="skolem">S'</span> <span class="main">⊆</span> Extend <span class="free">S</span> <span class="free">f</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> consistent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹set <span class="skolem">S'</span> <span class="main">⊆</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">n</span> <span class="main">≤</span> <span class="skolem">m</span><span class="main">.</span> extend <span class="free">S</span> <span class="free">f</span> <span class="bound">n</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> Extend_def <span class="keyword1"><span class="command">using</span></span> UN_finite_bound <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> List.finite_set<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹set <span class="skolem">S'</span> <span class="main">⊆</span> extend <span class="free">S</span> <span class="free">f</span> <span class="skolem">m</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> extend_bound <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="main">(</span>extend <span class="free">S</span> <span class="free">f</span> <span class="skolem">m</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms consistent_extend <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span>
    <span class="keyword1"><span class="command">unfolding</span></span> consistent_def <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">S'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Maximal›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">‹<span class="free">maximal</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">p</span><span class="main">.</span> <span class="bound">p</span> <span class="main">∉</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">⟶</span> <span class="main">¬</span> consistent <span class="main">(</span><span class="main">{</span><span class="bound">p</span><span class="main">}</span> <span class="main">∪</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span>›</span></span>

<span class="keyword1" id="FOL_Axiomatic-maximal_Extend"><span class="command">lemma</span></span> maximal_Extend<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹surj <span class="free">f</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹maximal <span class="main">(</span>Extend <span class="free">S</span> <span class="free">f</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> maximal <span class="main">(</span>Extend <span class="free">S</span> <span class="free">f</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    <span class="quoted"><span class="quoted">‹<span class="skolem">p</span> <span class="main">∉</span> Extend <span class="free">S</span> <span class="free">f</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="main">(</span><span class="main">{</span><span class="skolem">p</span><span class="main">}</span> <span class="main">∪</span> Extend <span class="free">S</span> <span class="free">f</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> maximal_def <span class="keyword1"><span class="command">using</span></span> assms consistent_Extend <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> k<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="skolem">k</span> <span class="main">=</span> <span class="skolem">p</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹surj <span class="free">f</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> surj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">p</span> <span class="main">∉</span> extend <span class="free">S</span> <span class="free">f</span> <span class="main">(</span>Suc <span class="skolem">k</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">p</span> <span class="main">∉</span> Extend <span class="free">S</span> <span class="free">f</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Extend_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> consistent <span class="main">(</span><span class="main">{</span><span class="skolem">p</span><span class="main">}</span> <span class="main">∪</span> extend <span class="free">S</span> <span class="free">f</span> <span class="skolem">k</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> k <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Let_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="skolem">p</span><span class="main">}</span> <span class="main">∪</span> extend <span class="free">S</span> <span class="free">f</span> <span class="skolem">k</span> <span class="main">⊆</span> <span class="main">{</span><span class="skolem">p</span><span class="main">}</span> <span class="main">∪</span> Extend <span class="free">S</span> <span class="free">f</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> Extend_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> consistent <span class="main">(</span><span class="main">{</span><span class="skolem">p</span><span class="main">}</span> <span class="main">∪</span> Extend <span class="free">S</span> <span class="free">f</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> consistent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="main">(</span><span class="main">{</span><span class="skolem">p</span><span class="main">}</span> <span class="main">∪</span> Extend <span class="free">S</span> <span class="free">f</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Saturation›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">‹<span class="free">saturated</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">p</span><span class="main">.</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="bound">p</span><span class="main">)</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="bound">p</span><span class="main">⟨</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="bound">a</span> <span class="main">[]</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span><span class="main">)</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span>›</span></span>

<span class="keyword1" id="FOL_Axiomatic-saturated_Extend"><span class="command">lemma</span></span> saturated_Extend<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="main">(</span>Extend <span class="free">S</span> <span class="free">f</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹surj <span class="free">f</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹saturated <span class="main">(</span>Extend <span class="free">S</span> <span class="free">f</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> saturated <span class="main">(</span>Extend <span class="free">S</span> <span class="free">f</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> p<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="skolem">p</span><span class="main">)</span> <span class="main">∈</span> Extend <span class="free">S</span> <span class="free">f</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∄</span><span class="bound">a</span><span class="main">.</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="skolem">p</span><span class="main">⟨</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="bound">a</span> <span class="main">[]</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span><span class="main">)</span> <span class="main">∈</span> Extend <span class="free">S</span> <span class="free">f</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> saturated_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> k<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="skolem">k</span> <span class="main">=</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="skolem">p</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹surj <span class="free">f</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> surj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>

  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹extend <span class="free">S</span> <span class="free">f</span> <span class="skolem">k</span> <span class="main">⊆</span> Extend <span class="free">S</span> <span class="free">f</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> Extend_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="main">(</span><span class="main">{</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="skolem">p</span><span class="main">}</span> <span class="main">∪</span> extend <span class="free">S</span> <span class="free">f</span> <span class="skolem">k</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> p<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> consistent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> extend <span class="free">S</span> <span class="free">f</span> <span class="main">(</span>Suc <span class="skolem">k</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="skolem">p</span><span class="main">⟨</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="bound">a</span> <span class="main">[]</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="skolem">p</span><span class="main">}</span> <span class="main">∪</span> extend <span class="free">S</span> <span class="free">f</span> <span class="skolem">k</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> k <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Let_def<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹extend <span class="free">S</span> <span class="free">f</span> <span class="main">(</span>Suc <span class="skolem">k</span><span class="main">)</span> <span class="main">⊆</span> Extend <span class="free">S</span> <span class="free">f</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> Extend_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span>
    <span class="keyword1"><span class="command">using</span></span> p<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Hintikka›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Hintikka <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">H</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'f</span><span class="main">,</span> <span class="tfree">'p</span><span class="main">)</span> fm set›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span>
    NoFalsity<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="hidden">❙</span><b>⊥</b></span> <span class="main">∉</span> <span class="free">H</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    Basic<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="free">P</span> <span class="free">ts</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">⟹</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="free">P</span> <span class="free">ts</span><span class="main">)</span> <span class="main">∉</span> <span class="free">H</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    ImpP<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">q</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">⟹</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">p</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">∨</span> <span class="free">q</span> <span class="main">∈</span> <span class="free">H</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    ImpN<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">⟹</span> <span class="free">p</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">∧</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">q</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    UniP<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free">p</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">⟹</span> <span class="main">∀</span><span class="bound">t</span><span class="main">.</span> <span class="free">p</span><span class="main">⟨</span><span class="bound">t</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">H</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    UniN<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="free">p</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">p</span><span class="main">⟨</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="bound">a</span> <span class="main">[]</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Model Existence›</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="free">sat</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="free"><span class="bound"><span class="entity">ts</span></span></span> <span class="main">≡</span> Pre <span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="free"><span class="bound"><span class="entity">ts</span></span></span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span>›</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">hmodel</span> <span class="main">(</span><span class="quoted">‹<span class="keyword1">⟦</span>_<span class="keyword1">⟧</span>›</span><span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⟦</span></span><span class="free"><span class="bound"><span class="entity">H</span></span></span><span class="main"><span class="free">⟧</span></span> <span class="main">≡</span> <span class="main">⟦</span><span class="main"><span class="hidden">❙</span><b>#</b></span><span class="main">,</span> <span class="main"><span class="hidden">❙</span><b>†</b></span><span class="main">,</span> sat <span class="free"><span class="bound"><span class="entity">H</span></span></span><span class="main">⟧</span>›</span></span>

<span class="keyword1" id="FOL_Axiomatic-semantics_tm_id"><span class="command">lemma</span></span> semantics_tm_id <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">‹<span class="main">⦇</span><span class="main"><span class="hidden">❙</span><b>#</b></span><span class="main">,</span> <span class="main"><span class="hidden">❙</span><b>†</b></span><span class="main">⦈</span> <span class="free">t</span> <span class="main">=</span> <span class="free">t</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">t</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">cong</span><span class="main"><span class="main">:</span></span> map_cong<span class="main">)</span>

<span class="keyword1" id="FOL_Axiomatic-semantics_tm_id_map"><span class="command">lemma</span></span> semantics_tm_id_map <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹map <span class="main">⦇</span><span class="main"><span class="hidden">❙</span><b>#</b></span><span class="main">,</span> <span class="main"><span class="hidden">❙</span><b>†</b></span><span class="main">⦈</span> <span class="free">ts</span> <span class="main">=</span> <span class="free">ts</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">cong</span><span class="main"><span class="main">:</span></span> map_cong<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> Hintikka_model<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹Hintikka <span class="free">H</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">p</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">⟶</span> <span class="main">⟦</span><span class="free">H</span><span class="main">⟧</span> <span class="free">p</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">p</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">⟶</span> <span class="main">¬</span> <span class="main">⟦</span><span class="free">H</span><span class="main">⟧</span> <span class="free">p</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">p</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> wf_induct<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> r<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">‹measure size_fm›</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> 1
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">..</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> ih<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">q</span><span class="main">.</span> <span class="main">(</span><span class="bound">q</span><span class="main">,</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> measure size_fm <span class="main">⟶</span> <span class="main">(</span><span class="bound">q</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">⟶</span> <span class="main">⟦</span><span class="free">H</span><span class="main">⟧</span> <span class="bound">q</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="bound">q</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">⟶</span> <span class="main">¬</span> <span class="main">⟦</span><span class="free">H</span><span class="main">⟧</span> <span class="bound">q</span><span class="main">)</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">x</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">⟶</span> <span class="main">⟦</span><span class="free">H</span><span class="main">⟧</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">⟶</span> <span class="main">¬</span> <span class="main">⟦</span><span class="free">H</span><span class="main">⟧</span> <span class="skolem">x</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="skolem">x</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">safe</span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> notI<span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> Falsity
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="hidden">❙</span><b>⊥</b></span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span>
      <span class="keyword1"><span class="command">using</span></span> assms Hintikka.NoFalsity <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟦</span><span class="free">H</span><span class="main">⟧</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> Falsity
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">⟦</span><span class="free">H</span><span class="main">⟧</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Pre <span class="skolem">P</span> <span class="skolem">ts</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="skolem">P</span> <span class="skolem">ts</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟦</span><span class="free">H</span><span class="main">⟧</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="skolem">P</span> <span class="skolem">ts</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Pre <span class="skolem">P</span> <span class="skolem">ts</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="skolem">P</span> <span class="skolem">ts</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> sat <span class="free">H</span> <span class="skolem">P</span> <span class="skolem">ts</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms Hintikka.Basic <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">⟦</span><span class="free">H</span><span class="main">⟧</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="skolem">P</span> <span class="skolem">ts</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Imp <span class="skolem">p</span> <span class="skolem">q</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="skolem">p</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">∨</span> <span class="skolem">q</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms Hintikka.ImpP <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟦</span><span class="free">H</span><span class="main">⟧</span> <span class="main">(</span><span class="skolem">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="skolem">q</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> ih Imp <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Imp <span class="skolem">p</span> <span class="skolem">q</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main">(</span><span class="skolem">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="skolem">q</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">p</span> <span class="main">∈</span> <span class="free">H</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms Hintikka.ImpN <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">⟦</span><span class="free">H</span><span class="main">⟧</span> <span class="main">(</span><span class="skolem">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="skolem">q</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> ih Imp <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Uni <span class="skolem">p</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="skolem">p</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">⟨</span><span class="bound">t</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms Hintikka.UniP <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">⟨</span><span class="skolem">t</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span><span class="main">,</span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="skolem">p</span><span class="main">)</span> <span class="main">∈</span> measure size_fm›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">t</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">t</span><span class="main">.</span> <span class="main">⟦</span><span class="free">H</span><span class="main">⟧</span> <span class="main">(</span><span class="skolem">p</span><span class="main">⟨</span><span class="bound">t</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> ih Uni <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟦</span><span class="free">H</span><span class="main">⟧</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="skolem">p</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Uni <span class="skolem">p</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="skolem">p</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="skolem">p</span><span class="main">⟨</span><span class="bound">t</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms Hintikka.UniN <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span><span class="main">⟨</span><span class="skolem">t</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span><span class="main">,</span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="skolem">p</span><span class="main">)</span> <span class="main">∈</span> measure size_fm›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">t</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="main">¬</span> <span class="main">⟦</span><span class="free">H</span><span class="main">⟧</span> <span class="main">(</span><span class="skolem">p</span><span class="main">⟨</span><span class="bound">t</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> ih Uni <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">⟦</span><span class="free">H</span><span class="main">⟧</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="skolem">p</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Maximal Consistent Sets are Hintikka Sets›</span></span>

<span class="keyword1" id="FOL_Axiomatic-inconsistent_head"><span class="command">lemma</span></span> inconsistent_head<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹maximal <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">p</span> <span class="main">∉</span> <span class="free">S</span>›</span></span>
  <span class="keyword2"><span class="keyword">obtains</span></span> <span class="free">S'</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹set <span class="free">S'</span> <span class="main">⊆</span> <span class="free">S</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">p</span> <span class="main">#</span> <span class="free">S'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms inconsistent_fm <span class="keyword1"><span class="command">unfolding</span></span> consistent_def maximal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>

<span class="keyword1" id="FOL_Axiomatic-inconsistent_parts"><span class="command">lemma</span></span> inconsistent_parts <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">ps</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹set <span class="free">ps</span> <span class="main">⊆</span> <span class="free">S</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> consistent <span class="free">S</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> consistent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="FOL_Axiomatic-Hintikka_Extend"><span class="command">lemma</span></span> Hintikka_Extend<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">H</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'f</span><span class="main">,</span> <span class="tfree">'p</span><span class="main">)</span> fm set›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="free">H</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹maximal <span class="free">H</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹saturated <span class="free">H</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹infinite <span class="main">(</span>UNIV <span class="main">::</span> <span class="tfree">'f</span> set<span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹Hintikka <span class="free">H</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="hidden">❙</span><b>⊥</b></span> <span class="main">∉</span> <span class="free">H</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="hidden">❙</span><b>⊥</b></span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">[</span><span class="main"><span class="hidden">❙</span><b>⊥</b></span><span class="main">]</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> consistent <span class="free">H</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> inconsistent_parts<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> ps<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">‹<span class="main">[</span><span class="main"><span class="hidden">❙</span><b>⊥</b></span><span class="main">]</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="free">H</span>›</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">P</span> <span class="skolem">ts</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="skolem">P</span> <span class="skolem">ts</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="skolem">P</span> <span class="skolem">ts</span><span class="main">)</span> <span class="main">∉</span> <span class="free">H</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>‡</b></span> <span class="skolem">P</span> <span class="skolem">ts</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">[</span><span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="skolem">P</span> <span class="skolem">ts</span><span class="main">,</span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="skolem">P</span> <span class="skolem">ts</span><span class="main">]</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> consistent <span class="free">H</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="hidden">❙</span><b>‡</b></span><span class="skolem">P</span> <span class="skolem">ts</span> <span class="main">∈</span> <span class="free">H</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="free">H</span>›</span></span> <span class="keyword1"><span class="command">..</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p</span> <span class="skolem">q</span>
  <span class="keyword3"><span class="command">assume</span></span> *<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="skolem">p</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">∨</span> <span class="skolem">q</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> disjCI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">q</span> <span class="main">∉</span> <span class="free">H</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Hq'</span></span> <span class="keyword2"><span class="keyword">where</span></span> Hq'<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">q</span> <span class="main">#</span> <span class="skolem">Hq'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span> <span class="quoted"><span class="quoted">‹set <span class="skolem">Hq'</span> <span class="main">⊆</span> <span class="free">H</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms inconsistent_head <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>

    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="skolem">p</span><span class="main">)</span> <span class="main">∉</span> <span class="free">H</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Hp'</span></span> <span class="keyword2"><span class="keyword">where</span></span> Hp'<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="skolem">p</span><span class="main">)</span> <span class="main">#</span> <span class="skolem">Hp'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span> <span class="quoted"><span class="quoted">‹set <span class="skolem">Hp'</span> <span class="main">⊆</span> <span class="free">H</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms inconsistent_head <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>

    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?H'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="skolem">Hp'</span> <span class="main">@</span> <span class="skolem">Hq'</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> H'<span class="main">:</span> <span class="quoted"><span class="quoted">‹set <span class="var">?H'</span> <span class="main">=</span> set <span class="skolem">Hp'</span> <span class="main">∪</span> set <span class="skolem">Hq'</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹set <span class="skolem">Hp'</span> <span class="main">⊆</span> set <span class="var">?H'</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹set <span class="skolem">Hq'</span> <span class="main">⊆</span> set <span class="var">?H'</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="skolem">p</span><span class="main">)</span> <span class="main">#</span> <span class="var">?H'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">q</span> <span class="main">#</span> <span class="var">?H'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> Hp'<span class="main">(</span>1<span class="main">)</span> Hq'<span class="main">(</span>1<span class="main">)</span> deduct imply_weaken <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="skolem">q</span><span class="main">)</span> <span class="main">#</span> <span class="var">?H'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> Boole imply_Cons imply_head MP' cut <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹set <span class="main">(</span><span class="main">(</span><span class="skolem">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="skolem">q</span><span class="main">)</span> <span class="main">#</span> <span class="var">?H'</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">H</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">q</span> <span class="main">∉</span> <span class="free">H</span>›</span></span> *<span class="main">(</span>1<span class="main">)</span> H' Hp'<span class="main">(</span>2<span class="main">)</span> Hq'<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span>
      <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> consistent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p</span> <span class="skolem">q</span>
  <span class="keyword3"><span class="command">assume</span></span> *<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main">(</span><span class="skolem">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="skolem">q</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">p</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">∧</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="skolem">q</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> conjI<span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">p</span> <span class="main">∉</span> <span class="free">H</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">H'</span></span> <span class="keyword2"><span class="keyword">where</span></span> S'<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">p</span> <span class="main">#</span> <span class="skolem">H'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span> <span class="quoted"><span class="quoted">‹set <span class="skolem">H'</span> <span class="main">⊆</span> <span class="free">H</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms inconsistent_head <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main">(</span><span class="skolem">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="skolem">q</span><span class="main">)</span><span class="main">)</span> <span class="main">#</span> <span class="skolem">H'</span> <span class="main">⊢</span> <span class="skolem">p</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main">(</span><span class="skolem">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="skolem">q</span><span class="main">)</span><span class="main">)</span> <span class="main">#</span> <span class="skolem">H'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹set <span class="main">(</span><span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main">(</span><span class="skolem">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="skolem">q</span><span class="main">)</span><span class="main">)</span> <span class="main">#</span> <span class="skolem">H'</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">H</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> *<span class="main">(</span>1<span class="main">)</span> S'<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span>
      <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> consistent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="skolem">q</span><span class="main">)</span> <span class="main">∉</span> <span class="free">H</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">H'</span></span> <span class="keyword2"><span class="keyword">where</span></span> H'<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="skolem">q</span><span class="main">)</span> <span class="main">#</span> <span class="skolem">H'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span> <span class="quoted"><span class="quoted">‹set <span class="skolem">H'</span> <span class="main">⊆</span> <span class="free">H</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms inconsistent_head <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main">(</span><span class="skolem">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="skolem">q</span><span class="main">)</span><span class="main">)</span> <span class="main">#</span> <span class="skolem">H'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="skolem">q</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main">(</span><span class="skolem">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="skolem">q</span><span class="main">)</span><span class="main">)</span> <span class="main">#</span> <span class="skolem">H'</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹set <span class="main">(</span><span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main">(</span><span class="skolem">p</span> <span class="main"><span class="hidden">❙</span><b>⟶</b></span> <span class="skolem">q</span><span class="main">)</span><span class="main">)</span> <span class="main">#</span> <span class="skolem">H'</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">H</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> *<span class="main">(</span>1<span class="main">)</span> H'<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span>
      <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> consistent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="skolem">p</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">t</span><span class="main">.</span> <span class="skolem">p</span><span class="main">⟨</span><span class="bound">t</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms consistent_add_instance
    <span class="keyword1"><span class="command">unfolding</span></span> maximal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="main"><span class="hidden">❙</span><b>∀</b></span> <span class="skolem">p</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="skolem">p</span><span class="main">⟨</span><span class="main"><span class="hidden">❙</span><b>†</b></span><span class="bound">a</span> <span class="main">[]</span><span class="main">/</span><span class="main">0</span><span class="main">⟩</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹saturated <span class="free">H</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> saturated_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Countable Formulas›</span></span>

<span class="keyword1"><span class="command">instance</span></span> tm <span class="main">::</span> <span class="main">(</span><span class="quoted">countable</span><span class="main">)</span> <span class="quoted">countable</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">countable_datatype</span>

<span class="keyword1"><span class="command">instance</span></span> fm <span class="main">::</span> <span class="main">(</span><span class="quoted">countable</span><span class="main">,</span> <span class="quoted">countable</span><span class="main">)</span> <span class="quoted">countable</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">countable_datatype</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Completeness›</span></span>

<span class="keyword1" id="FOL_Axiomatic-imply_completeness"><span class="command">lemma</span></span> imply_completeness<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">p</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'f</span> <span class="main">::</span> countable<span class="main">,</span> <span class="tfree">'p</span> <span class="main">::</span> countable<span class="main">)</span> fm›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="main">(</span><span class="bound">E</span> <span class="main">::</span> <span class="main">_</span> <span class="main">⇒</span> <span class="tfree">'f</span> tm<span class="main">)</span> <span class="bound">F</span> <span class="bound">G</span><span class="main">.</span> Ball <span class="free">X</span> <span class="main">⟦</span><span class="bound">E</span><span class="main">,</span> <span class="bound">F</span><span class="main">,</span> <span class="bound">G</span><span class="main">⟧</span> <span class="main">⟶</span> <span class="main">⟦</span><span class="bound">E</span><span class="main">,</span> <span class="bound">F</span><span class="main">,</span> <span class="bound">G</span><span class="main">⟧</span> <span class="free">p</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">(</span>params <span class="free">X</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹infinite <span class="main">(</span>UNIV <span class="main">::</span> <span class="tfree">'f</span> set<span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">ps</span><span class="main">.</span> set <span class="bound">ps</span> <span class="main">⊆</span> <span class="free">X</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">ps</span> <span class="main">⊢</span> <span class="free">p</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∄</span><span class="bound">ps</span><span class="main">.</span> set <span class="bound">ps</span> <span class="main">⊆</span> <span class="free">X</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">ps</span> <span class="main">⊢</span> <span class="free">p</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> *<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∄</span><span class="bound">ps</span><span class="main">.</span> set <span class="bound">ps</span> <span class="main">⊆</span> <span class="free">X</span> <span class="main">∧</span> <span class="main">(</span><span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">p</span><span class="main">)</span> <span class="main">#</span> <span class="bound">ps</span> <span class="main">⊢</span> <span class="main"><span class="hidden">❙</span><b>⊥</b></span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> Boole <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?S</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">p</span><span class="main">}</span> <span class="main">∪</span> <span class="free">X</span>›</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?H</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">‹Extend <span class="var">?S</span> from_nat›</span></span>

  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="var">?S</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> * <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> consistent_def imply_Cons inconsistent_fm<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹finite <span class="main">(</span>params <span class="var">?S</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹consistent <span class="var">?H</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹maximal <span class="var">?H</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> consistent_Extend maximal_Extend surj_from_nat <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹saturated <span class="var">?H</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> saturated_Extend <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹Hintikka <span class="var">?H</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> Hintikka_Extend <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟦</span><span class="var">?H</span><span class="main">⟧</span> <span class="skolem">p</span>›</span></span> <span class="keyword2"><span class="keyword">if</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">p</span> <span class="main">∈</span> <span class="var">?S</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">p</span>
    <span class="keyword1"><span class="command">using</span></span> that Extend_subset Hintikka_model <span class="quoted"><span class="quoted">‹Hintikka <span class="var">?H</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟦</span><span class="var">?H</span><span class="main">⟧</span> <span class="main">(</span><span class="main"><span class="hidden">❙</span><b>¬</b></span> <span class="free">p</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">q</span> <span class="main">∈</span> <span class="free">X</span><span class="main">.</span> <span class="main">⟦</span><span class="var">?H</span><span class="main">⟧</span> <span class="bound">q</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟦</span><span class="var">?H</span><span class="main">⟧</span> <span class="free">p</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> completeness<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">p</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>nat<span class="main">,</span> nat<span class="main">)</span> fm›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="main">(</span><span class="bound">E</span> <span class="main">::</span> nat <span class="main">⇒</span> nat tm<span class="main">)</span> <span class="bound">F</span> <span class="bound">G</span><span class="main">.</span> <span class="main">⟦</span><span class="bound">E</span><span class="main">,</span> <span class="bound">F</span><span class="main">,</span> <span class="bound">G</span><span class="main">⟧</span> <span class="free">p</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⊢</span> <span class="free">p</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms imply_completeness<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> X<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">‹<span class="main">{}</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Main Result›</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">valid</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>nat<span class="main">,</span> nat<span class="main">)</span> fm <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">valid</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="main">(</span><span class="bound">E</span> <span class="main">::</span> nat <span class="main">⇒</span> nat tm<span class="main">)</span> <span class="bound">F</span> <span class="bound">G</span><span class="main">.</span> <span class="main">⟦</span><span class="bound">E</span><span class="main">,</span> <span class="bound">F</span><span class="main">,</span> <span class="bound">G</span><span class="main">⟧</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span>›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> main<span class="main">:</span> <span class="quoted"><span class="quoted">‹valid <span class="free">p</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">⊢</span> <span class="free">p</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> completeness soundness <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div>
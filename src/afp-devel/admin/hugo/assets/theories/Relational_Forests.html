<div id="Forests">
<div class="head">
<h1>Theory Forests</h1>
</div>
<pre class="source"><span class="comment1">(* Title:      Orientations and Undirected Forests
   Author:     Walter Guttmann
   Maintainer: Walter Guttmann &lt;walter.guttmann at canterbury.ac.nz&gt;
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Orientations and Undirected Forests›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
In this theory we study orientations and various second-order specifications of undirected forests.
The results are structured by the classes in which they can be proved, which correspond to algebraic structures.
Most classes are generalisations of Kleene relation algebras.
None of the classes except <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>kleene_relation_algebra›</span></span></span></span> assumes the double-complement law <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>--x = x›</span></span></span></span> available in Boolean algebras.
The corresponding paper does not elaborate these fine distinctions, so some results take a different form in this theory.
They usually specialise to Kleene relation algebras after simplification using <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>--x = x›</span></span></span></span>.
›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Forests

<span class="keyword2"><span class="keyword">imports</span></span> <a href="../../stone_kleene_relation_algebras/theories/#Kleene_Relation_Algebras">Stone_Kleene_Relation_Algebras.Kleene_Relation_Algebras</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Orientability›</span></span>

<span class="comment1">(* move to Relation_Algebras *)</span>
<span class="keyword1"><span class="command">context</span></span> bounded_distrib_allegory_signature
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">irreflexive_inf</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">irreflexive_inf</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⊓</span> <span class="main">1</span> <span class="main">=</span> bot"</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">context</span></span> bounded_distrib_allegory
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="comment1">(* move to Relation_Algebras *)</span>
<span class="keyword1" id="Forests-irreflexive_inf_arc_asymmetric"><span class="command">lemma</span></span> irreflexive_inf_arc_asymmetric<span class="main">:</span>
  <span class="quoted"><span class="quoted">"irreflexive_inf <span class="free">x</span> <span class="main">⟹</span> arc <span class="free">x</span> <span class="main">⟹</span> asymmetric <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"irreflexive_inf <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"arc <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"bot <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> top<span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> arc_top_arc comp_right_one schroeder_1<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_inf.semiring.mult_zero_right conv_inf_bot_iff inf.sup_relative_same_increasing top_right_mult_increasing<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Forests-asymmetric_inf"><span class="command">lemma</span></span> asymmetric_inf<span class="main">:</span>
  <span class="quoted"><span class="quoted">"asymmetric <span class="free">x</span> <span class="main">⟷</span> irreflexive_inf <span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> inf.sup_monoid.add_commute schroeder_2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>

<span class="keyword1" id="Forests-asymmetric_irreflexive_inf"><span class="command">lemma</span></span> asymmetric_irreflexive_inf<span class="main">:</span>
  <span class="quoted"><span class="quoted">"asymmetric <span class="free">x</span> <span class="main">⟹</span> irreflexive_inf <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> asymmetric_inf_closed coreflexive_symmetric inf.idem inf_le2<span class="main">)</span>

<span class="keyword1" id="Forests-transitive_asymmetric_irreflexive_inf"><span class="command">lemma</span></span> transitive_asymmetric_irreflexive_inf<span class="main">:</span>
  <span class="quoted"><span class="quoted">"transitive <span class="free">x</span> <span class="main">⟹</span> asymmetric <span class="free">x</span> <span class="main">⟷</span> irreflexive_inf <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> asymmetric_inf asymmetric_irreflexive_inf inf.absorb2 inf.cobounded1 inf.sup_monoid.add_commute inf_assoc le_bot<span class="main">)</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">orientation</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">⊔</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> asymmetric <span class="free"><span class="bound"><span class="entity">y</span></span></span>"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">loop_orientation</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">⊔</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> antisymmetric <span class="free"><span class="bound"><span class="entity">y</span></span></span>"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">super_orientation</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">⊔</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">∧</span> asymmetric <span class="free"><span class="bound"><span class="entity">y</span></span></span>"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">loop_super_orientation</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">⊔</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">∧</span> antisymmetric <span class="free"><span class="bound"><span class="entity">y</span></span></span>"</span></span>

<span class="keyword1" id="Forests-orientation_symmetric"><span class="command">lemma</span></span> orientation_symmetric<span class="main">:</span>
  <span class="quoted"><span class="quoted">"orientation <span class="free">x</span> <span class="free">y</span> <span class="main">⟹</span> symmetric <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> conv_dist_sup sup_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Forests-orientation_irreflexive_inf"><span class="command">lemma</span></span> orientation_irreflexive_inf<span class="main">:</span>
  <span class="quoted"><span class="quoted">"orientation <span class="free">x</span> <span class="free">y</span> <span class="main">⟹</span> irreflexive_inf <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> asymmetric_irreflexive_inf asymmetric_conv_closed inf_sup_distrib2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Forests-loop_orientation_symmetric"><span class="command">lemma</span></span> loop_orientation_symmetric<span class="main">:</span>
  <span class="quoted"><span class="quoted">"loop_orientation <span class="free">x</span> <span class="free">y</span> <span class="main">⟹</span> symmetric <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> conv_dist_sup sup_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Forests-loop_orientation_diagonal"><span class="command">lemma</span></span> loop_orientation_diagonal<span class="main">:</span>
  <span class="quoted"><span class="quoted">"loop_orientation <span class="free">x</span> <span class="free">y</span> <span class="main">⟹</span> <span class="free">y</span> <span class="main">⊓</span> <span class="free">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span> <span class="main">⊓</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.sup_monoid.add_commute inf.sup_same_context inf_le2 inf_sup_distrib1 one_inf_conv sup.idem<span class="main">)</span>

<span class="keyword1" id="Forests-super_orientation_irreflexive_inf"><span class="command">lemma</span></span> super_orientation_irreflexive_inf<span class="main">:</span>
  <span class="quoted"><span class="quoted">"super_orientation <span class="free">x</span> <span class="free">y</span> <span class="main">⟹</span> irreflexive_inf <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> coreflexive_bot_closed inf.sup_monoid.add_assoc inf.sup_right_divisibility inf_bot_right loop_orientation_diagonal <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1" id="Forests-loop_super_orientation_diagonal"><span class="command">lemma</span></span> loop_super_orientation_diagonal<span class="main">:</span>
  <span class="quoted"><span class="quoted">"loop_super_orientation <span class="free">x</span> <span class="free">y</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">⊓</span> <span class="main">1</span> <span class="main">≤</span> <span class="free">y</span> <span class="main">⊓</span> <span class="free">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> inf.sup_right_divisibility inf_assoc loop_orientation_diagonal <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">orientable</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∃</span><span class="bound">y</span> <span class="main">.</span> orientation <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="bound">y</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">loop_orientable</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∃</span><span class="bound">y</span> <span class="main">.</span> loop_orientation <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="bound">y</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">super_orientable</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∃</span><span class="bound">y</span> <span class="main">.</span> super_orientation <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="bound">y</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">loop_super_orientable</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∃</span><span class="bound">y</span> <span class="main">.</span> loop_super_orientation <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="bound">y</span>"</span></span>

<span class="keyword1" id="Forests-orientable_symmetric"><span class="command">lemma</span></span> orientable_symmetric<span class="main">:</span>
  <span class="quoted"><span class="quoted">"orientable <span class="free">x</span> <span class="main">⟹</span> symmetric <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> orientable_def orientation_symmetric <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Forests-orientable_irreflexive_inf"><span class="command">lemma</span></span> orientable_irreflexive_inf<span class="main">:</span>
  <span class="quoted"><span class="quoted">"orientable <span class="free">x</span> <span class="main">⟹</span> irreflexive_inf <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> orientable_def orientation_irreflexive_inf <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Forests-loop_orientable_symmetric"><span class="command">lemma</span></span> loop_orientable_symmetric<span class="main">:</span>
  <span class="quoted"><span class="quoted">"loop_orientable <span class="free">x</span> <span class="main">⟹</span> symmetric <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> loop_orientable_def loop_orientation_symmetric <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Forests-super_orientable_irreflexive_inf"><span class="command">lemma</span></span> super_orientable_irreflexive_inf<span class="main">:</span>
  <span class="quoted"><span class="quoted">"super_orientable <span class="free">x</span> <span class="main">⟹</span> irreflexive_inf <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> super_orientable_def super_orientation_irreflexive_inf <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Forests-orientable_down_closed"><span class="command">lemma</span></span> orientable_down_closed<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">x</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">y</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"orientable <span class="free">y</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"orientable <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">⊔</span> <span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">y</span> <span class="main">∧</span> asymmetric <span class="skolem">z</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?z</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="skolem">z</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"orientation <span class="free">x</span> <span class="var">?z</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> conjI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"asymmetric <span class="var">?z</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_inf inf.left_commute inf.sup_monoid.add_assoc<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="var">?z</span> <span class="main">⊔</span> <span class="var">?z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>2<span class="main"><span class="main">)</span></span> conv_dist_inf inf.orderE inf_sup_distrib1<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Forests-loop_orientable_down_closed"><span class="command">lemma</span></span> loop_orientable_down_closed<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">x</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">y</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"loop_orientable <span class="free">y</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"loop_orientable <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">⊔</span> <span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">y</span> <span class="main">∧</span> antisymmetric <span class="skolem">z</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> loop_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?z</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="skolem">z</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"loop_orientation <span class="free">x</span> <span class="var">?z</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> conjI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"antisymmetric <span class="var">?z</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 antisymmetric_inf_closed inf_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="var">?z</span> <span class="main">⊔</span> <span class="var">?z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>2<span class="main"><span class="main">)</span></span> conv_dist_inf inf.orderE inf_sup_distrib1<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> loop_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Forests-super_orientable_down_closed"><span class="command">lemma</span></span> super_orientable_down_closed<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">y</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"super_orientable <span class="free">y</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"super_orientable <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms order_lesseq_imp super_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Forests-loop_super_orientable_down_closed"><span class="command">lemma</span></span> loop_super_orientable_down_closed<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">y</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"loop_super_orientable <span class="free">y</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"loop_super_orientable <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms order_lesseq_imp loop_super_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">orientable_1</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> loop_super_orientable <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">orientable_2</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∃</span><span class="bound">y</span> <span class="main">.</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≤</span> <span class="bound">y</span> <span class="main">⊔</span> <span class="bound">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">∧</span> <span class="bound">y</span> <span class="main">⊓</span> <span class="bound">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⊓</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">orientable_3</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∃</span><span class="bound">y</span> <span class="main">.</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≤</span> <span class="bound">y</span> <span class="main">⊔</span> <span class="bound">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">∧</span> <span class="bound">y</span> <span class="main">⊓</span> <span class="bound">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⊓</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">orientable_4</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> irreflexive_inf <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⟶</span> super_orientable <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">orientable_5</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> symmetric <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⟶</span> loop_orientable <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">orientable_6</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> symmetric <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">⊔</span> <span class="bound">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> <span class="bound">y</span> <span class="main">⊓</span> <span class="bound">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⊓</span> <span class="main">1</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">orientable_7</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> symmetric <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">⊔</span> <span class="bound">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> <span class="bound">y</span> <span class="main">⊓</span> <span class="bound">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⊓</span> <span class="main">1</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">orientable_8</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> symmetric <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> irreflexive_inf <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⟶</span> orientable <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1" id="Forests-super_orientation_diagonal"><span class="command">lemma</span></span> super_orientation_diagonal<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">y</span> <span class="main">⊔</span> <span class="free">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⟹</span> <span class="free">y</span> <span class="main">⊓</span> <span class="free">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⊓</span> <span class="main">1</span> <span class="main">⟹</span> <span class="free">y</span> <span class="main">⊓</span> <span class="free">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span> <span class="main">⊓</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> inf.antisym loop_super_orientation_diagonal <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Forests-orientable_2_implies_1"><span class="command">lemma</span></span> orientable_2_implies_1<span class="main">:</span>
  <span class="quoted"><span class="quoted">"orientable_2 <span class="free">x</span> <span class="main">⟹</span> orientable_1 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> loop_super_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Forests-orientable_2_3"><span class="command">lemma</span></span> orientable_2_3<span class="main">:</span>
  <span class="quoted"><span class="quoted">"orientable_2 <span class="free">x</span> <span class="main">⟷</span> orientable_3 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> eq_refl super_orientation_diagonal <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Forests-orientable_5_6"><span class="command">lemma</span></span> orientable_5_6<span class="main">:</span>
  <span class="quoted"><span class="quoted">"orientable_5 <span class="free">x</span> <span class="main">⟷</span> orientable_6 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> loop_orientable_def loop_orientation_diagonal <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1" id="Forests-orientable_6_7"><span class="command">lemma</span></span> orientable_6_7<span class="main">:</span>
  <span class="quoted"><span class="quoted">"orientable_6 <span class="free">x</span> <span class="main">⟷</span> orientable_7 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> super_orientation_diagonal <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1" id="Forests-orientable_7_implies_8"><span class="command">lemma</span></span> orientable_7_implies_8<span class="main">:</span>
  <span class="quoted"><span class="quoted">"orientable_7 <span class="free">x</span> <span class="main">⟹</span> orientable_8 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Forests-orientable_5_implies_1"><span class="command">lemma</span></span> orientable_5_implies_1<span class="main">:</span>
  <span class="quoted"><span class="quoted">"orientable_5 <span class="main">(</span><span class="free">x</span> <span class="main">⊔</span> <span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⟹</span> orientable_1 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> conv_dist_sup loop_orientable_def loop_super_orientable_def sup_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹ternary predicate S called <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>split›</span></span></span></span> here›</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">split</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="free"><span class="bound"><span class="entity">z</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">⊓</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">⊔</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">z</span></span></span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 3.1›</span></span>

<span class="keyword1" id="Forests-orientation_split"><span class="command">lemma</span></span> orientation_split<span class="main">:</span>
  <span class="quoted"><span class="quoted">"orientation <span class="free">x</span> <span class="free">y</span> <span class="main">⟷</span> split bot <span class="free">y</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 3.2›</span></span>

<span class="keyword1" id="Forests-split_1_loop_orientation"><span class="command">lemma</span></span> split_1_loop_orientation<span class="main">:</span>
  <span class="quoted"><span class="quoted">"split <span class="main">1</span> <span class="free">y</span> <span class="free">x</span> <span class="main">⟹</span> loop_orientation <span class="free">x</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 3.3›</span></span>

<span class="keyword1" id="Forests-loop_orientation_split"><span class="command">lemma</span></span> loop_orientation_split<span class="main">:</span>
  <span class="quoted"><span class="quoted">"loop_orientation <span class="free">x</span> <span class="free">y</span> <span class="main">⟷</span> split <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">1</span><span class="main">)</span> <span class="free">y</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.cobounded2 loop_orientation_diagonal<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 3.4›</span></span>

<span class="keyword1" id="Forests-loop_orientation_split_inf_1"><span class="command">lemma</span></span> loop_orientation_split_inf_1<span class="main">:</span>
  <span class="quoted"><span class="quoted">"loop_orientation <span class="free">x</span> <span class="free">y</span> <span class="main">⟷</span> split <span class="main">(</span><span class="free">y</span> <span class="main">⊓</span> <span class="main">1</span><span class="main">)</span> <span class="free">y</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.sup_monoid.add_commute inf.sup_same_context inf_le2 one_inf_conv<span class="main">)</span>

<span class="keyword1" id="Forests-loop_orientation_top_split"><span class="command">lemma</span></span> loop_orientation_top_split<span class="main">:</span>
  <span class="quoted"><span class="quoted">"loop_orientation top <span class="free">y</span> <span class="main">⟷</span> split <span class="main">1</span> <span class="free">y</span> top"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> loop_orientation_split<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹injective and transitive orientations›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">injectively_orientable</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∃</span><span class="bound">y</span> <span class="main">.</span> orientation <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="bound">y</span> <span class="main">∧</span> injective <span class="bound">y</span>"</span></span>

<span class="keyword1" id="Forests-injectively_orientable_orientable"><span class="command">lemma</span></span> injectively_orientable_orientable<span class="main">:</span>
  <span class="quoted"><span class="quoted">"injectively_orientable <span class="free">x</span> <span class="main">⟹</span> orientable <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> injectively_orientable_def orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Forests-orientable_orientable_1"><span class="command">lemma</span></span> orientable_orientable_1<span class="main">:</span>
  <span class="quoted"><span class="quoted">"orientable <span class="free">x</span> <span class="main">⟹</span> orientable_1 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> bot_least order_refl loop_super_orientable_def orientable_def<span class="main">)</span>

<span class="keyword1" id="Forests-injectively_orientable_down_closed"><span class="command">lemma</span></span> injectively_orientable_down_closed<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">x</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">y</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"injectively_orientable <span class="free">y</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"injectively_orientable <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">⊔</span> <span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">y</span> <span class="main">∧</span> asymmetric <span class="skolem">z</span> <span class="main">∧</span> injective <span class="skolem">z</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> injectively_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?z</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="skolem">z</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"injective <span class="var">?z</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 inf_commute injective_inf_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"orientation <span class="free">x</span> <span class="var">?z</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> conjI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"asymmetric <span class="var">?z</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_inf inf.left_commute inf.sup_monoid.add_assoc<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="var">?z</span> <span class="main">⊔</span> <span class="var">?z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>2<span class="main"><span class="main">)</span></span> conv_dist_inf inf.orderE inf_sup_distrib1<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> 2 injectively_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">transitively_orientable</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∃</span><span class="bound">y</span> <span class="main">.</span> orientation <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="bound">y</span> <span class="main">∧</span> transitive <span class="bound">y</span>"</span></span>

<span class="keyword1" id="Forests-transitively_orientable_orientable"><span class="command">lemma</span></span> transitively_orientable_orientable<span class="main">:</span>
  <span class="quoted"><span class="quoted">"transitively_orientable <span class="free">x</span> <span class="main">⟹</span> orientable <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> transitively_orientable_def orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Forests-irreflexive_transitive_orientation_asymmetric"><span class="command">lemma</span></span> irreflexive_transitive_orientation_asymmetric<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"irreflexive_inf <span class="free">x</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"transitive <span class="free">y</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">⊔</span> <span class="free">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"asymmetric <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms comp_inf.mult_right_dist_sup transitive_asymmetric_irreflexive_inf <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 12›</span></span>

<span class="keyword1" id="Forests-transitively_orientable_2"><span class="command">lemma</span></span> transitively_orientable_2<span class="main">:</span>
  <span class="quoted"><span class="quoted">"transitively_orientable <span class="free">x</span> <span class="main">⟷</span> irreflexive_inf <span class="free">x</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">⊔</span> <span class="bound">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span> <span class="main">∧</span> transitive <span class="bound">y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> irreflexive_transitive_orientation_asymmetric coreflexive_bot_closed loop_orientation_split transitively_orientable_def<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">context</span></span> relation_algebra_signature
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="entity">asymmetric_var</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">⇒</span> bool"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">asymmetric_var</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> irreflexive <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">*</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">context</span></span> pd_allegory
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 1.4›</span></span>

<span class="keyword1" id="Forests-asymmetric_var"><span class="command">lemma</span></span> asymmetric_var<span class="main">:</span>
  <span class="quoted"><span class="quoted">"asymmetric <span class="free">x</span> <span class="main">⟷</span> asymmetric_var <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> asymmetric_inf pseudo_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 1.3›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹(Theorem 1.2 is <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>asymmetric_irreflexive›</span></span></span></span> in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Relation_Algebras›</span></span></span></span>)›</span></span>

<span class="keyword1" id="Forests-transitive_asymmetric_irreflexive"><span class="command">lemma</span></span> transitive_asymmetric_irreflexive<span class="main">:</span>
  <span class="quoted"><span class="quoted">"transitive <span class="free">x</span> <span class="main">⟹</span> asymmetric <span class="free">x</span> <span class="main">⟷</span> irreflexive <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> strict_order_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Forests-orientable_irreflexive"><span class="command">lemma</span></span> orientable_irreflexive<span class="main">:</span>
  <span class="quoted"><span class="quoted">"orientable <span class="free">x</span> <span class="main">⟹</span> irreflexive <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> orientable_irreflexive_inf pseudo_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Forests-super_orientable_irreflexive"><span class="command">lemma</span></span> super_orientable_irreflexive<span class="main">:</span>
  <span class="quoted"><span class="quoted">"super_orientable <span class="free">x</span> <span class="main">⟹</span> irreflexive <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> pseudo_complement super_orientable_irreflexive_inf <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Forests-orientation_diversity_split"><span class="command">lemma</span></span> orientation_diversity_split<span class="main">:</span>
  <span class="quoted"><span class="quoted">"orientation <span class="main">(</span><span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="free">y</span> <span class="main">⟷</span> split bot <span class="free">y</span> <span class="main">(</span><span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">linear_orderable_1</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> linear_order <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">linear_orderable_2</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> linear_strict_order <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">linear_orderable_3</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> transitive <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> asymmetric <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> strict_linear <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">linear_orderable_3a</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> transitive <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> strict_linear <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">orientable_11</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> split <span class="main">1</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> top"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">orientable_12</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> split bot <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">(</span><span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Forests-linear_strict_order_split"><span class="command">lemma</span></span> linear_strict_order_split<span class="main">:</span>
  <span class="quoted"><span class="quoted">"linear_strict_order <span class="free">x</span> <span class="main">⟷</span> transitive <span class="free">x</span> <span class="main">∧</span> split bot <span class="free">x</span> <span class="main">(</span><span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> strict_order_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 1.6›</span></span>

<span class="keyword1" id="Forests-linear_strict_order_without_irreflexive"><span class="command">lemma</span></span> linear_strict_order_without_irreflexive<span class="main">:</span>
  <span class="quoted"><span class="quoted">"linear_strict_order <span class="free">x</span> <span class="main">⟷</span> transitive <span class="free">x</span> <span class="main">∧</span> strict_linear <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> strict_linear_irreflexive <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Forests-linear_order_without_reflexive"><span class="command">lemma</span></span> linear_order_without_reflexive<span class="main">:</span>
  <span class="quoted"><span class="quoted">"linear_order <span class="free">x</span> <span class="main">⟷</span> antisymmetric <span class="free">x</span> <span class="main">∧</span> transitive <span class="free">x</span> <span class="main">∧</span> linear <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> linear_reflexive <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Forests-linear_orderable_1_implies_2"><span class="command">lemma</span></span> linear_orderable_1_implies_2<span class="main">:</span>
  <span class="quoted"><span class="quoted">"linear_orderable_1 <span class="free">x</span> <span class="main">⟹</span> linear_orderable_2 <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> linear_order_strict_order <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Forests-linear_orderable_2_3"><span class="command">lemma</span></span> linear_orderable_2_3<span class="main">:</span>
  <span class="quoted"><span class="quoted">"linear_orderable_2 <span class="free">x</span> <span class="main">⟷</span> linear_orderable_3 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> linear_strict_order_split <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Forests-linear_orderable_3_3a"><span class="command">lemma</span></span> linear_orderable_3_3a<span class="main">:</span>
  <span class="quoted"><span class="quoted">"linear_orderable_3 <span class="free">x</span> <span class="main">⟷</span> linear_orderable_3a <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> strict_linear_irreflexive strict_order_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Forests-linear_orderable_3_implies_orientable_12"><span class="command">lemma</span></span> linear_orderable_3_implies_orientable_12<span class="main">:</span>
  <span class="quoted"><span class="quoted">"linear_orderable_3 <span class="free">x</span> <span class="main">⟹</span> orientable_12 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Forests-orientable_11_implies_12"><span class="command">lemma</span></span> orientable_11_implies_12<span class="main">:</span>
  <span class="quoted"><span class="quoted">"orientable_11 <span class="free">x</span> <span class="main">⟹</span> orientable_12 <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> inf_sup_distrib2 conv_complement conv_dist_inf conv_involutive inf_import_p inf_top.left_neutral linear_asymmetric maddux_3_13 p_inf symmetric_one_closed<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">context</span></span> stone_relation_algebra
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 3.5›</span></span>

<span class="keyword1" id="Forests-split_symmetric_asymmetric"><span class="command">lemma</span></span> split_symmetric_asymmetric<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"split <span class="free">x</span> <span class="free">y</span> <span class="free">z</span> <span class="main">⟷</span> <span class="free">y</span> <span class="main">⊓</span> <span class="free">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span> <span class="main">∧</span> <span class="main">(</span><span class="free">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">z</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">x</span> <span class="main">∧</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">z</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"split <span class="free">x</span> <span class="free">y</span> <span class="free">z</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">⊓</span> <span class="free">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span> <span class="main">∧</span> <span class="main">(</span><span class="free">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">z</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">x</span> <span class="main">∧</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">z</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_complement conv_dist_inf conv_involutive inf.cobounded1 inf.sup_monoid.add_commute inf_import_p inf_sup_distrib2 le_supI1<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">⊓</span> <span class="free">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span> <span class="main">∧</span> <span class="main">(</span><span class="free">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">z</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">x</span> <span class="main">∧</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">z</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"split <span class="free">x</span> <span class="free">y</span> <span class="free">z</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>z3<span class="main"><span class="main">)</span></span> assms conv_dist_sup conv_involutive inf.absorb2 inf.boundedE inf.cobounded1 inf.idem inf.sup_monoid.add_commute inf_import_p maddux_3_11_pp sup.left_commute sup_commute sup_inf_absorb<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Forests-orientable_1_2"><span class="command">lemma</span></span> orientable_1_2<span class="main">:</span>
  <span class="quoted"><span class="quoted">"orientable_1 <span class="free">x</span> <span class="main">⟷</span> orientable_2 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"orientable_1 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="skolem">y</span> <span class="main">⊔</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">∧</span> <span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> loop_super_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">1</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="var">?y</span> <span class="main">⊔</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">∧</span> <span class="var">?y</span> <span class="main">⊓</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⊓</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span> <span class="main">≤</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 inf.sup_right_divisibility inf_commute inf_left_commute inf_sup_distrib2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?y</span> <span class="main">⊔</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_inf.semiring.add_mono conv_complement conv_dist_inf conv_isotone sup.cobounded2 symmetric_one_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="var">?y</span> <span class="main">⊔</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_inf.semiring.add_mono maddux_3_11_pp regular_one_closed sup.cobounded1 sup.left_idem<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">1</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> maddux_3_11_pp regular_one_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">⊓</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">1</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_inf.semiring.distrib_left conv_complement conv_dist_inf conv_dist_sup coreflexive_symmetric distrib_imp1 inf_le2 symmetric_one_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">x</span> <span class="main">⊓</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> 1 inf_assoc inf_commute pseudo_complement regular_one_closed selection_closed_id inf.cobounded2 maddux_3_11_pp<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">⊓</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⊓</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"orientable_2 <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"orientable_2 <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"orientable_1 <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> loop_super_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Forests-orientable_8_implies_5"><span class="command">lemma</span></span> orientable_8_implies_5<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"orientable_8 <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"orientable_5 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"symmetric <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_complement symmetric_inf_closed<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"orientable <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms pseudo_complement<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">⊔</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span> <span class="main">∧</span> asymmetric <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"loop_orientation <span class="free">x</span> <span class="var">?y</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">⊔</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="skolem">y</span> <span class="main">⊔</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 conv_dist_inf conv_dist_sup sup_assoc sup_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">⊔</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> 2 maddux_3_11_pp regular_one_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">⊓</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 1 conv_dist_sup sup_inf_distrib2 symmetric_inf_closed<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"antisymmetric <span class="var">?y</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 2<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"loop_orientable <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> loop_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Forests-orientable_4_implies_1"><span class="command">lemma</span></span> orientable_4_implies_1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"orientable_4 <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"orientable_1 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span> <span class="main">≤</span> <span class="skolem">y</span> <span class="main">⊔</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">∧</span> asymmetric <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms pseudo_complement super_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">⊔</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"loop_super_orientation <span class="free">x</span> <span class="var">?y</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="var">?y</span> <span class="main">⊔</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> 1 comp_inf.semiring.add_mono conv_dist_sup inf_le2 maddux_3_11_pp reflexive_one_closed regular_one_closed sup.absorb1 sup.left_commute sup_assoc symmetric_one_closed<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"antisymmetric <span class="var">?y</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 conv_dist_sup distrib_imp1 inf_sup_distrib1 sup_monoid.add_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> loop_super_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Forests-orientable_1_implies_4"><span class="command">lemma</span></span> orientable_1_implies_4<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"orientable_1 <span class="main">(</span><span class="free">x</span> <span class="main">⊔</span> <span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"orientable_4 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"irreflexive_inf <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊔</span> <span class="main">1</span> <span class="main">≤</span> <span class="skolem">y</span> <span class="main">⊔</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">∧</span> antisymmetric <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms loop_super_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"super_orientation <span class="free">x</span> <span class="var">?y</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊔</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 2 pseudo_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="var">?y</span> <span class="main">⊔</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_complement conv_dist_inf inf_sup_distrib2<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">⊓</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> conv_complement conv_dist_inf inf_commute inf_left_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"asymmetric <span class="var">?y</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 2 pseudo_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"super_orientable <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> super_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Forests-orientable_1_implies_5"><span class="command">lemma</span></span> orientable_1_implies_5<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"orientable_1 <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"orientable_5 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"symmetric <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="skolem">y</span> <span class="main">⊔</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">∧</span> antisymmetric <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms loop_super_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">1</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"loop_orientation <span class="free">x</span> <span class="var">?y</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">⊔</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="skolem">y</span> <span class="main">⊔</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">1</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 1 conv_complement conv_dist_inf conv_dist_sup inf_sup_distrib2 sup.left_commute sup_commute<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">⊔</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> 2 inf_absorb2 maddux_3_11_pp regular_one_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">⊓</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">1</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 1 conv_complement conv_dist_inf conv_dist_sup sup_inf_distrib1<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"antisymmetric <span class="var">?y</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> 2 antisymmetric_inf_closed conv_complement conv_dist_inf inf_le2 le_supI symmetric_one_closed<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"loop_orientable <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> loop_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 2›</span></span>

<span class="keyword1" id="Forests-all_orientable_characterisations"><span class="command">lemma</span></span> all_orientable_characterisations<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">x</span> <span class="main">.</span> orientable_1 <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span> <span class="main">.</span> orientable_2 <span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">x</span> <span class="main">.</span> orientable_1 <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span> <span class="main">.</span> orientable_3 <span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">x</span> <span class="main">.</span> orientable_1 <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span> <span class="main">.</span> orientable_4 <span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">x</span> <span class="main">.</span> orientable_1 <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span> <span class="main">.</span> orientable_5 <span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">x</span> <span class="main">.</span> orientable_1 <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span> <span class="main">.</span> orientable_6 <span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">x</span> <span class="main">.</span> orientable_1 <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span> <span class="main">.</span> orientable_7 <span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">x</span> <span class="main">.</span> orientable_1 <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span> <span class="main">.</span> orientable_8 <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> orientable_1_2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> orientable_1_2 orientable_2_3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> orientable_1_implies_4 orientable_4_implies_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> orientable_5_implies_1 orientable_1_implies_5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> orientable_5_6 orientable_5_implies_1 orientable_1_implies_5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> orientable_5_6 orientable_5_implies_1 orientable_6_7 orientable_1_implies_5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> orientable_5_6 orientable_5_implies_1 orientable_6_7 orientable_7_implies_8 orientable_1_implies_5 orientable_8_implies_5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Forests-orientable_12_implies_11"><span class="command">lemma</span></span> orientable_12_implies_11<span class="main">:</span>
  <span class="quoted"><span class="quoted">"orientable_12 <span class="free">x</span> <span class="main">⟹</span> orientable_11 <span class="main">(</span><span class="free">x</span> <span class="main">⊔</span> <span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> inf_top.right_neutral conv_complement conv_dist_sup conv_involutive inf_import_p maddux_3_13 p_bot p_dist_inf p_dist_sup regular_one_closed symmetric_one_closed<span class="main">)</span>

<span class="comment1">(* The following lemma might go into Relation_Algebras. *)</span>
<span class="keyword1" id="Forests-linear_strict_order_order"><span class="command">lemma</span></span> linear_strict_order_order<span class="main">:</span>
  <span class="quoted"><span class="quoted">"linear_strict_order <span class="free">x</span> <span class="main">⟹</span> linear_order <span class="main">(</span><span class="free">x</span> <span class="main">⊔</span> <span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> strict_order_order transitive_asymmetric_irreflexive orientable_12_implies_11<span class="main">)</span>

<span class="keyword1" id="Forests-linear_orderable_2_implies_1"><span class="command">lemma</span></span> linear_orderable_2_implies_1<span class="main">:</span>
  <span class="quoted"><span class="quoted">"linear_orderable_2 <span class="free">x</span> <span class="main">⟹</span> linear_orderable_1 <span class="main">(</span><span class="free">x</span> <span class="main">⊔</span> <span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> linear_strict_order_order <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 4›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 12›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 13›</span></span>

<span class="keyword1" id="Forests-exists_split_characterisations"><span class="command">lemma</span></span> exists_split_characterisations<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> linear_orderable_1 <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> linear_orderable_2 <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> linear_orderable_1 <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> linear_orderable_3 <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> linear_orderable_1 <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> linear_orderable_3a <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> linear_orderable_1 <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> transitively_orientable <span class="main">(</span><span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> linear_orderable_1 <span class="bound">x</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> orientable_11 <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> orientable_11 <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> orientable_12 <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> 1 <span class="keyword1"><span class="command">using</span></span> linear_strict_order_order linear_order_strict_order <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> 2 <span class="keyword1"><span class="command">using</span></span> 1 strict_order_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> 1 linear_strict_order_without_irreflexive <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> 2 transitively_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> loop_orientation_top_split <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> orientable_11_implies_12 orientable_12_implies_11 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 4›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 12›</span></span>

<span class="keyword1" id="Forests-exists_all_orientable"><span class="command">lemma</span></span> exists_all_orientable<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> orientable_11 <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span> <span class="main">.</span> orientable_1 <span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"transitively_orientable <span class="main">(</span><span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∀</span><span class="bound">x</span> <span class="main">.</span> orientable_8 <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> iffI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> loop_super_orientable_def top_greatest <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> loop_orientation_top_split loop_super_orientable_def top_le <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> orientable_down_closed pseudo_complement transitively_orientable_orientable <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Undirected forests›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
We start with a few general results in Kleene algebras and a few basic properties of directed acyclic graphs.
›</span></span>

<span class="comment1">(* move to Kleene_Algebras *)</span>
<span class="keyword1"><span class="command">context</span></span> kleene_algebra
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 1.9›</span></span>

<span class="keyword1" id="Forests-plus_separate_comp_bot"><span class="command">lemma</span></span> plus_separate_comp_bot<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">*</span> <span class="free">y</span> <span class="main">=</span> bot"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">⊔</span> <span class="free">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">=</span> <span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊔</span> <span class="free">y</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊔</span> <span class="free">y</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">⊔</span> <span class="free">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">=</span> <span class="free">x</span> <span class="main">*</span> <span class="free">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="free">y</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms cancel_separate_1 semiring.distrib_right mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊔</span> <span class="free">y</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms star_absorb<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> star.circ_back_loop_fixpoint star.circ_plus_same sup_assoc sup_commute mult_assoc<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="comment1">(* move to Kleene_Relation_Algebras *)</span>
<span class="keyword1"><span class="command">context</span></span> bounded_distrib_kleene_allegory
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1" id="Forests-reflexive_inf_plus_star"><span class="command">lemma</span></span> reflexive_inf_plus_star<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"reflexive <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="free">y</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> <span class="main">1</span> <span class="main">⟷</span> <span class="free">x</span> <span class="main">⊓</span> <span class="free">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms reflexive_inf_star sup.absorb_iff1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">context</span></span> pd_kleene_allegory
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="comment1">(* move to Kleene_Relation_Algebras *)</span>
<span class="keyword1" id="Forests-acyclic_star_inf_conv_iff"><span class="command">lemma</span></span> acyclic_star_inf_conv_iff<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"irreflexive <span class="free">w</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="free">w</span> <span class="main">⟷</span> <span class="free">w</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms acyclic_star_below_complement_1 acyclic_star_inf_conv conv_complement conv_order equivalence_one_closed inf.absorb1 inf.left_commute pseudo_complement star.circ_increasing<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 1.7›</span></span>

<span class="comment1">(* move to Kleene_Relation_Algebras *)</span>
<span class="keyword1" id="Forests-acyclic_irreflexive_star_antisymmetric"><span class="command">lemma</span></span> acyclic_irreflexive_star_antisymmetric<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic <span class="free">x</span> <span class="main">⟷</span> irreflexive <span class="free">x</span> <span class="main">∧</span> antisymmetric <span class="main">(</span><span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> acyclic_star_inf_conv_iff conv_star_commute dual_order.trans eq_iff reflexive_inf_closed star.circ_mult_increasing star.circ_reflexive<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 1.8›</span></span>

<span class="comment1">(* move to Kleene_Relation_Algebras *)</span>
<span class="keyword1" id="Forests-acyclic_plus_asymmetric"><span class="command">lemma</span></span> acyclic_plus_asymmetric<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic <span class="free">x</span> <span class="main">⟷</span> asymmetric <span class="main">(</span><span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> acyclic_asymmetric asymmetric_irreflexive star.circ_transitive_equal star.left_plus_circ mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 1.3›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹(Theorem 1.1 is <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>acyclic_asymmetric›</span></span></span></span> in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Kleene_Relation_Algebras›</span></span></span></span>)›</span></span>

<span class="keyword1" id="Forests-transitive_acyclic_irreflexive"><span class="command">lemma</span></span> transitive_acyclic_irreflexive<span class="main">:</span>
  <span class="quoted"><span class="quoted">"transitive <span class="free">x</span> <span class="main">⟹</span> acyclic <span class="free">x</span> <span class="main">⟷</span> irreflexive <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> antisym star.circ_mult_increasing star_right_induct_mult <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1" id="Forests-transitive_acyclic_asymmetric"><span class="command">lemma</span></span> transitive_acyclic_asymmetric<span class="main">:</span>
  <span class="quoted"><span class="quoted">"transitive <span class="free">x</span> <span class="main">⟹</span> acyclic <span class="free">x</span> <span class="main">⟷</span> asymmetric <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> strict_order_var transitive_acyclic_irreflexive <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 1.5›</span></span>

<span class="keyword1" id="Forests-strict_order_transitive_acyclic"><span class="command">lemma</span></span> strict_order_transitive_acyclic<span class="main">:</span>
  <span class="quoted"><span class="quoted">"strict_order <span class="free">x</span> <span class="main">⟷</span> transitive <span class="free">x</span> <span class="main">∧</span> acyclic <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> transitive_acyclic_irreflexive <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Forests-linear_strict_order_transitive_acyclic"><span class="command">lemma</span></span> linear_strict_order_transitive_acyclic<span class="main">:</span>
  <span class="quoted"><span class="quoted">"linear_strict_order <span class="free">x</span> <span class="main">⟷</span> transitive <span class="free">x</span> <span class="main">∧</span> acyclic <span class="free">x</span> <span class="main">∧</span> strict_linear <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> transitive_acyclic_irreflexive <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
The following are various specifications of an undirected graph being acyclic.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_1</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">.</span> orientation <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="bound">y</span> <span class="main">⟶</span> acyclic <span class="bound">y</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_1b</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">.</span> orientation <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="bound">y</span> <span class="main">⟶</span> <span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="bound">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_2</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> asymmetric <span class="bound">y</span> <span class="main">⟶</span> acyclic <span class="bound">y</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_2a</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">⊔</span> <span class="bound">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> asymmetric <span class="bound">y</span> <span class="main">⟶</span> acyclic <span class="bound">y</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_2b</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">⊔</span> <span class="bound">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> asymmetric <span class="bound">y</span> <span class="main">⟶</span> <span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="bound">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_3a</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≤</span> <span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⟶</span> <span class="bound">y</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_3b</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> <span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⟶</span> <span class="bound">y</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_3c</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≤</span> <span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⟶</span> <span class="bound">y</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_3d</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> <span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⟶</span> <span class="bound">y</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_4</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⟶</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⊓</span> <span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="bound">y</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_4a</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⟶</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⊓</span> <span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="bound">y</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_4b</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⟶</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⊓</span> <span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="bound">y</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_4c</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⟶</span> <span class="bound">y</span> <span class="main">⊓</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⊓</span> <span class="main">-</span><span class="bound">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> bot"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_5a</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⟶</span> <span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⊓</span> <span class="main">-</span><span class="bound">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_5b</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⟶</span> <span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⊓</span> <span class="main">-</span><span class="bound">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_5c</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⟶</span> <span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⊓</span> <span class="main">-</span><span class="bound">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_5d</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⟶</span> <span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">⊓</span> <span class="main">-</span><span class="bound">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_5e</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="bound">z</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> <span class="bound">z</span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> <span class="bound">y</span> <span class="main">⊓</span> <span class="bound">z</span> <span class="main">=</span> bot <span class="main">⟶</span> <span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="bound">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_5f</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="bound">z</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">⊔</span> <span class="bound">z</span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> <span class="bound">y</span> <span class="main">⊓</span> <span class="bound">z</span> <span class="main">=</span> bot <span class="main">⟶</span> <span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="bound">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_5g</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">y</span> <span class="bound">z</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">⊔</span> <span class="bound">z</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> <span class="bound">y</span> <span class="main">⊓</span> <span class="bound">z</span> <span class="main">=</span> bot <span class="main">⟶</span> <span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="bound">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">acyclic_6</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∃</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">⊔</span> <span class="bound">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> acyclic <span class="bound">y</span> <span class="main">∧</span> injective <span class="bound">y</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 6›</span></span>

<span class="keyword1" id="Forests-acyclic_2_2a"><span class="command">lemma</span></span> acyclic_2_2a<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"acyclic_2 <span class="free">x</span> <span class="main">⟷</span> acyclic_2a <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟷</span> <span class="bound">y</span> <span class="main">⊔</span> <span class="bound">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms conv_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> acyclic_2_def acyclic_2a_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 6›</span></span>

<span class="keyword1" id="Forests-acyclic_2a_2b"><span class="command">lemma</span></span> acyclic_2a_2b<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"acyclic_2a <span class="free">x</span> <span class="main">⟷</span> acyclic_2b <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> acyclic_2a_def acyclic_2b_def acyclic_star_inf_conv_iff asymmetric_irreflexive<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 5›</span></span>

<span class="keyword1" id="Forests-acyclic_1_1b"><span class="command">lemma</span></span> acyclic_1_1b<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"acyclic_1 <span class="free">x</span> <span class="main">⟷</span> acyclic_1b <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> acyclic_1_def acyclic_1b_def acyclic_star_inf_conv_iff asymmetric_irreflexive<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 10›</span></span>

<span class="keyword1" id="Forests-acyclic_6_1_injectively_orientable"><span class="command">lemma</span></span> acyclic_6_1_injectively_orientable<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_6 <span class="free">x</span> <span class="main">⟷</span> acyclic_1 <span class="free">x</span> <span class="main">∧</span> injectively_orientable <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"acyclic_6 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">⊔</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span> <span class="main">∧</span> acyclic <span class="skolem">y</span> <span class="main">∧</span> injective <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> acyclic_6_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"acyclic_1 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> acyclic_1_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span>
    <span class="keyword3"><span class="command">assume</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"orientation <span class="free">x</span> <span class="skolem">z</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> 1 inf_sup_absorb inf_sup_distrib1<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">z</span> <span class="main">*</span> <span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span> <span class="main">*</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_isotone<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">1</span> <span class="main">⊓</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 2 asymmetric_var comp_inf.mult_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_bot<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">=</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 3 4 plus_separate_comp_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> comp_isotone semiring.add_right_mono star_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊔</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> comp_isotone semiring.add_left_mono semiring.add_right_mono star_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">1</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> 1 conv_complement conv_isotone conv_plus_commute inf.absorb2 inf.orderE order_conv_closed order_one_closed semiring.add_right_mono sup.absorb1<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span><span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> comp_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> top <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.eq_refl star.circ_left_top star_plus mult_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> 4 bot_least comp_commute_below_diversity inf.absorb2 pseudo_complement schroeder_1 mult_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> sup.absorb1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="skolem">z</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"acyclic_1 <span class="free">x</span> <span class="main">∧</span> injectively_orientable <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 injectively_orientable_def acyclic_asymmetric <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"acyclic_1 <span class="free">x</span> <span class="main">∧</span> injectively_orientable <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"acyclic_6 <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> acyclic_6_def acyclic_1_def injectively_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Forests-acyclic_6_symmetric"><span class="command">lemma</span></span> acyclic_6_symmetric<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_6 <span class="free">x</span> <span class="main">⟹</span> symmetric <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> acyclic_6_1_injectively_orientable injectively_orientable_orientable orientable_symmetric<span class="main">)</span>

<span class="keyword1" id="Forests-acyclic_6_irreflexive"><span class="command">lemma</span></span> acyclic_6_irreflexive<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_6 <span class="free">x</span> <span class="main">⟹</span> irreflexive <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> acyclic_6_1_injectively_orientable injectively_orientable_orientable orientable_irreflexive<span class="main">)</span>

<span class="keyword1" id="Forests-acyclic_4_irreflexive"><span class="command">lemma</span></span> acyclic_4_irreflexive<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_4 <span class="free">x</span> <span class="main">⟹</span> irreflexive <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> acyclic_4_def bot_least inf.absorb2 inf.sup_monoid.add_assoc p_bot pseudo_complement star.circ_reflexive<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 6.4›</span></span>

<span class="keyword1" id="Forests-acyclic_2_implies_1"><span class="command">lemma</span></span> acyclic_2_implies_1<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_2 <span class="free">x</span> <span class="main">⟹</span> acyclic_1 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> acyclic_2_def acyclic_1_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 8›</span></span>

<span class="keyword1" id="Forests-acyclic_4a_4b"><span class="command">lemma</span></span> acyclic_4a_4b<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_4a <span class="free">x</span> <span class="main">⟷</span> acyclic_4b <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> acyclic_4a_def acyclic_4b_def eq_iff star.circ_increasing <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 7›</span></span>

<span class="keyword1" id="Forests-acyclic_3a_3b"><span class="command">lemma</span></span> acyclic_3a_3b<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_3a <span class="free">x</span> <span class="main">⟷</span> acyclic_3b <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> acyclic_3a_def acyclic_3b_def antisym star.circ_increasing star_involutive star_isotone<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 7›</span></span>

<span class="keyword1" id="Forests-acyclic_3a_3c"><span class="command">lemma</span></span> acyclic_3a_3c<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"irreflexive <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"acyclic_3a <span class="free">x</span> <span class="main">⟷</span> acyclic_3c <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"acyclic_3a <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"acyclic_3c <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> acyclic_3a_def acyclic_3c_def order_lesseq_imp star.left_plus_below_circ<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"acyclic_3c <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic_3a <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> acyclic_3a_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">∧</span> <span class="free">x</span> <span class="main">≤</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">∧</span> <span class="free">x</span> <span class="main">≤</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms inf.order_lesseq_imp le_infI p_inf_sup_below star_left_unfold_equal<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 acyclic_3c_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 7›</span></span>

<span class="keyword1" id="Forests-acyclic_3c_3d"><span class="command">lemma</span></span> acyclic_3c_3d<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"acyclic_3c <span class="free">x</span> <span class="main">⟷</span> acyclic_3d <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span> <span class="bound">z</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">≤</span> <span class="bound">z</span> <span class="main">∧</span> <span class="bound">z</span> <span class="main">≤</span> <span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⟷</span> <span class="bound">y</span> <span class="main">≤</span> <span class="bound">z</span> <span class="main">∧</span> <span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">=</span> <span class="bound">z</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> iffI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">smt</span> comp_associative plus_sup star.circ_transitive_equal star.left_plus_circ sup_absorb1 sup_absorb2<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star.circ_mult_increasing<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> acyclic_3c_def acyclic_3d_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 8›</span></span>

<span class="keyword1" id="Forests-acyclic_4a_implies_3a"><span class="command">lemma</span></span> acyclic_4a_implies_3a<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_4a <span class="free">x</span> <span class="main">⟹</span> acyclic_3a <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> acyclic_4a_def acyclic_3a_def inf.absorb1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Forests-acyclic_4a_implies_4"><span class="command">lemma</span></span> acyclic_4a_implies_4<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_4a <span class="free">x</span> <span class="main">⟹</span> acyclic_4 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> acyclic_4_def acyclic_4a_4b acyclic_4b_def pp_increasing<span class="main">)</span>

<span class="keyword1" id="Forests-acyclic_4b_implies_4c"><span class="command">lemma</span></span> acyclic_4b_implies_4c<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_4b <span class="free">x</span> <span class="main">⟹</span> acyclic_4c <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> acyclic_4b_def acyclic_4c_def inf.sup_relative_same_increasing<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 8.5›</span></span>

<span class="keyword1" id="Forests-acyclic_4_implies_2"><span class="command">lemma</span></span> acyclic_4_implies_2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"acyclic_4 <span class="free">x</span> <span class="main">⟹</span> acyclic_2 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"acyclic_4 <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic_2 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> acyclic_2_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span>
    <span class="keyword3"><span class="command">assume</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">∧</span> asymmetric <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms conv_inf_bot_iff conv_isotone pseudo_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> dual_order.trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.commute acyclic_4_def comp_inf.mult_left_isotone<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> acyclic_star_below_complement_1 le_bot<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 10.3›</span></span>

<span class="keyword1" id="Forests-acyclic_6_implies_4a"><span class="command">lemma</span></span> acyclic_6_implies_4a<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_6 <span class="free">x</span> <span class="main">⟹</span> acyclic_4a <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"acyclic_6 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">⊔</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span> <span class="main">∧</span> acyclic <span class="skolem">y</span> <span class="main">∧</span> injective <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> acyclic_6_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic_4a <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> acyclic_4a_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.orderE inf_sup_distrib1<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cancel_separate_2<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 inf_sup_distrib2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">z</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> sup_least<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf_sup_distrib1 star.circ_back_loop_fixpoint sup_commute<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> inf.sup_right_isotone semiring.add_right_mono star_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> acyclic_star_below_complement bot_least inf.sup_monoid.add_commute pseudo_complement sup.absorb2<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="skolem">y</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> dedekind_2 inf_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">y</span> <span class="main">*</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">z</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_isotone inf.coboundedI2 mult_isotone<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">z</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 mult_left_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="skolem">z</span>"</span></span>
        <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf_sup_distrib1 star.circ_loop_fixpoint sup_commute<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> inf.sup_right_isotone semiring.add_right_mono star_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 acyclic_star_below_complement_1 inf_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> dedekind_1 inf_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">z</span> <span class="main">*</span> <span class="skolem">y</span> <span class="main">*</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative comp_isotone conv_dist_inf inf.coboundedI2<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">z</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 mult_right_isotone mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="skolem">z</span>"</span></span>
        <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="skolem">z</span>"</span></span>
      <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 1.10›</span></span>

<span class="keyword1" id="Forests-top_injective_inf_complement"><span class="command">lemma</span></span> top_injective_inf_complement<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"injective <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"top <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="free">y</span><span class="main">)</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">y</span><span class="main">)</span> <span class="main">=</span> bot"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">y</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="main">-</span><span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_dist_inf inf.cobounded2 inf_left_idem mult_left_one p_shunting_swap schroeder_4_p<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="free">y</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">=</span> bot"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> assms comp_isotone coreflexive_comp_inf coreflexive_idempotent coreflexive_symmetric dual_order.trans inf.cobounded1 strict_order_var<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_inf schroeder_2 mult_assoc<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Forests-top_injective_inf_complement_2"><span class="command">lemma</span></span> top_injective_inf_complement_2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"injective <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">y</span><span class="main">)</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="main">(</span><span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="free">y</span><span class="main">)</span> <span class="main">*</span> top <span class="main">=</span> bot"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> assms top_injective_inf_complement conv_dist_comp conv_dist_inf conv_involutive conv_complement conv_top conv_bot<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 10.3›</span></span>

<span class="keyword1" id="Forests-acyclic_6_implies_5a"><span class="command">lemma</span></span> acyclic_6_implies_5a<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_6 <span class="free">x</span> <span class="main">⟹</span> acyclic_5a <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"acyclic_6 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">⊔</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span> <span class="main">∧</span> acyclic <span class="skolem">y</span> <span class="main">∧</span> injective <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> acyclic_6_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic_5a <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> acyclic_5a_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> 1 inf.orderE inf_sup_distrib1<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> 1 cancel_separate_2<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 inf_sup_distrib2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 cancel_separate_2 inf_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 3 inf_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> inf.sup_monoid.add_commute inf_sup_distrib1 star.circ_loop_fixpoint sup_commute mult_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf_sup_distrib2 star_left_unfold_equal<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">intro</span> sup_least<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf_sup_distrib1 star.circ_back_loop_fixpoint star.circ_plus_same sup_commute mult_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> bot"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> sup_least<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> comp_inf.mult_isotone comp_isotone inf.cobounded1 star_isotone<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> bot"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> acyclic_star_inf_conv inf.orderE inf.sup_monoid.add_assoc pseudo_complement star.left_plus_below_circ<span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> bot"</span></span>
          <span class="keyword1"><span class="command">.</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> top <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative comp_inf.mult_isotone star.circ_left_top star.circ_plus_same top_left_mult_increasing<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> bot"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> top_injective_inf_complement<span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> bot"</span></span>
          <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> bot_least le_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf_sup_distrib1 star.circ_loop_fixpoint sup_commute mult_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">1</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf_sup_distrib1 star_left_unfold_equal<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">intro</span> sup_least<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">1</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> inf.sup_monoid.add_commute inf_sup_distrib1 star.circ_back_loop_fixpoint star.circ_plus_same sup_commute mult_assoc<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> bot"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> sup_least<span class="main">)</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> comp_inf.mult_isotone comp_isotone inf.cobounded1 star_isotone<span class="main">)</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> bot"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> acyclic_asymmetric conv_inf_bot_iff conv_plus_commute star_sup_1 sup.idem mult_assoc<span class="main">)</span>
          <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> bot"</span></span>
            <span class="keyword1"><span class="command">.</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> top <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> comp_inf.mult_isotone comp_isotone inf.cobounded1 inf.orderE star.circ_plus_same top.extremum mult_assoc<span class="main">)</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> bot"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> top_injective_inf_complement<span class="main">)</span>
          <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> bot"</span></span>
            <span class="keyword1"><span class="command">.</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> bot_least le_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span> <span class="main">*</span> top <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span> <span class="main">*</span> top"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> comp_inf.mult_isotone comp_isotone eq_iff top.extremum mult_assoc<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> bot"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> top_injective_inf_complement_2<span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> bot_least le_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">z</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> antisym star.circ_reflexive<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 9.7›</span></span>

<span class="keyword1" id="Forests-acyclic_5b_implies_4"><span class="command">lemma</span></span> acyclic_5b_implies_4<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"irreflexive <span class="free">x</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"acyclic_5b <span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"acyclic_4 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> acyclic_4_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> acyclic_5b_def assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> inf.sup_left_divisibility inf.sup_monoid.add_assoc star.circ_mult_increasing<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span> <span class="main">=</span> bot"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> comp_inf.semiring.mult_zero_left inf.orderE inf.sup_monoid.add_assoc inf.sup_monoid.add_commute pseudo_complement<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> inf.sup_monoid.add_commute pseudo_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 9›</span></span>

<span class="keyword1" id="Forests-acyclic_5a_5b"><span class="command">lemma</span></span> acyclic_5a_5b<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_5a <span class="free">x</span> <span class="main">⟷</span> acyclic_5b <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> acyclic_5a_def acyclic_5b_def star.circ_reflexive reflexive_inf_plus_star<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 9›</span></span>

<span class="keyword1" id="Forests-acyclic_5a_5c"><span class="command">lemma</span></span> acyclic_5a_5c<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_5a <span class="free">x</span> <span class="main">⟷</span> acyclic_5c <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> acyclic_5a_def acyclic_5c_def inf_commute star.circ_reflexive reflexive_inf_plus_star<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 9›</span></span>

<span class="keyword1" id="Forests-acyclic_5b_5d"><span class="command">lemma</span></span> acyclic_5b_5d<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_5b <span class="free">x</span> <span class="main">⟷</span> acyclic_5d <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"acyclic_5b <span class="free">x</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">y</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊔</span> <span class="main">1</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="bound">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> <span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> acyclic_5b_def star_left_unfold_equal sup_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">⟷</span> acyclic_5d <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf_sup_distrib2 acyclic_5d_def<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Forests-acyclic_5a_5e"><span class="command">lemma</span></span> acyclic_5a_5e<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_5a <span class="free">x</span> <span class="main">⟷</span> acyclic_5e <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"acyclic_5a <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic_5e <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> acyclic_5e_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="skolem">z</span>
    <span class="keyword3"><span class="command">assume</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">∧</span> <span class="skolem">z</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">∧</span> <span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span> <span class="main">=</span> bot"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> p_antitone_iff pseudo_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> acyclic_5a_def comp_inf.mult_isotone inf.cobounded1 inf.right_idem star_isotone<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> antisym star.circ_reflexive<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"acyclic_5e <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic_5a <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> acyclic_5a_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?z</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span>"</span></span>
    <span class="keyword3"><span class="command">assume</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">⊓</span> <span class="var">?z</span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.left_commute<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="var">?z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> acyclic_5e_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 9›</span></span>

<span class="keyword1" id="Forests-acyclic_5e_5f"><span class="command">lemma</span></span> acyclic_5e_5f<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_5e <span class="free">x</span> <span class="main">⟷</span> acyclic_5f <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> acyclic_5e_def acyclic_5f_def<span class="main">)</span>

<span class="keyword1" id="Forests-acyclic_5e_down_closed"><span class="command">lemma</span></span> acyclic_5e_down_closed<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">y</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"acyclic_5e <span class="free">y</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"acyclic_5e <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms acyclic_5e_def order.trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Forests-acyclic_5a_down_closed"><span class="command">lemma</span></span> acyclic_5a_down_closed<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="free">y</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"acyclic_5a <span class="free">y</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"acyclic_5a <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> acyclic_5e_down_closed assms acyclic_5a_5e <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹further variants of the existence of a linear order›</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">linear_orderable_4</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> transitive <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> acyclic <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> strict_linear <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">linear_orderable_5</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> transitive <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> acyclic <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> linear <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">linear_orderable_6</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> acyclic <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> linear <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">linear_orderable_7</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> split <span class="main">1</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> top"</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">linear_orderable_8</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> split bot <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span><span class="main">)</span> <span class="main">(</span><span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Forests-linear_orderable_3_4"><span class="command">lemma</span></span> linear_orderable_3_4<span class="main">:</span>
  <span class="quoted"><span class="quoted">"linear_orderable_3 <span class="free">x</span> <span class="main">⟷</span> linear_orderable_4 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> transitive_acyclic_asymmetric <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Forests-linear_orderable_5_implies_6"><span class="command">lemma</span></span> linear_orderable_5_implies_6<span class="main">:</span>
  <span class="quoted"><span class="quoted">"linear_orderable_5 <span class="free">x</span> <span class="main">⟹</span> linear_orderable_6 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Forests-linear_orderable_6_implies_3"><span class="command">lemma</span></span> linear_orderable_6_implies_3<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"linear_orderable_6 <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"linear_orderable_3 <span class="main">(</span><span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"transitive <span class="main">(</span><span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative mult_isotone star.circ_mult_upper_bound star.left_plus_below_circ<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"asymmetric <span class="main">(</span><span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms acyclic_asymmetric star.circ_transitive_equal star.left_plus_circ mult_assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"strict_linear <span class="main">(</span><span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> assms acyclic_star_inf_conv conv_star_commute inf.sup_monoid.add_commute inf_absorb2 maddux_3_13 orientable_11_implies_12 star_left_unfold_equal<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 2 3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Forests-linear_orderable_7_implies_1"><span class="command">lemma</span></span> linear_orderable_7_implies_1<span class="main">:</span>
  <span class="quoted"><span class="quoted">"linear_orderable_7 <span class="free">x</span> <span class="main">⟹</span> linear_orderable_1 <span class="main">(</span><span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> star.circ_transitive_equal <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Forests-linear_orderable_6_implies_8"><span class="command">lemma</span></span> linear_orderable_6_implies_8<span class="main">:</span>
  <span class="quoted"><span class="quoted">"linear_orderable_6 <span class="free">x</span> <span class="main">⟹</span> linear_orderable_8 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> linear_orderable_6_implies_3<span class="main">)</span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">path_orderable</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> univalent <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> injective <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> acyclic <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> linear <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Forests-path_orderable_implies_linear_orderable_6"><span class="command">lemma</span></span> path_orderable_implies_linear_orderable_6<span class="main">:</span>
  <span class="quoted"><span class="quoted">"path_orderable <span class="free">x</span> <span class="main">⟹</span> linear_orderable_6 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">simple_paths</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∃</span><span class="bound">y</span> <span class="main">.</span> <span class="bound">y</span> <span class="main">⊔</span> <span class="bound">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> acyclic <span class="bound">y</span> <span class="main">∧</span> injective <span class="bound">y</span> <span class="main">∧</span> univalent <span class="bound">y</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 14.1›</span></span>

<span class="keyword1" id="Forests-simple_paths_acyclic_6"><span class="command">lemma</span></span> simple_paths_acyclic_6<span class="main">:</span>
  <span class="quoted"><span class="quoted">"simple_paths <span class="free">x</span> <span class="main">⟹</span> acyclic_6 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> simple_paths_def acyclic_6_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 14.2›</span></span>

<span class="keyword1" id="Forests-simple_paths_transitively_orientable"><span class="command">lemma</span></span> simple_paths_transitively_orientable<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"simple_paths <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"transitively_orientable <span class="main">(</span><span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">⊔</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span> <span class="main">∧</span> acyclic <span class="skolem">y</span> <span class="main">∧</span> injective <span class="skolem">y</span> <span class="main">∧</span> univalent <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> simple_paths_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"transitive <span class="var">?y</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative mult_right_isotone star.circ_mult_upper_bound star.left_plus_below_circ<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"asymmetric <span class="var">?y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 acyclic_plus_asymmetric <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">⊔</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> antisym<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">≤</span> <span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 comp_isotone star_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_dist_sup conv_involutive conv_order conv_plus_commute sup_commute<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">⊔</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 4 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> irreflexive_conv_closed<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">≤</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> cancel_separate_1_sup conv_star_commute star.left_plus_below_circ<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="var">?y</span> <span class="main">⊔</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> conv_plus_commute conv_star_commute star.circ_reflexive star_left_unfold_equal sup.absorb1 sup_assoc sup_monoid.add_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>+</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span> <span class="main">≤</span> <span class="var">?y</span> <span class="main">⊔</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.order_lesseq_imp inf.sup_monoid.add_commute inf.sup_right_isotone p_inf_sup_below sup_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> 2 3 transitively_orientable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="quoted"><span class="quoted">"<span class="free">spanning</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">≤</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≤</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">⊔</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">∧</span> acyclic <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">∧</span> injective <span class="free"><span class="bound"><span class="entity">y</span></span></span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">spannable</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="main">∃</span><span class="bound">y</span> <span class="main">.</span> spanning <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="bound">y</span>"</span></span>

<span class="keyword1" id="Forests-acyclic_6_implies_spannable"><span class="command">lemma</span></span> acyclic_6_implies_spannable<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_6 <span class="free">x</span> <span class="main">⟹</span> spannable <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> acyclic_6_def star.circ_increasing sup.cobounded1 spannable_def<span class="main">)</span>

<span class="keyword1" id="Forests-acyclic_3a_spannable_implies_6"><span class="command">lemma</span></span> acyclic_3a_spannable_implies_6<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"acyclic_3a <span class="free">x</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"spannable <span class="free">x</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"acyclic_6 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> acyclic_6_def acyclic_3a_def assms conv_isotone le_supI spannable_def<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 10.3›</span></span>

<span class="keyword1" id="Forests-acyclic_6_implies_3a"><span class="command">lemma</span></span> acyclic_6_implies_3a<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_6 <span class="free">x</span> <span class="main">⟹</span> acyclic_3a <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> acyclic_6_implies_4a acyclic_4a_implies_3a<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 10.3›</span></span>

<span class="keyword1" id="Forests-acyclic_6_implies_2"><span class="command">lemma</span></span> acyclic_6_implies_2<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_6 <span class="free">x</span> <span class="main">⟹</span> acyclic_2 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> acyclic_6_implies_4a acyclic_6_symmetric acyclic_4_implies_2 acyclic_4a_implies_4<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 11›</span></span>

<span class="keyword1" id="Forests-acyclic_6_3a_spannable"><span class="command">lemma</span></span> acyclic_6_3a_spannable<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_6 <span class="free">x</span> <span class="main">⟷</span> symmetric <span class="free">x</span> <span class="main">∧</span> spannable <span class="free">x</span> <span class="main">∧</span> acyclic_3a <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> acyclic_6_implies_3a acyclic_3a_spannable_implies_6 acyclic_6_implies_spannable acyclic_6_symmetric <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">context</span></span> stone_kleene_relation_algebra
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 11.3›</span></span>

<span class="keyword1" id="Forests-point_spanning"><span class="command">lemma</span></span> point_spanning<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"point <span class="free">p</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"spanning <span class="main">(</span><span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="main">(</span><span class="free">p</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="quoted"><span class="quoted">"spannable <span class="main">(</span><span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"injective <span class="var">?y</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms injective_inf_closed<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">*</span> <span class="var">?y</span> <span class="main">≤</span> <span class="main">-</span><span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms cancel_separate_5 inf.sup_monoid.add_commute vector_inf_comp <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"transitive <span class="var">?y</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms vector_inf_comp<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"acyclic <span class="var">?y</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> transitive_acyclic_irreflexive<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">≤</span> <span class="var">?y</span> <span class="main">⊔</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> regular_complement_top sup_commute sup_inf_distrib1<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"top <span class="main">=</span> <span class="free">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">p</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms inf.eq_iff shunt_bijective top_greatest vector_conv_covector <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?y</span> <span class="main">⊔</span> <span class="main">1</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="var">?y</span> <span class="main">⊔</span> <span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 4 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_isotone mult_isotone<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="var">?y</span> <span class="main">⊔</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> antisym cancel_separate_1 conv_star_commute star.circ_mult_1 star.circ_mult_increasing star.right_plus_circ star_right_induct_mult sup_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="main">1</span> <span class="main">≤</span> <span class="main">(</span><span class="var">?y</span> <span class="main">⊔</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> top.extremum top_le <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"spanning <span class="main">(</span><span class="main">-</span><span class="main">1</span><span class="main">)</span> <span class="main">(</span><span class="free">p</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 3 inf.cobounded2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"spannable <span class="main">(</span><span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> spannable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(* move to Kleene_Relation_Algebras *)</span>
<span class="keyword1" id="Forests-irreflexive_star"><span class="command">lemma</span></span> irreflexive_star<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="main">1</span> <span class="main">≤</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_infI2 star.circ_reflexive<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span> <span class="main">≤</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star.circ_increasing<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">1</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> maddux_3_11_pp regular_one_closed sup.absorb_iff1 sup_assoc<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> antisym inf.cobounded1 star_involutive star_isotone<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 6.5›</span></span>

<span class="keyword1" id="Forests-acyclic_2_1"><span class="command">lemma</span></span> acyclic_2_1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"orientable <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"acyclic_2 <span class="free">x</span> <span class="main">⟷</span> acyclic_1 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"acyclic_2 <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"acyclic_1 <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> acyclic_2_implies_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"acyclic_1 <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"orientation <span class="free">x</span> <span class="skolem">y</span> <span class="main">∧</span> symmetric <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms orientable_def orientable_symmetric <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic_2 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> acyclic_2_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span>
    <span class="keyword3"><span class="command">assume</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">∧</span> asymmetric <span class="skolem">z</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?z</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="free">x</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="skolem">z</span> <span class="main">⊔</span> <span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"orientation <span class="free">x</span> <span class="var">?z</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?z</span> <span class="main">⊔</span> <span class="var">?z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="skolem">z</span> <span class="main">⊔</span> <span class="main">-</span><span class="main">-</span><span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="free">x</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="skolem">z</span> <span class="main">⊔</span> <span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊔</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> 2 3 comp_inf.semiring.combine_common_factor conv_complement conv_dist_inf conv_dist_sup inf_sup_distrib1 orientation_symmetric sup.left_commute sup_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> 2 inf_commute maddux_3_11_pp pp_dist_sup sup_monoid.add_commute<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?z</span> <span class="main">⊔</span> <span class="var">?z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="free">x</span>"</span></span>
        <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?z</span> <span class="main">⊓</span> <span class="var">?z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="free">x</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="skolem">z</span> <span class="main">⊔</span> <span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">x</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="skolem">z</span> <span class="main">⊔</span> <span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 2 conv_complement conv_dist_inf conv_dist_sup inf.sup_monoid.add_commute<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="free">x</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="skolem">z</span> <span class="main">⊓</span> <span class="free">x</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="skolem">z</span> <span class="main">⊔</span> <span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="skolem">z</span> <span class="main">⊔</span> <span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">x</span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="skolem">z</span> <span class="main">⊔</span> <span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="skolem">z</span> <span class="main">⊔</span> <span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> comp_inf.semiring.distrib_left inf_sup_distrib2 sup_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> bot"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> 2 3 inf.cobounded1 inf.left_commute inf.orderE p_dist_sup pseudo_complement sup.absorb_iff1<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?z</span> <span class="main">⊓</span> <span class="var">?z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
        <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">hence</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"acyclic <span class="var">?z</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 acyclic_1_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">≤</span> <span class="var">?z</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 3 le_supI1 pp_increasing<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="skolem">z</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 4 comp_isotone star_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 8›</span></span>

<span class="keyword1" id="Forests-acyclic_4_4c"><span class="command">lemma</span></span> acyclic_4_4c<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_4 <span class="free">x</span> <span class="main">⟷</span> acyclic_4c <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"acyclic_4 <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic_4c <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> acyclic_4c_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span>
    <span class="keyword3"><span class="command">assume</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 acyclic_4_def inf.cobounded1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="skolem">y</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> p_shunting_swap pseudo_complement<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 2 inf_absorb2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"acyclic_4c <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic_4 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> acyclic_4_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span>
    <span class="keyword3"><span class="command">assume</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 3 acyclic_4c_def inf_le1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> inf_import_p <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> p_inf_pp pp_dist_star pp_pp_inf_bot_iff<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 4 inf_absorb2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> p_shunting_swap pseudo_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 9›</span></span>

<span class="keyword1" id="Forests-acyclic_5f_5g"><span class="command">lemma</span></span> acyclic_5f_5g<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_5f <span class="free">x</span> <span class="main">⟷</span> acyclic_5g <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"acyclic_5f <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"acyclic_5g <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> acyclic_5f_def acyclic_5g_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"acyclic_5g <span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic_5f <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> acyclic_5f_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="skolem">z</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?z</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span>"</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">⊔</span> <span class="skolem">z</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">∧</span> <span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span> <span class="main">=</span> bot"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">≤</span> <span class="var">?y</span> <span class="main">∧</span> <span class="skolem">z</span> <span class="main">≤</span> <span class="var">?z</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> inf.sup_monoid.add_commute pseudo_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="var">?y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="var">?z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> comp_inf.mult_isotone star_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> acyclic_5g_def inf.left_commute inf.sup_monoid.add_commute maddux_3_11_pp<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="skolem">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> antisym star.circ_reflexive<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Forests-linear_orderable_3_implies_5"><span class="command">lemma</span></span> linear_orderable_3_implies_5<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"linear_orderable_3 <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"linear_orderable_5 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"top <span class="main">=</span> <span class="free">x</span> <span class="main">⊔</span> <span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms conv_dist_sup orientable_12_implies_11 sup_assoc sup_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊔</span> <span class="free">x</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> conv_star_commute star.circ_increasing star_sup_one sup_assoc sup_commute sup_mono<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms top_le transitive_acyclic_asymmetric<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Forests-linear_orderable_8_implies_7"><span class="command">lemma</span></span> linear_orderable_8_implies_7<span class="main">:</span>
  <span class="quoted"><span class="quoted">"linear_orderable_8 <span class="free">x</span> <span class="main">⟹</span> linear_orderable_7 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> orientable_12_implies_11 star_left_unfold_equal sup_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 13›</span></span>

<span class="keyword1" id="Forests-exists_split_characterisations_2"><span class="command">lemma</span></span> exists_split_characterisations_2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> linear_orderable_1 <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> linear_orderable_4 <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> linear_orderable_1 <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> linear_orderable_5 <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> linear_orderable_1 <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> linear_orderable_6 <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> linear_orderable_1 <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> linear_orderable_7 <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> linear_orderable_1 <span class="bound">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> linear_orderable_8 <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> 1 <span class="keyword1"><span class="command">using</span></span> exists_split_characterisations<span class="main">(</span>1<span class="main">)</span> strict_order_transitive_acyclic <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> 2 <span class="keyword1"><span class="command">using</span></span> 1 linear_orderable_3_implies_5 linear_orderable_6_implies_3 transitive_acyclic_asymmetric <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> 3 <span class="keyword1"><span class="command">using</span></span> 2 exists_split_characterisations<span class="main">(</span>1<span class="main">)</span> linear_orderable_6_implies_3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> 2 linear_orderable_8_implies_7 linear_orderable_6_implies_3 linear_orderable_7_implies_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">using</span></span> 3 linear_orderable_8_implies_7 asymmetric_irreflexive linear_orderable_6_implies_3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Arc axiom›</span></span>

<span class="keyword1"><span class="command">class</span></span> stone_kleene_relation_algebra_arc <span class="main">=</span> stone_kleene_relation_algebra <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> arc_axiom<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> bot <span class="main">⟹</span> <span class="main">∃</span><span class="bound">y</span> <span class="main">.</span> arc <span class="bound">y</span> <span class="main">∧</span> <span class="bound">y</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">x</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">subclass</span></span> stone_relation_algebra_tarski
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">unfold_locales</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≠</span> bot"</span></span>
  <span class="keyword1"><span class="command">from</span></span> 2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"arc <span class="skolem">y</span> <span class="main">∧</span> <span class="skolem">y</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="skolem">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> arc_axiom <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"top <span class="main">*</span> <span class="skolem">x</span> <span class="main">*</span> top <span class="main">=</span> top"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult_assoc le_iff_sup mult_left_isotone semiring.distrib_left sup.orderE top.extremum<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">context</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> orientable_path<span class="main">:</span> <span class="quoted"><span class="quoted">"arc <span class="free">x</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">z</span> <span class="main">.</span> <span class="bound">z</span> <span class="main">≤</span> <span class="free">y</span> <span class="main">∧</span> asymmetric <span class="bound">z</span> <span class="main">∧</span> <span class="free">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="bound">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 8.6›</span></span>

<span class="keyword1" id="Forests-acyclic_2_4"><span class="command">lemma</span></span> acyclic_2_4<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"irreflexive <span class="free">x</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"acyclic_2 <span class="free">x</span> <span class="main">⟷</span> acyclic_4 <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic_2 <span class="free">x</span> <span class="main">⟹</span> acyclic_4 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> acyclic_4_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> impI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span>
    <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"acyclic_2 <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">x</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span> <span class="main">≠</span> bot"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pseudo_complement<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">z</span></span> <span class="keyword2"><span class="keyword">where</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"arc <span class="skolem">z</span> <span class="main">∧</span> <span class="skolem">z</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> arc_axiom <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">w</span></span> <span class="keyword2"><span class="keyword">where</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">≤</span> <span class="skolem">y</span> <span class="main">∧</span> asymmetric <span class="skolem">w</span> <span class="main">∧</span> <span class="skolem">z</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="skolem">w</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> orientable_path <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 2 5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">⊓</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">w</span> <span class="main">⊓</span> <span class="skolem">z</span> <span class="main">⊓</span> <span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">x</span> <span class="main">⊓</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">x</span> <span class="main">⊓</span> <span class="skolem">z</span> <span class="main">⊓</span> <span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.commute sup.commute inf.left_commute sup.left_commute conv_dist_inf conv_dist_sup inf_sup_distrib1<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> bot"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">intro</span> sup_least<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">⊓</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> bot"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 5<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">⊓</span> <span class="skolem">z</span> <span class="main">⊓</span> <span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">z</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> 5 inf.coboundedI1<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">y</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 4 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> eq_refl inf.cobounded1 inf.left_commute inf.sup_monoid.add_commute inf_p order_trans pseudo_complement<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span> <span class="main">⊓</span> <span class="skolem">z</span> <span class="main">⊓</span> <span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> bot"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">x</span> <span class="main">⊓</span> <span class="skolem">w</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> bot"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> conv_dist_inf conv_inf_bot_iff inf.left_commute inf.sup_monoid.add_commute le_bot<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"irreflexive <span class="skolem">z</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> 4 assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> dual_order.trans irreflexive_complement_reflexive irreflexive_inf_closed reflexive_complement_irreflexive<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"asymmetric <span class="skolem">z</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 4 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> pseudo_complement irreflexive_inf_arc_asymmetric<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="free">x</span> <span class="main">⊓</span> <span class="skolem">z</span> <span class="main">⊓</span> <span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> bot"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf.left_commute inf.sup_monoid.add_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="var">?y</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 6 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_bot acyclic_2_def<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> acyclic_star_below_complement_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="var">?y</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> dual_order.trans pseudo_complement star.circ_sub_dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">w</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⊓</span> <span class="skolem">z</span> <span class="main">⊓</span> <span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_inf.semiring.distrib_left conv_dist_inf conv_dist_sup inf.sup_monoid.add_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">⊓</span> <span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 5 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_inf.p_pp_comp inf.absorb2 pp_pp_inf_bot_iff<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free">x</span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> pseudo_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">=</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 4 inf.orderE <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"False"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 3 4 comp_inf.coreflexive_pseudo_complement inf_bot_right <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic_4 <span class="free">x</span> <span class="main">⟹</span> acyclic_2 <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> acyclic_4_implies_2<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">context</span></span> kleene_relation_algebra
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 8›</span></span>

<span class="keyword1" id="Forests-acyclic_3a_implies_4b"><span class="command">lemma</span></span> acyclic_3a_implies_4b<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"acyclic_3a <span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"acyclic_4b <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> acyclic_4b_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="skolem">y</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?y</span> <span class="main">⊔</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> shunting_var <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star.circ_increasing star.circ_sub_dist sup_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 assms acyclic_3a_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="skolem">y</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>z3<span class="main"><span class="main">)</span></span> inf.sup_monoid.add_commute inf_sup_absorb inf_sup_distrib2 maddux_3_13 sup_commute sup_inf_absorb<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">⊓</span> <span class="skolem">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">=</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inf_absorb1 star.circ_increasing<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Forests-acyclic_3a_4b"><span class="command">lemma</span></span> acyclic_3a_4b<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_3a <span class="free">x</span> <span class="main">⟷</span> acyclic_4b <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> acyclic_3a_implies_4b acyclic_4a_4b acyclic_4a_implies_3a <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Forests-acyclic_4_4a"><span class="command">lemma</span></span> acyclic_4_4a<span class="main">:</span>
  <span class="quoted"><span class="quoted">"acyclic_4 <span class="free">x</span> <span class="main">⟷</span> acyclic_4a <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> acyclic_4_def acyclic_4a_def<span class="main">)</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Counterexamples›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Calls to nitpick have been put into comments to save processing time.
›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹independence of (0)›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">x</span> <span class="main">⟹</span> irreflexive_inf <span class="free">x</span> <span class="main">⟹</span> orientable <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹nitpick[expect=genuine,card=4,timeout=600]›</span></span>
  <span class="keyword1"><span class="command">oops</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="quoted"><span class="quoted">"linear_orderable_6 <span class="free">x</span> <span class="main">⟹</span> path_orderable <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹nitpick[expect=genuine,card=8,timeout=600]›</span></span>
  <span class="keyword1"><span class="command">oops</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹(5) does not imply (6)›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">x</span> <span class="main">⟹</span> irreflexive <span class="free">x</span> <span class="main">⟹</span> acyclic_5a <span class="free">x</span> <span class="main">⟹</span> acyclic_6 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹nitpick[expect=genuine,card=4,timeout=600]›</span></span>
  <span class="keyword1"><span class="command">oops</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹(2) does not imply (4)›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">x</span> <span class="main">⟹</span> irreflexive <span class="free">x</span> <span class="main">⟹</span> acyclic_2 <span class="free">x</span> <span class="main">⟹</span> acyclic_4 <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹nitpick[expect=genuine,card=8,timeout=600]›</span></span>
  <span class="keyword1"><span class="command">oops</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

</pre>
</div><div id="Algorithms">
<div class="head">
<h1>Theory Algorithms</h1>
</div>
<pre class="source"><span class="comment1">(* Title:      Axioms and Algorithmic Proofs
   Author:     Walter Guttmann
   Maintainer: Walter Guttmann &lt;walter.guttmann at canterbury.ac.nz&gt;
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Axioms and Algorithmic Proofs›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
In this theory we verify the correctness of three basic graph algorithms.
We use them to constructively prove a number of graph properties.
›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Algorithms

<span class="keyword2"><span class="keyword">imports</span></span> <span class="quoted">"<a href="https://www.cl.cam.ac.uk/research/hvg/Isabelle/dist/library/HOL/HOL-Hoare/Hoare_Logic.html">HOL-Hoare.Hoare_Logic</a>"</span> <a href="#Forests">Forests</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">context</span></span> stone_kleene_relation_algebra_arc
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Assuming the arc axiom we can define the function <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>choose_arc›</span></span></span></span> that selects an arc in a non-empty graph.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">choose_arc</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">≡</span> <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> bot <span class="keyword1">then</span> bot <span class="keyword1">else</span> <span class="keyword1">SOME</span> <span class="bound">y</span> <span class="main">.</span> arc <span class="bound">y</span> <span class="main">∧</span> <span class="bound">y</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>

<span class="keyword1" id="Algorithms-choose_arc_below"><span class="command">lemma</span></span> choose_arc_below<span class="main">:</span>
  <span class="quoted"><span class="quoted">"choose_arc <span class="free">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> bot"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> True
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> choose_arc_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?P</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">y</span> <span class="main">.</span> arc <span class="bound">y</span> <span class="main">∧</span> <span class="bound">y</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">x</span>"</span></span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">y</span> <span class="main">.</span> <span class="var">?P</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> someI_ex<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> someI_ex False arc_axiom <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> False choose_arc_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Algorithms-choose_arc_arc"><span class="command">lemma</span></span> choose_arc_arc<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> bot"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"arc <span class="main">(</span>choose_arc <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?P</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">y</span> <span class="main">.</span> arc <span class="bound">y</span> <span class="main">∧</span> <span class="bound">y</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">y</span> <span class="main">.</span> <span class="var">?P</span> <span class="bound">y</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> someI_ex<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> someI_ex assms arc_axiom <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> assms choose_arc_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Algorithms-choose_arc_bot"><span class="command">lemma</span></span> choose_arc_bot<span class="main">:</span>
  <span class="quoted"><span class="quoted">"choose_arc bot <span class="main">=</span> bot"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> bot_unique choose_arc_below regular_closed_bot<span class="main">)</span>

<span class="keyword1" id="Algorithms-choose_arc_bot_iff"><span class="command">lemma</span></span> choose_arc_bot_iff<span class="main">:</span>
  <span class="quoted"><span class="quoted">"choose_arc <span class="free">x</span> <span class="main">=</span> bot <span class="main">⟷</span> <span class="free">x</span> <span class="main">=</span> bot"</span></span>
  <span class="keyword1"><span class="command">using</span></span> covector_bot_closed inf_bot_right choose_arc_arc vector_bot_closed choose_arc_bot <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1" id="Algorithms-choose_arc_regular"><span class="command">lemma</span></span> choose_arc_regular<span class="main">:</span>
  <span class="quoted"><span class="quoted">"regular <span class="main">(</span>choose_arc <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> bot"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> bot"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> choose_arc_bot<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> bot"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> arc_regular choose_arc_arc<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Constructing a spanning tree›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">spanning_forest</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">≡</span> forest <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∧</span> components <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">≤</span> forest_components <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∧</span> regular <span class="free"><span class="bound"><span class="entity">f</span></span></span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">kruskal_spanning_invariant</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">≡</span> symmetric <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">∧</span> spanning_forest <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">(</span><span class="main">-</span><span class="free"><span class="bound"><span class="entity">h</span></span></span> <span class="main">⊓</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Algorithms-spanning_forest_spanning"><span class="command">lemma</span></span> spanning_forest_spanning<span class="main">:</span>
  <span class="quoted"><span class="quoted">"spanning_forest <span class="free">f</span> <span class="free">g</span> <span class="main">⟹</span> spanning <span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="free">g</span><span class="main">)</span> <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>z3<span class="main"><span class="main">)</span></span> cancel_separate_1 order_trans star.circ_increasing spanning_forest_def<span class="main">)</span>

<span class="keyword1" id="Algorithms-spanning_forest_spanning_regular"><span class="command">lemma</span></span> spanning_forest_spanning_regular<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">f</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">g</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"spanning_forest <span class="free">f</span> <span class="free">g</span> <span class="main">⟷</span> spanning <span class="free">g</span> <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>z3<span class="main"><span class="main">)</span></span> assms cancel_separate_1 components_increasing dual_order.trans forest_components_star star_isotone spanning_forest_def<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
We prove total correctness of Kruskal's spanning tree algorithm (ignoring edge weights) \cite{Kruskal1956}.
The algorithm and proof are adapted from the AFP theory <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Relational_Minimum_Spanning_Trees.Kruskal›</span></span></span></span> to work in Stone-Kleene relation algebras \cite{Guttmann2017c,Guttmann2018c}.
›</span></span>

<span class="keyword1" id="Algorithms-kruskal_vc_1"><span class="command">lemma</span></span> kruskal_vc_1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"kruskal_spanning_invariant bot <span class="free">g</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> kruskal_spanning_invariant_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">=</span> <span class="free">g</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="free">g</span> <span class="main">=</span> <span class="free">g</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> inf.sup_monoid.add_commute selection_closed_id <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"spanning_forest bot <span class="main">(</span><span class="main">-</span><span class="free">g</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> star.circ_transitive_equal spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
For the remainder of this theory we assume there are finitely many regular elements.
This means that the graphs are finite and is needed for proving termination of the algorithms.
›</span></span>

<span class="keyword1"><span class="command">context</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> finite_regular<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">}</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1" id="Algorithms-kruskal_vc_2"><span class="command">lemma</span></span> kruskal_vc_2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"kruskal_spanning_invariant <span class="free">f</span> <span class="free">g</span> <span class="free">h</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">≠</span> bot"</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>choose_arc <span class="free">h</span> <span class="main">≤</span> <span class="main">-</span>forest_components <span class="free">f</span> <span class="main">⟶</span> kruskal_spanning_invariant <span class="main">(</span><span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> choose_arc <span class="free">h</span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> top <span class="main">*</span> choose_arc <span class="free">h</span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> choose_arc <span class="free">h</span><span class="main">)</span> <span class="free">g</span> <span class="main">(</span><span class="free">h</span> <span class="main">⊓</span> <span class="main">-</span>choose_arc <span class="free">h</span> <span class="main">⊓</span> <span class="main">-</span>choose_arc <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>
                                               <span class="main">∧</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">h</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span>choose_arc <span class="free">h</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span>choose_arc <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span> <span class="main">&lt;</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">h</span> <span class="main">}</span><span class="main">)</span> <span class="main">∧</span>
           <span class="main">(</span><span class="main">¬</span> choose_arc <span class="free">h</span> <span class="main">≤</span> <span class="main">-</span>forest_components <span class="free">f</span> <span class="main">⟶</span> kruskal_spanning_invariant <span class="free">f</span> <span class="free">g</span> <span class="main">(</span><span class="free">h</span> <span class="main">⊓</span> <span class="main">-</span>choose_arc <span class="free">h</span> <span class="main">⊓</span> <span class="main">-</span>choose_arc <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>
                                                 <span class="main">∧</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">h</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span>choose_arc <span class="free">h</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span>choose_arc <span class="free">h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span> <span class="main">&lt;</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">h</span> <span class="main">}</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"choose_arc <span class="free">h</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">f</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="free">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="var">?e</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?h</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?e</span> <span class="main">⊓</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"forest_components <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">h</span> <span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">h</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?e</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="free">f</span> <span class="main">∧</span> regular <span class="var">?e</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> kruskal_spanning_invariant_def spanning_forest_def choose_arc_regular<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="var">?f</span> <span class="main">∧</span> regular <span class="var">?F</span> <span class="main">∧</span> regular <span class="main">(</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> regular_closed_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?e</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> inf.orderE choose_arc_bot_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> psubset_card_mono<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> finite_regular <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">using</span></span> 1 3 kruskal_spanning_invariant_def choose_arc_below <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span> <span class="main">⟶</span> kruskal_spanning_invariant <span class="var">?f</span> <span class="free">g</span> <span class="var">?h</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">¬</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span> <span class="main">⟶</span> kruskal_spanning_invariant <span class="free">f</span> <span class="free">g</span> <span class="var">?h</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> conjI<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"injective <span class="var">?f</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_injective_inv<span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> covector_mult_closed<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative comp_isotone star.right_plus_below_circ<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">meson</span> mult_left_isotone order_lesseq_imp star_outer_increasing top.extremum<span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> kruskal_spanning_invariant_def kruskal_injective_inv_2 choose_arc_arc spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> arc_injective choose_arc_arc <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> kruskal_spanning_invariant_def kruskal_injective_inv_3 choose_arc_arc spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span> <span class="main">⟶</span> kruskal_spanning_invariant <span class="var">?f</span> <span class="free">g</span> <span class="var">?h</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> 7<span class="main">:</span> <span class="quoted"><span class="quoted">"equivalence <span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def forest_components_equivalence spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> arc_top_arc choose_arc_arc<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 6 7 conv_complement conv_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">hence</span></span> 8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="var">?F</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">=</span> bot"</span></span>
        <span class="keyword1"><span class="command">using</span></span> le_bot triple_schroeder_p <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"kruskal_spanning_invariant <span class="var">?f</span> <span class="free">g</span> <span class="var">?h</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> kruskal_spanning_invariant_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?h</span> <span class="main">=</span> <span class="var">?h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_complement conv_dist_inf inf_commute inf_left_commute kruskal_spanning_invariant_def<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="var">?h</span> <span class="main">=</span> <span class="var">?h</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>hide_lams<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> kruskal_spanning_invariant_def inf_assoc pp_dist_inf<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"spanning_forest <span class="var">?f</span> <span class="main">(</span><span class="main">-</span><span class="var">?h</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> spanning_forest_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="var">?f</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="var">?f</span>"</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_acyclic_inv<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> covector_mult_closed<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> 8 assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def spanning_forest_def kruskal_acyclic_inv_1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> 8 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> comp_associative mult_left_sub_dist_sup_left star.circ_loop_fixpoint sup_commute le_bot<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> 6 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> p_antitone_iff<span class="main">)</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="main">-</span><span class="var">?h</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_subgraph_inv<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> kruskal_spanning_invariant_def choose_arc_below order.trans pp_isotone_inf<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"components <span class="main">(</span><span class="main">-</span><span class="var">?h</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> forest_components <span class="var">?f</span>"</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_spanning_inv<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> 5 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> 1 regular_closed_star regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="var">?f</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span> <span class="main">⟶</span> kruskal_spanning_invariant <span class="free">f</span> <span class="free">g</span> <span class="var">?h</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?F</span>"</span></span>
      <span class="keyword1"><span class="command">hence</span></span> 9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="var">?F</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 assms<span class="main">(</span>2<span class="main">)</span> arc_in_partition choose_arc_arc <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"kruskal_spanning_invariant <span class="free">f</span> <span class="free">g</span> <span class="var">?h</span> <span class="main">∧</span> <span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> kruskal_spanning_invariant_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?h</span> <span class="main">=</span> <span class="var">?h</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_complement conv_dist_inf inf_commute inf_left_commute kruskal_spanning_invariant_def<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">-</span><span class="var">?h</span> <span class="main">=</span> <span class="var">?h</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>hide_lams<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> kruskal_spanning_invariant_def inf_assoc pp_dist_inf<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"spanning_forest <span class="free">f</span> <span class="main">(</span><span class="main">-</span><span class="var">?h</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> spanning_forest_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"injective <span class="free">f</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"acyclic <span class="free">f</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="main">-</span><span class="free">h</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="main">-</span><span class="var">?h</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> comp_inf.mult_right_isotone inf.sup_monoid.add_commute inf_left_commute p_antitone_inf pp_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="main">-</span><span class="var">?h</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"components <span class="main">(</span><span class="main">-</span><span class="var">?h</span> <span class="main">⊓</span> <span class="free">g</span><span class="main">)</span> <span class="main">≤</span> <span class="var">?F</span>"</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> kruskal_spanning_inv_1<span class="main">)</span>
            <span class="keyword1"><span class="command">using</span></span> 9 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def spanning_forest_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> kruskal_spanning_invariant_def forest_components_equivalence spanning_forest_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">f</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?n2</span> <span class="main">&lt;</span> <span class="var">?n1</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> kruskal_spanning<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">VARS</span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">e</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">f</span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">h</span></span></span></span></span></span></span></span></span></span></span></span></span></span>
  <span class="main">[</span> symmetric <span class="free">g</span> <span class="main">]</span>
  f <span class="main">:=</span> bot<span class="main">;</span>
  h <span class="main">:=</span> <span class="free">g</span><span class="main">;</span>
  <span class="keyword1">WHILE</span> <span class="bound">h</span> <span class="main">≠</span> bot
    <span class="keyword1">INV</span> <span class="main">{</span> kruskal_spanning_invariant <span class="bound">f</span> <span class="free">g</span> <span class="bound">h</span> <span class="main">}</span>
    <span class="keyword1">VAR</span> <span class="main">{</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="bound">h</span> <span class="main">}</span> <span class="main">}</span>
     <span class="keyword1">DO</span> e <span class="main">:=</span> choose_arc <span class="bound">h</span><span class="main">;</span>
        <span class="keyword1">IF</span> <span class="bound">e</span> <span class="main">≤</span> <span class="main">-</span>forest_components <span class="bound">f</span> <span class="keyword1">THEN</span>
          f <span class="main">:=</span> <span class="main">(</span><span class="bound">f</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span>top <span class="main">*</span> <span class="bound">e</span> <span class="main">*</span> <span class="bound">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="bound">f</span> <span class="main">⊓</span> top <span class="main">*</span> <span class="bound">e</span> <span class="main">*</span> <span class="bound">f</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊔</span> <span class="bound">e</span>
        <span class="keyword1">ELSE</span>
          <span class="keyword1">SKIP</span>
        <span class="keyword1">FI</span><span class="main">;</span>
        h <span class="main">:=</span> <span class="bound">h</span> <span class="main">⊓</span> <span class="main">-</span><span class="bound">e</span> <span class="main">⊓</span> <span class="main">-</span><span class="bound">e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>
     <span class="keyword1">OD</span>
  <span class="main">[</span> spanning_forest <span class="bound">f</span> <span class="free">g</span> <span class="main">]</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">vcg_tc_simp</span>
  <span class="keyword1"><span class="command">using</span></span> kruskal_vc_1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">using</span></span> kruskal_vc_2 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">using</span></span> kruskal_spanning_invariant_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Algorithms-kruskal_exists_spanning"><span class="command">lemma</span></span> kruskal_exists_spanning<span class="main">:</span>
  <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">f</span> <span class="main">.</span> spanning_forest <span class="bound">f</span> <span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> tc_extract_function kruskal_spanning <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 16›</span></span>

<span class="keyword1" id="Algorithms-symmetric_spannable"><span class="command">lemma</span></span> symmetric_spannable<span class="main">:</span>
  <span class="quoted"><span class="quoted">"symmetric <span class="free">g</span> <span class="main">⟹</span> spannable <span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="free">g</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> kruskal_exists_spanning spanning_forest_spanning spannable_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Breadth-first search›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
We prove total correctness of a simple breadth-first search algorithm.
It is a variant of an algorithm discussed in \cite{Berghammer1999}.
›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> bfs_reachability<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">VARS</span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">p</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">q</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">t</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
  <span class="main">[</span> regular <span class="free">r</span> <span class="main">∧</span> regular <span class="free">s</span> <span class="main">∧</span> vector <span class="free">s</span> <span class="main">]</span>
  t <span class="main">:=</span> bot<span class="main">;</span>
  q <span class="main">:=</span> <span class="free">s</span><span class="main">;</span>
  p <span class="main">:=</span> <span class="main">-</span><span class="free">s</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">s</span><span class="main">;</span>
  <span class="keyword1">WHILE</span> <span class="bound">p</span> <span class="main">≠</span> bot
    <span class="keyword1">INV</span> <span class="main">{</span> regular <span class="free">r</span> <span class="main">∧</span> regular <span class="bound">q</span> <span class="main">∧</span> vector <span class="bound">q</span> <span class="main">∧</span> asymmetric <span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span> <span class="main">≤</span> <span class="free">r</span> <span class="main">∧</span> <span class="bound">t</span> <span class="main">≤</span> <span class="bound">q</span> <span class="main">∧</span> <span class="bound">q</span> <span class="main">=</span> <span class="bound">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span> <span class="main">∧</span> <span class="bound">p</span> <span class="main">=</span> <span class="main">-</span><span class="bound">q</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="bound">q</span> <span class="main">}</span>
    <span class="keyword1">VAR</span> <span class="main">{</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="main">-</span><span class="bound">q</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">}</span> <span class="main">}</span>
     <span class="keyword1">DO</span> t <span class="main">:=</span> <span class="bound">t</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="bound">q</span> <span class="main">*</span> <span class="bound">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">;</span>
        q <span class="main">:=</span> <span class="bound">q</span> <span class="main">⊔</span> <span class="bound">p</span><span class="main">;</span>
        p <span class="main">:=</span> <span class="main">-</span><span class="bound">q</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="bound">p</span>
     <span class="keyword1">OD</span>
  <span class="main">[</span> asymmetric <span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span> <span class="main">≤</span> <span class="free">r</span> <span class="main">∧</span> <span class="bound">q</span> <span class="main">=</span> <span class="bound">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span> <span class="main">∧</span> <span class="bound">q</span> <span class="main">=</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span> <span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">vcg_tc</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p</span> <span class="skolem">q</span> <span class="skolem">t</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">r</span> <span class="main">∧</span> regular <span class="free">s</span> <span class="main">∧</span> vector <span class="free">s</span>"</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">r</span> <span class="main">∧</span> regular <span class="free">s</span> <span class="main">∧</span> vector <span class="free">s</span> <span class="main">∧</span> asymmetric bot <span class="main">∧</span> bot <span class="main">≤</span> <span class="free">r</span> <span class="main">∧</span> bot <span class="main">≤</span> <span class="free">s</span> <span class="main">∧</span> <span class="free">s</span> <span class="main">=</span> bot<span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span> <span class="main">∧</span> <span class="main">-</span><span class="free">s</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">s</span> <span class="main">=</span> <span class="main">-</span><span class="free">s</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="free">s</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> star.circ_zero<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p</span> <span class="skolem">q</span> <span class="skolem">t</span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>regular <span class="free">r</span> <span class="main">∧</span> regular <span class="skolem">q</span> <span class="main">∧</span> vector <span class="skolem">q</span> <span class="main">∧</span> asymmetric <span class="skolem">t</span> <span class="main">∧</span> <span class="skolem">t</span> <span class="main">≤</span> <span class="free">r</span> <span class="main">∧</span> <span class="skolem">t</span> <span class="main">≤</span> <span class="skolem">q</span> <span class="main">∧</span> <span class="skolem">q</span> <span class="main">=</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span> <span class="main">∧</span> <span class="skolem">p</span> <span class="main">=</span> <span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span><span class="main">)</span> <span class="main">∧</span> <span class="main">¬</span> <span class="skolem">p</span> <span class="main">≠</span> bot"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">=</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> antisym<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> 1 conv_order mult_left_isotone star_isotone <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.sup_monoid.add_commute mult_1_left mult_left_isotone mult_right_isotone order_lesseq_imp pseudo_complement star.circ_reflexive star_left_induct_mult<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"asymmetric <span class="skolem">t</span> <span class="main">∧</span> <span class="skolem">t</span> <span class="main">≤</span> <span class="free">r</span> <span class="main">∧</span> <span class="skolem">q</span> <span class="main">=</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span> <span class="main">∧</span> <span class="skolem">q</span> <span class="main">=</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">p</span> <span class="skolem">q</span> <span class="skolem">t</span>
  <span class="keyword3"><span class="command">assume</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span>regular <span class="free">r</span> <span class="main">∧</span> regular <span class="skolem">q</span> <span class="main">∧</span> vector <span class="skolem">q</span> <span class="main">∧</span> asymmetric <span class="skolem">t</span> <span class="main">∧</span> <span class="skolem">t</span> <span class="main">≤</span> <span class="free">r</span> <span class="main">∧</span> <span class="skolem">t</span> <span class="main">≤</span> <span class="skolem">q</span> <span class="main">∧</span> <span class="skolem">q</span> <span class="main">=</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span> <span class="main">∧</span> <span class="skolem">p</span> <span class="main">=</span> <span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span><span class="main">)</span> <span class="main">∧</span> <span class="skolem">p</span> <span class="main">≠</span> bot<span class="main">)</span> <span class="main">∧</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">}</span> <span class="main">=</span> <span class="skolem">n</span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"vector <span class="skolem">p</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> vector_complement_closed vector_inf_closed vector_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">p</span><span class="main">,</span> <span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">,</span> <span class="skolem">t</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span>
        <span class="main">∈</span> <span class="main">{</span> <span class="bound">trip</span> <span class="main">.</span> <span class="main">(</span><span class="keyword1">case</span> <span class="bound">trip</span> <span class="keyword1">of</span> <span class="main">(</span><span class="bound">p</span><span class="main">,</span> <span class="bound">q</span><span class="main">,</span> <span class="bound">t</span><span class="main">)</span> <span class="main">⇒</span> regular <span class="free">r</span> <span class="main">∧</span> regular <span class="bound">q</span> <span class="main">∧</span> vector <span class="bound">q</span> <span class="main">∧</span> asymmetric <span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span> <span class="main">≤</span> <span class="free">r</span> <span class="main">∧</span> <span class="bound">t</span> <span class="main">≤</span> <span class="bound">q</span> <span class="main">∧</span> <span class="bound">q</span> <span class="main">=</span> <span class="bound">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span> <span class="main">∧</span> <span class="bound">p</span> <span class="main">=</span> <span class="main">-</span><span class="bound">q</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="bound">q</span><span class="main">)</span> <span class="main">∧</span>
                   <span class="main">(</span><span class="keyword1">case</span> <span class="bound">trip</span> <span class="keyword1">of</span> <span class="main">(</span><span class="bound">p</span><span class="main">,</span> <span class="bound">q</span><span class="main">,</span> <span class="bound">t</span><span class="main">)</span> <span class="main">⇒</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="main">-</span><span class="bound">q</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">}</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">n</span> <span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> CollectI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> conjI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">intro</span> case_prodI<span class="main"><span class="keyword3">,</span></span> <span class="operator">intro</span> conjI<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="free">r</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"regular <span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"vector <span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 vector_complement_closed vector_inf_closed vector_mult_closed vector_sup_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"asymmetric <span class="main">(</span><span class="skolem">t</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="skolem">t</span> <span class="main">⊓</span> <span class="skolem">p</span> <span class="main">*</span> <span class="skolem">q</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_inf.mult_right_isotone conv_dist_comp conv_involutive conv_order inf.cobounded2<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">t</span> <span class="main">⊓</span> <span class="skolem">p</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_inf.mult_right_isotone comp_inf.star.circ_sup_sub_sup_one_1 inf.boundedE le_sup_iff mult_right_isotone<span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> antisym bot_least inf.sup_monoid.add_assoc pseudo_complement<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
          <span class="keyword1"><span class="command">using</span></span> conv_inf_bot_iff inf_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">p</span> <span class="main">*</span> <span class="skolem">q</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_inf.comp_isotone conv_dist_comp conv_involutive conv_order inf.cobounded2<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="skolem">q</span> <span class="main">⊓</span> <span class="skolem">p</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_inf.comp_isotone inf.cobounded1 vector_covector<span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.cobounded1 inf.sup_monoid.add_commute le_bot pseudo_complement<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">t</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span> <span class="main">⊓</span> <span class="main">(</span><span class="skolem">t</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="main">(</span><span class="skolem">t</span> <span class="main">⊓</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">t</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⊓</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sup.commute sup.left_commute conv_dist_sup inf_sup_distrib1 inf_sup_distrib2<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> bot"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 4 5 6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="free">r</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> inf.cobounded1 le_supI<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> comp_inf.star.circ_sup_sub_sup_one_1 inf.absorb2 inf.coboundedI2 inf.sup_monoid.add_commute le_sup_iff mult_right_isotone sup_left_divisibility<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">t</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> antisym<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> 7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">≤</span> <span class="main">(</span><span class="skolem">t</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_order mult_left_isotone star_isotone sup_left_divisibility<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span> <span class="main">≤</span> <span class="main">(</span><span class="skolem">t</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 comp_associative conv_dist_sup inf.coboundedI2 mult_right_sub_dist_sup_right <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="skolem">t</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_sup mult_left_isotone star.circ_increasing star.circ_mult_upper_bound star.circ_sub_dist<span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 8<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span> <span class="main">≤</span> <span class="main">(</span><span class="skolem">t</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span>"</span></span>
          <span class="keyword1"><span class="command">.</span></span>
        <span class="keyword1"><span class="command">have</span></span> 9<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">q</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span> <span class="main">=</span> bot"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_dist_inf covector_inf_comp_3 pp_inf_p semiring.mult_not_zero vector_complement_closed<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span><span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span> <span class="main">=</span> <span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">-</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="main">-</span><span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> p_dist_inf vector_covector<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">q</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_sup inf_sup_distrib1 mult_right_dist_sup<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 9 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">p</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_complement conv_dist_inf conv_involutive inf.sup_monoid.add_assoc inf_vector_comp vector_complement_closed<span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 10<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span><span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span> <span class="main">=</span> bot"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 inf_import_p pseudo_complement <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span><span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>z3<span class="main"><span class="main">)</span></span> maddux_3_11_pp pp_dist_comp regular_closed_inf regular_conv_closed<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">=</span> <span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="main">(</span><span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span><span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="main">-</span><span class="main">(</span><span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_sup inf_sup_distrib1 semiring.distrib_right<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="skolem">t</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 8 10 le_sup_iff bot_least <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span> <span class="main">≤</span> <span class="main">(</span><span class="skolem">t</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 7 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">have</span></span> 11<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span> <span class="main">≤</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 conv_order mult_left_isotone <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">p</span> <span class="main">≤</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult_right_isotone<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="skolem">q</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 regular_complement_top semiring.distrib_left <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">-</span><span class="skolem">q</span> <span class="main">=</span> bot"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> bot_least conv_complement_sub conv_dist_comp conv_involutive mult_right_isotone regular_closed_bot stone sup.absorb2 sup_commute<span class="main">)</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 12<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">p</span> <span class="main">≤</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 11 order.trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">have</span></span> 13<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span> <span class="main">≤</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_inf mult_left_isotone<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">p</span> <span class="main">≤</span> <span class="skolem">p</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_dist_comp conv_dist_inf conv_involutive inf.coboundedI2 mult_isotone mult_right_isotone top.extremum<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> 14<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">p</span> <span class="main">≤</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 le_infE <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">t</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">p</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">p</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_dist_sup semiring.distrib_left semiring.distrib_right sup_assoc<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 11 12 13 14 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">t</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> maddux_3_21_pp sup.boundedE sup_right_divisibility<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">t</span> <span class="main">⊔</span> <span class="main">(</span><span class="free">r</span> <span class="main">⊓</span> <span class="skolem">q</span> <span class="main">*</span> <span class="skolem">p</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span> <span class="main">≤</span> <span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>verit<span class="main"><span class="main">,</span></span> ccfv_SIG<span class="main"><span class="main">)</span></span> star.circ_loop_fixpoint star_left_induct sup.bounded_iff sup_left_divisibility<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">p</span> <span class="main">=</span> <span class="main">-</span><span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> antisym<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">p</span> <span class="main">≤</span> <span class="main">-</span><span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> inf.sup_right_isotone mult_left_sub_dist_sup_right <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">have</span></span> 15<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">=</span> <span class="main">-</span> <span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span> <span class="main">⊔</span> <span class="main">-</span> <span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">p</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_inf.semiring.distrib_left mult_left_dist_sup<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span> <span class="main">≤</span> <span class="main">-</span> <span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">p</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> bot_least p_dist_inf p_dist_sup p_inf_sup_below pseudo_complement<span class="main">)</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span> <span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">≤</span> <span class="main">-</span> <span class="main">(</span><span class="skolem">q</span> <span class="main">⊔</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">p</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 15 sup.absorb2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">subgoal</span></span></span></span> <span class="keyword1"><span class="command">proof</span></span> <span class="operator">clarsimp</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">q</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">p</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">}</span> <span class="main">&lt;</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> psubset_card_mono<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">}</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> finite_regular <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">q</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">p</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">}</span> <span class="main">⊂</span> <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">}</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">q</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">⟶</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> 16<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">q</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">p</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">}</span> <span class="main">⊆</span> <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">}</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">have</span></span> 17<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="skolem">p</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 2 regular_conv_closed regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
          <span class="keyword1"><span class="command">hence</span></span> 18<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="skolem">p</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">p</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inf.absorb1 pp_inf_p<span class="main">)</span>
          <span class="keyword1"><span class="command">have</span></span> 19<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">q</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">q</span> <span class="main">≤</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> comp_associative conv_dist_sup mult_left_isotone star.circ_increasing star.circ_mult_upper_bound star.circ_sub_dist sup_left_divisibility<span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> 20<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 2 le_infI2 order_lesseq_imp pp_increasing <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">hence</span></span> 21<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="main">-</span><span class="skolem">q</span> <span class="main">⊓</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">using</span></span> 16 17 18 19 20 21 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">q</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">p</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="main">(</span><span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">}</span> <span class="main">&lt;</span> <span class="skolem">n</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 18›</span></span>

<span class="keyword1" id="Algorithms-bfs_reachability_exists"><span class="command">lemma</span></span> bfs_reachability_exists<span class="main">:</span>
  <span class="quoted"><span class="quoted">"regular <span class="free">r</span> <span class="main">∧</span> regular <span class="free">s</span> <span class="main">∧</span> vector <span class="free">s</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">t</span> <span class="main">.</span> asymmetric <span class="bound">t</span> <span class="main">∧</span> <span class="bound">t</span> <span class="main">≤</span> <span class="free">r</span> <span class="main">∧</span> <span class="bound">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span> <span class="main">=</span> <span class="free">r</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">s</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> tc_extract_function bfs_reachability <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 17›</span></span>

<span class="keyword1" id="Algorithms-orientable_path"><span class="command">lemma</span></span> orientable_path<span class="main">:</span>
  <span class="quoted"><span class="quoted">"arc <span class="free">x</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">z</span> <span class="main">.</span> <span class="bound">z</span> <span class="main">≤</span> <span class="free">y</span> <span class="main">∧</span> asymmetric <span class="bound">z</span> <span class="main">∧</span> <span class="free">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="bound">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"arc <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">y</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"regular <span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="free">y</span><span class="main">)</span> <span class="main">∧</span> regular <span class="main">(</span><span class="free">x</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">∧</span> vector <span class="main">(</span><span class="free">x</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> bijective_regular mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"asymmetric <span class="skolem">t</span> <span class="main">∧</span> <span class="skolem">t</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="free">y</span> <span class="main">∧</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> top<span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="free">y</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> top<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> bfs_reachability_exists <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?z</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">⊓</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="free">y</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> arc_top_arc conv_complement conv_isotone conv_star_commute arc_conv_closed pp_dist_star<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="free">y</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">x</span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 comp_associative conv_dist_comp shunt_bijective <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span> <span class="main">*</span> <span class="free">x</span> <span class="main">*</span> top"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 3 mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> top <span class="main">*</span> <span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 comp_associative conv_dist_comp shunt_bijective <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> arc_top_arc arc_conv_closed<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">(</span><span class="main">-</span><span class="main">-</span><span class="var">?z</span><span class="main">)</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_order inf.orderE inf_pp_semi_commute star_isotone<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="var">?z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> conv_order conv_star_commute pp_dist_star <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">z</span> <span class="main">.</span> <span class="bound">z</span> <span class="main">≤</span> <span class="free">y</span> <span class="main">∧</span> asymmetric <span class="bound">z</span> <span class="main">∧</span> <span class="free">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">-</span><span class="bound">z</span><span class="main"><span class="hidden">⇧</span><sup>⋆</sup></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> 3 asymmetric_inf_closed inf.cobounded2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Extending partial orders to linear orders›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
We prove total correctness of Szpilrajn's algorithm \cite{Szpilrajn1930}.
A partial-correctness proof using Prover9 is given in \cite{BerghammerStruth2010}.
›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> szpilrajn<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="keyword1">VARS</span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">e</span></span></span></span></span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound">t</span></span></span></span></span></span></span></span></span>
  <span class="main">[</span> order <span class="free">p</span> <span class="main">∧</span> regular <span class="free">p</span> <span class="main">]</span>
  t <span class="main">:=</span> <span class="free">p</span><span class="main">;</span>
  <span class="keyword1">WHILE</span> <span class="bound">t</span> <span class="main">⊔</span> <span class="bound">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≠</span> top
    <span class="keyword1">INV</span> <span class="main">{</span> order <span class="bound">t</span> <span class="main">∧</span> regular <span class="bound">t</span> <span class="main">∧</span> <span class="free">p</span> <span class="main">≤</span> <span class="bound">t</span> <span class="main">}</span>
    <span class="keyword1">VAR</span> <span class="main">{</span> card <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="main">(</span><span class="bound">t</span> <span class="main">⊔</span> <span class="bound">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">}</span> <span class="main">}</span>
     <span class="keyword1">DO</span> e <span class="main">:=</span> choose_arc <span class="main">(</span><span class="main">-</span><span class="main">(</span><span class="bound">t</span> <span class="main">⊔</span> <span class="bound">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span><span class="main">)</span><span class="main">;</span>
        t <span class="main">:=</span> <span class="bound">t</span> <span class="main">⊔</span> <span class="bound">t</span> <span class="main">*</span> <span class="bound">e</span> <span class="main">*</span> <span class="bound">t</span>
     <span class="keyword1">OD</span>
  <span class="main">[</span> linear_order <span class="bound">t</span> <span class="main">∧</span> <span class="free">p</span> <span class="main">≤</span> <span class="bound">t</span> <span class="main">]</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">vcg_tc_simp</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">t</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"choose_arc <span class="main">(</span><span class="main">-</span><span class="skolem">t</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?tet</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">t</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?t</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">⊔</span> <span class="var">?tet</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?s1</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?tet</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?s2</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"reflexive <span class="skolem">t</span> <span class="main">∧</span> transitive <span class="skolem">t</span> <span class="main">∧</span> antisymmetric <span class="skolem">t</span> <span class="main">∧</span> regular <span class="skolem">t</span> <span class="main">∧</span> <span class="free">p</span> <span class="main">≤</span> <span class="skolem">t</span> <span class="main">∧</span> <span class="main">¬</span> linear <span class="skolem">t</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"reflexive <span class="var">?t</span> <span class="main">∧</span>
        transitive <span class="var">?t</span> <span class="main">∧</span>
        antisymmetric <span class="var">?t</span> <span class="main">∧</span>
        <span class="var">?t</span> <span class="main">=</span> <span class="skolem">t</span> <span class="main">⊔</span> <span class="main">-</span><span class="main">-</span><span class="var">?tet</span> <span class="main">∧</span>
        <span class="free">p</span> <span class="main">≤</span> <span class="var">?t</span> <span class="main">∧</span>
        card <span class="var">?s1</span> <span class="main">&lt;</span> card <span class="var">?s2</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">intro</span> conjI<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"reflexive <span class="var">?t</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sup.coboundedI1<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="skolem">t</span> <span class="main">⊓</span> <span class="main">-</span><span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≠</span> bot"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 regular_closed_top regular_conv_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"arc <span class="var">?e</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> choose_arc_arc <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?t</span> <span class="main">*</span> <span class="var">?t</span> <span class="main">=</span> <span class="skolem">t</span> <span class="main">*</span> <span class="skolem">t</span> <span class="main">⊔</span> <span class="skolem">t</span> <span class="main">*</span> <span class="var">?tet</span> <span class="main">⊔</span> <span class="var">?tet</span> <span class="main">*</span> <span class="skolem">t</span> <span class="main">⊔</span> <span class="var">?tet</span> <span class="main">*</span> <span class="var">?tet</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>z3<span class="main"><span class="main">)</span></span> mult_left_dist_sup mult_right_dist_sup sup_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="var">?t</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">intro</span> sup_least<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">*</span> <span class="skolem">t</span> <span class="main">≤</span> <span class="var">?t</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 sup.coboundedI1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">*</span> <span class="var">?tet</span> <span class="main">≤</span> <span class="var">?t</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> le_supI2 mult_left_isotone mult_assoc<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?tet</span> <span class="main">*</span> <span class="skolem">t</span> <span class="main">≤</span> <span class="var">?t</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 mult_right_isotone sup.coboundedI2 mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="skolem">t</span> <span class="main">*</span> <span class="skolem">t</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="var">?e</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> arc_top_arc mult_assoc mult_right_isotone mult_left_isotone top_greatest<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"transitive <span class="var">?tet</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> mult_assoc mult_right_isotone mult_left_isotone<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="var">?tet</span> <span class="main">*</span> <span class="var">?tet</span> <span class="main">≤</span> <span class="var">?t</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> le_supI2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"transitive <span class="var">?t</span>"</span></span>
      <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> choose_arc_below inf.cobounded2 order_lesseq_imp p_dist_sup regular_closed_p<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> choose_arc_below inf.cobounded1 order_trans regular_closed_inf regular_closed_p<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?t</span> <span class="main">⊓</span> <span class="var">?t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> <span class="main">(</span><span class="skolem">t</span> <span class="main">⊓</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="skolem">t</span> <span class="main">⊓</span> <span class="var">?tet</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?tet</span> <span class="main">⊓</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span> <span class="main">⊔</span> <span class="main">(</span><span class="var">?tet</span> <span class="main">⊓</span> <span class="var">?tet</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>z3<span class="main"><span class="main">)</span></span> conv_dist_sup inf_sup_distrib1 inf_sup_distrib2 sup_monoid.add_assoc<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">intro</span> sup_least<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"antisymmetric <span class="skolem">t</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">*</span> <span class="skolem">t</span> <span class="main">*</span> <span class="skolem">t</span> <span class="main">=</span> <span class="skolem">t</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 preorder_idempotent <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> p_antitone_iff conv_complement conv_order conv_involutive<span class="main">)</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> triple_schroeder_p <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">⊓</span> <span class="var">?tet</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_associative conv_dist_comp p_antitone pseudo_complement_pp<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">⊓</span> <span class="var">?tet</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="var">?tet</span> <span class="main">⊓</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> conv_isotone inf_commute conv_one conv_dist_inf conv_involutive<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="skolem">t</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">≤</span> <span class="var">?e</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> arc_top_arc mult_assoc mult_right_isotone mult_left_isotone top_greatest<span class="main">)</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?tet</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> conv_dist_comp schroeder_3_p triple_schroeder_p<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span> <span class="main">*</span> <span class="skolem">t</span> <span class="main">*</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">t</span> <span class="main">*</span> <span class="skolem">t</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> preorder_idempotent mult_assoc<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?e</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">≤</span> <span class="main">-</span><span class="var">?tet</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> triple_schroeder_p mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?tet</span> <span class="main">⊓</span> <span class="var">?tet</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">=</span> bot"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conv_dist_comp p_antitone pseudo_complement_pp mult_assoc<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"antisymmetric <span class="var">?tet</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"antisymmetric <span class="var">?t</span>"</span></span>
      <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?t</span> <span class="main">=</span> <span class="skolem">t</span> <span class="main">⊔</span> <span class="main">-</span><span class="main">-</span><span class="var">?tet</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 choose_arc_regular regular_mult_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">≤</span> <span class="var">?t</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_supI1<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"card <span class="var">?s1</span> <span class="main">&lt;</span> card <span class="var">?s2</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> psubset_card_mono<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> finite_regular <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?tet</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span> <span class="main">⊂</span> <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?tet</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">⟶</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> conv_dist_sup <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">hence</span></span> 5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?tet</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span> <span class="main">⊆</span> <span class="main">{</span> <span class="bound">x</span> <span class="main">.</span> regular <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">}</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">have</span></span> 6<span class="main">:</span> <span class="quoted"><span class="quoted">"regular <span class="var">?e</span> <span class="main">∧</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span> <span class="main">∧</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> 2 3 4 choose_arc_regular <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?tet</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span>
          <span class="keyword3"><span class="command">assume</span></span> 7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="main">-</span><span class="var">?tet</span>"</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">≤</span> <span class="var">?e</span> <span class="main">*</span> <span class="skolem">t</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> mult_right_isotone mult_sub_right_one order.trans<span class="main">)</span> 
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">*</span> <span class="skolem">t</span> <span class="main">≤</span> <span class="main">-</span><span class="main">(</span><span class="skolem">t</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?e</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 7 p_antitone_iff schroeder_3_p mult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">≤</span> <span class="main">-</span><span class="main">(</span><span class="main">1</span><span class="keyword1"><span class="hidden">⇧</span><sup>T</sup></span> <span class="main">*</span> <span class="var">?e</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> 1 conv_isotone mult_left_isotone p_antitone <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">-</span><span class="var">?e</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span>
            <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>z3<span class="main"><span class="main">)</span></span> bot_least eq_refl inf.absorb1 pseudo_complement semiring.mult_not_zero top_le<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">using</span></span> 5 6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem 15›</span></span>

<span class="keyword1" id="Algorithms-szpilrajn_exists"><span class="command">lemma</span></span> szpilrajn_exists<span class="main">:</span>
  <span class="quoted"><span class="quoted">"order <span class="free">p</span> <span class="main">∧</span> regular <span class="free">p</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">t</span> <span class="main">.</span> linear_order <span class="bound">t</span> <span class="main">∧</span> <span class="free">p</span> <span class="main">≤</span> <span class="bound">t</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> tc_extract_function szpilrajn <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Algorithms-complement_one_transitively_orientable"><span class="command">lemma</span></span> complement_one_transitively_orientable<span class="main">:</span>
  <span class="quoted"><span class="quoted">"transitively_orientable <span class="main">(</span><span class="main">-</span><span class="main">1</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">t</span> <span class="main">.</span> linear_order <span class="bound">t</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> szpilrajn_exists bijective_one_closed bijective_regular order_one_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> exists_split_characterisations<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

</pre>
</div>
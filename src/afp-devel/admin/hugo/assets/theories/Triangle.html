<div id="Angles">
<div class="head">
<h1>Theory Angles</h1>
</div>
<pre class="source"><span class="comment1">(*
  File:    Angles.thy
  Author:  Manuel Eberl &lt;eberlm@in.tum.de&gt;

  Definition of angles between vectors and between three points.
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Definition of angles›</span></span>
<span class="keyword1"><span class="command">theory</span></span> Angles
<span class="keyword2"><span class="keyword">imports</span></span>
  <span class="quoted">"<a href="../../HOL/HOL-Analysis/Multivariate_Analysis.html">HOL-Analysis.Multivariate_Analysis</a>"</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1" id="Angles-collinear_translate_iff"><span class="command">lemma</span></span> collinear_translate_iff<span class="main">:</span> <span class="quoted"><span class="quoted">"collinear <span class="main">(</span><span class="main">(</span><span class="main">(+)</span> <span class="free">a</span><span class="main">)</span> <span class="main">`</span> <span class="free">A</span><span class="main">)</span> <span class="main">⟷</span> collinear <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> collinear_def<span class="main">)</span>


<span class="keyword1"><span class="command">definition</span></span> <span class="entity">vangle</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">vangle</span> <span class="free"><span class="bound"><span class="entity">u</span></span></span> <span class="free"><span class="bound"><span class="entity">v</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">u</span></span></span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="free"><span class="bound"><span class="entity">v</span></span></span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span> pi <span class="main">/</span> <span class="numeral">2</span> <span class="keyword1">else</span> arccos <span class="main">(</span><span class="free"><span class="bound"><span class="entity">u</span></span></span> <span class="main">∙</span> <span class="free"><span class="bound"><span class="entity">v</span></span></span> <span class="main">/</span> <span class="main">(</span>norm <span class="free"><span class="bound"><span class="entity">u</span></span></span> <span class="main">*</span> norm <span class="free"><span class="bound"><span class="entity">v</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">angle</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">angle</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="free"><span class="bound"><span class="entity">b</span></span></span> <span class="free"><span class="bound"><span class="entity">c</span></span></span> <span class="main">=</span> vangle <span class="main">(</span><span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="main">-</span> <span class="free"><span class="bound"><span class="entity">b</span></span></span><span class="main">)</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">c</span></span></span> <span class="main">-</span> <span class="free"><span class="bound"><span class="entity">b</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Angles-angle_altdef"><span class="command">lemma</span></span> angle_altdef<span class="main">:</span> <span class="quoted"><span class="quoted">"angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">=</span> arccos <span class="main">(</span><span class="main">(</span><span class="free">a</span> <span class="main">-</span> <span class="free">b</span><span class="main">)</span> <span class="main">∙</span> <span class="main">(</span><span class="free">c</span> <span class="main">-</span> <span class="free">b</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span>dist <span class="free">a</span> <span class="free">b</span> <span class="main">*</span> dist <span class="free">c</span> <span class="free">b</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> angle_def vangle_def dist_norm<span class="main">)</span>

<span class="keyword1" id="Angles-vangle_0_left"><span class="command">lemma</span></span> vangle_0_left <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"vangle <span class="main">0</span> <span class="free">v</span> <span class="main">=</span> pi <span class="main">/</span> <span class="numeral">2</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> vangle_0_right <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"vangle <span class="free">u</span> <span class="main">0</span> <span class="main">=</span> pi <span class="main">/</span> <span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vangle_def<span class="main">)</span>

<span class="keyword1" id="Angles-vangle_refl"><span class="command">lemma</span></span> vangle_refl <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟹</span> vangle <span class="free">u</span> <span class="free">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vangle_def dot_square_norm power2_eq_square<span class="main">)</span>

<span class="keyword1" id="Angles-angle_refl"><span class="command">lemma</span></span> angle_refl <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"angle <span class="free">a</span> <span class="free">a</span> <span class="free">b</span> <span class="main">=</span> pi <span class="main">/</span> <span class="numeral">2</span>"</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">a</span> <span class="free">b</span> <span class="free">b</span> <span class="main">=</span> pi <span class="main">/</span> <span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> angle_def<span class="main">)</span>

<span class="keyword1" id="Angles-angle_refl_mid"><span class="command">lemma</span></span> angle_refl_mid <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="free">b</span> <span class="main">⟹</span> angle <span class="free">a</span> <span class="free">b</span> <span class="free">a</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> angle_def<span class="main">)</span>


<span class="keyword1" id="Angles-cos_vangle"><span class="command">lemma</span></span> cos_vangle<span class="main">:</span> <span class="quoted"><span class="quoted">"cos <span class="main">(</span>vangle <span class="free">u</span> <span class="free">v</span><span class="main">)</span> <span class="main">=</span> <span class="free">u</span> <span class="main">∙</span> <span class="free">v</span> <span class="main">/</span> <span class="main">(</span>norm <span class="free">u</span> <span class="main">*</span> norm <span class="free">v</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> vangle_def <span class="keyword1"><span class="command">using</span></span> Cauchy_Schwarz_ineq2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">u</span></span> <span class="quoted"><span class="free">v</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>

<span class="keyword1" id="Angles-cos_angle"><span class="command">lemma</span></span> cos_angle<span class="main">:</span> <span class="quoted"><span class="quoted">"cos <span class="main">(</span>angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span> <span class="main">-</span> <span class="free">b</span><span class="main">)</span> <span class="main">∙</span> <span class="main">(</span><span class="free">c</span> <span class="main">-</span> <span class="free">b</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span>dist <span class="free">a</span> <span class="free">b</span> <span class="main">*</span> dist <span class="free">c</span> <span class="free">b</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> angle_def cos_vangle dist_norm<span class="main">)</span>

<span class="keyword1" id="Angles-inner_conv_angle"><span class="command">lemma</span></span> inner_conv_angle<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="main">-</span> <span class="free">b</span><span class="main">)</span> <span class="main">∙</span> <span class="main">(</span><span class="free">c</span> <span class="main">-</span> <span class="free">b</span><span class="main">)</span> <span class="main">=</span> dist <span class="free">a</span> <span class="free">b</span> <span class="main">*</span> dist <span class="free">c</span> <span class="free">b</span> <span class="main">*</span> cos <span class="main">(</span>angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cos_angle<span class="main">)</span>

<span class="keyword1" id="Angles-vangle_commute"><span class="command">lemma</span></span> vangle_commute<span class="main">:</span> <span class="quoted"><span class="quoted">"vangle <span class="free">u</span> <span class="free">v</span> <span class="main">=</span> vangle <span class="free">v</span> <span class="free">u</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vangle_def inner_commute mult.commute<span class="main">)</span>

<span class="keyword1" id="Angles-angle_commute"><span class="command">lemma</span></span> angle_commute<span class="main">:</span> <span class="quoted"><span class="quoted">"angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">=</span> angle <span class="free">c</span> <span class="free">b</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> angle_def vangle_commute<span class="main">)</span>

<span class="keyword1" id="Angles-vangle_nonneg"><span class="command">lemma</span></span> vangle_nonneg<span class="main">:</span> <span class="quoted"><span class="quoted">"vangle <span class="free">u</span> <span class="free">v</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> vangle_le_pi<span class="main">:</span> <span class="quoted"><span class="quoted">"vangle <span class="free">u</span> <span class="free">v</span> <span class="main">≤</span> pi"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Cauchy_Schwarz_ineq2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">u</span></span> <span class="quoted"><span class="free">v</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> vangle_def <span class="dynamic"><span class="dynamic">field_simps</span></span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> arccos_lbound arccos_ubound<span class="main">)</span>

<span class="keyword1"><span class="command">lemmas</span></span> vangle_bounds <span class="main">=</span> vangle_nonneg vangle_le_pi

<span class="keyword1" id="Angles-angle_nonneg"><span class="command">lemma</span></span> angle_nonneg<span class="main">:</span> <span class="quoted"><span class="quoted">"angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> angle_le_pi<span class="main">:</span> <span class="quoted"><span class="quoted">"angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">≤</span> pi"</span></span>
  <span class="keyword1"><span class="command">using</span></span> vangle_bounds <span class="keyword1"><span class="command">unfolding</span></span> angle_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> angle_bounds <span class="main">=</span> angle_nonneg angle_le_pi

<span class="keyword1" id="Angles-sin_vangle_nonneg"><span class="command">lemma</span></span> sin_vangle_nonneg<span class="main">:</span> <span class="quoted"><span class="quoted">"sin <span class="main">(</span>vangle <span class="free">u</span> <span class="free">v</span><span class="main">)</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> vangle_bounds <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sin_ge_zero<span class="main">)</span>

<span class="keyword1" id="Angles-sin_angle_nonneg"><span class="command">lemma</span></span> sin_angle_nonneg<span class="main">:</span> <span class="quoted"><span class="quoted">"sin <span class="main">(</span>angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span><span class="main">)</span> <span class="main">≥</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> angle_bounds <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> sin_ge_zero<span class="main">)</span>


<span class="keyword1" id="Angles-vangle_eq_0D"><span class="command">lemma</span></span> vangle_eq_0D<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"vangle <span class="free">u</span> <span class="free">v</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"norm <span class="free">u</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">v</span> <span class="main">=</span> norm <span class="free">v</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">∙</span> <span class="free">v</span> <span class="main">=</span> norm <span class="free">u</span> <span class="main">*</span> norm <span class="free">v</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> arccos_eq_iff<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">u</span> <span class="main">∙</span> <span class="free">v</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span>norm <span class="free">u</span> <span class="main">*</span> norm <span class="free">v</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="main">1</span></span><span class="main">]</span> Cauchy_Schwarz_ineq2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">u</span></span> <span class="quoted"><span class="free">v</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> vangle_def <span class="quasi_keyword">split</span><span class="main"><span class="main">:</span></span> if_split_asm<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> norm_cauchy_schwarz_eq<span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Angles-vangle_eq_piD"><span class="command">lemma</span></span> vangle_eq_piD<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"vangle <span class="free">u</span> <span class="free">v</span> <span class="main">=</span> pi"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"norm <span class="free">u</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">v</span> <span class="main">+</span> norm <span class="free">v</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">u</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">-</span><span class="free">u</span><span class="main">)</span> <span class="main">∙</span> <span class="free">v</span> <span class="main">=</span> norm <span class="main">(</span><span class="main">-</span><span class="free">u</span><span class="main">)</span> <span class="main">*</span> norm <span class="free">v</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> arccos_eq_iff<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">u</span> <span class="main">∙</span> <span class="free">v</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span>norm <span class="free">u</span> <span class="main">*</span> norm <span class="free">v</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="main">1</span>"</span></span><span class="main">]</span> Cauchy_Schwarz_ineq2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">u</span></span> <span class="quoted"><span class="free">v</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span> vangle_def <span class="quasi_keyword">split</span><span class="main"><span class="main">:</span></span> if_split_asm<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> norm_cauchy_schwarz_eq<span class="main">)</span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Angles-dist_triangle_eq"><span class="command">lemma</span></span> dist_triangle_eq<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">::</span> real_inner"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>dist <span class="free">a</span> <span class="free">c</span> <span class="main">=</span> dist <span class="free">a</span> <span class="free">b</span> <span class="main">+</span> dist <span class="free">b</span> <span class="free">c</span><span class="main">)</span> <span class="main">⟷</span> dist <span class="free">a</span> <span class="free">b</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">c</span> <span class="main">-</span> <span class="free">b</span><span class="main">)</span> <span class="main">+</span> dist <span class="free">b</span> <span class="free">c</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">a</span> <span class="main">-</span> <span class="free">b</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> norm_triangle_eq<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">-</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">-</span> <span class="free">b</span>"</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_norm norm_minus_commute <span class="dynamic"><span class="dynamic">algebra_simps</span></span><span class="main">)</span>

<span class="keyword1" id="Angles-angle_eq_pi_imp_dist_additive"><span class="command">lemma</span></span> angle_eq_pi_imp_dist_additive<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">=</span> pi"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"dist <span class="free">a</span> <span class="free">c</span> <span class="main">=</span> dist <span class="free">a</span> <span class="free">b</span> <span class="main">+</span> dist <span class="free">b</span> <span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> vangle_eq_piD<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">[</span></span><span class="operator">unfolded</span> angle_def<span class="main"><span class="main">]</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> dist_triangle_eq<span class="main">)</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_norm norm_minus_commute<span class="main">)</span>


<span class="keyword1" id="Angles-orthogonal_iff_vangle"><span class="command">lemma</span></span> orthogonal_iff_vangle<span class="main">:</span> <span class="quoted"><span class="quoted">"orthogonal <span class="free">u</span> <span class="free">v</span> <span class="main">⟷</span> vangle <span class="free">u</span> <span class="free">v</span> <span class="main">=</span> pi <span class="main">/</span> <span class="numeral">2</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> arccos_eq_iff<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">∙</span> <span class="free">v</span> <span class="main">/</span> <span class="main">(</span>norm <span class="free">u</span> <span class="main">*</span> norm <span class="free">v</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="main">0</span></span><span class="main">]</span> Cauchy_Schwarz_ineq2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">u</span></span> <span class="quoted"><span class="free">v</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> vangle_def orthogonal_def<span class="main">)</span>

<span class="keyword1" id="Angles-cos_minus1_imp_pi"><span class="command">lemma</span></span> cos_minus1_imp_pi<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"cos <span class="free">x</span> <span class="main">=</span> <span class="main">-</span><span class="main">1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="numeral">3</span> <span class="main">*</span> pi"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> pi"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"cos <span class="main">(</span><span class="free">x</span> <span class="main">-</span> pi<span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="main">::</span> <span class="quoted">int</span> <span class="keyword2"><span class="keyword">where</span></span> n<span class="main">:</span> <span class="quoted"><span class="quoted">"of_int <span class="skolem">n</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">/</span> pi <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> cos_one_2pi_int<span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">∈</span> <span class="main">{</span><span class="main">-</span><span class="main">1</span><span class="main">&lt;..&lt;</span><span class="main">1</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> n <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1" id="Angles-vangle_eqI"><span class="command">lemma</span></span> vangle_eqI<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">v</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">w</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">u</span> <span class="main">∙</span> <span class="free">v</span><span class="main">)</span> <span class="main">*</span> norm <span class="free">w</span> <span class="main">*</span> norm <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">w</span> <span class="main">∙</span> <span class="free">x</span><span class="main">)</span> <span class="main">*</span> norm <span class="free">u</span> <span class="main">*</span> norm <span class="free">v</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"vangle <span class="free">u</span> <span class="free">v</span> <span class="main">=</span> vangle <span class="free">w</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Cauchy_Schwarz_ineq2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">u</span></span> <span class="quoted"><span class="free">v</span></span><span class="main">]</span> Cauchy_Schwarz_ineq2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">w</span></span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">unfolding</span></span> vangle_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> arccos_eq_iff <span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>

<span class="keyword1" id="Angles-angle_eqI"><span class="command">lemma</span></span> angle_eqI<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="free">b</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="free">c</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">≠</span> <span class="free">e</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">d</span> <span class="main">≠</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">b</span><span class="main">-</span><span class="free">a</span><span class="main">)</span> <span class="main">∙</span> <span class="main">(</span><span class="free">c</span><span class="main">-</span><span class="free">a</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> dist <span class="free">d</span> <span class="free">e</span> <span class="main">*</span> dist <span class="free">d</span> <span class="free">f</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">e</span><span class="main">-</span><span class="free">d</span><span class="main">)</span> <span class="main">∙</span> <span class="main">(</span><span class="free">f</span><span class="main">-</span><span class="free">d</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> dist <span class="free">a</span> <span class="free">b</span> <span class="main">*</span> dist <span class="free">a</span> <span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"angle <span class="free">b</span> <span class="free">a</span> <span class="free">c</span> <span class="main">=</span> angle <span class="free">e</span> <span class="free">d</span> <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> angle_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> vangle_eqI<span class="main">)</span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_norm norm_minus_commute<span class="main">)</span>

<span class="keyword1" id="Angles-cos_vangle_eqD"><span class="command">lemma</span></span> cos_vangle_eqD<span class="main">:</span> <span class="quoted"><span class="quoted">"cos <span class="main">(</span>vangle <span class="free">u</span> <span class="free">v</span><span class="main">)</span> <span class="main">=</span> cos <span class="main">(</span>vangle <span class="free">w</span> <span class="free">x</span><span class="main">)</span> <span class="main">⟹</span> vangle <span class="free">u</span> <span class="free">v</span> <span class="main">=</span> vangle <span class="free">w</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> cos_inj_pi<span class="main">)</span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vangle_bounds<span class="main">)</span>

<span class="keyword1" id="Angles-cos_angle_eqD"><span class="command">lemma</span></span> cos_angle_eqD<span class="main">:</span> <span class="quoted"><span class="quoted">"cos <span class="main">(</span>angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span><span class="main">)</span> <span class="main">=</span> cos <span class="main">(</span>angle <span class="free">d</span> <span class="free">e</span> <span class="free">f</span><span class="main">)</span> <span class="main">⟹</span> angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">=</span> angle <span class="free">d</span> <span class="free">e</span> <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> angle_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> cos_vangle_eqD<span class="main">)</span>

<span class="keyword1" id="Angles-sin_vangle_zero_iff"><span class="command">lemma</span></span> sin_vangle_zero_iff<span class="main">:</span> <span class="quoted"><span class="quoted">"sin <span class="main">(</span>vangle <span class="free">u</span> <span class="free">v</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟷</span> vangle <span class="free">u</span> <span class="free">v</span> <span class="main">∈</span> <span class="main">{</span><span class="main">0</span><span class="main">,</span> pi<span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"sin <span class="main">(</span>vangle <span class="free">u</span> <span class="free">v</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="main">::</span> <span class="quoted">int</span> <span class="keyword2"><span class="keyword">where</span></span> n<span class="main">:</span> <span class="quoted"><span class="quoted">"of_int <span class="skolem">n</span> <span class="main">=</span> vangle <span class="free">u</span> <span class="free">v</span> <span class="main">/</span> pi"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> sin_zero_iff_int2<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">∈</span> <span class="main">{</span><span class="main">0</span><span class="main">..</span><span class="main">1</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> vangle_bounds <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> <span class="main">{</span><span class="main">0</span><span class="main">,</span><span class="main">1</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"vangle <span class="free">u</span> <span class="free">v</span> <span class="main">∈</span> <span class="main">{</span><span class="main">0</span><span class="main">,</span>pi<span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> n <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Angles-sin_angle_zero_iff"><span class="command">lemma</span></span> sin_angle_zero_iff<span class="main">:</span> <span class="quoted"><span class="quoted">"sin <span class="main">(</span>angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟷</span> angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">∈</span> <span class="main">{</span><span class="main">0</span><span class="main">,</span> pi<span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> angle_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> sin_vangle_zero_iff<span class="main">)</span>

<span class="keyword1" id="Angles-vangle_collinear"><span class="command">lemma</span></span> vangle_collinear<span class="main">:</span> <span class="quoted"><span class="quoted">"vangle <span class="free">u</span> <span class="free">v</span> <span class="main">∈</span> <span class="main">{</span><span class="main">0</span><span class="main">,</span> pi<span class="main">}</span> <span class="main">⟹</span> collinear <span class="main">{</span><span class="main">0</span><span class="main">,</span> <span class="free">u</span><span class="main">,</span> <span class="free">v</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> norm_cauchy_schwarz_equal <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> norm_cauchy_schwarz_abs_eq<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> vangle_eq_0D vangle_eq_piD <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> eq_neg_iff_add_eq_0<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Angles-angle_collinear"><span class="command">lemma</span></span> angle_collinear<span class="main">:</span> <span class="quoted"><span class="quoted">"angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">∈</span> <span class="main">{</span><span class="main">0</span><span class="main">,</span> pi<span class="main">}</span> <span class="main">⟹</span> collinear <span class="main">{</span><span class="free">a</span><span class="main">,</span> <span class="free">b</span><span class="main">,</span> <span class="free">c</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">unfold</span> angle_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">drule</span> vangle_collinear<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> collinear_translate_iff<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">,</span></span> <span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">-</span></span><span class="free"><span class="free">b</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> insert_commute<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1" id="Angles-not_collinear_vangle"><span class="command">lemma</span></span> not_collinear_vangle<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>collinear <span class="main">{</span><span class="main">0</span><span class="main">,</span><span class="free">u</span><span class="main">,</span><span class="free">v</span><span class="main">}</span> <span class="main">⟹</span> vangle <span class="free">u</span> <span class="free">v</span> <span class="main">∈</span> <span class="main">{</span><span class="main">0</span><span class="main">&lt;..&lt;</span>pi<span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> vangle_bounds<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">u</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">v</span></span></span></span><span class="main">]</span> vangle_collinear<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">u</span></span> <span class="quoted"><span class="free">v</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"vangle <span class="free">u</span> <span class="free">v</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> vangle <span class="free">u</span> <span class="free">v</span> <span class="main">=</span> pi"</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1" id="Angles-not_collinear_angle"><span class="command">lemma</span></span> not_collinear_angle<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>collinear <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span> <span class="main">⟹</span> angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">∈</span> <span class="main">{</span><span class="main">0</span><span class="main">&lt;..&lt;</span>pi<span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> angle_bounds<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">b</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">c</span></span></span></span><span class="main">]</span> angle_collinear<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">b</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">=</span> pi"</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Contributions from Lukas Bulwahn›</span></span>

<span class="keyword1" id="Angles-vangle_scales"><span class="command">lemma</span></span> vangle_scales<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"vangle <span class="main">(</span><span class="free">c</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">v<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="free">v<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">=</span> vangle <span class="free">v<span class="hidden">⇩</span><sub>1</sub></span> <span class="free">v<span class="hidden">⇩</span><sub>2</sub></span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> vangle_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="Angles-vangle_inverse"><span class="command">lemma</span></span> vangle_inverse<span class="main">:</span>
  <span class="quoted"><span class="quoted">"vangle <span class="main">(</span><span class="main">-</span> <span class="free">v<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="free">v<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">=</span> pi <span class="main">-</span> vangle <span class="free">v<span class="hidden">⇩</span><sub>1</sub></span> <span class="free">v<span class="hidden">⇩</span><sub>2</sub></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="free">v<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">∙</span> <span class="free">v<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">/</span> <span class="main">(</span>norm <span class="free">v<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">*</span> norm <span class="free">v<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span><span class="main">¦</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">v<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="free">v<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cauchy_Schwarz_ineq2<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="free">v<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="free">v<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> vangle_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> arccos_minus_abs<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Angles-orthogonal_iff_angle"><span class="command">lemma</span></span> orthogonal_iff_angle<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"orthogonal <span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span> <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span> <span class="main">⟷</span> angle <span class="free">A</span> <span class="free">B</span> <span class="free">C</span> <span class="main">=</span> pi <span class="main">/</span> <span class="numeral">2</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> angle_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> orthogonal_iff_vangle<span class="main">)</span>

<span class="keyword1" id="Angles-angle_inverse"><span class="command">lemma</span></span> angle_inverse<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"between <span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">C</span><span class="main">)</span> <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="free">B</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">≠</span> <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">A</span> <span class="free">B</span> <span class="free">D</span> <span class="main">=</span> pi <span class="main">-</span> angle <span class="free">C</span> <span class="free">B</span> <span class="free">D</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">C</span><span class="main">)</span> <span class="free">B</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> u<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> X<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">=</span> <span class="skolem">u</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">A</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">u</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">C</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add.commute betweenE between_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">≠</span> <span class="free">B</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">B</span> <span class="main">≠</span> <span class="free">C</span>›</span></span> X <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">≠</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="main">(</span><span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">u</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">u</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">≠</span> <span class="main">1</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">≥</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">≤</span> <span class="main">1</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> X <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">-</span> <span class="free">B</span> <span class="main">=</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">u</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> real_vector.scale_right_diff_distrib real_vector.scale_left_diff_distrib<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> X <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">-</span> <span class="free">B</span> <span class="main">=</span> <span class="skolem">u</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> scaleR_diff_left real_vector.scale_right_diff_distrib<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">-</span> <span class="free">B</span> <span class="main">=</span> <span class="main">-</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">u</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">u</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="main">(</span><span class="operator">metis</span> minus_diff_eq real_vector.scale_minus_left<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"vangle <span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span> <span class="main">(</span><span class="free">D</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> pi <span class="main">-</span> vangle <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span> <span class="main">(</span><span class="free">D</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">&lt;</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">u</span><span class="main">)</span> <span class="main">/</span> <span class="skolem">u</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vangle_inverse vangle_scales<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> angle_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Angles-strictly_between_implies_angle_eq_pi"><span class="command">lemma</span></span> strictly_between_implies_angle_eq_pi<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"between <span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">C</span><span class="main">)</span> <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="free">B</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">≠</span> <span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">A</span> <span class="free">B</span> <span class="free">C</span> <span class="main">=</span> pi"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">C</span><span class="main">)</span> <span class="free">B</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> u<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> X<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">=</span> <span class="skolem">u</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">A</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">u</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">C</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add.commute betweenE between_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">≠</span> <span class="free">B</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">B</span> <span class="main">≠</span> <span class="free">C</span>›</span></span> X <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">≠</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">≠</span> <span class="free">B</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">B</span> <span class="main">≠</span> <span class="free">C</span>›</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">C</span><span class="main">)</span> <span class="free">B</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> X <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">-</span> <span class="free">B</span> <span class="main">=</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">u</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> real_vector.scale_right_diff_distrib real_vector.scale_left_diff_distrib<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">A</span> <span class="free">B</span> <span class="main">=</span> norm <span class="main">(</span><span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">u</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">≥</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">≤</span> <span class="main">1</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_norm<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> X <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span> <span class="main">-</span> <span class="free">B</span> <span class="main">=</span> <span class="skolem">u</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> scaleR_diff_left real_vector.scale_right_diff_distrib<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">C</span> <span class="free">B</span> <span class="main">=</span> norm <span class="main">(</span><span class="skolem">u</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_norm<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span> <span class="main">∙</span> <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span>dist <span class="free">A</span> <span class="free">B</span> <span class="main">*</span> dist <span class="free">C</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">u</span> <span class="main">*</span> <span class="main">(</span><span class="skolem">u</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="main">¦</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">u</span><span class="main">¦</span> <span class="main">*</span> <span class="main">¦</span><span class="skolem">u</span><span class="main">¦</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">≠</span> <span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dot_square_norm power2_eq_square<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">≠</span> <span class="main">1</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">≥</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">≤</span> <span class="main">1</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> divide_eq_minus_1_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> angle_altdef <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="Triangle">
<div class="head">
<h1>Theory Triangle</h1>
</div>
<pre class="source"><span class="comment1">(*
  File:    Triangle.thy
  Author:  Manuel Eberl &lt;eberlm@in.tum.de&gt;

  Sine and cosine laws, angle sum in a triangle, congruence theorems,
  Isosceles Triangle Theorem
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Basic Properties of Triangles›</span></span>
<span class="keyword1"><span class="command">theory</span></span> Triangle
<span class="keyword2"><span class="keyword">imports</span></span>
  <a href="Angles.html">Angles</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  We prove a number of basic geometric properties of triangles. All theorems hold
  in any real inner product space.
›</span></span>
<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Thales' theorem›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> thales<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="free">B</span> <span class="free">C</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">::</span> real_inner"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">B</span> <span class="main">(</span>midpoint <span class="free">A</span> <span class="free">C</span><span class="main">)</span> <span class="main">=</span> dist <span class="free">A</span> <span class="free">C</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"orthogonal <span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span> <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">A</span> <span class="free">C</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">=</span> dist <span class="free">B</span> <span class="main">(</span>midpoint <span class="free">A</span> <span class="free">C</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">*</span> <span class="numeral">4</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> assms<span class="main">)</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span> power2_eq_square<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> orthogonal_def dist_norm power2_norm_eq_inner midpoint_def
                   <span class="dynamic"><span class="dynamic">algebra_simps</span></span> inner_commute<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Sine and cosine laws›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  The proof of the Law of Cosines follows trivially from the definition of the angle,
  the definition of the norm in vector spaces with an inner product and the bilinearity
  of the inner product.
›</span></span>

<span class="keyword1" id="Triangle-cosine_law_vector"><span class="command">lemma</span></span> cosine_law_vector<span class="main">:</span>
  <span class="quoted"><span class="quoted">"norm <span class="main">(</span><span class="free">u</span> <span class="main">-</span> <span class="free">v</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">=</span> norm <span class="free">u</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">+</span> norm <span class="free">v</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">*</span> norm <span class="free">u</span> <span class="main">*</span> norm <span class="free">v</span> <span class="main">*</span> cos <span class="main">(</span>vangle <span class="free">u</span> <span class="free">v</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power2_norm_eq_inner cos_vangle <span class="dynamic"><span class="dynamic">algebra_simps</span></span> inner_commute<span class="main">)</span>

<span class="keyword1" id="Triangle-cosine_law_triangle"><span class="command">lemma</span></span> cosine_law_triangle<span class="main">:</span>
  <span class="quoted"><span class="quoted">"dist <span class="free">b</span> <span class="free">c</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">=</span> dist <span class="free">a</span> <span class="free">b</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">+</span> dist <span class="free">a</span> <span class="free">c</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">-</span> <span class="numeral">2</span> <span class="main">*</span> dist <span class="free">a</span> <span class="free">b</span> <span class="main">*</span> dist <span class="free">a</span> <span class="free">c</span> <span class="main">*</span> cos <span class="main">(</span>angle <span class="free">b</span> <span class="free">a</span> <span class="free">c</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cosine_law_vector<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">-</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">-</span> <span class="free">a</span>"</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_norm angle_def vangle_commute norm_minus_commute<span class="main">)</span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  According to our definition, angles are always between $0$ and $\pi$ and therefore,
  the sign of an angle is always non-negative. We can therefore look at
  $\sin(\alpha)^2$, which we can express in terms of $\cos(\alpha)$ using the
  identity $\sin(\alpha)^2 + \cos(\alpha)^2 = 1$. The remaining proof is then a
  trivial consequence of the definitions.
›</span></span>
<span class="keyword1" id="Triangle-sine_law_triangle"><span class="command">lemma</span></span> sine_law_triangle<span class="main">:</span>
  <span class="quoted"><span class="quoted">"sin <span class="main">(</span>angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span><span class="main">)</span> <span class="main">*</span> dist <span class="free">b</span> <span class="free">c</span> <span class="main">=</span> sin <span class="main">(</span>angle <span class="free">b</span> <span class="free">a</span> <span class="free">c</span><span class="main">)</span> <span class="main">*</span> dist <span class="free">a</span> <span class="free">c</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">=</span> <span class="var">?B</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> <span class="free">b</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> neq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="free">b</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> power2_eq_imp_eq<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> neq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>sin <span class="main">(</span>angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span><span class="main">)</span> <span class="main">*</span> dist <span class="free">b</span> <span class="free">c</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">*</span> dist <span class="free">a</span> <span class="free">b</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">=</span>
                     dist <span class="free">a</span> <span class="free">b</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">*</span> dist <span class="free">b</span> <span class="free">c</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">-</span> <span class="main">(</span><span class="main">(</span><span class="free">a</span> <span class="main">-</span> <span class="free">b</span><span class="main">)</span> <span class="main">∙</span> <span class="main">(</span><span class="free">c</span> <span class="main">-</span> <span class="free">b</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sin_squared_eq cos_angle dist_commute <span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> dist <span class="free">a</span> <span class="free">b</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">*</span> dist <span class="free">a</span> <span class="free">c</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">-</span> <span class="main">(</span><span class="main">(</span><span class="free">b</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">∙</span> <span class="main">(</span><span class="free">c</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> dist_norm power2_norm_eq_inner<span class="main">)</span>
         <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power2_eq_square <span class="dynamic"><span class="dynamic">algebra_simps</span></span> inner_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> neq <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span>sin <span class="main">(</span>angle <span class="free">b</span> <span class="free">a</span> <span class="free">c</span><span class="main">)</span> <span class="main">*</span> dist <span class="free">a</span> <span class="free">c</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">*</span> dist <span class="free">a</span> <span class="free">b</span> <span class="main">^</span> <span class="numeral">2</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sin_squared_eq cos_angle dist_commute <span class="dynamic"><span class="dynamic">field_simps</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">^</span><span class="numeral">2</span> <span class="main">=</span> <span class="var">?B</span><span class="main">^</span><span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> neq <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> mult_cancel_right<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">qed</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> mult_nonneg_nonneg sin_angle_nonneg<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="operator">simp_all</span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  The following forms of the Law of Sines/Cosines are more convenient for eliminating
  sines/cosines from a goal completely.
›</span></span>

<span class="keyword1" id="Triangle-cosine_law_triangle'"><span class="command">lemma</span></span> cosine_law_triangle'<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="numeral">2</span> <span class="main">*</span> dist <span class="free">a</span> <span class="free">b</span> <span class="main">*</span> dist <span class="free">a</span> <span class="free">c</span> <span class="main">*</span> cos <span class="main">(</span>angle <span class="free">b</span> <span class="free">a</span> <span class="free">c</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>dist <span class="free">a</span> <span class="free">b</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">+</span> dist <span class="free">a</span> <span class="free">c</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">-</span> dist <span class="free">b</span> <span class="free">c</span> <span class="main">^</span> <span class="numeral">2</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cosine_law_triangle<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">b</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">a</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Triangle-cosine_law_triangle''"><span class="command">lemma</span></span> cosine_law_triangle''<span class="main">:</span>
  <span class="quoted"><span class="quoted">"cos <span class="main">(</span>angle <span class="free">b</span> <span class="free">a</span> <span class="free">c</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>dist <span class="free">a</span> <span class="free">b</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">+</span> dist <span class="free">a</span> <span class="free">c</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">-</span> dist <span class="free">b</span> <span class="free">c</span> <span class="main">^</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> dist <span class="free">a</span> <span class="free">b</span> <span class="main">*</span> dist <span class="free">a</span> <span class="free">c</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> cosine_law_triangle<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">b</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">a</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Triangle-sine_law_triangle'"><span class="command">lemma</span></span> sine_law_triangle'<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">≠</span> <span class="free">c</span> <span class="main">⟹</span> sin <span class="main">(</span>angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span><span class="main">)</span> <span class="main">=</span> sin <span class="main">(</span>angle <span class="free">b</span> <span class="free">a</span> <span class="free">c</span><span class="main">)</span> <span class="main">*</span> dist <span class="free">a</span> <span class="free">c</span> <span class="main">/</span> dist <span class="free">b</span> <span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> sine_law_triangle<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">b</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span><span class="main">)</span>

<span class="keyword1" id="Triangle-sine_law_triangle''"><span class="command">lemma</span></span> sine_law_triangle''<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">≠</span> <span class="free">c</span> <span class="main">⟹</span> sin <span class="main">(</span>angle <span class="free">c</span> <span class="free">b</span> <span class="free">a</span><span class="main">)</span> <span class="main">=</span> sin <span class="main">(</span>angle <span class="free">b</span> <span class="free">a</span> <span class="free">c</span><span class="main">)</span> <span class="main">*</span> dist <span class="free">a</span> <span class="free">c</span> <span class="main">/</span> dist <span class="free">b</span> <span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> sine_law_triangle<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">b</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">divide_simps</span></span> angle_commute<span class="main">)</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Sum of angles›</span></span>

<span class="keyword1"><span class="command">context</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword2"><span class="keyword">private</span></span> <span class="keyword1" id="Triangle-gather_squares"><span class="command">lemma</span></span> gather_squares<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="main">*</span> <span class="free">b</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span><span class="main">^</span><span class="numeral">2</span> <span class="main">*</span> <span class="main">(</span><span class="free">b</span> <span class="main">::</span> real<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power2_eq_square<span class="main">)</span>

<span class="keyword2"><span class="keyword">private</span></span> <span class="keyword1" id="Triangle-eval_power"><span class="command">lemma</span></span> eval_power<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">^</span> numeral <span class="free">n</span> <span class="main">=</span> <span class="free">x</span> <span class="main">*</span> <span class="free">x</span> <span class="main">^</span> pred_numeral <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> numeral_eq_Suc<span class="main"><span class="keyword3">,</span></span> <span class="operator">subst</span> power_Suc<span class="main">)</span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  The proof that the sum of the angles in a triangle is $\pi$ is somewhat more
  involved. Following the HOL Light proof by John Harrison, we first prove
  that $\cos(\alpha + \beta + \gamma) = -1$ and $\alpha + \beta + \gamma \in [0;3\pi)$,
  which then implies the theorem.

  The main work is proving $\cos(\alpha + \beta + \gamma)$. This is done using the
  addition theorems for the sine and cosine, then using the Laws of Sines to eliminate
  all $\sin$ terms save $\sin(\gamma)^2$, which only appears squared in the remaining goal.
  We then use $\sin(\gamma)^2 = 1 - \cos(\gamma)^2$ to eliminate this term and apply
  the law of cosines to eliminate this term as well.

  The remaining goal is a non-linear equation containing only the length of the sides
  of the triangle. It can be shown by simple algebraic rewriting.
›</span></span>
<span class="keyword1" id="Triangle-angle_sum_triangle"><span class="command">lemma</span></span> angle_sum_triangle<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="free">b</span> <span class="main">∨</span> <span class="free">b</span> <span class="main">≠</span> <span class="free">c</span> <span class="main">∨</span> <span class="free">a</span> <span class="main">≠</span> <span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"angle <span class="free">c</span> <span class="free">a</span> <span class="free">b</span> <span class="main">+</span> angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">+</span> angle <span class="free">b</span> <span class="free">c</span> <span class="free">a</span> <span class="main">=</span> pi"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> cos_minus1_imp_pi<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"cos <span class="main">(</span>angle <span class="free">c</span> <span class="free">a</span> <span class="free">b</span> <span class="main">+</span> angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">+</span> angle <span class="free">b</span> <span class="free">c</span> <span class="free">a</span><span class="main">)</span> <span class="main">=</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="free">b</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"cos <span class="main">(</span>angle <span class="free">c</span> <span class="free">a</span> <span class="free">b</span> <span class="main">+</span> angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">+</span> angle <span class="free">b</span> <span class="free">c</span> <span class="free">a</span><span class="main">)</span> <span class="main">=</span> <span class="main">-</span><span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cos_add sin_add cosine_law_triangle'' <span class="dynamic"><span class="dynamic">field_simps</span></span>
                       sine_law_triangle''<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">b</span></span> <span class="quoted"><span class="free">c</span></span><span class="main"><span class="main">]</span></span> sine_law_triangle''<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">b</span></span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">c</span></span><span class="main"><span class="main">]</span></span>
                       angle_commute dist_commute gather_squares sin_squared_eq<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> eval_power <span class="dynamic"><span class="dynamic">algebra_simps</span></span> dist_commute<span class="main">)</span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword1"><span class="command">qed</span></span> <span class="main">(</span><span class="operator">insert</span> assms<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">c</span> <span class="free">a</span> <span class="free">b</span> <span class="main">+</span> angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">+</span> angle <span class="free">b</span> <span class="free">c</span> <span class="free">a</span> <span class="main">&lt;</span> <span class="numeral">3</span> <span class="main">*</span> pi"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>angle <span class="free">c</span> <span class="free">a</span> <span class="free">b</span> <span class="main">+</span> angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">+</span> angle <span class="free">b</span> <span class="free">c</span> <span class="free">a</span> <span class="main">&lt;</span> <span class="numeral">3</span> <span class="main">*</span> pi<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> angle_le_pi<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span> angle_le_pi<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">b</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> angle_le_pi<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">b</span></span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">a</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">have</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"angle <span class="free">c</span> <span class="free">a</span> <span class="free">b</span> <span class="main">=</span> pi"</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">=</span> pi"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp_all</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> angle_eq_pi_imp_dist_additive<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c</span></span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">b</span></span><span class="main">]</span>
                     angle_eq_pi_imp_dist_additive<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">b</span></span> <span class="quoted"><span class="free">c</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> add_nonneg_nonneg angle_nonneg<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Congruence Theorems›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  If two triangles agree on two angles at a non-degenerate side, the third angle
  must also be equal.
›</span></span>
<span class="keyword1" id="Triangle-similar_triangle_aa"><span class="command">lemma</span></span> similar_triangle_aa<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">b1</span> <span class="main">≠</span> <span class="free">c1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b2</span> <span class="main">≠</span> <span class="free">c2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">a1</span> <span class="free">b1</span> <span class="free">c1</span> <span class="main">=</span> angle <span class="free">a2</span> <span class="free">b2</span> <span class="free">c2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">b1</span> <span class="free">c1</span> <span class="free">a1</span> <span class="main">=</span> angle <span class="free">b2</span> <span class="free">c2</span> <span class="free">a2</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"angle <span class="free">b1</span> <span class="free">a1</span> <span class="free">c1</span> <span class="main">=</span> angle <span class="free">b2</span> <span class="free">a2</span> <span class="free">c2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms angle_sum_triangle<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a1</span></span> <span class="quoted"><span class="free">b1</span></span> <span class="quoted"><span class="free">c1</span></span><span class="main">]</span> angle_sum_triangle<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a2</span></span> <span class="quoted"><span class="free">b2</span></span> <span class="quoted"><span class="free">c2</span></span><span class="main">,</span> <span class="operator">symmetric</span><span class="main">]</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">algebra_simps</span></span> angle_commute<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  A triangle is defined by its three angles and the lengths of three sides up to congruence.
  Two triangles are congruent if they have their angles are the same and their sides have
  the same length.
›</span></span>

<span class="keyword1"><span class="command">locale</span></span> congruent_triangle <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">a1</span> <span class="free">b1</span> <span class="free">c1</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">::</span> real_inner"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">a2</span> <span class="free">b2</span> <span class="free">c2</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'b</span> <span class="main">::</span> real_inner"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> sides'<span class="main">:</span>  <span class="quoted"><span class="quoted">"dist <span class="free">a1</span> <span class="free">b1</span> <span class="main">=</span> dist <span class="free">a2</span> <span class="free">b2</span>"</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">a1</span> <span class="free">c1</span> <span class="main">=</span> dist <span class="free">a2</span> <span class="free">c2</span>"</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">b1</span> <span class="free">c1</span> <span class="main">=</span> dist <span class="free">b2</span> <span class="free">c2</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> angles'<span class="main">:</span> <span class="quoted"><span class="quoted">"angle <span class="free">b1</span> <span class="free">a1</span> <span class="free">c1</span> <span class="main">=</span> angle <span class="free">b2</span> <span class="free">a2</span> <span class="free">c2</span>"</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">a1</span> <span class="free">b1</span> <span class="free">c1</span> <span class="main">=</span> angle <span class="free">a2</span> <span class="free">b2</span> <span class="free">c2</span>"</span></span>
                   <span class="quoted"><span class="quoted">"angle <span class="free">a1</span> <span class="free">c1</span> <span class="free">b1</span> <span class="main">=</span> angle <span class="free">a2</span> <span class="free">c2</span> <span class="free">b2</span>"</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1" id="Triangle-sides"><span class="command">lemma</span></span> sides<span class="main">:</span>
  <span class="quoted"><span class="quoted">"dist <span class="free">a1</span> <span class="free">b1</span> <span class="main">=</span> dist <span class="free">a2</span> <span class="free">b2</span>"</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">a1</span> <span class="free">c1</span> <span class="main">=</span> dist <span class="free">a2</span> <span class="free">c2</span>"</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">b1</span> <span class="free">c1</span> <span class="main">=</span> dist <span class="free">b2</span> <span class="free">c2</span>"</span></span>
  <span class="quoted"><span class="quoted">"dist <span class="free">b1</span> <span class="free">a1</span> <span class="main">=</span> dist <span class="free">a2</span> <span class="free">b2</span>"</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">c1</span> <span class="free">a1</span> <span class="main">=</span> dist <span class="free">a2</span> <span class="free">c2</span>"</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">c1</span> <span class="free">b1</span> <span class="main">=</span> dist <span class="free">b2</span> <span class="free">c2</span>"</span></span>
  <span class="quoted"><span class="quoted">"dist <span class="free">a1</span> <span class="free">b1</span> <span class="main">=</span> dist <span class="free">b2</span> <span class="free">a2</span>"</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">a1</span> <span class="free">c1</span> <span class="main">=</span> dist <span class="free">c2</span> <span class="free">a2</span>"</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">b1</span> <span class="free">c1</span> <span class="main">=</span> dist <span class="free">c2</span> <span class="free">b2</span>"</span></span>
  <span class="quoted"><span class="quoted">"dist <span class="free">b1</span> <span class="free">a1</span> <span class="main">=</span> dist <span class="free">b2</span> <span class="free">a2</span>"</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">c1</span> <span class="free">a1</span> <span class="main">=</span> dist <span class="free">c2</span> <span class="free">a2</span>"</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">c1</span> <span class="free">b1</span> <span class="main">=</span> dist <span class="free">c2</span> <span class="free">b2</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> sides' <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_commute<span class="main">)</span>

<span class="keyword1" id="Triangle-angles"><span class="command">lemma</span></span> angles<span class="main">:</span>
  <span class="quoted"><span class="quoted">"angle <span class="free">b1</span> <span class="free">a1</span> <span class="free">c1</span> <span class="main">=</span> angle <span class="free">b2</span> <span class="free">a2</span> <span class="free">c2</span>"</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">a1</span> <span class="free">b1</span> <span class="free">c1</span> <span class="main">=</span> angle <span class="free">a2</span> <span class="free">b2</span> <span class="free">c2</span>"</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">a1</span> <span class="free">c1</span> <span class="free">b1</span> <span class="main">=</span> angle <span class="free">a2</span> <span class="free">c2</span> <span class="free">b2</span>"</span></span>
  <span class="quoted"><span class="quoted">"angle <span class="free">c1</span> <span class="free">a1</span> <span class="free">b1</span> <span class="main">=</span> angle <span class="free">b2</span> <span class="free">a2</span> <span class="free">c2</span>"</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">c1</span> <span class="free">b1</span> <span class="free">a1</span> <span class="main">=</span> angle <span class="free">a2</span> <span class="free">b2</span> <span class="free">c2</span>"</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">b1</span> <span class="free">c1</span> <span class="free">a1</span> <span class="main">=</span> angle <span class="free">a2</span> <span class="free">c2</span> <span class="free">b2</span>"</span></span>
  <span class="quoted"><span class="quoted">"angle <span class="free">b1</span> <span class="free">a1</span> <span class="free">c1</span> <span class="main">=</span> angle <span class="free">c2</span> <span class="free">a2</span> <span class="free">b2</span>"</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">a1</span> <span class="free">b1</span> <span class="free">c1</span> <span class="main">=</span> angle <span class="free">c2</span> <span class="free">b2</span> <span class="free">a2</span>"</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">a1</span> <span class="free">c1</span> <span class="free">b1</span> <span class="main">=</span> angle <span class="free">b2</span> <span class="free">c2</span> <span class="free">a2</span>"</span></span>
  <span class="quoted"><span class="quoted">"angle <span class="free">c1</span> <span class="free">a1</span> <span class="free">b1</span> <span class="main">=</span> angle <span class="free">c2</span> <span class="free">a2</span> <span class="free">b2</span>"</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">c1</span> <span class="free">b1</span> <span class="free">a1</span> <span class="main">=</span> angle <span class="free">c2</span> <span class="free">b2</span> <span class="free">a2</span>"</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">b1</span> <span class="free">c1</span> <span class="free">a1</span> <span class="main">=</span> angle <span class="free">b2</span> <span class="free">c2</span> <span class="free">a2</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> angles' <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> angle_commute<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> congruent_triangleD <span class="main">=</span> congruent_triangle.sides congruent_triangle.angles



<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  Given two triangles that agree on a subset of its side lengths and angles that are
  sufficient to define a triangle uniquely up to congruence, one can conclude that they
  must also agree on all remaining quantities, i.e. that they are congruent.

  The following four congruence theorems state what constitutes such a uniquely-defining
  subset of quantities. Each theorem states in its name which quantities are required and
  in which order (clockwise or counter-clockwise): an ``s'' stands for a side,
  an ``a'' stands for an angle.

  The lemma ``congruent-triangleI-sas, for example, requires that two adjacent sides and the
  angle inbetween are the same in both triangles.
›</span></span>

<span class="keyword1" id="Triangle-congruent_triangleI_sss"><span class="command">lemma</span></span> congruent_triangleI_sss<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">a1</span> <span class="free">b1</span> <span class="free">c1</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">::</span> real_inner"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">a2</span> <span class="free">b2</span> <span class="free">c2</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'b</span> <span class="main">::</span> real_inner"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">a1</span> <span class="free">b1</span> <span class="main">=</span> dist <span class="free">a2</span> <span class="free">b2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">b1</span> <span class="free">c1</span> <span class="main">=</span> dist <span class="free">b2</span> <span class="free">c2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">a1</span> <span class="free">c1</span> <span class="main">=</span> dist <span class="free">a2</span> <span class="free">c2</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"congruent_triangle <span class="free">a1</span> <span class="free">b1</span> <span class="free">c1</span> <span class="free">a2</span> <span class="free">b2</span> <span class="free">c2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"angle <span class="skolem">a1</span> <span class="skolem">b1</span> <span class="skolem">c1</span> <span class="main">=</span> angle <span class="skolem">a2</span> <span class="skolem">b2</span> <span class="skolem">c2</span>"</span></span>
    <span class="keyword2"><span class="keyword">if</span></span> <span class="quoted"><span class="quoted">"dist <span class="skolem">a1</span> <span class="skolem">b1</span> <span class="main">=</span> dist <span class="skolem">a2</span> <span class="skolem">b2</span>"</span></span> <span class="quoted"><span class="quoted">"dist <span class="skolem">b1</span> <span class="skolem">c1</span> <span class="main">=</span> dist <span class="skolem">b2</span> <span class="skolem">c2</span>"</span></span> <span class="quoted"><span class="quoted">"dist <span class="skolem">a1</span> <span class="skolem">c1</span> <span class="main">=</span> dist <span class="skolem">a2</span> <span class="skolem">c2</span>"</span></span>
    <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a1</span> <span class="skolem">b1</span> <span class="skolem">c1</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">a2</span> <span class="skolem">b2</span> <span class="skolem">c2</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'b</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> that cosine_law_triangle''<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">a1</span></span> <span class="quoted"><span class="skolem">b1</span></span> <span class="quoted"><span class="skolem">c1</span></span><span class="main">]</span> cosine_law_triangle''<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">a2</span></span> <span class="quoted"><span class="skolem">b2</span></span> <span class="quoted"><span class="skolem">c2</span></span><span class="main">]</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> cos_angle_eqD<span class="main">)</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">unfold_locales</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> A <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> dist_commute<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> congruent_triangle_sss <span class="main">=</span> congruent_triangleD<span class="main">[</span><span class="operator">OF</span> congruent_triangleI_sss<span class="main">]</span>

<span class="keyword1" id="Triangle-congruent_triangleI_sas"><span class="command">lemma</span></span> congruent_triangleI_sas<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">a1</span> <span class="free">b1</span> <span class="main">=</span> dist <span class="free">a2</span> <span class="free">b2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">b1</span> <span class="free">c1</span> <span class="main">=</span> dist <span class="free">b2</span> <span class="free">c2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">a1</span> <span class="free">b1</span> <span class="free">c1</span> <span class="main">=</span> angle <span class="free">a2</span> <span class="free">b2</span> <span class="free">c2</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"congruent_triangle <span class="free">a1</span> <span class="free">b1</span> <span class="free">c1</span> <span class="free">a2</span> <span class="free">b2</span> <span class="free">c2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> congruent_triangleI_sss<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">a1</span> <span class="free">c1</span> <span class="main">=</span> dist <span class="free">a2</span> <span class="free">c2</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> power2_eq_imp_eq<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> cosine_law_triangle<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a1</span></span> <span class="quoted"><span class="free">c1</span></span> <span class="quoted"><span class="free">b1</span></span><span class="main">]</span> cosine_law_triangle<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a2</span></span> <span class="quoted"><span class="free">c2</span></span> <span class="quoted"><span class="free">b2</span></span><span class="main">]</span> assms
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>dist <span class="free">a1</span> <span class="free">c1</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span> <span class="main">=</span> <span class="main">(</span>dist <span class="free">a2</span> <span class="free">c2</span><span class="main">)</span><span class="main"><span class="hidden">⇧</span><sup>2</sup></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span> <span class="operator">simp_all</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="operator">fact</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> congruent_triangle_sas <span class="main">=</span> congruent_triangleD<span class="main">[</span><span class="operator">OF</span> congruent_triangleI_sas<span class="main">]</span>

<span class="keyword1" id="Triangle-congruent_triangleI_aas"><span class="command">lemma</span></span> congruent_triangleI_aas<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">a1</span> <span class="free">b1</span> <span class="free">c1</span> <span class="main">=</span> angle <span class="free">a2</span> <span class="free">b2</span> <span class="free">c2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">b1</span> <span class="free">c1</span> <span class="free">a1</span> <span class="main">=</span> angle <span class="free">b2</span> <span class="free">c2</span> <span class="free">a2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">a1</span> <span class="free">b1</span> <span class="main">=</span> dist <span class="free">a2</span> <span class="free">b2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>collinear <span class="main">{</span><span class="free">a1</span><span class="main">,</span><span class="free">b1</span><span class="main">,</span><span class="free">c1</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"congruent_triangle <span class="free">a1</span> <span class="free">b1</span> <span class="free">c1</span> <span class="free">a2</span> <span class="free">b2</span> <span class="free">c2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> congruent_triangleI_sas<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>collinear <span class="main">{</span><span class="free">a1</span><span class="main">,</span><span class="free">b1</span><span class="main">,</span><span class="free">c1</span><span class="main">}</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> neq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a1</span> <span class="main">≠</span> <span class="free">b1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> neq'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a2</span> <span class="main">≠</span> <span class="free">b2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">"angle <span class="free">c1</span> <span class="free">a1</span> <span class="free">b1</span> <span class="main">=</span> angle <span class="free">c2</span> <span class="free">a2</span> <span class="free">b2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> neq neq' assms
    <span class="keyword1"><span class="command">using</span></span> angle_sum_triangle<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a1</span></span> <span class="quoted"><span class="free">b1</span></span> <span class="quoted"><span class="free">c1</span></span><span class="main">]</span> angle_sum_triangle<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a2</span></span> <span class="quoted"><span class="free">b2</span></span> <span class="quoted"><span class="free">c2</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> B<span class="main">:</span> <span class="quoted"><span class="quoted">"angle <span class="free">b1</span> <span class="free">a1</span> <span class="free">c1</span> <span class="main">∈</span> <span class="main">{</span><span class="main">0</span><span class="main">&lt;..&lt;</span>pi<span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> not_collinear_angle<span class="main">)</span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> insert_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> sine_law_triangle<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c1</span></span> <span class="quoted"><span class="free">a1</span></span> <span class="quoted"><span class="free">b1</span></span><span class="main">]</span> sine_law_triangle<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">c2</span></span> <span class="quoted"><span class="free">a2</span></span> <span class="quoted"><span class="free">b2</span></span><span class="main">]</span> assms A B
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">b1</span> <span class="free">c1</span> <span class="main">=</span> dist <span class="free">b2</span> <span class="free">c2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> angle_commute dist_commute sin_angle_zero_iff<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="operator">fact</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> congruent_triangle_aas <span class="main">=</span> congruent_triangleD<span class="main">[</span><span class="operator">OF</span> congruent_triangleI_aas<span class="main">]</span>

<span class="keyword1" id="Triangle-congruent_triangleI_asa"><span class="command">lemma</span></span> congruent_triangleI_asa<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">a1</span> <span class="free">b1</span> <span class="free">c1</span> <span class="main">=</span> angle <span class="free">a2</span> <span class="free">b2</span> <span class="free">c2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">a1</span> <span class="free">b1</span> <span class="main">=</span> dist <span class="free">a2</span> <span class="free">b2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">b1</span> <span class="free">a1</span> <span class="free">c1</span> <span class="main">=</span> angle <span class="free">b2</span> <span class="free">a2</span> <span class="free">c2</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>collinear <span class="main">{</span><span class="free">a1</span><span class="main">,</span> <span class="free">b1</span><span class="main">,</span> <span class="free">c1</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"congruent_triangle <span class="free">a1</span> <span class="free">b1</span> <span class="free">c1</span> <span class="free">a2</span> <span class="free">b2</span> <span class="free">c2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> congruent_triangleI_aas<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> neq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a1</span> <span class="main">≠</span> <span class="free">b1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">a2</span> <span class="main">≠</span> <span class="free">b2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">b1</span> <span class="free">c1</span> <span class="free">a1</span> <span class="main">=</span> angle <span class="free">b2</span> <span class="free">c2</span> <span class="free">a2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> similar_triangle_aa<span class="main">)</span> <span class="main">(</span><span class="operator">insert</span> assms neq<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> angle_commute<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> <span class="operator">fact</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1"><span class="command">lemmas</span></span> congruent_triangle_asa <span class="main">=</span> congruent_triangleD<span class="main">[</span><span class="operator">OF</span> congruent_triangleI_asa<span class="main">]</span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Isosceles Triangle Theorem›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  We now prove the Isosceles Triangle Theorem: in a triangle where two sides have
  the same length, the two angles that are adjacent to only one of the two sides
  must be equal.
›</span></span>
<span class="keyword1" id="Triangle-isosceles_triangle"><span class="command">lemma</span></span> isosceles_triangle<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">a</span> <span class="free">c</span> <span class="main">=</span> dist <span class="free">b</span> <span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"angle <span class="free">b</span> <span class="free">a</span> <span class="free">c</span> <span class="main">=</span> angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> congruent_triangle_sss<span class="main">)</span> <span class="main">(</span><span class="operator">insert</span> assms<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_commute<span class="main">)</span>


<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  For the non-degenerate case (i.e. the three points are not collinear), We also
  prove the converse.
›</span></span>
<span class="keyword1" id="Triangle-isosceles_triangle_converse"><span class="command">lemma</span></span> isosceles_triangle_converse<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">a</span> <span class="free">b</span> <span class="free">c</span> <span class="main">=</span> angle <span class="free">b</span> <span class="free">a</span> <span class="free">c</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>collinear <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   <span class="quoted"><span class="quoted">"dist <span class="free">a</span> <span class="free">c</span> <span class="main">=</span> dist <span class="free">b</span> <span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> congruent_triangle_asa<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> _ _ assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
     <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_commute angle_commute assms<span class="main">)</span>


<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Contributions by Lukas Bulwahn›</span></span>
  
<span class="keyword1" id="Triangle-Pythagoras"><span class="command">lemma</span></span> Pythagoras<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="free">B</span> <span class="free">C</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">::</span> real_inner"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"orthogonal <span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">C</span><span class="main">)</span> <span class="main">(</span><span class="free">B</span> <span class="main">-</span> <span class="free">C</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>dist <span class="free">B</span> <span class="free">C</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>dist <span class="free">C</span> <span class="free">A</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">(</span>dist <span class="free">A</span> <span class="free">B</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"cos <span class="main">(</span>angle <span class="free">A</span> <span class="free">C</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> orthogonal_iff_angle cos_pi_half<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cosine_law_triangle<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="free">B</span></span> <span class="quoted"><span class="free">C</span></span><span class="main"><span class="main">]</span></span> dist_commute<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Triangle-isosceles_triangle_orthogonal_on_midpoint"><span class="command">lemma</span></span> isosceles_triangle_orthogonal_on_midpoint<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="free">B</span> <span class="free">C</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">::</span> euclidean_space"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">C</span> <span class="free">A</span> <span class="main">=</span> dist <span class="free">C</span> <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"orthogonal <span class="main">(</span><span class="free">C</span> <span class="main">-</span> midpoint <span class="free">A</span> <span class="free">B</span><span class="main">)</span> <span class="main">(</span><span class="free">A</span> <span class="main">-</span> midpoint <span class="free">A</span> <span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="free">B</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?M</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"midpoint <span class="free">A</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">≠</span> <span class="free">B</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">A</span> <span class="var">?M</span> <span class="free">C</span> <span class="main">=</span> pi <span class="main">-</span> angle <span class="free">B</span> <span class="var">?M</span> <span class="free">C</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> angle_inverse between_midpoint<span class="main">)</span>
       <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> between_midpoint eq_commute<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted">"midpoint <span class="skolem">A</span> <span class="skolem">B</span>"</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">for</span></span></span></span> <span class="skolem">A</span> <span class="skolem">B</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">A</span> <span class="var">?M</span> <span class="free">C</span> <span class="main">=</span> angle <span class="free">C</span> <span class="var">?M</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> congruence<span class="main">:</span> <span class="quoted"><span class="quoted">"congruent_triangle <span class="free">C</span> <span class="free">A</span> <span class="var">?M</span> <span class="free">C</span> <span class="free">B</span> <span class="var">?M</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> congruent_triangleI_sss<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">C</span> <span class="free">A</span> <span class="main">=</span> dist <span class="free">C</span> <span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">.</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">A</span> <span class="var">?M</span> <span class="main">=</span> dist <span class="free">B</span> <span class="var">?M</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_midpoint<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">C</span> <span class="main">(</span>midpoint <span class="free">A</span> <span class="free">B</span><span class="main">)</span> <span class="main">=</span> dist <span class="free">C</span> <span class="main">(</span>midpoint <span class="free">A</span> <span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">..</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> congruent_triangle.angles<span class="main"><span class="main">(</span></span>6<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"angle <span class="free">A</span> <span class="var">?M</span> <span class="free">C</span> <span class="main">=</span> pi <span class="main">/</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> angle_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> orthogonal_iff_angle orthogonal_commute<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> orthogonal_clauses<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div>
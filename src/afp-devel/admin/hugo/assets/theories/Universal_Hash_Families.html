<div id='Field'>y>
<div class="head">
<h1>Theory Definitions</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Introduction and Definition</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Definitions</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Probability/Independent_Family.html"><span>HOL-Probability.Independent_Family</span></a><span>"</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Universal hash families are commonly used in randomized algorithms and data structures to
</span><span>randomize the input of algorithms, such that probabilistic methods can be employed without requiring
</span><span>any assumptions about the input distribution.
</span><span>
</span><span>If we regard a family of hash functions from a domain $D$ to a finite range $R$ as a uniform probability
</span><span>space, then the family is $k$-universal if:
</span><span>\begin{itemize}
</span><span>\item For each $x \in D$ the evaluation of the functions at $x$ forms a uniformly distributed random variable on $R$.
</span><span>\item The evaluation random variables for $k$ or fewer distinct domain elements form an 
</span><span>independent family of random variables.
</span><span>\end{itemize}
</span><span>
</span><span>This definition closely follows the definition from Vadhan~\cite[\textsection 3.5.5]{vadhan2012}, with the minor
</span><span>modification that independence is required not only for exactly $k$, but also for \emph{fewer} than $k$ distinct
</span><span>domain elements. The correction is due to the fact that in the corner case where $D$ has fewer than $k$ elements,
</span><span>the second part of their definition becomes void. In the formalization this helps avoid an unnecessary assumption in 
</span><span>the theorems.
</span><span>
</span><span>The following definition introduces the notion of $k$-wise independent random variables:</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Definitions.prob_space.k_wise_indep_vars_def|fact"><span class="entity_def" id="Definitions.prob_space.k_wise_indep_vars_def|thm"><span class="entity_def" id="Definitions.prob_space.k_wise_indep_vars_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>prob_space</span><span class="main"><span>)</span></span><span> </span><span class="entity"><span class="entity_def" id="Definitions.prob_space.k_wise_indep_vars.cong|fact"><span class="entity_def" id="Definitions.prob_space.k_wise_indep_vars.cong|thm"><span class="entity_def" id="Definitions.prob_space.k_wise_indep_vars|const"><span class="entity_def" id="offset_1375..1392">k_wise_indep_vars</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k_wise_indep_vars</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>M'</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>X</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>J</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span class="main"><span>.</span></span><span> </span><span>card</span><span> </span><span class="bound"><span>J</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span>finite</span><span> </span><span class="bound"><span>J</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span>indep_vars</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>M'</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>X</span></span></span></span><span> </span><span class="bound"><span>J</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1490..1495">lemma</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>prob_space</span><span class="main"><span>)</span></span><span> </span><span class="entity_def" id="Definitions.prob_space.k_wise_indep_vars_subset|fact"><span class="entity_def" id="Definitions.prob_space.k_wise_indep_vars_subset|thm"><span>k_wise_indep_vars_subset</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Definitions.html#offset_1375..1392"><span>k_wise_indep_vars</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>M'</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>J</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>J</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="free"><span>J</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_vars</span><span> </span><span class="free"><span>M'</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>J</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Definitions.html#offset_1490..1495"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Definitions.html#offset_1490..1495"><span>k_wise_indep_vars_def</span></a><span class="main"><span>)</span></span><span> 

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Similarly for a finite non-empty set $A$ the predicate </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>uniform_on</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>A</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> indicates that
</span><span>the random variable is uniformly distributed on $A$:</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Definitions.prob_space.uniform_on_def|fact"><span class="entity_def" id="Definitions.prob_space.uniform_on_def|thm"><span class="entity_def" id="Definitions.prob_space.uniform_on_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>prob_space</span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Definitions.prob_space.uniform_on.cong|fact"><span class="entity_def" id="Definitions.prob_space.uniform_on.cong|thm"><span class="entity_def" id="Definitions.prob_space.uniform_on|const"><span class="entity_def" id="offset_1905..1915">uniform_on</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>X</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>A</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>
  </span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span>count_space</span><span> </span><span>UNIV</span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>X</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>uniform_measure</span><span> </span><span class="main"><span>(</span></span><span>count_space</span><span> </span><span>UNIV</span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>A</span></span></span></span><span> </span><span class="main"><span>â§</span></span><span> 
  </span><span class="free"><span class="bound"><span class="entity"><span>A</span></span></span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>{}</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span>finite</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>A</span></span></span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span>random_variable</span><span> </span><span class="main"><span>(</span></span><span>count_space</span><span> </span><span>UNIV</span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>X</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2059..2064">lemma</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>prob_space</span><span class="main"><span>)</span></span><span> </span><span class="entity_def" id="Definitions.prob_space.uniform_onD|fact"><span class="entity_def" id="Definitions.prob_space.uniform_onD|thm"><span>uniform_onD</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Definitions.html#offset_1905..1915"><span>uniform_on</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>space</span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>card</span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>space</span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>prob</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>X</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>space</span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>Int_commute</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>vimage_def</span><span> </span><span>Int_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure</span><span> </span><span class="main"><span>(</span></span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span>count_space</span><span> </span><span>UNIV</span><span class="main"><span>)</span></span><span> </span><span class="free"><span>X</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>B</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Definitions.html#offset_2059..2064"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>measure_distr</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Definitions.html#offset_2059..2064"><span>uniform_on_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure</span><span> </span><span class="main"><span>(</span></span><span>uniform_measure</span><span> </span><span class="main"><span>(</span></span><span>count_space</span><span> </span><span>UNIV</span><span class="main"><span>)</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>B</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Definitions.html#offset_2059..2064"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Definitions.html#offset_2059..2064"><span>uniform_on_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>card</span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Definitions.html#offset_2059..2064"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>measure_uniform_measure</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Definitions.html#offset_2059..2064"><span>uniform_on_def</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>With the two previous definitions it is possible to define the $k$-universality condition for a family
</span><span>of hash functions from $D$ to $R$:</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Definitions.prob_space.k_universal_def|fact"><span class="entity_def" id="Definitions.prob_space.k_universal_def|thm"><span class="entity_def" id="Definitions.prob_space.k_universal_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>prob_space</span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Definitions.prob_space.k_universal.cong|fact"><span class="entity_def" id="Definitions.prob_space.k_universal.cong|thm"><span class="entity_def" id="Definitions.prob_space.k_universal|const"><span>k_universal</span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>X</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>D</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>R</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>
  </span><a class="entity_ref" href="Definitions.html#offset_1375..1392"><span>k_wise_indep_vars</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>count_space</span><span> </span><span>UNIV</span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>X</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>D</span></span></span></span><span> </span><span class="main"><span>â§</span></span><span>
  </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>D</span></span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Definitions.html#offset_1905..1915"><span>uniform_on</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>X</span></span></span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>R</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Note: The definition is slightly more generic then the informal specification from above.
</span><span>This is because usually a family is formed by a single function with a variable seed parameter. Instead of
</span><span>choosing a random function from a probability space, a random seed is chosen from the probability space
</span><span>which parameterizes the hash function.
</span><span>
</span><span>The following section contains some preliminary results about independent families
</span><span>of random variables.
</span><span>Section~\ref{sec:carter_wegman} introduces the Carter-Wegman hash family, which is an
</span><span>explicit construction of $k$-universal families for arbitrary $k$ using polynomials over finite fields.
</span><span>The last section contains a proof that the factor ring of the integers modulo a prime ideal is a finite field,
</span><span>followed by an isomorphic construction of prime fields over an initial segment of the natural numbers.</span><span>âº</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre></div><div id='Field'>>


<body>
<div class="head">
<h1>Theory Preliminary_Results</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Preliminary Results</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Preliminary_Results</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> 
    </span><span class="quoted"><span>"</span><a href="Definitions.html"><span>Definitions</span></a><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Probability/Stream_Space.html"><span>HOL-Probability.Stream_Space</span></a><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Probability/Probability_Mass_Function.html"><span>HOL-Probability.Probability_Mass_Function</span></a><span>"</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_178..183">lemma</span></span></span><span> </span><span class="entity_def" id="Preliminary_Results.set_comp_image_cong|fact"><span class="entity_def" id="Preliminary_Results.set_comp_image_cong|thm"><span>set_comp_image_cong</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>|</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>|</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_178..183"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>setcompr_eq_image</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_335..340">lemma</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>prob_space</span><span class="main"><span>)</span></span><span> </span><span class="entity_def" id="Preliminary_Results.measure_pmf.k_wise_indep_vars_compose|fact"><span class="entity_def" id="Preliminary_Results.prob_space.k_wise_indep_vars_compose|fact"><span class="entity_def" id="Preliminary_Results.measure_pmf.k_wise_indep_vars_compose|thm"><span class="entity_def" id="Preliminary_Results.prob_space.k_wise_indep_vars_compose|thm"><span>k_wise_indep_vars_compose</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>k_wise_indep_vars</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>M'</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>measurable</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M'</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>N</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>k_wise_indep_vars</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>N</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>indep_vars_compose2</span><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> N</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>N</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> X</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>X</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> Y</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Y</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> M'</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M'</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_335..340"><span>assms</span></a><span> 
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_335..340"><span>k_wise_indep_vars_def</span></a><span> </span><span>subsetD</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The following two lemmas are of independent interest, they help infer independence of events
</span><span>and random variables on distributions. (Candidates for 
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>theory</span></span><span> "</span><a href="../../HOL/HOL-Probability/Independent_Family.html"><span>HOL-Probability.Independent_Family</span></a><span>"</span><span class="antiquote"><span>}</span></span></span><span>).</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_865..870">lemma</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>prob_space</span><span class="main"><span>)</span></span><span> </span><span class="entity_def" id="Preliminary_Results.measure_pmf.indep_sets_distr|fact"><span class="entity_def" id="Preliminary_Results.prob_space.indep_sets_distr|fact"><span class="entity_def" id="Preliminary_Results.measure_pmf.indep_sets_distr|thm"><span class="entity_def" id="Preliminary_Results.prob_space.indep_sets_distr|thm"><span class="entity_def" id="offset_887..903">indep_sets_distr</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>A</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>random_variable</span><span> </span><span class="free"><span>N</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>F</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>space</span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_1008..1015">indep_F</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_sets</span><span> </span><span class="free"><span>F</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_1044..1050">sets_A</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>sets</span><span> </span><span class="free"><span>N</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob_space.indep_sets</span><span> </span><span class="main"><span>(</span></span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>N</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>prob_space.indep_setsI</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>A'</span></span><span> </span><span class="bound"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>J</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>{}</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>J</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>finite</span><span> </span><span class="bound"><span>J</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>â</span></span><span class="bound"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>A'</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â¹</span></span><span> 
      </span><span>measure</span><span> </span><span class="main"><span>(</span></span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>N</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>A'</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="bound"><span>J</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>â</span></span><span class="bound"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span>measure</span><span> </span><span class="main"><span>(</span></span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>N</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>A'</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>A'</span></span><span> </span><span class="skolem"><span>J</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_1343..1344">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>J</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="skolem"><span>J</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>J</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>A'</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>j</span></span><span>"</span></span></span><span>

    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_1399..1405">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>F'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>F'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="skolem"><span>A'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>space</span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>F'</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>A'</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>space</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span>  </span><span>set_eq_iff</span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_1399..1405"><span>F'_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_1343..1344"><span>a</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>A'</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>sets</span><span> </span><span class="free"><span>N</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_1343..1344"><span>a</span></a><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_1044..1050"><span>sets_A</span></a><span> </span><span>sets.finite_INT</span><span> </span><span>subset_iff</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_1670..1671">b</span><span class="main"><span>:</span></span><span> 
      </span><span class="quoted"><span class="quoted"><span>"</span><span>measure</span><span> </span><span class="main"><span>(</span></span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>N</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>A'</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>F'</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_865..870"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>measure_distr</span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>J</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>F'</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>j</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_1343..1344"><span>a</span></a><span class="main"><span>(</span></span><span>4</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_1399..1405"><span>F'_def</span></a><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_865..870"><span>F_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_1867..1868">c</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>measure</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>F'</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span>measure</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>F'</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_1008..1015"><span>indep_F</span></a><span> </span><span>indep_setsD</span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_1343..1344"><span>a</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>,</span></span></span><span>2</span><span class="main"><span class="main"><span>,</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>J</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>F'</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="skolem"><span>A'</span></span><span> </span><span class="bound"><span>j</span></span><span>  </span><span class="main"><span>â©</span></span><span> </span><span>space</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Preliminary_Results.html#offset_1399..1405"><span>F'_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>J</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>A'</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>sets</span><span> </span><span class="free"><span>N</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_1343..1344"><span>a</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>,</span></span><span>4</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_1044..1050"><span>sets_A</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2151..2152">d</span><span class="main"><span>:</span></span><span>
      </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>J</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>measure</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>F'</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure</span><span> </span><span class="main"><span>(</span></span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>N</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>A'</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_865..870"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span>measure_distr</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>

    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span>
      </span><span class="quoted"><span class="quoted"><span>"</span><span>measure</span><span> </span><span class="main"><span>(</span></span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>N</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>A'</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>â</span></span><span class="skolem"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span>measure</span><span> </span><span class="main"><span>(</span></span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>N</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>A'</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_1670..1671"><span>b</span></a><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_1867..1868"><span>c</span></a><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_2151..2152"><span>d</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob_space</span><span> </span><span class="main"><span>(</span></span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>N</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>prob_space_distr</span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_865..870"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>sets</span><span> </span><span class="main"><span>(</span></span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>N</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_1044..1050"><span>sets_A</span></a><span> </span><span>sets_distr</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2546..2551">lemma</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>prob_space</span><span class="main"><span>)</span></span><span> </span><span class="entity_def" id="Preliminary_Results.measure_pmf.indep_vars_distr|fact"><span class="entity_def" id="Preliminary_Results.prob_space.indep_vars_distr|fact"><span class="entity_def" id="Preliminary_Results.measure_pmf.indep_vars_distr|thm"><span class="entity_def" id="Preliminary_Results.prob_space.indep_vars_distr|thm"><span>indep_vars_distr</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>measurable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>N</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>measurable</span><span> </span><span class="free"><span>N</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M'</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_vars</span><span> </span><span class="free"><span>M'</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob_space.indep_vars</span><span> </span><span class="main"><span>(</span></span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>N</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>M'</span></span><span> </span><span class="free"><span>X'</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> D</span><span class="main"><span>:</span></span><span> </span><span>prob_space</span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>N</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>prob_space_distr</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_2546..2551"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2857..2859">by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2873..2874">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>space</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>space</span><span> </span><span class="free"><span>N</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_2546..2551"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>measurable_def</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Preliminary_Results.html#offset_2857..2859"><span>D.indep_sets</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>space</span><span> </span><span class="free"><span>N</span></span><span> </span><span class="main"><span>|</span></span><span class="bound"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>sets</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M'</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_887..903"><span>indep_sets_distr</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_2546..2551"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>space</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>|</span></span><span class="bound"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>sets</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M'</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>space</span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>space</span><span> </span><span class="free"><span>N</span></span><span> </span><span class="main"><span>|</span></span><span class="bound"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>sets</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M'</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.set_comp_image_cong|fact"><span>set_comp_image_cong</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>set_eq_iff</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>use</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_2873..2874"><span>a</span></a><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_sets</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>space</span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> 
        </span><span class="main"><span>{</span></span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>space</span><span> </span><span class="free"><span>N</span></span><span> </span><span class="main"><span>|</span></span><span class="bound"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>sets</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M'</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_2546..2551"><span>assms</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>indep_vars_def2</span><span> </span><span class="quasi_keyword"><span>cong</span></span><span class="main"><span class="main"><span>:</span></span></span><span>indep_sets_cong</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>i</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>X'</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>space</span><span> </span><span class="free"><span>N</span></span><span> </span><span class="main"><span>|</span></span><span class="bound"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>sets</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M'</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>sets</span><span> </span><span class="free"><span>N</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_2546..2551"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span>measurable_sets</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_2546..2551"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Preliminary_Results.html#offset_2857..2859"><span>D.indep_vars_def2</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Preliminary_Results.range_inter|fact"><span class="entity_def" id="Preliminary_Results.range_inter|thm"><span>range_inter</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>range</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(â©)</span></span><span> </span><span class="free"><span>F</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Pow</span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><span>image_def</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The singletons and the empty set form an intersection stable generator of a countable
</span><span>discrete $\sigma$-algebra:</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3874..3879">lemma</span></span></span><span> </span><span class="entity_def" id="Preliminary_Results.sigma_sets_singletons_and_empty|fact"><span class="entity_def" id="Preliminary_Results.sigma_sets_singletons_and_empty|thm"><span>sigma_sets_singletons_and_empty</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>countable</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sigma_sets</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span>insert</span><span> </span><span class="main"><span>{}</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Pow</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sigma_sets</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Pow</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_3874..3879"><span>assms</span></a><span> </span><span>sigma_sets_singletons</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Pow</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>sigma_sets</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span>insert</span><span> </span><span class="main"><span>{}</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>sigma_sets_subseteq</span><span> </span><span>subset_insertI</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>insert</span><span> </span><span class="main"><span>{}</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>Pow</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sigma_sets</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span>insert</span><span> </span><span class="main"><span>{}</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>Pow</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><span>sigma_algebra.sigma_sets_subset</span><span> </span><span>sigma_algebra_Pow</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>In some of the following theorems, the premise </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure_pmf</span><span> </span><span class="free"><span>p</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> is used. This allows stating
</span><span>theorems that hold for pmfs more concisely, for example, instead of  
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span>measure_pmf.prob</span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>measure_pmf.prob</span><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>B</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> we can 
</span><span>just write </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure_pmf</span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>prob</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>prob</span></span><span> </span><span class="free"><span>B</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> in the locale </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>locale</span></span><span> "</span><span>prob_space</span><span>"</span><span class="antiquote"><span>}</span></span></span><span>.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Preliminary_Results.prob_space_restrict_space|fact"><span class="entity_def" id="Preliminary_Results.prob_space_restrict_space|thm"><span>prob_space_restrict_space</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure_pmf</span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob_space</span><span> </span><span class="main"><span>(</span></span><span>restrict_space</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>prob_spaceI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>emeasure_restrict_space</span><span> </span><span>emeasure_pmf</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The abbreviation below is used to specify the discrete $\sigma$-algebra on </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span>UNIV</span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span>
</span><span>as a measure space. It is used in places where the existing definitions, such as </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>indep_vars</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span>,
</span><span>expect a measure space even though only a \emph{measurable} space is really needed, i.e., in cases
</span><span>where the property is invariant with respect to the actual measure.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Preliminary_Results.discrete|const"><span>discrete</span></span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span>count_space</span><span> </span><span>UNIV</span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5378..5383">lemma</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>prob_space</span><span class="main"><span>)</span></span><span> </span><span class="entity_def" id="Preliminary_Results.measure_pmf.indep_vars_restrict_space|fact"><span class="entity_def" id="Preliminary_Results.prob_space.indep_vars_restrict_space|fact"><span class="entity_def" id="Preliminary_Results.measure_pmf.indep_vars_restrict_space|thm"><span class="entity_def" id="Preliminary_Results.prob_space.indep_vars_restrict_space|thm"><span class="entity_def" id="offset_5400..5425">indep_vars_restrict_space</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure_pmf</span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span>prob_space.indep_vars</span><span> </span><span class="main"><span>(</span></span><span>restrict_space</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span class="main"><span>)</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_vars</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span class="main"><span>)</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_5607..5608">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>id</span><span> </span><span class="main"><span>â</span></span><span> </span><span>restrict_space</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>M</sub></span></span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>measurable_def</span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.range_inter|fact"><span>range_inter</span></a><span> </span><span>sets_restrict_space</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob_space.indep_vars</span><span> </span><span class="main"><span>(</span></span><span>distr</span><span> </span><span class="main"><span>(</span></span><span>restrict_space</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span>id</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span class="main"><span>)</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_5378..5383"><span>assms</span></a><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_5607..5608"><span>a</span></a><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.prob_space_restrict_space|fact"><span>prob_space_restrict_space</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.prob_space.indep_vars_distr|fact"><span>prob_space.indep_vars_distr</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span>emeasure</span><span> </span><span class="main"><span>(</span></span><span>distr</span><span> </span><span class="main"><span>(</span></span><span>restrict_space</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span>id</span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>emeasure</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="bound"><span>A</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>emeasure_distr</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_5607..5608"><span>a</span></a><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>emeasure_restrict_space</span><span> </span><span>emeasure_Int_set_pmf</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>distr</span><span> </span><span class="main"><span>(</span></span><span>restrict_space</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span>id</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>measure_eqI</span><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6217..6222">lemma</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>prob_space</span><span class="main"><span>)</span></span><span> </span><span class="entity_def" id="Preliminary_Results.measure_pmf.measure_pmf_eq|fact"><span class="entity_def" id="Preliminary_Results.prob_space.measure_pmf_eq|fact"><span class="entity_def" id="Preliminary_Results.measure_pmf.measure_pmf_eq|thm"><span class="entity_def" id="Preliminary_Results.prob_space.measure_pmf_eq|thm"><span class="entity_def" id="offset_6239..6253">measure_pmf_eq</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure_pmf</span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>Q</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>prob</span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_6217..6222"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>measure_eq_AE</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><span>AE_pmfI</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_6217..6222"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The following lemma is an intro rule for the independence of random variables defined on pmfs.
</span><span>In that case it is possible, to check the independence of random variables point-wise.
</span><span>
</span><span>The proof relies on the fact that the support of a pmf is countable and the $\sigma$-algebra of
</span><span>such a set can be generated by singletons.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6772..6777">lemma</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>prob_space</span><span class="main"><span>)</span></span><span> </span><span class="entity_def" id="Preliminary_Results.measure_pmf.indep_vars_pmf|fact"><span class="entity_def" id="Preliminary_Results.prob_space.indep_vars_pmf|fact"><span class="entity_def" id="Preliminary_Results.measure_pmf.indep_vars_pmf|thm"><span class="entity_def" id="Preliminary_Results.prob_space.indep_vars_pmf|thm"><span>indep_vars_pmf</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure_pmf</span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>J</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>finite</span><span> </span><span class="bound"><span>J</span></span><span> </span><span class="main"><span>â¹</span></span><span> 
    </span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_vars</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span class="main"><span>)</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> R</span><span class="main"><span>:</span></span><span>prob_space</span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>restrict_space</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.prob_space_restrict_space|fact"><span>prob_space_restrict_space</span></a><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_7095..7097">by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7111..7124">events_eq_pow</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Preliminary_Results.html#offset_7095..7097"><span>R.events</span></a><span> </span><span class="main"><span>=</span></span><span> </span><span>Pow</span><span> </span><span class="main"><span>(</span></span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>sets_restrict_space</span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.range_inter|fact"><span>range_inter</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_7208..7214">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>G</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>G</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>{}</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>âª</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_7274..7280">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>F</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>F</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>|</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7343..7357">sigma_sets_pow</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>sigma_sets</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>G</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Pow</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Preliminary_Results.html#offset_7208..7214"><span>G_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>metis</span></span><span> </span><span>countable_image</span><span> </span><span>countable_set_pmf</span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.sigma_sets_singletons_and_empty|fact"><span>sigma_sets_singletons_and_empty</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7542..7553">F_in_events</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>Pow</span><span> </span><span class="main"><span>(</span></span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_7274..7280"><span>F_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7628..7641">as_sigma_sets</span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>sigma_sets</span><span> </span><span class="main"><span>(</span></span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>F</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>i</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_7757..7758">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> 
          </span><span class="main"><span>{</span></span><span class="free"><span>X</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>|</span></span><span class="bound"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> opaque_lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>inf_le2</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span>
      </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>X</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>|</span></span><span class="bound"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>sigma_sets</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>X</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>G</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_7757..7758"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Preliminary_Results.html#offset_7343..7357"><span>sigma_sets_pow</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>sigma_sets</span><span> </span><span class="main"><span>(</span></span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>X</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>|</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>sigma_sets_vimage_commute</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>sigma_sets</span><span> </span><span class="main"><span>(</span></span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>F</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Preliminary_Results.html#offset_7274..7280"><span>F_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> 
      </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>sigma_sets</span><span> </span><span class="main"><span>(</span></span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>F</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8495..8507">F_Int_stable</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>Int_stable</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>F</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>Int_stableI</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>b</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="skolem"><span>i</span></span><span>"</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>b</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="skolem"><span>i</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>F</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_7274..7280"><span>F_def</span></a><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_7208..7214"><span>G_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8719..8731">F_indep_sets</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Preliminary_Results.html#offset_7095..7097"><span>R.indep_sets</span></a><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_7095..7097"><span>R.indep_setsI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>i</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>F</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_7095..7097"><span>R.events</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_7274..7280"><span>F_def</span></a><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_7111..7124"><span>events_eq_pow</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>A</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>J</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_8918..8919">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>J</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>J</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="skolem"><span>J</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>â</span></span><span class="skolem"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>A</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="bound"><span>j</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8975..8976">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>J</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>A</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>PowD</span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_8918..8919"><span>a</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>,</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>subsetD</span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_7542..7553"><span>F_in_events</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_9076..9081">x_def</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>J</span></span><span>  </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>A</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="bound"><span>j</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_8918..8919"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>Pi_def</span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_7274..7280"><span>F_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>metis</span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Preliminary_Results.html#offset_7095..7097"><span>R.prob</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>A</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>â</span></span><span class="skolem"><span>J</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_7095..7097"><span>R.prob</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>A</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>A</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_9288..9292">True</span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>A</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_8918..8919"><span>a</span></a><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_9288..9292"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>metis</span></span><span> </span><span>measure_empty</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>J</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_9076..9081"><span>x_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>J</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_9076..9081"><span>x_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Preliminary_Results.html#offset_7208..7214"><span>G_def</span></a><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_9619..9624">y_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>J</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>y</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>image_def</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>metis</span></span><span class="main"><span>)</span></span><span> 

      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>A</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_8975..8976"><span>b</span></a><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_8918..8919"><span>a</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Preliminary_Results.html#offset_7095..7097"><span>R.prob</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>A</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>prob</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>A</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>measure_restrict_space</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>prob</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_8918..8919"><span>a</span></a><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_9076..9081"><span>x_def</span></a><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_9619..9624"><span>y_def</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>vimage_def</span><span> </span><span>measure_Int_set_pmf</span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>arg_cong2</span><span> </span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>measure</span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span>prob</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>A</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_9076..9081"><span>x_def</span></a><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_9619..9624"><span>y_def</span></a><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_8918..8919"><span>a</span></a><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_6772..6777"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>vimage_def</span><span> </span><span>measure_Int_set_pmf</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>â</span></span><span class="skolem"><span>J</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_7095..7097"><span>R.prob</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>A</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_8975..8976"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>measure_restrict_space</span><span> </span><span class="quasi_keyword"><span>cong</span></span><span class="main"><span class="main"><span>:</span></span></span><span>prod.cong</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Preliminary_Results.html#offset_7095..7097"><span>R.indep_sets</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span>sigma_sets</span><span> </span><span class="main"><span>(</span></span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>F</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_7095..7097"><span>R.indep_sets_sigma</span></a><span class="main"><span>[</span></span><span class="operator"><span>simplified</span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_8495..8507"><span>F_Int_stable</span></a><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_8719..8731"><span>F_indep_sets</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>space_restrict_space</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Preliminary_Results.html#offset_7095..7097"><span>R.indep_sets</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_7628..7641"><span>as_sigma_sets</span></a><span> </span><span class="quasi_keyword"><span>cong</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Preliminary_Results.html#offset_7095..7097"><span>R.indep_sets_cong</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Preliminary_Results.html#offset_7095..7097"><span>R.indep_vars</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span class="main"><span>)</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span>  </span><a class="entity_ref" href="Preliminary_Results.html#offset_7095..7097"><span>R.indep_vars_def2</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>measurable_def</span><span> </span><span>sets_restrict_space</span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.range_inter|fact"><span>range_inter</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_5400..5425"><span>indep_vars_restrict_space</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_6772..6777"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10844..10849">lemma</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>prob_space</span><span class="main"><span>)</span></span><span> </span><span class="entity_def" id="Preliminary_Results.measure_pmf.split_indep_events|fact"><span class="entity_def" id="Preliminary_Results.prob_space.split_indep_events|fact"><span class="entity_def" id="Preliminary_Results.measure_pmf.split_indep_events|thm"><span class="entity_def" id="Preliminary_Results.prob_space.split_indep_events|thm"><span>split_indep_events</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure_pmf</span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_vars</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span class="main"><span>)</span></span><span> </span><span class="free"><span>X'</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>K</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>K</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>K</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>K</span></span><span class="main"><span>.</span></span><span> </span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>space</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>UNIV</span><span>"</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span>events</span><span> </span><span class="main"><span>=</span></span><span> </span><span>UNIV</span><span>"</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span> </span><span>UNIV</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Preliminary_Results.html#offset_10844..10849"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_vars</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span class="main"><span>)</span></span><span> </span><span class="free"><span>X'</span></span><span> </span><span class="free"><span>K</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_10844..10849"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>,</span></span><span>3</span><span class="main"><span>)</span></span><span> </span><span>indep_vars_subset</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_events</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>space</span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>K</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>indep_eventsI_indep_vars</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_11366..11367">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>indep_events</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>K</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span>  </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>K</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>prob</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>K</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_6239..6253"><span>measure_pmf_eq</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_10844..10849"><span>assms</span></a><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>1</span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>K</span></span><span class="main"><span>.</span></span><span> </span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_11366..11367"><span>a</span></a><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_10844..10849"><span>assms</span></a><span class="main"><span>(</span></span><span>4</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>K</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>indep_events_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11706..11711">lemma</span></span></span><span> </span><span class="entity_def" id="Preliminary_Results.pmf_of_set_eq_uniform|fact"><span class="entity_def" id="Preliminary_Results.pmf_of_set_eq_uniform|thm"><span>pmf_of_set_eq_uniform</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>measure_pmf</span><span> </span><span class="main"><span>(</span></span><span>pmf_of_set</span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>uniform_measure</span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_11846..11847">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_11706..11711"><span>assms</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>card_gt_0_iff</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_11922..11923">b</span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>Y</span></span><span class="main"><span>.</span></span><span> </span><span>emeasure</span><span> </span><span class="main"><span>(</span></span><span>pmf_of_set</span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>Y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>emeasure</span><span> </span><span class="main"><span>(</span></span><span>uniform_measure</span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>Y</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_11706..11711"><span>assms</span></a><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_11846..11847"><span>a</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>emeasure_pmf_of_set</span><span> </span><span>divide_ennreal</span><span> </span><span>ennreal_of_nat_eq_real_of_nat</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>measure_eqI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_11922..11923"><span>b</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_12170..12175">lemma</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span>prob_space</span><span class="main"><span>)</span></span><span> </span><span class="entity_def" id="Preliminary_Results.measure_pmf.uniform_onI|fact"><span class="entity_def" id="Preliminary_Results.prob_space.uniform_onI|fact"><span class="entity_def" id="Preliminary_Results.measure_pmf.uniform_onI|thm"><span class="entity_def" id="Preliminary_Results.prob_space.uniform_onI|thm"><span>uniform_onI</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure_pmf</span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>indicator</span><span> </span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>card</span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>uniform_on</span><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_12364..12365">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><span>measure_pmf.prob</span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>indicator</span><span> </span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>card</span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_12170..12175"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>,</span></span><span>4</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_12466..12467">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>map_pmf</span><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>pmf_of_set</span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>pmf_eqI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Preliminary_Results.html#offset_12170..12175"><span>assms</span></a><span> </span><span>pmf_map</span><span> </span><span>vimage_def</span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_12364..12365"><span>a</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map_pmf</span><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>map_pmf_rep_eq</span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_12170..12175"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure_pmf</span><span> </span><span class="main"><span>(</span></span><span>pmf_of_set</span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_12466..12467"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span>uniform_measure</span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.pmf_of_set_eq_uniform|fact"><span>pmf_of_set_eq_uniform</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_12170..12175"><span>assms</span></a><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>2</span><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span><span>3</span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>uniform_measure</span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>random_variable</span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_12170..12175"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span>  </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_12170..12175"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>,</span></span><span>3</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#offset_12170..12175"><span>uniform_on_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre></div><div id='Field'></head>


<body>
<div class="head">
<h1>Theory Carter_Wegman_Hash_Family</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Carter-Wegman Hash Family\label{sec:carter_wegman}</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Carter_Wegman_Hash_Family</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> 
    </span><a href="../Interpolation_Polynomials_HOL_Algebra/Interpolation_Polynomial_Cardinalities.html"><span>Interpolation_Polynomials_HOL_Algebra.Interpolation_Polynomial_Cardinalities</span></a><span>
    </span><a href="Preliminary_Results.html"><span>Preliminary_Results</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The Carter-Wegman hash family is a generic method to obtain
</span><span>$k$-universal hash families for arbitrary $k$. (There are faster solutions, such as tabulation
</span><span>hashing, which are limited to a specific $k$. See for example \cite{thorup2010}.)
</span><span>
</span><span>The construction was described by Wegman and Carter~\cite{wegman1981}, it is a hash
</span><span>family between the elements of a finite field and works by choosing randomly a polynomial
</span><span>over the field with degree less than $k$. The hash function is the evaluation of a such a
</span><span>polynomial.
</span><span>
</span><span>Using the property that the fraction of polynomials interpolating a given set of $s \leq k$
</span><span>points is </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span>, which is shown in 
</span><span>\cite{Interpolation_Polynomials_HOL_Algebra-AFP}, it is possible to obtain both that 
</span><span>the hash functions are $k$-wise independent and uniformly distributed.
</span><span>
</span><span>In the following two locales are introduced, the main reason for both is to make the statements
</span><span>of the theorems and proofs more concise. The first locale </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>poly_hash_family</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> fixes a finite
</span><span>ring $R$ and the probability space of the polynomials of degree less than $k$. Because the ring is 
</span><span>not a field, the family is not yet $k$-universal, but it is still possible to state a few results such 
</span><span>as the fact that the range of the hash function is a subset of the carrier of the ring.
</span><span>
</span><span>The second locale </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>carter_wegman_hash_family</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> is an extension of the former with the
</span><span>assumption that $R$ is a field with which the $k$-universality follows.
</span><span>
</span><span>The reason for using two separate locales is to support use cases, where the ring is only probably
</span><span>a field. For example if it is the set of integers modulo an approximate prime, in such a situation a
</span><span>subset of the properties of an algorithm using approximate primes would need to be verified
</span><span>even if $R$ is only a ring.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Carter_Wegman_Hash_Family.INTEG.R.hash_def|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.INTEG.P.hash_def|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.ring.hash_def|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.INTEG.R.hash_def|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.INTEG.P.hash_def|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.ring.hash_def|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.ring.hash_def_raw|axiom"><span>definition</span></span></span></span></span></span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring|locale"><span>ring</span></a><span class="main"><span>)</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Carter_Wegman_Hash_Family.ring.hash.cong|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.ring.hash.cong|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.INTEG.R.hash|const"><span class="entity_def" id="Carter_Wegman_Hash_Family.INTEG.P.hash|const"><span class="entity_def" id="Carter_Wegman_Hash_Family.ring.hash|const"><span class="entity_def" id="offset_2052..2056">hash</span></span></span></span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>eval</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.axioms|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.intro|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family_def|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family_axioms.intro|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family_axioms_def|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.axioms(2)|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.axioms(1)|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.intro|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family_def|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family_axioms.intro|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family_axioms_def|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family_def|axiom"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family_axioms_def|axiom"><span class="entity_def" id="offset_2074..2080">locale</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family|locale"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family|const"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family_axioms|const"><span>poly_hash_family</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring|locale"><span>ring</span></a><span> </span><span class="main"><span>+</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.finite_carrier|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.finite_carrier|thm"><span class="entity_def" id="offset_2134..2148">finite_carrier</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.k_ge_0|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.k_ge_0|thm"><span class="entity_def" id="offset_2187..2193">k_ge_0</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.space_def|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.space_def|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.space_def_raw|axiom"><span class="entity_def" id="offset_2210..2220">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.space.cong|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.space.cong|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.space|const"><span class="entity_def" id="offset_2221..2226">space</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>space</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials|const"><span>bounded_degree_polynomials</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.M_def|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.M_def|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.M_def_raw|axiom"><span class="entity_def" id="offset_2274..2284">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.M.cong|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.M.cong|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.M|const"><span class="entity_def" id="offset_2285..2286">M</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure_pmf</span><span> </span><span class="main"><span>(</span></span><span>pmf_of_set</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.finite_space|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.finite_space|thm"><span>finite_space</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2210..2220"><span>space_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>fin_degree_bounded</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2134..2148"><span>finite_carrier</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.non_empty_bounded_degree_polynomials|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.non_empty_bounded_degree_polynomials|thm"><span>non_empty_bounded_degree_polynomials</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2210..2220"><span>space_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>non_empty_bounded_degree_polynomials</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>This is to add </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> [</span><span>source</span><span>] </span><span>carrier_not_empty</span><span class="antiquote"><span>}</span></span></span><span> to the simp set in the context of 
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>locale</span></span><span> "</span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.poly_hash_family|locale"><span>poly_hash_family</span></a><span>"</span><span class="antiquote"><span>}</span></span></span><span>:</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.non_empty_carrier|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.non_empty_carrier|thm"><span>non_empty_carrier</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>carrier_not_empty</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>sublocale</span></span></span><span> </span><span>prob_space</span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2285..2286"><span>M</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2274..2284"><span>M_def</span></a><span> </span><span>prob_space_measure_pmf</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2858..2863">lemma</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.hash_range|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.hash_range|thm"><span class="entity_def" id="offset_2864..2874">hash_range</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2858..2863"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2074..2080"><span>hash_def</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2210..2220"><span>space_def</span></a><span> </span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials_def|fact"><span>bounded_degree_polynomials_def</span></a><span> 
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>metis</span></span><span> </span><span>eval_in_carrier</span><span> </span><span>polynomial_incl</span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Polynomials.html#Polynomials.univ_poly_carrier|fact"><span>univ_poly_carrier</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3106..3111">lemma</span></span></span><span>  </span><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.hash_range_2|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.hash_range_2|thm"><span>hash_range_2</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2864..2874"><span>hash_range</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3106..3111"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.integrable_M|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_family.integrable_M|thm"><span>integrable_M</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span>list</span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'c</span></span><span class="main"><span>::</span></span><span class="main"><span>{</span></span><span>banach</span><span class="main"><span>,</span></span><span> </span><span>second_countable_topology</span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2285..2286"><span>M</span></a><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2274..2284"><span>M_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>integrable_measure_pmf_finite</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.axioms|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.intro|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family_def|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family_axioms.intro|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family_axioms_def|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.axioms(2)|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.axioms(1)|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.intro|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family_def|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family_axioms.intro|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family_axioms_def|thm"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family_def|axiom"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family_axioms_def|axiom"><span class="entity_def" id="offset_3424..3430">locale</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family|locale"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family|const"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family_axioms|const"><span>carter_wegman_hash_family</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.poly_hash_family|locale"><span>poly_hash_family</span></a><span> </span><span class="main"><span>+</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.field_R|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.field_R|thm"><span class="entity_def" id="offset_3488..3495">field_R</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.field|const"><span>field</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3513..3522">sublocale</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.field|locale"><span>field</span></a><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3488..3495"><span>field_R</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.field_size|const"><span class="entity_def" id="offset_3568..3578">field_size</span></span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3600..3605">lemma</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.poly_cards|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.poly_cards|thm"><span class="entity_def" id="offset_3606..3616">poly_cards</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>K</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="free"><span>K</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>K</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>K</span></span><span class="main"><span>.</span></span><span> </span><span>eval</span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3568..3578"><span>field_size</span></a><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span>card</span><span> </span><span class="free"><span>K</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>space_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3513..3522"><span>interpolating_polynomials_card</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span>card</span><span> </span><span class="free"><span>K</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> K</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>K</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3600..3605"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2134..2148"><span>finite_carrier</span></a><span> </span><span>finite_subset</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3929..3934">lemma</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.poly_cards_single|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.poly_cards_single|thm"><span class="entity_def" id="offset_3935..3952">poly_cards_single</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span class="main"><span>.</span></span><span> </span><span>eval</span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3568..3578"><span>field_size</span></a><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3606..3616"><span>poly_cards</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> K</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>x</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> y</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3929..3934"><span>assms</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2187..2193"><span>k_ge_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4148..4153">lemma</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.hash_prob|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.hash_prob|thm"><span class="entity_def" id="offset_4154..4163">hash_prob</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>K</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="free"><span>K</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>K</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>K</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3568..3578"><span>field_size</span></a><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span>card</span><span> </span><span class="free"><span>K</span></span><span>"</span></span></span><span> 
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.zero|const"><span>ð¬</span></a></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_4372..4373">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3568..3578"><span>field_size</span></a><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2134..2148"><span>finite_carrier</span></a><span> </span><span>card_gt_0_iff</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_4447..4448">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="free"><span>K</span></span><span class="main"><span>.</span></span><span> </span><span>eval</span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3568..3578"><span>field_size</span></a><span> </span><span class="main"><span>^</span></span><span> </span><span>card</span><span> </span><span class="free"><span>K</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_4372..4373"><span>a</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_4148..4153"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>frac_eq_eq</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3606..3616"><span>poly_cards</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_4148..4153"><span>assms</span></a><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>1</span><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span><span>2</span><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span><span>3</span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>power_add</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>space_def</span></a><span> </span><span>bounded_degree_polynomials_card</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>M_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>hash_def</span></a><span> </span><span>measure_pmf_of_set</span><span> </span><span>Int_def</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_4447..4448"><span>b</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4813..4818">lemma</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.prob_single|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.prob_single|thm"><span class="entity_def" id="offset_4819..4830">prob_single</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3568..3578"><span>field_size</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_4154..4163"><span>hash_prob</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> K</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>x</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_4813..4818"><span>assms</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2134..2148"><span>finite_carrier</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2187..2193"><span>k_ge_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.prob_range|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.prob_range|thm"><span class="entity_def" id="offset_5006..5016">prob_range</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3568..3578"><span>field_size</span></a><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>prob</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>measure_pmf_eq</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>M_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>measure_finite_Union</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>M_def</span></a><span> </span><span>disjoint_family_on_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3568..3578"><span>field_size</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>sum.cong</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_4819..4830"><span>prob_single</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3568..3578"><span>field_size</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5609..5614">lemma</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.indep|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.indep|thm"><span class="entity_def" id="offset_5615..5620">indep</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>J</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="free"><span>J</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_vars</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="free"><span>J</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.zero|const"><span>ð¬</span></a></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span>card_R_ge_0</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3568..3578"><span>field_size</span></a><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>card_gt_0_iff</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2134..2148"><span>finite_carrier</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_5846..5851">fin_J</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>J</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2134..2148"><span>finite_carrier</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_5609..5614"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span>finite_subset</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>indep_vars_pmf</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>M_def</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>a</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>J'</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_6009..6010">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>J'</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>J</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="skolem"><span>J'</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6042..6049">card_J'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="skolem"><span>J'</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>card_mono</span><span> </span><span>order_trans</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_6009..6010"><span>a</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_5609..5614"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_5846..5851"><span>fin_J</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6133..6143">J'_in_carr</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>J'</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>order_trans</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_6009..6010"><span>a</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_5609..5614"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="skolem"><span>J'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="skolem"><span>J'</span></span><span class="main"><span>.</span></span><span> </span><span>prob</span><span>  </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="skolem"><span>J'</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_6330..6334">True</span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6346..6352">a_carr</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>J'</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_6330..6334"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="skolem"><span>J'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> 
        </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="skolem"><span>J'</span></span><span class="main"><span>.</span></span><span> </span><span>eval</span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>M_def</span></a><span> </span><span>measure_pmf_of_set</span><span> </span><span>Int_def</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>hash_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3568..3578"><span>field_size</span></a><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>card</span><span> </span><span class="skolem"><span>J'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_6330..6334"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3606..3616"><span>poly_cards</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_6133..6143"><span>J'_in_carr</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_6042..6049"><span>card_J'</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> 
        </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3568..3578"><span>field_size</span></a><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>card</span><span> </span><span class="skolem"><span>J'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3568..3578"><span>field_size</span></a><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>space_def</span></a><span> </span><span>bounded_degree_polynomials_card</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> 
        </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3568..3578"><span>field_size</span></a><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>card</span><span> </span><span class="skolem"><span>J'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3568..3578"><span>field_size</span></a><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>card</span><span> </span><span class="skolem"><span>J'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_6042..6049"><span>card_J'</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power_add</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>power_mult</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> 
            </span><span>diff_mult_distrib</span><span> </span><span>frac_eq_eq</span><span> </span><span>add.commute</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> 
        </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3568..3578"><span>field_size</span></a><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>card</span><span> </span><span class="skolem"><span>J'</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3568..3578"><span>field_size</span></a><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>card</span><span> </span><span class="skolem"><span>J'</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power_add</span><span> </span><span>power_mult</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> 
        </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="skolem"><span>J'</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span class="main"><span>.</span></span><span> </span><span>eval</span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_6346..6352"><span>a_carr</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3935..3952"><span>poly_cards_single</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><span>subsetD</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_6133..6143"><span>J'_in_carr</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>]</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>space_def</span></a><span> </span><span>bounded_degree_polynomials_card</span><span> </span><span>power_divide</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="skolem"><span>J'</span></span><span class="main"><span>.</span></span><span> </span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>measure_pmf_of_set</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>M_def</span></a><span> </span><span>Int_def</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>hash_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>j</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_7731..7736">j_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>J'</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>j</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>subsetI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_7731..7736"><span>j_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_7731..7736"><span>j_def</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_6133..6143"><span>J'_in_carr</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2864..2874"><span>hash_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7985..7986">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>j</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>j</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="skolem"><span>J'</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_6009..6010"><span>a</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span>prod_zero</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_6009..6010"><span>a</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_7731..7736"><span>j_def</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> 
        </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="skolem"><span>J'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>j</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>  
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_7731..7736"><span>j_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="skolem"><span>J'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_7985..7986"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
      </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>measure_pmf_of_set</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>M_def</span></a><span> </span><span>Int_def</span><span> </span><span>prod_dividef</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.k_wise_indep|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.k_wise_indep|thm"><span class="entity_def" id="offset_8542..8554">k_wise_indep</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span>k_wise_indep_vars</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>k_wise_indep_vars_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_5615..5620"><span>indep</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8667..8672">lemma</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.inj_if_degree_1|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.inj_if_degree_1|thm"><span>inj_if_degree_1</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2221..2226"><span>space</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Polynomials.html#Polynomials.degree|const"><span>degree</span></a><span> </span><span class="free"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_8667..8672"><span>assms</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3513..3522"><span>eval_inj_if_degree_1</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>M_def</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>space_def</span></a><span> </span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials_def|fact"><span>bounded_degree_polynomials_def</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>hash_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8889..8894">lemma</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.uniform|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.uniform|thm"><span class="entity_def" id="offset_8895..8902">uniform</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>uniform_on</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8987..8988">a</span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="free"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>indicat_real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3568..3578"><span>field_size</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_5006..5016"><span>prob_range</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_8889..8894"><span>assms</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>indicator_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>uniform_onI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>use</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_8987..8988"><span>a</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>M_def</span></a><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>This the main result of this section - the Carter-Wegman hash family is $k$-universal.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theorem</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.k_universal|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_family.k_universal|thm"><span>k_universal</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span>k_universal</span><span> </span><span class="free"><span>k</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_2052..2056"><span>hash</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_8895..8902"><span>uniform</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_8542..8554"><span>k_wise_indep</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_3424..3430"><span>k_universal_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9427..9432">lemma</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_familyI|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.poly_hash_familyI|thm"><span>poly_hash_familyI</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring|const"><span>ring</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.poly_hash_family|const"><span>poly_hash_family</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_9427..9432"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.poly_hash_family_def|fact"><span>poly_hash_family_def</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.poly_hash_family_axioms_def|fact"><span>poly_hash_family_axioms_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9631..9636">lemma</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_familyI|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.carter_wegman_hash_familyI|thm"><span>carter_wegman_hash_familyI</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.field|const"><span>field</span></a><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>F</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.carter_wegman_hash_family|const"><span>carter_wegman_hash_family</span></a><span> </span><span class="free"><span>F</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_9631..9636"><span>assms</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.field.is_ring|fact"><span>field.is_ring</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_9631..9636"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.poly_hash_familyI|fact"><span>poly_hash_familyI</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.carter_wegman_hash_family_def|fact"><span>carter_wegman_hash_family_def</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.carter_wegman_hash_family_axioms_def|fact"><span>carter_wegman_hash_family_axioms_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9917..9922">lemma</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.hash_k_wise_indep|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.hash_k_wise_indep|thm"><span>hash_k_wise_indep</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.field|const"><span>field</span></a><span> </span><span class="free"><span>F</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span>finite</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>F</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Definitions.html#Definitions.prob_space.k_wise_indep_vars|const"><span>prob_space.k_wise_indep_vars</span></a><span> </span><span class="main"><span>(</span></span><span>pmf_of_set</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials|const"><span>bounded_degree_polynomials</span></a><span> </span><span class="free"><span>F</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>n</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>pmf_of_set</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>F</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.ring.hash|const"><span>ring.hash</span></a><span> </span><span class="free"><span>F</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>F</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10162..10171">interpret</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.carter_wegman_hash_family|locale"><span>carter_wegman_hash_family</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>F</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_9917..9922"><span>assms</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.carter_wegman_hash_familyI|fact"><span>carter_wegman_hash_familyI</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_10162..10171"><span>k_wise_indep_vars</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>pmf_of_set</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>F</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_10162..10171"><span>hash</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>F</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_10162..10171"><span>k_wise_indep_vars_compose</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_10162..10171"><span>k_wise_indep</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_10162..10171"><span>M_def</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_10162..10171"><span>space_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10450..10455">lemma</span></span></span><span> </span><span class="entity_def" id="Carter_Wegman_Hash_Family.hash_prob_single|fact"><span class="entity_def" id="Carter_Wegman_Hash_Family.hash_prob_single|thm"><span>hash_prob_single</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.field|const"><span>field</span></a><span> </span><span class="free"><span>F</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span>finite</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>F</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>ð«(</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span>pmf_of_set</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials|const"><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials|const"><span>bounded_degree_polynomials</span></a></a><span> </span><span class="free"><span class="free"><span>F</span></span></span><span> </span><span class="free"><span class="free"><span>n</span></span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.ring.hash|const"><span>ring.hash</span></a><span> </span><span class="free"><span>F</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>F</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10720..10729">interpret</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.carter_wegman_hash_family|locale"><span>carter_wegman_hash_family</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>F</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_10450..10455"><span>assms</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.carter_wegman_hash_familyI|fact"><span>carter_wegman_hash_familyI</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_10720..10729"><span>prob_single</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_10450..10455"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>,</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_10720..10729"><span>M_def</span></a><span> </span><a class="entity_ref" href="Carter_Wegman_Hash_Family.html#offset_10720..10729"><span>space_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre></div><div id='Field'>v class="head">
<h1>Theory Field</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Finite Fields</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Field</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Algebra/Ring_Divisibility.html"><span>HOL-Algebra.Ring_Divisibility</span></a><span>"</span></span><span> </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Algebra/IntRing.html"><span>HOL-Algebra.IntRing</span></a><span>"</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>This section contains a proof that the factor ring </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="free"><span>p</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> for
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> [</span><span>names_short</span><span>] </span><span class="quoted"><span>"</span><span>prime</span><span> </span><span class="free"><span>p</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> is a field. Note that the bulk of the work has already been done in
</span><span>HOL-Algebra, in particular it is established that </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="free"><span>p</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> is a domain.
</span><span>
</span><span>However, any domain with a finite carrier is already a field. This can be seen by establishing that
</span><span>multiplication by a non-zero element is an injective map between the elements of the carrier of the
</span><span>domain. But an injective map between sets of the same non-finite cardinality is also surjective.
</span><span>Hence it is possible to find the unit element in the image of such a map.
</span><span>
</span><span>The following definition introduces the canonical embedding of </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="main"><span>{..&lt;</span></span><span class="main"><span>(</span></span><span class="free"><span>p</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> into </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="free"><span>p</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span>.
</span><span>It will be shown that it is a bijection which establishes that </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="free"><span>p</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> is finite.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Field.zfact_iso_def|fact"><span class="entity_def" id="Field.zfact_iso_def|thm"><span class="entity_def" id="Field.zfact_iso_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Field.zfact_iso|const"><span>zfact_iso</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>int</span><span> </span><span>set</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>zfact_iso</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ideal.html#Ideal.genideal|const"><span>Idl</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>{</span></span><span>int</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1050..1057">context</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>int</span><span> </span><span>set</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_1108..1114">n_ge_0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ideal.html#Ideal.genideal|const"><span>Idl</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>{</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Field.ideal_I|fact"><span class="entity_def" id="Field.ideal_I|thm"><span class="entity_def" id="offset_1168..1175">ideal_I</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ideal.html#Ideal.ideal|const"><span>ideal</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_1050..1057"><span>I_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int.genideal_ideal|fact"><span>int.genideal_ideal</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Field.zfact_iso_inj|fact"><span class="entity_def" id="Field.zfact_iso_inj|thm"><span class="entity_def" id="offset_1248..1261">zfact_iso_inj</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>inj_onI</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_1335..1336">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_1359..1360">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Field.html#Field.zfact_iso_def|fact"><span>zfact_iso_def</span></a><span> </span><a class="entity_ref" href="Field.html#offset_1050..1057"><span>I_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>int</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>int</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int.quotient_eq_iff_same_a_r_cos|fact"><span>int.quotient_eq_iff_same_a_r_cos</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_1168..1175"><span>ideal_I</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>int</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span>int</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>int</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span>int</span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_1050..1057"><span>I_def</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.Idl_subset_eq_dvd|fact"><span>Idl_subset_eq_dvd</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_Idl_subset_ideal|fact"><span>int_Idl_subset_ideal</span></a><span> </span><span>mod_eq_dvd_iff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_1335..1336"><span>a</span></a><span> </span><a class="entity_ref" href="Field.html#offset_1359..1360"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1767..1772">lemma</span></span></span><span> </span><span class="entity_def" id="Field.I_shift|fact"><span class="entity_def" id="Field.I_shift|thm"><span class="entity_def" id="offset_1773..1780">I_shift</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>u</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="free"><span>u</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="free"><span>v</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>u</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_1050..1057"><span>I_def</span></a><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.Idl_subset_eq_dvd|fact"><span>Idl_subset_eq_dvd</span></a><span> </span><a class="entity_ref" href="Field.html#offset_1767..1772"><span>assms</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_Idl_subset_ideal|fact"><span>int_Idl_subset_ideal</span></a><span> </span><span>mod_eq_dvd_iff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_1168..1175"><span>ideal_I</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int.quotient_eq_iff_same_a_r_cos|fact"><span>int.quotient_eq_iff_same_a_r_cos</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Field.zfact_iso_ran|fact"><span class="entity_def" id="Field.zfact_iso_ran|thm"><span class="entity_def" id="offset_2065..2078">zfact_iso_ran</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_def|fact"><span>zfact_iso_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact_def|fact"><span>ZFact_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/QuotRing.html#QuotRing.FactRing_simps|fact"><span>FactRing_simps</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int.a_rcosetsI|fact"><span>int.a_rcosetsI</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_2444..2449">y_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>I</span></span><span>  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_1050..1057"><span>I_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact_def|fact"><span>ZFact_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/QuotRing.html#QuotRing.FactRing_simps|fact"><span>FactRing_simps</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>z</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_2542..2547">z_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="skolem"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Euclidean_Division.pos_mod_sign</span><span> </span><span>mod_mod_trivial</span><span> </span><a class="entity_ref" href="Field.html#offset_1108..1114"><span>n_ge_0</span></a><span> </span><span>nonneg_int_cases</span><span>
          </span><span>of_nat_0_less_iff</span><span> </span><span>of_nat_mod</span><span> </span><span>unique_euclidean_semiring_numeral_class.pos_mod_bound</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>I</span></span><span>  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Field.html#offset_2444..2449"><span>y_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="skolem"><span>z</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Field.html#offset_1773..1780"><span>I_shift</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Field.html#offset_2542..2547"><span>z_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>z</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Field.html#Field.zfact_iso_def|fact"><span>zfact_iso_def</span></a><span> </span><a class="entity_ref" href="Field.html#offset_1050..1057"><span>I_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>z</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_2542..2547"><span>z_def</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Field.zfact_iso_0|fact"><span class="entity_def" id="Field.zfact_iso_0|thm"><span>zfact_iso_0</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.zero|const"><span>ð¬</span></a></span><span>â</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>â</span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> i</span><span class="main"><span>:</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ideal.html#Ideal.ideal|locale"><span>ideal</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_1168..1175"><span>ideal_I</span></a><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3249..3251">by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> s</span><span class="main"><span>:</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/RingHom.html#RingHom.ring_hom_ring|locale"><span>ring_hom_ring</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>(+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â</span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>)</span></a></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
   </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_3249..3251"><span>i.rcos_ring_hom_ring</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact_def|fact"><span>ZFact_def</span></a><span> </span><a class="entity_ref" href="Field.html#offset_1050..1057"><span>I_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Field.html#Field.zfact_iso_def|fact"><span>zfact_iso_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact_def|fact"><span>ZFact_def</span></a><span> </span><a class="entity_ref" href="Field.html#offset_1050..1057"><span>I_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Field.zfact_iso_bij|fact"><span class="entity_def" id="Field.zfact_iso_bij|thm"><span class="entity_def" id="offset_3457..3470">zfact_iso_bij</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span>bij_betw</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span>  </span><span>bij_betw_def</span><span> </span><a class="entity_ref" href="Field.html#offset_1248..1261"><span>zfact_iso_inj</span></a><span> </span><a class="entity_ref" href="Field.html#offset_2065..2078"><span>zfact_iso_ran</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Field.zfact_card|fact"><span class="entity_def" id="Field.zfact_card|thm"><span class="entity_def" id="offset_3598..3608">zfact_card</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>bij_betw_same_card</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_3457..3470"><span>zfact_iso_bij</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Field.zfact_finite|fact"><span class="entity_def" id="Field.zfact_finite|thm"><span>zfact_finite</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Field.html#offset_1108..1114"><span>n_ge_0</span></a><span> </span><a class="entity_ref" href="Field.html#offset_3598..3608"><span>zfact_card</span></a><span> </span><span>card.infinite</span><span> </span><span>less_nat_zero_code</span><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3830..3835">lemma</span></span></span><span> </span><span class="entity_def" id="Field.finite_domains_are_fields|fact"><span class="entity_def" id="Field.finite_domains_are_fields|thm"><span>finite_domains_are_fields</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.domain|const"><span>domain</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.field|const"><span>field</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.domain|locale"><span>domain</span></a><span> </span><span class="quoted"><span class="free"><span>R</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_3830..3835"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.Units|const"><span>Units</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.zero|const"><span>ð¬</span></a></span><span>â</span><span class="free"><span>R</span></span><span>â</span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.Units|const"><span>Units</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.Units_def|fact"><span>Units_def</span></a><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.zero|const"><span>ð¬</span></a></span><span>â</span><span class="free"><span>R</span></span><span>â </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.Units|const"><span>Units</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="Field.html#offset_3830..3835"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring_Divisibility.html#Ring_Divisibility.domain.zero_is_prime|fact"><span>domain.zero_is_prime</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Divisibility.html#Divisibility.primeE|fact"><span>primeE</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.Units|const"><span>Units</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.zero|const"><span>ð¬</span></a></span><span>â</span><span class="free"><span>R</span></span><span>â</span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.zero|const"><span>ð¬</span></a></span><span>â</span><span class="free"><span>R</span></span><span>â</span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.Units|const"><span>Units</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_4319..4320">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.zero|const"><span>ð¬</span></a></span><span>â</span><span class="free"><span>R</span></span><span>â</span><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_4358..4364">x_carr</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
      </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_4397..4403">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>f</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.mult|const"><span>â</span></a></span><span>â</span><span class="free"><span>R</span></span><span>â </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_4397..4403"><span>f_def</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>inj_onI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>metis</span></span><span> </span><span>DiffD1</span><span> </span><span>DiffD2</span><span> </span><a class="entity_ref" href="Field.html#offset_4319..4320"><span>a</span></a><span> </span><a class="entity_ref" href="Field.html#offset_3830..3835"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.domain.m_rcancel|fact"><span>domain.m_rcancel</span></a><span> </span><span>insertI1</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>card_image</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_4397..4403"><span>f_def</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>image_subsetI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.ring_simprules|fact"><span>ring.ring_simprules</span></a><span> </span><a class="entity_ref" href="Field.html#offset_4358..4364"><span>x_carr</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>card_subset_eq</span><span> </span><a class="entity_ref" href="Field.html#offset_3830..3835"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
      </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.one|const"><span>ð­</span></a></span><span>â</span><span class="free"><span>R</span></span><span>â </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.one|const"><span>ð­</span></a></span><span>â</span><span class="free"><span>R</span></span><span>â</span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>image_iff</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_5036..5045">y_carrier</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_5067..5077">y_left_inv</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.mult|const"><span>â</span></a></span><span>â</span><span class="free"><span>R</span></span><span>â </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.one|const"><span>ð­</span></a></span><span>â</span><span class="free"><span>R</span></span><span>â</span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_4397..4403"><span>f_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span>  </span><span class="entity_def" id="offset_5140..5151">y_right_inv</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.mult|const"><span>â</span></a></span><span>â</span><span class="free"><span>R</span></span><span>â </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.one|const"><span>ð­</span></a></span><span>â</span><span class="free"><span>R</span></span><span>â</span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_3830..3835"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Field.html#offset_4319..4320"><span>a</span></a><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>DiffD1</span><span> </span><a class="entity_ref" href="Field.html#offset_4319..4320"><span>a</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.cring.cring_simprules|fact"><span>cring.cring_simprules</span></a><span class="main"><span class="main"><span>(</span></span></span><span>14</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.domain.axioms|fact"><span>domain.axioms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.Units|const"><span>Units</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_5036..5045"><span>y_carrier</span></a><span> </span><a class="entity_ref" href="Field.html#offset_5067..5077"><span>y_left_inv</span></a><span> </span><a class="entity_ref" href="Field.html#offset_5140..5151"><span>y_right_inv</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>DiffD1</span><span> </span><a class="entity_ref" href="Field.html#offset_4319..4320"><span>a</span></a><span> </span><a class="entity_ref" href="Field.html#offset_3830..3835"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring_Divisibility.html#Ring_Divisibility.cring.divides_one|fact"><span>cring.divides_one</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.domain.axioms|fact"><span>domain.axioms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Divisibility.html#Divisibility.factor_def|fact"><span>factor_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.field|const"><span>field</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_3830..3835"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.field.intro|fact"><span>field.intro</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.field_axioms.intro|fact"><span>field_axioms.intro</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5503..5508">lemma</span></span></span><span> </span><span class="entity_def" id="Field.zfact_prime_is_field|fact"><span class="entity_def" id="Field.zfact_prime_is_field|thm"><span>zfact_prime_is_field</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Factorial_Ring.prime</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>p</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>nat</span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.field|const"><span>field</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_finite|fact"><span>zfact_finite</span></a><span> </span><a class="entity_ref" href="Field.html#offset_5503..5508"><span>assms</span></a><span> </span><span>prime_gt_0_nat</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.domain|const"><span>domain</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact_prime_is_domain|fact"><span>ZFact_prime_is_domain</span></a><span> </span><a class="entity_ref" href="Field.html#offset_5503..5508"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.finite_domains_are_fields|fact"><span>finite_domains_are_fields</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>In some applications it is more convenient to work with natural numbers instead of
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="free"><span>p</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> whose elements are cosets. To support that use case the following definition
</span><span>introduces an additive and multiplicative structure on </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="main"><span>{..&lt;</span></span><span class="free"><span>p</span></span><span class="main"><span>}</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span>. After verifying that
</span><span>the function </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> and its inverse are homomorphisms, the ring and field property
</span><span>can be transfered from </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="free"><span>p</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> to to the structure on </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="main"><span>{..&lt;</span></span><span class="free"><span>p</span></span><span class="main"><span>}</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span>.</span><span>âº</span></span></span><span> 

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Field.mod_ring_def|fact"><span class="entity_def" id="Field.mod_ring_def|thm"><span class="entity_def" id="Field.mod_ring_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Field.mod_ring|const"><span>mod_ring</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>nat</span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring|type"><span>ring</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>mod_ring</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>â¦</span></span><span> 
    carrier </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>}</span></span><span class="main"><span>,</span></span><span>
    mult </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
    one </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>,</span></span><span>
    zero </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span>
    add </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¦</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Field.zfact_iso_inv_def|fact"><span class="entity_def" id="Field.zfact_iso_inv_def|thm"><span class="entity_def" id="Field.zfact_iso_inv_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>int</span><span> </span><span>set</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>zfact_iso_inv</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>inv_into</span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Field.zfact_iso_inv_0|fact"><span class="entity_def" id="Field.zfact_iso_inv_0|thm"><span>zfact_iso_inv_0</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_6663..6669">n_ge_0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.zero|const"><span>ð¬</span></a></span><span>â</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>â </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv_def|fact"><span>zfact_iso_inv_def</span></a><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_0|fact"><span>zfact_iso_0</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_6663..6669"><span>n_ge_0</span></a><span class="main"><span>,</span></span><span> </span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_6663..6669"><span>n_ge_0</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>inv_into_f_f</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inj|fact"><span>zfact_iso_inj</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6870..6875">lemma</span></span></span><span> </span><span class="entity_def" id="Field.zfact_coset|fact"><span class="entity_def" id="Field.zfact_coset|thm"><span>zfact_coset</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>n_ge_0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ideal.html#Ideal.genideal|const"><span>Idl</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>{</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_6870..6875"><span>assms</span></a><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_ran|fact"><span>zfact_iso_ran</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv_def|fact"><span>zfact_iso_inv_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>f_inv_into_f</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_def|fact"><span>zfact_iso_def</span></a><span> </span><a class="entity_ref" href="Field.html#offset_6870..6875"><span>I_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Field.zfact_iso_inv_is_ring_iso|fact"><span class="entity_def" id="Field.zfact_iso_inv_is_ring_iso|thm"><span>zfact_iso_inv_is_ring_iso</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_7318..7324">n_ge_1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/QuotRing.html#QuotRing.ring_iso|const"><span>ring_iso</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/QuotRing.html#QuotRing.ring_iso_memI|fact"><span>ring_iso_memI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> r</span><span class="main"><span>:</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.cring|locale"><span>cring</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact_is_cring|fact"><span>ZFact_is_cring</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_7501..7507">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>I</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>I</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ideal.html#Ideal.genideal|const"><span>Idl</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>{</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7545..7551">n_ge_0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_7318..7324"><span>n_ge_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> i</span><span class="main"><span>:</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ideal.html#Ideal.ideal|locale"><span>ideal</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>I</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.ideal_I|fact"><span>ideal_I</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_7545..7551"><span>n_ge_0</span></a><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Field.html#offset_7501..7507"><span>I_def</span></a><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_7646..7648">by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> s</span><span class="main"><span>:</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/RingHom.html#RingHom.ring_hom_ring|locale"><span>ring_hom_ring</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>(+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â</span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>)</span></a></span><span> </span><span class="skolem"><span>I</span></span><span>"</span></span></span><span>
   </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_7646..7648"><span>i.rcos_ring_hom_ring</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact_def|fact"><span>ZFact_def</span></a><span> </span><a class="entity_ref" href="Field.html#offset_7501..7507"><span>I_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> 
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv_def|fact"><span>zfact_iso_inv_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_ran|fact"><span>zfact_iso_ran</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_7545..7551"><span>n_ge_0</span></a><span class="main"><span>]</span></span><span> </span><span>inv_into_into</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>

    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span>
    </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.mult|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>â </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.mult|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>â </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_8359..8365">x_carr</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_8401..8407">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_8453..8459">y_carr</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_8495..8501">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.mult|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>â </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>I</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="skolem"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.mult|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>â </span><span class="main"><span>(</span></span><span class="skolem"><span>I</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="skolem"><span>y'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_8401..8407"><span>x'_def</span></a><span> </span><a class="entity_ref" href="Field.html#offset_8495..8501"><span>y'_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_8359..8365"><span>x_carr</span></a><span> </span><a class="entity_ref" href="Field.html#offset_8453..8459"><span>y_carr</span></a><span> </span><a class="entity_ref" href="Field.html#Field.zfact_coset|fact"><span>zfact_coset</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_7545..7551"><span>n_ge_0</span></a><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Field.html#offset_7501..7507"><span>I_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>I</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>int</span><span> </span><span class="skolem"><span>y'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>I</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>y'</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_7501..7507"><span>I_def</span></a><span> </span><span>zmod_int</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Field.html#Field.I_shift|fact"><span>I_shift</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_7545..7551"><span>n_ge_0</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>I</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>(</span></span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.mult|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>â </span><span class="skolem"><span>y'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.mult|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>â </span><span class="skolem"><span>y'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_def|fact"><span>zfact_iso_def</span></a><span> </span><a class="entity_ref" href="Field.html#offset_7501..7507"><span>I_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_9111..9112">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.mult|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>â </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.mult|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>â </span><span class="skolem"><span>y'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_9195..9196">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.mult|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>â </span><span class="skolem"><span>y'</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span> </span><a class="entity_ref" href="Field.html#offset_7545..7551"><span>n_ge_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.mult|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>â </span><span class="skolem"><span>y'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.mult|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>â </span><span class="skolem"><span>y'</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv_def|fact"><span>zfact_iso_inv_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>inv_into_f_f</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inj|fact"><span>zfact_iso_inj</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_7545..7551"><span>n_ge_0</span></a><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_9195..9196"><span>b</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> 
      </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.mult|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>â </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.mult|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>â </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_9111..9112"><span>a</span></a><span> </span><a class="entity_ref" href="Field.html#offset_8401..8407"><span>x'_def</span></a><span> </span><a class="entity_ref" href="Field.html#offset_8495..8501"><span>y'_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span>
    </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.add|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>â </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.add|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>â </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_9816..9822">x_carr</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_9858..9864">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_9910..9916">y_carr</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_9952..9958">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.add|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>â </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>I</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="skolem"><span>x'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.add|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>â </span><span class="main"><span>(</span></span><span class="skolem"><span>I</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="skolem"><span>y'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_9858..9864"><span>x'_def</span></a><span> </span><a class="entity_ref" href="Field.html#offset_9952..9958"><span>y'_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_9816..9822"><span>x_carr</span></a><span> </span><a class="entity_ref" href="Field.html#offset_9910..9916"><span>y_carr</span></a><span> </span><a class="entity_ref" href="Field.html#Field.zfact_coset|fact"><span>zfact_coset</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_7545..7551"><span>n_ge_0</span></a><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Field.html#offset_7501..7507"><span>I_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>I</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>int</span><span> </span><span class="skolem"><span>y'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>I</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>y'</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_7501..7507"><span>I_def</span></a><span> </span><span>zmod_int</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Field.html#Field.I_shift|fact"><span>I_shift</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_7545..7551"><span>n_ge_0</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>I</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/AbelCoset.html#AbelCoset.a_r_coset|const"><span>+&gt;</span></a></span><span>â</span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.int_ring|const"><span>ðµ</span></a></span><span>â </span><span class="main"><span>(</span></span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.add|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>â </span><span class="skolem"><span>y'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.add|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>â </span><span class="skolem"><span>y'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_def|fact"><span>zfact_iso_def</span></a><span> </span><a class="entity_ref" href="Field.html#offset_7501..7507"><span>I_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10568..10569">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.add|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>â </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.add|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>â </span><span class="skolem"><span>y'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10652..10653">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.add|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>â </span><span class="skolem"><span>y'</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span> </span><a class="entity_ref" href="Field.html#offset_7545..7551"><span>n_ge_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.add|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>â </span><span class="skolem"><span>y'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.add|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>â </span><span class="skolem"><span>y'</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv_def|fact"><span>zfact_iso_inv_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>inv_into_f_f</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inj|fact"><span>zfact_iso_inj</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_7545..7551"><span>n_ge_0</span></a><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_10652..10653"><span>b</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> 
      </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.add|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>â </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.add|const"><span>â</span></a></span><span>â</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>â </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_10568..10569"><span>a</span></a><span> </span><a class="entity_ref" href="Field.html#offset_9858..9864"><span>x'_def</span></a><span> </span><a class="entity_ref" href="Field.html#offset_9952..9958"><span>y'_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.one|const"><span>ð­</span></a></span><span>â</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>â </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.one|const"><span>ð­</span></a></span><span>â</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>â</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Field.html#Field.zfact_iso_def|fact"><span>zfact_iso_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact_def|fact"><span>ZFact_def</span></a><span> </span><a class="entity_ref" href="Field.html#offset_7501..7507"><span>I_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.one|const"><span>ð­</span></a></span><span>â</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>â </span><span class="main"><span>=</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Group.html#Group.monoid.one|const"><span>ð­</span></a></span><span>â</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>â</span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv_def|fact"><span>zfact_iso_inv_def</span></a><span> </span><a class="entity_ref" href="Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>inv_into_f_f</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inj|fact"><span>zfact_iso_inj</span></a><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Field.html#offset_7318..7324"><span>n_ge_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>bij_betw</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv_def|fact"><span>zfact_iso_inv_def</span></a><span> </span><a class="entity_ref" href="Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_bij|fact"><span>zfact_iso_bij</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_7545..7551"><span>n_ge_0</span></a><span class="main"><span>]</span></span><span> </span><span>bij_betw_inv_into</span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Field.mod_ring_finite|fact"><span class="entity_def" id="Field.mod_ring_finite|thm"><span>mod_ring_finite</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Field.mod_ring_carr|fact"><span class="entity_def" id="Field.mod_ring_carr|thm"><span>mod_ring_carr</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â·</span></span><span>  </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Field.mod_ring_is_cring|fact"><span class="entity_def" id="Field.mod_ring_is_cring|thm"><span>mod_ring_is_cring</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_11752..11758">n_ge_1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.cring|const"><span>cring</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_11812..11818">n_ge_0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_11752..11758"><span>n_ge_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.cring|locale"><span>cring</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact_is_cring|fact"><span>ZFact_is_cring</span></a><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11909..11911">by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.cring|const"><span>cring</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¦</span></span><span> zero </span><span class="main"><span>:=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.zero|const"><span>ð¬</span></a></span><span>â</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>â </span><span class="main"><span>â¦</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Field.html#offset_11909..11911"><span>ring_iso_imp_img_cring</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv_is_ring_iso|fact"><span>zfact_iso_inv_is_ring_iso</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_11752..11758"><span>n_ge_1</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¦</span></span><span> zero </span><span class="main"><span>:=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.zero|const"><span>ð¬</span></a></span><span>â</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>â </span><span class="main"><span>â¦</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv_0|fact"><span>zfact_iso_inv_0</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_11812..11818"><span>n_ge_0</span></a><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Field.zfact_iso_is_ring_iso|fact"><span class="entity_def" id="Field.zfact_iso_is_ring_iso|thm"><span>zfact_iso_is_ring_iso</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_12311..12317">n_ge_1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/QuotRing.html#QuotRing.ring_iso|const"><span>ring_iso</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_12404..12405">r</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring|const"><span>ring</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact_is_cring|fact"><span>ZFact_is_cring</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.cring.axioms|fact"><span>cring.axioms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_12482..12491">interpret</span></span></span><span> s</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring|locale"><span>ring</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.mod_ring_is_cring|fact"><span>mod_ring_is_cring</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.cring.axioms|fact"><span>cring.axioms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Field.html#offset_12311..12317"><span>n_ge_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_12582..12588">n_ge_0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_12311..12317"><span>n_ge_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span>inv_into</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/QuotRing.html#QuotRing.ring_iso|const"><span>ring_iso</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/QuotRing.html#QuotRing.ring_iso_set_sym|fact"><span>ring_iso_set_sym</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_12404..12405"><span>r</span></a><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv_is_ring_iso|fact"><span>zfact_iso_inv_is_ring_iso</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_12311..12317"><span>n_ge_1</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span> 
    </span><span>inv_into</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inv_into</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso|const"><span>zfact_iso</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv_def|fact"><span>zfact_iso_inv_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>inv_into_inv_into_eq</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_bij|fact"><span>zfact_iso_bij</span></a><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_12582..12588"><span>n_ge_0</span></a><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_12482..12491"><span>s.ring_iso_restrict</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>If </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>p</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> is a prime than </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>p</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> is a field:</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_13385..13390">lemma</span></span></span><span> </span><span class="entity_def" id="Field.mod_ring_is_field|fact"><span class="entity_def" id="Field.mod_ring_is_field|thm"><span>mod_ring_is_field</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>Factorial_Ring.prime</span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.field|const"><span>field</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_13488..13494">p_ge_0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>p</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_13385..13390"><span>assms</span></a><span> </span><span>prime_gt_0_nat</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_13547..13553">p_ge_1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>p</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#offset_13385..13390"><span>assms</span></a><span> </span><span>prime_gt_1_nat</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_13602..13611">interpret</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.field|locale"><span>field</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_prime_is_field|fact"><span>zfact_prime_is_field</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_13385..13390"><span>assms</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.field|const"><span>field</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¦</span></span><span> zero </span><span class="main"><span>:=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.zero|const"><span>ð¬</span></a></span><span>â</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span>â </span><span class="main"><span>â¦</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Field.html#offset_13602..13611"><span>ring_iso_imp_img_field</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv_is_ring_iso|fact"><span>zfact_iso_inv_is_ring_iso</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_13547..13553"><span>p_ge_1</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¦</span></span><span> zero </span><span class="main"><span>:=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv|const"><span>zfact_iso_inv</span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.zero|const"><span>ð¬</span></a></span><span>â</span><a class="entity_ref" href="../../HOL/HOL-Algebra/IntRing.html#IntRing.ZFact|const"><span>ZFact</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span>â </span><span class="main"><span>â¦</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Field.html#Field.zfact_iso_inv_0|fact"><span>zfact_iso_inv_0</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Field.html#offset_13488..13494"><span>p_ge_0</span></a><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre></div>
<div id='Binary_Operations'>y>
<div class="head">
<h1>Theory Bits_Digits</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Digit functions</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Bits_Digits</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="../../HOL/HOL/Main.html"><span>Main</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>We define the n-th bit of a number in base 2 representation</span><span> </span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Bits_Digits.nth_bit_def|fact"><span class="entity_def" id="Bits_Digits.nth_bit_def|thm"><span class="entity_def" id="Bits_Digits.nth_bit_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Bits_Digits.nth_bit|const"><span>nth_bit</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infix</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>Â¡</span></span><span>"</span></span><span> 100</span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>nth_bit</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>num</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>num</span></span></span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>as well as the n-th digit of a number in an arbitrary base</span><span> </span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Bits_Digits.nth_digit_def|fact"><span class="entity_def" id="Bits_Digits.nth_digit_def|thm"><span class="entity_def" id="Bits_Digits.nth_digit_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Bits_Digits.nth_digit|const"><span>nth_digit</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>nth_digit</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>num</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>base</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>num</span></span></span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>base</span></span></span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>base</span></span></span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>In base 2, the two definitions coincide.</span><span> </span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.nth_digit_base2_equiv|fact"><span class="entity_def" id="Bits_Digits.nth_digit_base2_equiv|thm"><span>nth_digit_base2_equiv</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_587..592">lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.general_digit_base|fact"><span class="entity_def" id="Bits_Digits.general_digit_base|thm"><span>general_digit_base</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>t1</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="free"><span>t2</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>t1</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>t2</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> 
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_699..700">1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>t1</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>t2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>t1</span></span><span class="main"><span>-</span></span><span class="free"><span>t2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_587..592"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Suc_lessD</span><span> </span><span>less_imp_le</span><span> </span><span>less_numeral_extra</span><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>power_diff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>t2</span></span><span> </span><span class="keyword1"><span>dvd</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>t1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>`</span><span class="free"><span>t1</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="free"><span>t2</span></span><span>`</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>le_imp_power_dvd</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>t1</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>t2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>t1</span></span><span class="main"><span>-</span></span><span class="free"><span>t2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>div_mult_swap</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>t2</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>t1</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_699..700"><span>1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_587..592"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.nth_bit_bounded|fact"><span class="entity_def" id="Bits_Digits.nth_bit_bounded|thm"><span>nth_bit_bounded</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.nth_digit_bounded|fact"><span class="entity_def" id="Bits_Digits.nth_digit_bounded|thm"><span>nth_digit_bounded</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>less_Suc_eq_le</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.obtain_smallest|fact"><span class="entity_def" id="Bits_Digits.obtain_smallest|thm"><span>obtain_smallest</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>k</span></span></span><span class="main"><span>â¤</span></span><span class="free"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>a</span></span></span><span class="main"><span>&lt;</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>ex_least_nat_le</span><span> </span><span>not_less_zero</span><span> </span><span>zero_le</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Simple properties and equivalences</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Reduce the </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a></span><span class="antiquote"><span>}</span></span></span><span> function to </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a></span><span class="antiquote"><span>}</span></span></span><span> if the base is a power of 2</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.digit_gen_pow2_reduct|fact"><span class="entity_def" id="Bits_Digits.digit_gen_pow2_reduct|thm"><span>digit_gen_pow2_reduct</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><span>*</span></span><span class="free"><span>t</span></span><span class="main"><span>+</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_1627..1633">moddiv</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_1687..1690">klc</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>a</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>b</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_1719..1724">x_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>b</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>b</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>c</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><span>mod_div_decomp</span><span> </span><span>mod_less_divisor</span><span> </span><span>zero_less_numeral</span><span> </span><span>zero_less_power</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_1854..1856">bk</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><span>-</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_1719..1724"><span>x_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span>Euclidean_Division.div_eq_0_iff</span><span> </span><span>add_diff_inverse_nat</span><span> </span><span>add_self_div_2</span><span>
          </span><span>div_mult_self3</span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_1687..1690"><span>klc</span></a><span> </span><span>mult.left_commute</span><span> </span><span>nat_le_linear</span><span> </span><span>not_less</span><span> </span><span>power_add</span><span> </span><span>power_eq_0_iff</span><span> 
          </span><span>semiring_normalization_rules</span><span class="main"><span class="main"><span>(</span></span></span><span>7</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><span>-</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_1687..1690"><span>klc</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>mod2_eq_if</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_1854..1856"><span>bk</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>div_mult2_eq</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_1627..1633"><span>moddiv</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><span>*</span></span><span class="free"><span>t</span></span><span class="main"><span>+</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>power_add</span><span> </span><span>power_mult</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Show equivalence of numbers by equivalence of all their bits (digits)</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.aux_even_pow2_factor|fact"><span class="entity_def" id="Bits_Digits.aux_even_pow2_factor|thm"><span>aux_even_pow2_factor</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>b</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span>odd</span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span>  </span><span class="quoted"><span class="free"><span>a</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>full_nat_induct</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_2967..2968">1</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>odd</span><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>nat_power_eq_Suc_0_iff</span><span> </span><span>power_Suc</span><span> </span><span>power_Suc0_right</span><span> </span><span>power_commutes</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_3142..3147">False</span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>t</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>t</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_3142..3147"><span>False</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>t</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_3219..3224">n_def</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>t</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>t</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#offset_2967..2968"><span>1.prems</span></a><span>"</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_3304..3306">ih</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>r</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span>odd</span><span> </span><span class="bound"><span>s</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_2967..2968"><span>1</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_3219..3224"><span>n_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>r</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>s</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_3219..3224"><span>n_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_3304..3306"><span>ih</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_3219..3224"><span>n_def</span></a><span> </span><span>power_commutes</span><span> </span><span>semiring_normalization_rules</span><span class="main"><span class="main"><span>(</span></span></span><span>18</span><span class="main"><span class="main"><span>)</span></span></span><span>
                          </span><span>semiring_normalization_rules</span><span class="main"><span class="main"><span>(</span></span></span><span>28</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.aux0_digit_wise_equiv|fact"><span class="entity_def" id="Bits_Digits.aux0_digit_wise_equiv|thm"><span>aux0_digit_wise_equiv</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_3654..3661">a_geq_0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>consider</span></span></span><span> </span><span class="main"><span>(</span></span><span>odd</span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>(</span></span><span>even</span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>odd</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>div_by_1</span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><span>power_0</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>even</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_3879..3885">bk_def</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>b</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span>odd</span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux_even_pow2_factor|fact"><span>aux_even_pow2_factor</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_3654..3661"><span>a_geq_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>b</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>k</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_3993..4000">bk_cond</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span>odd</span><span> </span><span class="skolem"><span>b</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_4090..4096">digi_b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_3879..3885"><span>bk_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_3993..4000"><span>bk_cond</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><span>odd_iff_mod_2_eq_one</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_3993..4000"><span>bk_cond</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_4090..4096"><span>digi_b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.aux1_digit_wise_equiv|fact"><span class="entity_def" id="Bits_Digits.aux1_digit_wise_equiv|thm"><span>aux1_digit_wise_equiv</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="var"><span>?Q</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?Q</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span>a_neq_0</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="var"><span>?Q</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="var"><span>?P</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux0_digit_wise_equiv|fact"><span>aux0_digit_wise_equiv</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>zero_neq_one</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>}</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="var"><span>?Q</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.aux2_digit_wise_equiv|fact"><span class="entity_def" id="Bits_Digits.aux2_digit_wise_equiv|thm"><span>aux2_digit_wise_equiv</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>r</span></span></span><span class="main"><span>&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quoted"><span class="free"><span>k</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span>
       </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>dvd_imp_mod_0</span><span> </span><span>dvd_mult_div_cancel</span><span> </span><span>dvd_refl</span><span> </span><span>even_iff_mod_2_eq_zero</span><span>
        </span><span>lessI</span><span> </span><span>minus_mod_eq_div_mult</span><span> </span><span>minus_mod_eq_mult_div</span><span> </span><span>mult_dvd_mono</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.digit_wise_equiv|fact"><span class="entity_def" id="Bits_Digits.digit_wise_equiv|thm"><span>digit_wise_equiv</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="var"><span>?Q</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?Q</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_5212..5216">notP</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="var"><span>?P</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5228..5232">have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_5271..5273">ab</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span class="main"><span>&lt;</span></span><span class="skolem"><span>b</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>b</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_5306..5312">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>c</span></span></span><span class="main"><span>::</span></span><span class="quoted"><span>nat</span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_5349..5350">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span class="main"><span>+</span></span><span class="skolem"><span>c</span></span><span class="main"><span>=</span></span><span class="skolem"><span>b</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_5306..5312"><span>c_def</span></a><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#offset_5271..5273"><span>ab</span></a><span>"</span></span><span> </span><span>less_imp_le</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux1_digit_wise_equiv|fact"><span>aux1_digit_wise_equiv</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_5306..5312"><span>c_def</span></a><span> </span><span>not_less0</span><span> </span><span>not_mod_2_eq_1_eq_0</span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_5228..5232"><span>that</span></a><span> </span><span>zero_less_diff</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>k</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_5579..5581">k1</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>k2</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>r</span></span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.obtain_smallest|fact"><span>obtain_smallest</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_5691..5694">cr0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>r</span></span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux2_digit_wise_equiv|fact"><span>aux2_digit_wise_equiv</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_5691..5694"><span>cr0</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>c</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_5349..5350"><span>b</span></a><span> </span><span>div_plus_div_distrib_dvd_right</span><span> </span><span>even_add</span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_5579..5581"><span>k1</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><span>odd_iff_mod_2_eq_one</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_5228..5232"><span>this</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>a</span></span></span><span> </span><span class="quoted"><span class="free"><span>b</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_5228..5232"><span>this</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>b</span></span></span><span> </span><span class="quoted"><span class="free"><span>a</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_5212..5216"><span>notP</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>linorder_neqE_nat</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>}</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?Q</span></span><span> </span><span class="main"><span>==&gt;</span></span><span> </span><span class="var"><span>?P</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Represent natural numbers in their binary expansion</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6265..6270">lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.aux3_digit_sum_repr|fact"><span class="entity_def" id="Bits_Digits.aux3_digit_sum_repr|thm"><span>aux3_digit_sum_repr</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>r</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_6265..6270"><span>assms</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6393..6398">lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.aux2_digit_sum_repr|fact"><span class="entity_def" id="Bits_Digits.aux2_digit_sum_repr|thm"><span>aux2_digit_sum_repr</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>c</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>r</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>c</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>c</span></span><span class="main"><span>+</span></span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>r</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>a</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>âº</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_6393..6398"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>less_iff_Suc_add</span><span>
          </span><span>monoid_mult_class.power_add</span><span> </span><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_6393..6398"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span>
            </span><span>div_plus_div_distrib_dvd_left</span><span>
            </span><span>le_imp_power_dvd</span><span>
          </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>flip</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>mod_add_left_eq</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6829..6834">lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.aux1_digit_sum_repr|fact"><span class="entity_def" id="Bits_Digits.aux1_digit_sum_repr|thm"><span>aux1_digit_sum_repr</span></span></span><span class="main"><span>:</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>c</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>r</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>r</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_6930..6936">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>a</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_6983..6989">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>d</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>d</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_7036..7042">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>e</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span>Suc</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="bound"><span>k</span></span><span class="main"><span>-</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_7097..7103">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>b</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>b</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>r</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7150..7152">ad</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>d</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_6930..6936"><span>a_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_6983..6989"><span>d_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_6829..6834"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>Suc_leI</span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_6930..6936"><span>a_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_6829..6834"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_6983..6989"><span>d_def</span></a><span> </span><span>sum.atLeastLessThan_concat</span><span> </span><span>zero_le</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>d</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span>  </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>Suc</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_6983..6989"><span>d_def</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>sum.cong</span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>add_Suc</span><span> </span><span>le_add_diff_inverse</span><span> </span><span>numerals</span><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>power_Suc</span><span> </span><span>power_add</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_7548..7551">d2r</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>d</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="skolem"><span>e</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_6983..6989"><span>d_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_7036..7042"><span>e_def</span></a><span>
     </span><span>sum_distrib_left</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span>  </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>Suc</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span>Suc</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="skolem"><span>e</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_7548..7551"><span>d2r</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_7150..7152"><span>ad</span></a><span> </span><span>lessThan_atLeast0</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_6829..6834"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quoted"><span class="free"><span>r</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>atLeastLessThan_empty</span><span> </span><span>atLeastLessThan_iff</span><span> </span><span>lessI</span><span> </span><span>linorder_not_less</span><span> 
                  </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_bounded|fact"><span>nth_bit_bounded</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_8127..8130">Suc</span><span> </span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8145..8147">r2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span>Suc</span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span>  </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>  </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_bounded|fact"><span>nth_bit_bounded</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_8127..8130"><span>Suc.hyps</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_8127..8130"><span>Suc.prems</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span>Suc_lessD</span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_6829..6834"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#offset_8145..8147"><span>r2</span></a><span>"</span></span><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span>Suc_leI</span><span> </span><span>Suc_le_lessD</span><span> </span><span>add_Suc</span><span> </span><span>add_le_mono</span><span> </span><span>mult_2</span><span> </span><span>power_Suc</span><span> </span><span>sum.atLeast0_lessThan_Suc</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_6930..6936"><span>a_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8559..8561">ar</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>a</span></span><span class="main"><span>+</span></span><span class="skolem"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>r</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_7548..7551"><span>d2r</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux2_digit_sum_repr|fact"><span>aux2_digit_sum_repr</span></a><span> </span><span>lessI</span><span> </span><span>semiring_normalization_rules</span><span class="main"><span class="main"><span>(</span></span></span><span>24</span><span class="main"><span class="main"><span>)</span></span></span><span> 
              </span><span>semiring_normalization_rules</span><span class="main"><span class="main"><span>(</span></span></span><span>7</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="comment1"><span>(</span><span>*</span><span> Second part of proof </span><span>*</span><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8771..8773">ab</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>b</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_6930..6936"><span>a_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_7097..7103"><span>b_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_6983..6989"><span>d_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>r</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quoted"><span class="free"><span>r</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_8947..8950">Suc</span><span> </span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8965..8967">r2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>*</span></span><span>  </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>â¤</span></span><span>  </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>r</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_bounded|fact"><span>nth_bit_bounded</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="skolem"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>r</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_8947..8950"><span>Suc.hyps</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#offset_8965..8967"><span>r2</span></a><span>"</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>b</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_7097..7103"><span>b_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>r</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_8771..8773"><span>ab</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux3_digit_sum_repr|fact"><span>aux3_digit_sum_repr</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_8559..8561"><span>ar</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_6930..6936"><span>a_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_7150..7152"><span>ad</span></a><span> </span><span>lessThan_atLeast0</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9412..9417">lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.digit_sum_repr|fact"><span class="entity_def" id="Bits_Digits.digit_sum_repr|thm"><span>digit_sum_repr</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>c</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><span>â¤</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_9412..9417"><span>assms</span></a><span> </span><span>less_le_trans</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_9579..9582">nik</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>â¥</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>r</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>&lt;</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="free"><span>c</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quoted"><span class="free"><span>c</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>c</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_bounded|fact"><span>nth_bit_bounded</span></a><span>
            </span><span>add_mono_thms_linordered_field</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span></span></span><span class="free"><span class="free"><span class="free"><span class="free"><span class="free"><span>n</span></span></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span></a></span></a></span></a></span></a></span><span> </span><span class="skolem"><span class="skolem"><span class="skolem"><span class="skolem"><span class="skolem"><span>c</span></span></span></span></span></span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span></span></span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>*</span></span></span></span></span></span><span> </span><span class="numeral"><span class="numeral"><span class="numeral"><span class="numeral"><span class="numeral"><span>2</span></span></span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>^</span></span></span></span></span></span><span> </span><span class="skolem"><span class="skolem"><span class="skolem"><span class="skolem"><span class="skolem"><span>c</span></span></span></span></span></span><span>"</span></span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="numeral"><span class="numeral"><span class="numeral"><span class="numeral"><span class="numeral"><span>2</span></span></span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>^</span></span></span></span></span></span><span> </span><span class="skolem"><span class="skolem"><span class="skolem"><span class="skolem"><span class="skolem"><span>c</span></span></span></span></span></span><span>"</span></span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span></span></span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>â</span></span></span></span></span></span><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span>r</span></span></span></span></span></span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>&lt;</span></span></span></span></span></span><span class="skolem"><span class="skolem"><span class="skolem"><span class="skolem"><span class="skolem"><span>c</span></span></span></span></span></span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>.</span></span></span></span></span></span><span> </span><span class="free"><span class="free"><span class="free"><span class="free"><span class="free"><span>n</span></span></span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span></a></span></a></span></a></span></a></span><span> </span><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span>r</span></span></span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>*</span></span></span></span></span></span><span> </span><span class="numeral"><span class="numeral"><span class="numeral"><span class="numeral"><span class="numeral"><span>2</span></span></span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>^</span></span></span></span></span></span><span> </span><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span class="bound"><span>r</span></span></span></span></span></span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span></span></span><span>"</span></span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span class="numeral"><span class="numeral"><span class="numeral"><span class="numeral"><span>2</span></span></span></span></span></span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>^</span></span></span></span></span></span><span class="skolem"><span class="skolem"><span class="skolem"><span class="skolem"><span class="skolem"><span>c</span></span></span></span></span></span><span>"</span></span></span></span></span></span></span><span class="main"><span>]</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>â¥</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>r</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>less_le_trans</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>r</span></span></span><span class="main"><span>â¥</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>r</span></span><span>  </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_9579..9582"><span>nik</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>r</span></span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>r</span></span><span>  </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux1_digit_sum_repr|fact"><span>aux1_digit_sum_repr</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_9412..9417"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>r</span></span><span> </span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>not_less</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.digit_wise_equiv|fact"><span>digit_wise_equiv</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>presburger</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.digit_sum_repr_variant|fact"><span class="entity_def" id="Bits_Digits.digit_sum_repr_variant|thm"><span>digit_sum_repr_variant</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>less_exp</span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.digit_sum_repr|fact"><span>digit_sum_repr</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.digit_sum_index_variant|fact"><span class="entity_def" id="Bits_Digits.digit_sum_index_variant|thm"><span>digit_sum_index_variant</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>r</span></span><span class="main"><span>&gt;</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>r</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>less_exp</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10639..10643">pow2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>&gt;</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>r</span></span><span class="main"><span>&gt;</span></span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>less_trans</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.digit_sum_repr|fact"><span>digit_sum_repr</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.digit_sum_repr_variant|fact"><span>digit_sum_repr_variant</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_10639..10643"><span>pow2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Digits are preserved under shifts</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10935..10940">lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.digit_shift_preserves_digits|fact"><span class="entity_def" id="Bits_Digits.digit_shift_preserves_digits|thm"><span>digit_shift_preserves_digits</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_10935..10940"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11082..11087">lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.digit_shift_inserts_zero_least_siginificant_digit|fact"><span class="entity_def" id="Bits_Digits.digit_shift_inserts_zero_least_siginificant_digit|thm"><span>digit_shift_inserts_zero_least_siginificant_digit</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>t</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_11082..11087"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>t</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>Suc_times_mod_eq</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>One_nat_def</span><span> </span><span>diff_Suc_Suc</span><span> </span><span>gr_implies_not0</span><span> </span><span>minus_mod_eq_div_mult</span><span> 
                 </span><span>mod_mult_self1_is_0</span><span> </span><span>nonzero_mult_div_cancel_right</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>t</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>0</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Suc_pred</span><span> </span><span>div_mult2_eq</span><span> </span><span>power_Suc</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Represent natural numbers in their base-b digitwise expansion</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11790..11795">lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.aux3_digit_gen_sum_repr|fact"><span class="entity_def" id="Bits_Digits.aux3_digit_gen_sum_repr|thm"><span>aux3_digit_gen_sum_repr</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>d</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_11790..11795"><span>assms</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11964..11969">lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.aux2_digit_gen_sum_repr|fact"><span class="entity_def" id="Bits_Digits.aux2_digit_gen_sum_repr|thm"><span>aux2_digit_gen_sum_repr</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>c</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>r</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>c</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>c</span></span><span class="main"><span>+</span></span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>a</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>âº</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_11964..11969"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>less_iff_Suc_add</span><span>
          </span><span>monoid_mult_class.power_add</span><span> </span><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_11964..11969"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span>
            </span><span>div_plus_div_distrib_dvd_left</span><span>
            </span><span>le_imp_power_dvd</span><span>
          </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>flip</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>mod_add_left_eq</span><span class="main"><span>)</span></span><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_12420..12425">lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.aux1_digit_gen_sum_repr|fact"><span class="entity_def" id="Bits_Digits.aux1_digit_gen_sum_repr|thm"><span>aux1_digit_gen_sum_repr</span></span></span><span class="main"><span>:</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>c</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>r</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_12565..12571">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>a</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_12628..12634">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>d</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>d</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_12691..12697">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>e</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span>Suc</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="bound"><span>k</span></span><span class="main"><span>-</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_12762..12768">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>f</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>r</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_12825..12827">ad</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>d</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12565..12571"><span>a_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12628..12634"><span>d_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12420..12425"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>Suc_leI</span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12565..12571"><span>a_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12420..12425"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12628..12634"><span>d_def</span></a><span> </span><span>sum.atLeastLessThan_concat</span><span> </span><span>zero_le</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>d</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>Suc</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12628..12634"><span>d_def</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>sum.cong</span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>add_Suc</span><span> </span><span>le_add_diff_inverse</span><span> </span><span>power_Suc</span><span> </span><span>power_add</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_13227..13230">d2r</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>d</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="skolem"><span>e</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12628..12634"><span>d_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12691..12697"><span>e_def</span></a><span> </span><span>sum_distrib_left</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
                          </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span>  </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>Suc</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span>Suc</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>+</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="skolem"><span>e</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_13227..13230"><span>d2r</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12825..12827"><span>ad</span></a><span> </span><span>lessThan_atLeast0</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12420..12425"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quoted"><span class="free"><span>r</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_bounded|fact"><span>nth_digit_bounded</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_13800..13803">Suc</span><span> </span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>r2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_bounded|fact"><span>nth_digit_bounded</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Suc</span><span> </span><span class="skolem"><span>r</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_13800..13803"><span>Suc.hyps</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_13800..13803"><span>Suc.prems</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span>Suc_lessD</span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12420..12425"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
      </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span> 
                     </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12420..12425"><span>assms</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> </span><span>mult_eq_if</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span>Suc</span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12565..12571"><span>a_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_14390..14392">ar</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a</span></span><span class="main"><span>+</span></span><span class="skolem"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_13227..13230"><span>d2r</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux2_digit_gen_sum_repr|fact"><span>aux2_digit_gen_sum_repr</span></a><span> </span><span>lessI</span><span> </span><span>semiring_normalization_rules</span><span class="main"><span class="main"><span>(</span></span></span><span>24</span><span class="main"><span class="main"><span>)</span></span></span><span> 
              </span><span>semiring_normalization_rules</span><span class="main"><span class="main"><span>(</span></span></span><span>7</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="comment1"><span>(</span><span>*</span><span> Second part of proof </span><span>*</span><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_14626..14628">ab</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>f</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12565..12571"><span>a_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12762..12768"><span>f_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12628..12634"><span>d_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>r</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quoted"><span class="free"><span>r</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_14823..14826">Suc</span><span> </span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_14841..14843">r2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>r</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_bounded|fact"><span>nth_digit_bounded</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="skolem"><span>r</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="skolem"><span>r</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_14823..14826"><span>Suc.hyps</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#offset_14841..14843"><span>r2</span></a><span>"</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12420..12425"><span>assms</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> </span><span>mult_eq_if</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span>f</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12762..12768"><span>f_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_14626..14628"><span>ab</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux3_digit_gen_sum_repr|fact"><span>aux3_digit_gen_sum_repr</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_14390..14392"><span>ar</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12565..12571"><span>a_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_12825..12827"><span>ad</span></a><span> </span><span>lessThan_atLeast0</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.aux_gen_b_factor|fact"><span class="entity_def" id="Bits_Digits.aux_gen_b_factor|thm"><span>aux_gen_b_factor</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>c</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>c</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><span class="bound"><span>c</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span>  </span><span class="quoted"><span class="free"><span>a</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>full_nat_induct</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_15546..15547">1</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>n</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>t</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_15632..15637">n_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>t</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>t</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_15546..15547"><span>1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_15546..15547"><span>1</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_15717..15719">ih</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>r</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Suc_leI</span><span> </span><span>gr0I</span><span> </span><span>mult_0_right</span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_15632..15637"><span>n_def</span></a><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>r</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>s</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_15632..15637"><span>n_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_15717..15719"><span>ih</span></a><span> </span><span>mult.commute</span><span> </span><span>mult.left_commute</span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_15632..15637"><span>n_def</span></a><span> </span><span>power_Suc</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>mult.commute</span><span> </span><span>power_0</span><span> </span><span>power_Suc</span><span> </span><span>power_Suc0_right</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_16060..16065">lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.aux0_digit_wise_gen_equiv|fact"><span class="entity_def" id="Bits_Digits.aux0_digit_wise_gen_equiv|thm"><span>aux0_digit_wise_gen_equiv</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_16113..16120">a_geq_0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>c</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>c</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><span class="bound"><span>c</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux_gen_b_factor|fact"><span>aux_gen_b_factor</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_16113..16120"><span>a_geq_0</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_16060..16065"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>c</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>k</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_16325..16332">ck_cond</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><span class="skolem"><span>c</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_16383..16389">c_cond</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_16113..16120"><span>a_geq_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_16438..16444">digi_b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_16325..16332"><span>ck_cond</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_16383..16389"><span>c_cond</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_16438..16444"><span>digi_b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span> </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>div_by_1</span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span> </span><span>power.simps</span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.aux1_digit_wise_gen_equiv|fact"><span class="entity_def" id="Bits_Digits.aux1_digit_wise_gen_equiv|thm"><span>aux1_digit_wise_gen_equiv</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="var"><span>?Q</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?Q</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span>a_neq_0</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="var"><span>?Q</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="var"><span>?P</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux0_digit_wise_gen_equiv|fact"><span>aux0_digit_wise_gen_equiv</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_17068..17069">}</span></span></span><span> </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_17068..17069"><span>this</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="var"><span>?Q</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.aux2_digit_wise_gen_equiv|fact"><span class="entity_def" id="Bits_Digits.aux2_digit_wise_gen_equiv|thm"><span>aux2_digit_wise_gen_equiv</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>r</span></span></span><span class="main"><span>&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quoted"><span class="free"><span>k</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>dvd_imp_mod_0</span><span> </span><span>dvd_mult_div_cancel</span><span> </span><span>dvd_refl</span><span>
        </span><span>lessI</span><span> </span><span>minus_mod_eq_div_mult</span><span> </span><span>minus_mod_eq_mult_div</span><span> </span><span>mult_dvd_mono</span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>mod_0_imp_dvd</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Two numbers are the same if and only if their digits are the same</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.digit_wise_gen_equiv|fact"><span class="entity_def" id="Bits_Digits.digit_wise_gen_equiv|thm"><span>digit_wise_gen_equiv</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="var"><span>?Q</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?Q</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_17730..17734">notP</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="var"><span>?P</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_17746..17750">have</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_17796..17798">xy</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span class="main"><span>&lt;</span></span><span class="skolem"><span>y</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_17831..17837">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>c</span></span></span><span class="main"><span>::</span></span><span class="quoted"><span>nat</span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17874..17875">y</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span class="main"><span>+</span></span><span class="skolem"><span>c</span></span><span class="main"><span>=</span></span><span class="skolem"><span>y</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_17831..17837"><span>c_def</span></a><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#offset_17796..17798"><span>xy</span></a><span>"</span></span><span> </span><span>less_imp_le</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux0_digit_wise_gen_equiv|fact"><span>aux0_digit_wise_gen_equiv</span></a><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_17831..17837"><span>c_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_17746..17750"><span>that</span></a><span> </span><span>zero_less_diff</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>k</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_18100..18102">k1</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> 
                      </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>k2</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>r</span></span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.obtain_smallest|fact"><span>obtain_smallest</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_18246..18249">cr0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>r</span></span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux2_digit_wise_gen_equiv|fact"><span>aux2_digit_wise_gen_equiv</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_18246..18249"><span>cr0</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>c</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_17874..17875"><span>y</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_18100..18102"><span>k1</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux1_digit_wise_gen_equiv|fact"><span>aux1_digit_wise_gen_equiv</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>c</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
                </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span> this ISAR proof was found by sledgehammer  </span><span>*</span><span>)</span></span><span>
                        </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>ka</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
                        </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_18664..18666">a1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="keyword1"><span>dvd</span></span><span> </span><span class="skolem"><span>c</span></span><span>"</span></span></span><span>
                        </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_18713..18715">a2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
                        </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_18794..18796">a3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>c</span></span><span>"</span></span></span><span>
                        </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_18841..18843">a4</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>num</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>base</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="bound"><span>num</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>base</span></span><span> 
                                    </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>num</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>base</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="bound"><span>base</span></span><span>"</span></span></span><span>
                </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_18967..18969">f5</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span> </span><span class="bound"><span>na</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>na</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>n</span></span><span>"</span></span></span><span>
                  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
                  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_19052..19054">f6</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>k</span></span><span>"</span></span></span><span>
                    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_18794..18796"><span>a3</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_18664..18666"><span>a1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>add.commute</span><span> </span><span>div_plus_div_distrib_dvd_left</span><span class="main"><span>)</span></span><span>
                  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_19210..19212">f7</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
                    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_18794..18796"><span>a3</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_18713..18715"><span>a2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>add.commute</span><span> </span><span>mod_add_right_eq</span><span class="main"><span>)</span></span><span>
                  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="bound"><span>nb</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="bound"><span>nb</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>nb</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="bound"><span>na</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
                    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>add.commute</span><span> </span><span>minus_mod_eq_mult_div</span><span> </span><span>mod_add_right_eq</span><span> 
                        </span><span>mod_mult_self1_is_0</span><span class="main"><span>)</span></span><span>
                  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>c</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>ka</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
                    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_19210..19212"><span>f7</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_19052..19054"><span>f6</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_18967..18969"><span>f5</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_18841..18843"><span>a4</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_18100..18102"><span>k1</span></a><span class="main"><span>)</span></span><span>
                </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_17746..17750"><span>this</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span> </span><span class="quoted"><span class="free"><span>y</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_17746..17750"><span>this</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>y</span></span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_17730..17734"><span>notP</span></a><span> 
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>linorder_neqE_nat</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="keyword1"><span class="command"><span>}</span></span></span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?Q</span></span><span> </span><span class="main"><span>==&gt;</span></span><span> </span><span class="var"><span>?P</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>A number is equal to the sum of its digits multiplied by powers of two</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_20036..20041">lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.digit_gen_sum_repr|fact"><span class="entity_def" id="Bits_Digits.digit_gen_sum_repr|thm"><span>digit_gen_sum_repr</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>c</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><span>â¤</span></span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_20036..20041"><span>assms</span></a><span> </span><span>less_le_trans</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_20228..20231">nik</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>c</span></span><span class="main"><span>â¤</span></span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>k</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>r</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>c</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quoted"><span class="free"><span>c</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> c</span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_20417..20419">IH</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>r</span></span><span class="main"><span>&lt;</span></span><span class="skolem"><span>c</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>c</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_20474..20479">bound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="skolem"><span>c</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_bounded|fact"><span>nth_digit_bounded</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_20036..20041"><span>assms</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_20417..20419"><span>IH</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_20474..20479"><span>bound</span></a><span> </span><span>add_mono_thms_linordered_field</span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> 
            </span><span>add_mono_thms_linordered_field</span><span class="main"><span class="main"><span>(</span></span></span><span>5</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>le_less</span><span> </span><span>mult_eq_if</span><span> </span><span>not_one_le_zero</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>k</span></span><span class="main"><span>â¥</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>r</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>k</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>less_le_trans</span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_20036..20041"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>r</span></span></span><span class="main"><span>â¥</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span> 
    </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_20228..20231"><span>nik</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>r</span></span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span> 
               </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux1_digit_gen_sum_repr|fact"><span>aux1_digit_gen_sum_repr</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_20036..20041"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span> 
                    </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>not_less</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.digit_wise_gen_equiv|fact"><span>digit_wise_gen_equiv</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.digit_gen_sum_repr_variant|fact"><span class="entity_def" id="Bits_Digits.digit_gen_sum_repr_variant|thm"><span>digit_gen_sum_repr_variant</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>n</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quoted"><span class="free"><span>n</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>less_trans_Suc</span><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.digit_gen_sum_repr|fact"><span>digit_gen_sum_repr</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_21690..21695">lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.digit_gen_sum_index_variant|fact"><span class="entity_def" id="Bits_Digits.digit_gen_sum_index_variant|thm"><span>digit_gen_sum_index_variant</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>r</span></span><span class="main"><span>&gt;</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¹</span></span><span> 
  </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>r</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>r</span></span><span class="main"><span>&gt;</span></span><span class="free"><span>n</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="skolem"><span>r</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="skolem"><span>r</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>less_trans_Suc</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_21938..21942">powb</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>&gt;</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>r</span></span><span class="main"><span>&gt;</span></span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>less_trans</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>r</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.digit_gen_sum_repr|fact"><span>digit_gen_sum_repr</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.digit_gen_sum_repr_variant|fact"><span>digit_gen_sum_repr_variant</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_21938..21942"><span>powb</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>r</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_21690..21695"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>text</span></span><span> </span><span class="raw_text"><span>nth_digit</span></span><span class="antiquote"><span>}</span></span></span><span> extracts coefficients from a base-b digitwise expansion</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_22319..22324">lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.nth_digit_gen_power_series|fact"><span class="entity_def" id="Bits_Digits.nth_digit_gen_power_series|thm"><span>nth_digit_gen_power_series</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>q</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_22405..22410">bound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span> &lt; 2^c makes proof easier, but is too strong for const f </span><span>*</span><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="free"><span>q</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="free"><span>t</span></span><span class="main"><span>â¤</span></span><span class="free"><span>q</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>q</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>t</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22319..22324"><span>b_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>one_less_numeral_iff</span><span> </span><span>power_gt1</span><span> </span><span>semiring_norm</span><span class="main"><span>(</span></span><span>76</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22405..22410"><span>bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>t</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="skolem"><span>t</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22405..22410"><span>bound</span></a><span> </span><span>less_imp_le_nat</span><span> </span><span>less_le_trans</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>self_le_power</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22405..22410"><span>bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> 
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_22908..22911">Suc</span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>t</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_22966..22970">True</span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_22980..22990">f_le_bound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22405..22410"><span>bound</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Suc_pred</span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22319..22324"><span>b_def</span></a><span> </span><span>less_Suc_eq_le</span><span> </span><span>numeral_2_eq_2</span><span> </span><span>zero_less_Suc</span><span> </span><span>zero_less_power</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_23135..23147">series_bound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="skolem"><span>q</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quoted"><span class="skolem"><span>q</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22405..22410"><span>bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>less_imp_le_nat</span><span class="main"><span>)</span></span><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> q</span><span>
          </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
            </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_23330..23333">asm</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="skolem"><span>q</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="skolem"><span>q</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span> 
                </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="skolem"><span>q</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22980..22990"><span>f_le_bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>  
            </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_23330..23333"><span>asm</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
            </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="skolem"><span>q</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
              </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>One_nat_def</span><span> </span><span>Suc_neq_Zero</span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22319..22324"><span>b_def</span></a><span> </span><span>eq_imp_le</span><span> </span><span>mult.assoc</span><span> </span><span>mult_eq_if</span><span> </span><span>numerals</span><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> 
                  </span><span>power_not_zero</span><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_23330..23333"><span>asm</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
          </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="skolem"><span>q</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>t</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="skolem"><span>t</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22908..22911"><span>Suc</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span>  </span><span>Suc_n_not_le_n</span><span> </span><span>add.commute</span><span> </span><span>add.left_neutral</span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22319..22324"><span>b_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22405..22410"><span>bound</span></a><span> </span><span>div_mult_self1</span><span> 
              </span><span>less_imp_le_nat</span><span> </span><span>less_mult_imp_div_less</span><span> </span><span>mod_less</span><span> </span><span>not_one_le_zero</span><span> </span><span>one_less_numeral_iff</span><span> 
              </span><span>one_less_power</span><span> </span><span>power_Suc</span><span> </span><span>semiring_norm</span><span class="main"><span>(</span></span><span>76</span><span class="main"><span>)</span></span><span> </span><span>zero_less_Suc</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
            </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>t</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>t</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22966..22970"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
            </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="skolem"><span>q</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>t</span></span><span> </span><span class="free"><span>b</span></span><span> 
                </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="skolem"><span>q</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>t</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
              </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux2_digit_gen_sum_repr|fact"><span>aux2_digit_gen_sum_repr</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="skolem"><span>q</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>t</span></span><span>"</span></span></span><span> 
                    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_23135..23147"><span>series_bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
            </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="skolem"><span>q</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>t</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span>
                  </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="skolem"><span>q</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>t</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span> 
              </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>add.commute</span><span class="main"><span>)</span></span><span>
            </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22908..22911"><span>Suc</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>t</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22966..22970"><span>True</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>t</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
          </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22966..22970"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span> </span><span class="comment1"><span>(</span><span>*</span><span> t &gt; Suc q </span><span>*</span><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>t</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_25146..25156">f_le_bound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22405..22410"><span>bound</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Suc_pred</span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22319..22324"><span>b_def</span></a><span> </span><span>less_Suc_eq_le</span><span> </span><span>numeral_2_eq_2</span><span> </span><span>zero_less_Suc</span><span> </span><span>zero_less_power</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_25301..25306">bound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="skolem"><span>q</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>q</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quoted"><span class="skolem"><span>q</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22405..22410"><span>bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>less_imp_le_nat</span><span class="main"><span>)</span></span><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> q</span><span>
          </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
            </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_25495..25498">asm</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="skolem"><span>q</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="skolem"><span>q</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span> 
                </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="skolem"><span>q</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_25146..25156"><span>f_le_bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>  
            </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_25495..25498"><span>asm</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
            </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="skolem"><span>q</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
              </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>One_nat_def</span><span> </span><span>Suc_neq_Zero</span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22319..22324"><span>b_def</span></a><span> </span><span>eq_imp_le</span><span> </span><span>mult.assoc</span><span> </span><span>mult_eq_if</span><span> </span><span>numerals</span><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> 
                  </span><span>power_not_zero</span><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_25495..25498"><span>asm</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
          </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="skolem"><span>q</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_25301..25306"><span>bound</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="skolem"><span>t</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>t</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span>âº</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_22319..22324"><span>b_def</span></a><span> </span><span>nat_power_less_imp_less</span><span> </span><span>not_le</span><span> </span><span>numeral_2_eq_2</span><span> </span><span>power_Suc</span><span> 
                     </span><span>zero_less_Suc</span><span> </span><span>zero_less_power</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>t</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_25301..25306"><span>bound</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Suc</span><span> </span><span class="skolem"><span>q</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Equivalence condition for the </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>text</span></span><span> </span><span class="raw_text"><span>nth_digit</span></span><span class="antiquote"><span>}</span></span></span><span> function </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>cite</span></span><span> "</span><span>h10lecturenotes</span><span>"</span><span class="antiquote"><span>}</span></span></span><span>
</span><span>      (see equation 2.29)</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_26580..26585">lemma</span></span></span><span> </span><span class="entity_def" id="Bits_Digits.digit_gen_equiv|fact"><span class="entity_def" id="Bits_Digits.digit_gen_equiv|thm"><span>digit_gen_equiv</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>d</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="var"><span>?Q</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_26738..26739">p</span><span class="main"><span>:</span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?P</span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?Q</span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>a</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_26789..26793">True</span><span>

    </span><span class="comment1"><span>(</span><span>*</span><span> 3rd condition </span><span>*</span><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quoted"><span class="free"><span>k</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_26951..26954">Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>&lt;</span></span><span>Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="skolem"><span>k</span></span><span>  
            </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>&lt;</span></span><span class="skolem"><span>k</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>k</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_26580..26585"><span>assms</span></a><span> </span><span>mult_le_mono</span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_bounded|fact"><span>nth_digit_bounded</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>&lt;</span></span><span class="skolem"><span>k</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_26951..26954"><span>Suc.hyps</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_26580..26585"><span>assms</span></a><span> </span><span>order.strict_trans2</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
      </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_26580..26585"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_26951..26954"><span>Suc.hyps</span></a><span> </span><span>mult_eq_if</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_27434..27440">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27506..27507">3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span>"</span></span></span><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

    </span><span class="comment1"><span>(</span><span>*</span><span> 2nd condition</span><span>*</span><span>)</span></span><span>
     </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27563..27564">2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>d</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_bounded|fact"><span>nth_digit_bounded</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>b</span></span></span><span> </span><span class="quoted"><span class="free"><span>a</span></span></span><span> </span><span class="quoted"><span class="free"><span>k</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_26738..26739"><span>p</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_26580..26585"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>

    </span><span class="comment1"><span>(</span><span>*</span><span> 1st condition </span><span>*</span><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_27657..27663">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>=</span></span><span>Suc</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>a</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><span>-</span></span><span>Suc</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>a</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_26580..26585"><span>assms</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.digit_gen_sum_repr_variant|fact"><span>digit_gen_sum_repr_variant</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_27831..27832">s</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span>  
            </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>=</span></span><span>Suc</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>a</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_26789..26793"><span>True</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_27434..27440"><span>y_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_26738..26739"><span>p</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>Suc_leI</span><span> </span><span>atLeast0LessThan</span><span> </span><span>gr_implies_not0</span><span> 
          </span><span>linorder_not_less</span><span> </span><span>sum.atLeastLessThan_concat</span><span> </span><span>sum.lessThan_Suc</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Suc</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>Suc</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> 
          </span><span class="main"><span>=</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Suc</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>sum.cong</span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Suc_le_lessD</span><span> </span><span>Zero_not_Suc</span><span> </span><span>add_diff_cancel_left'</span><span> </span><span>diff_Suc_1</span><span> </span><span>diff_Suc_Suc</span><span> 
          </span><span>less_imp_Suc_add</span><span> </span><span>power_add</span><span> </span><span>power_eq_if</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>=</span></span><span>Suc</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>a</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_27657..27663"><span>x_def</span></a><span> </span><span>sum_distrib_right</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span>  </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>Suc</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span class="skolem"><span>y</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_27831..27832"><span>s</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_27563..27564"><span>2</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_27506..27507"><span>3</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_26580..26585"><span>assms</span></a><span> </span><span>power_gt_expt</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>b</span></span></span><span> </span><span class="quoted"><span class="free"><span>k</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_28738..28746">moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>d</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_28738..28746"><span>calculation</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_26738..26739"><span>p</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_26580..26585"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>   
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?Q</span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_28908..28913">conds</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux3_digit_gen_sum_repr|fact"><span>aux3_digit_gen_sum_repr</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="skolem"><span>y</span></span></span><span> </span><span class="quoted"><span class="free"><span>b</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>d</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_26580..26585"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span class="main"><span>(</span></span><span class="free"><span>d</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux2_digit_gen_sum_repr|fact"><span>aux2_digit_gen_sum_repr</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>d</span></span><span class="main"><span>*</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="free"><span>k</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>x</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_28908..28913"><span>conds</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?P</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#offset_28908..28913"><span>conds</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_def|fact"><span>nth_digit_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>


</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre></div><div id='Binary_Operations'>div class="head">
<h1>Theory Carries</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Carries</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="Bits_Digits.html"><span>Bits_Digits</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Carries in base-b expansions</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Some auxiliary lemmas</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Carries.rev_induct|fact"><span class="entity_def" id="Carries.rev_induct|thm"><span>rev_induct</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>consumes</span></span><span> 1</span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>case_names</span></span><span> base step</span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_195..197">le</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_215..219">base</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_235..239">step</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="free"><span>i</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>i</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>n</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quoted"><span class="skolem"><span>n</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>arith</span></span><span>
    </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_215..219"><span>base</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="skolem"><span>i</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_450..453">Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>arith</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_518..519">k</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_450..453"><span>Suc.prems</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>arith</span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_590..592">by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Carries.html#offset_450..453"><span>Suc.hyps</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_235..239"><span>step</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Carries.html#offset_518..519"><span>k</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_590..592"><span>this</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_195..197"><span>le</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Definition of carry received at position k</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>When adding two numbers m and n, the carry is \emph{introduced}
</span><span>      at position 1 but is \emph{received} at position 2. The function below
</span><span>      accounts for the latter case. 
</span><span>
</span><span>\begin{center} \begin{verbatim}
</span><span>        k: 6 5 4 3 2 1 0
</span><span>        c:         1
</span><span>   - - - - - - - - - - - -
</span><span>        m:   1 0 1 0 1 0
</span><span>        n:           1 1
</span><span>    ----------------------
</span><span>    m + n: 0 1 0 1 1 0 0
</span><span>\end{verbatim} \end{center}</span><span> </span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Carries.bin_carry_def|fact"><span class="entity_def" id="Carries.bin_carry_def|thm"><span class="entity_def" id="Carries.bin_carry_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Carries.bin_carry|const"><span>bin_carry</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bin_carry</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Carry in the subtraction of two natural numbers</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Carries.bin_narry_def|fact"><span class="entity_def" id="Carries.bin_narry_def|thm"><span class="entity_def" id="Carries.bin_narry_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Carries.bin_narry|const"><span>bin_narry</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bin_narry</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Equivalent definition</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Carries.bin_narry2_def|fact"><span class="entity_def" id="Carries.bin_narry2_def|thm"><span class="entity_def" id="Carries.bin_narry2_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Carries.bin_narry2|const"><span>bin_narry2</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bin_narry2</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Carries.bin_narry_equiv|fact"><span class="entity_def" id="Carries.bin_narry_equiv|thm"><span>bin_narry_equiv</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_narry|const"><span>bin_narry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_narry2|const"><span>bin_narry2</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>c</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_narry_def|fact"><span>bin_narry_def</span></a><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_narry2_def|fact"><span>bin_narry2_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span>add.commute</span><span> </span><span>div_less</span><span> </span><span>dvd_0_right</span><span> </span><span>even_Suc</span><span> </span><span>le_add_diff_inverse2</span><span> </span><span>less_add_eq_less</span><span> 
        </span><span>mod_greater_zero_iff_not_dvd</span><span> </span><span>neq0_conv</span><span> </span><span>not_mod2_eq_Suc_0_eq_0</span><span> </span><span>order_le_less</span><span> </span><span>zero_less_diff</span><span> 
        </span><span>zero_less_numeral</span><span> </span><span>zero_less_power</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>le_div_geq</span><span> </span><span>less_imp_diff_less</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Properties of carries</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Carries.div_sub|fact"><span class="entity_def" id="Carries.div_sub|thm"><span>div_sub</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="keyword1"><span>else</span></span><span>  </span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>consider</span></span></span><span> </span><span class="main"><span>(</span></span><span>alb</span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>b</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>(</span></span><span>ageb</span><span class="main"><span>)</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span class="main"><span>â¥</span></span><span class="free"><span>b</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>cases</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>alb</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>div_le_mono</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_2375..2379">ageb</span><span>
    </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>a1</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>a2</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_2403..2409">a1_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>c</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_2430..2436">a2_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>c</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_2457..2462">a_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span class="main"><span>=</span></span><span class="skolem"><span>a1</span></span><span class="main"><span>*</span></span><span class="free"><span>c</span></span><span class="main"><span>+</span></span><span class="skolem"><span>a2</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>mod_div_decomp</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>b1</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>b2</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_2536..2542">b1_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>b1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>c</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_2563..2569">b2_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>b2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="free"><span>c</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_2590..2595">b_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>=</span></span><span class="skolem"><span>b1</span></span><span class="main"><span>*</span></span><span class="free"><span>c</span></span><span class="main"><span>+</span></span><span class="skolem"><span>b2</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>mod_div_decomp</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2655..2661">a1geb1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a1</span></span><span class="main"><span>â¥</span></span><span class="skolem"><span>b1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_2375..2379"><span>ageb</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_2403..2409"><span>a1_def</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_2536..2542"><span>b1_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>div_le_mono</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>c</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>c</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_2836..2841">cneq0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>b2</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_2919..2924">a2lb2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>b2</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a1</span></span><span class="main"><span>=</span></span><span class="skolem"><span>b1</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_2375..2379"><span>ageb</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_2919..2924"><span>a2lb2</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_2457..2462"><span>a_def</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_2590..2595"><span>b_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span> 
        </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
          </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><span class="skolem"><span>a1</span></span><span class="main"><span>=</span></span><span class="skolem"><span>b1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_3136..3141">a1gb1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a1</span></span><span class="main"><span>&gt;</span></span><span class="skolem"><span>b1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_2655..2661"><span>a1geb1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
          </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_3187..3193">boundc</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a2</span></span><span class="main"><span>+</span></span><span class="free"><span>c</span></span><span class="main"><span>-</span></span><span class="skolem"><span>b2</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>c</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_2919..2924"><span>a2lb2</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_2836..2841"><span>cneq0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
          </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span class="main"><span>-</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>b1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>b2</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_2457..2462"><span>a_def</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_2590..2595"><span>b_def</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_2655..2661"><span>a1geb1</span></a><span> </span><span>nat_diff_add_eq1</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="skolem"><span>b1</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>a1</span></span></span><span> </span><span class="quoted"><span class="free"><span>c</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>a2</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>b2</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
          </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>b1</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>b2</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_3136..3141"><span>a1gb1</span></a><span> </span><span>Suc_diff_Suc</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="skolem"><span>b1</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>a1</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
          </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>b1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>b2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>div_eq_0_iff</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="skolem"><span>b2</span></span></span><span> </span><span class="quoted"><span class="free"><span>c</span></span></span><span class="main"><span>]</span></span><span> </span><span>mod_div_trivial</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>b</span></span></span><span> </span><span class="quoted"><span class="free"><span>c</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Carries.html#offset_2563..2569"><span>b2_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
          </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>-</span></span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>b1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>b2</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>c</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_2457..2462"><span>a_def</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_2590..2595"><span>b_def</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_2836..2841"><span>cneq0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_3187..3193"><span>boundc</span></a><span> </span><span>div_less</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_2403..2409"><span>a1_def</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_2430..2436"><span>a2_def</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_2536..2542"><span>b1_def</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_2563..2569"><span>b2_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
        </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_3879..3885">a2geb2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span> </span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>b2</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>a1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>b1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>b2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="free"><span>c</span></span><span>"</span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_2655..2661"><span>a1geb1</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_2457..2462"><span>a_def</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_2590..2595"><span>b_def</span></a><span> </span><span>nat_diff_add_eq1</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_3879..3885"><span>a2geb2</span></a><span> </span><span>div_add1_eq</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>a1</span></span><span class="main"><span>-</span></span><span class="skolem"><span>b1</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="free"><span>c</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a2</span></span><span class="main"><span>-</span></span><span class="skolem"><span>b2</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="free"><span>c</span></span></span><span class="main"><span>]</span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_2563..2569"><span>b2_def</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_2430..2436"><span>a2_def</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_2403..2409"><span>a1_def</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_2536..2542"><span>b1_def</span></a><span> </span><span>less_imp_diff_less</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Carries.dif_digit_formula|fact"><span class="entity_def" id="Carries.dif_digit_formula|thm"><span>dif_digit_formula</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_narry|const"><span>bin_narry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>presume</span></span></span><span> </span><span>asm</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span class="main"><span>â¥</span></span><span class="free"><span>b</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Suc</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span>Nat.add_diff_assoc</span><span> </span><span>One_nat_def</span><span> </span><span>Suc_pred</span><span> </span><span>add.commute</span><span> </span><span>diff_is_0_eq</span><span> </span><span>div_add_self1</span><span> 
          </span><span>div_le_mono</span><span> </span><a class="entity_ref" href="Carries.html#Carries.div_sub|fact"><span>div_sub</span></a><span> </span><span>mod_add_self1</span><span> </span><span>nat_le_linear</span><span> </span><span>neq0_conv</span><span> </span><span>plus_1_eq_Suc</span><span> </span><span>power_not_zero</span><span> 
          </span><span>zero_neq_numeral</span><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span>diff_is_0_eq</span><span> </span><span>even_Suc</span><span> </span><span>even_diff_nat</span><span> </span><span>even_iff_mod_2_eq_zero</span><span> </span><span>le_less</span><span> </span><span>mod_add_eq</span><span> 
          </span><span>nat.simps</span><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>not_mod_2_eq_1_eq_0</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>}</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>presume</span></span></span><span> </span><span>asm2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.div_sub|fact"><span>div_sub</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>b</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="free"><span>a</span></span></span><span class="main"><span>]</span></span><span> </span><span>div_le_mono</span><span> </span><span>even_add</span><span> </span><span>even_iff_mod_2_eq_zero</span><span> 
        </span><span>le_add_diff_inverse2</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span>mod_mod_trivial</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="quoted"><span class="numeral"><span>2</span></span></span><span class="main"><span>]</span></span><span> 
        </span><span>not_less</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span>not_mod_2_eq_1_eq_0</span><span> </span><a class="entity_ref" href="Carries.html#Carries.div_sub|fact"><span>div_sub</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>smt</span></span><span>

  </span><span class="keyword1"><span class="command"><span>}</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_narry_def|fact"><span>bin_narry_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Carries.dif_narry_formula|fact"><span class="entity_def" id="Carries.dif_narry_formula|thm"><span>dif_narry_formula</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span class="main"><span>â¥</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_narry|const"><span>bin_narry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_narry|const"><span>bin_narry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>presume</span></span></span><span> </span><span class="entity_def" id="offset_5508..5510">a1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>presume</span></span></span><span> </span><span class="entity_def" id="offset_5564..5566">a2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_5625..5627">f3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_5671..5673">f4</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_5564..5566"><span>a2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><span>le_less_trans</span><span> </span><span>mod2_eq_if</span><span> </span><span>mod_greater_zero_iff_not_dvd</span><span> </span><span>not_less</span><span> 
          </span><span>zero_less_Suc</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_5564..5566"><span>a2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>One_nat_def</span><span> </span><span>le_simps</span><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>mod_less_divisor</span><span> </span><span>mod_mult2_eq</span><span> 
          </span><span>mult.left_neutral</span><span> </span><span>neq0_conv</span><span> </span><span>not_less</span><span> </span><span>semiring_normalization_rules</span><span class="main"><span class="main"><span>(</span></span></span><span>7</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>False</span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_5671..5673"><span>f4</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_5625..5627"><span>f3</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_5508..5510"><span>a1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>One_nat_def</span><span> </span><span>add.commute</span><span> </span><span>div_add_self1</span><span> </span><span>div_le_mono</span><span> </span><span>less_imp_le</span><span> 
          </span><span>mod_div_trivial</span><span> </span><span>mod_mult2_eq</span><span> </span><span>mult.left_neutral</span><span> </span><span>not_less</span><span> </span><span>plus_1_eq_Suc</span><span> 
          </span><span>semiring_normalization_rules</span><span class="main"><span class="main"><span>(</span></span></span><span>7</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>zero_less_Suc</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>}</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>presume</span></span></span><span> </span><span class="entity_def" id="offset_6317..6319">a1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>presume</span></span></span><span> </span><span class="entity_def" id="offset_6363..6365">a2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>presume</span></span></span><span> </span><span class="entity_def" id="offset_6419..6421">a3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>presume</span></span></span><span> </span><span class="entity_def" id="offset_6477..6479">a4</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6498..6500">f6</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_6363..6365"><span>a2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>nn</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_6600..6602">f7</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>nn</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_6477..6479"><span>a4</span></a><span> </span><span>le_add_diff_inverse</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_6419..6421"><span>a3</span></a><span> </span><a class="entity_ref" href="Carries.html#Carries.div_sub|fact"><span>div_sub</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>presburger</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6794..6796">f8</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_6317..6319"><span>a1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>div_mult2_eq</span><span> </span><a class="entity_ref" href="Carries.html#Carries.div_sub|fact"><span>div_sub</span></a><span> </span><span>power_Suc</span><span> </span><span>power_commutes</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6954..6956">f9</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span> </span><span class="bound"><span>na</span></span><span class="main"><span>.</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>na</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="bound"><span>na</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>â¨</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>n</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>add_Suc_right</span><span> </span><span>add_cancel_left_right</span><span> </span><span>div_add_self1</span><span> </span><span>lessI</span><span> 
            </span><span>less_Suc_eq_0_disj</span><span> </span><span>less_one</span><span> </span><span>zero_neq_one</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="bound"><span>nb</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>na</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="bound"><span>nb</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>nb</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>na</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¨</span></span><span>
         </span><span class="main"><span>Â¬</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>na</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="bound"><span>nb</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="main"><span>â¨</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>na</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.div_sub|fact"><span>div_sub</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7325..7328">f10</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="bound"><span>nb</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¬</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>nb</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="main"><span>â¨</span></span><span> </span><span class="bound"><span>nb</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>na</span></span><span> 
          </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>na</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="bound"><span>nb</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="main"><span>â¨</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>na</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>diff_Suc_Suc</span><span> </span><span>diff_commute</span><span> </span><span>diff_diff_left</span><span> </span><span>mod_add_self1</span><span> </span><span>plus_1_eq_Suc</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span>Suc</span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>n</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_7325..7328"><span>f10</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_6954..6956"><span>f9</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_6794..6796"><span>f8</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_6600..6602"><span>f7</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_6498..6500"><span>f6</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_6477..6479"><span>a4</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>add_diff_cancel_left'</span><span> </span><span>add_diff_assoc</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>False</span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>}</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_narry_def|fact"><span>bin_narry_def</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span>add_0_left</span><span> </span><span>add_less_cancel_left</span><span> </span><span>divmod_digit_0</span><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>le_less_trans</span><span> </span><span>mod_less_divisor</span><span>
        </span><span>mod_mult2_eq</span><span> </span><span>mult_zero_right</span><span> </span><span>nat_neq_iff</span><span> </span><span>not_less</span><span> </span><span>not_mod2_eq_Suc_0_eq_0</span><span> 
        </span><span>semiring_normalization_rules</span><span class="main"><span class="main"><span>(</span></span></span><span>7</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>zero_less_numeral</span><span> </span><span>zero_less_power</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span>One_nat_def</span><span> </span><span>add.left_neutral</span><span> </span><span>divmod_digit_0</span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>le_less_trans</span><span> </span><span>less_imp_le</span><span>
          </span><span>mod_less_divisor</span><span> </span><span>mod_mult2_eq</span><span> </span><span>mod_mult_self1_is_0</span><span> </span><span>mult_zero_right</span><span> </span><span>not_less</span><span>
          </span><span>not_mod2_eq_Suc_0_eq_0</span><span> </span><span>not_one_le_zero</span><span> </span><span>semiring_normalization_rules</span><span class="main"><span class="main"><span>(</span></span></span><span>7</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>zero_less_numeral</span><span> 
          </span><span>zero_less_power</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
 
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Carries.sum_digit_formula|fact"><span class="entity_def" id="Carries.sum_digit_formula|thm"><span>sum_digit_formula</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry_def|fact"><span>bin_carry_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>div_add1_eq</span><span> </span><span>mod_add_eq</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Carries.sum_carry_formula|fact"><span class="entity_def" id="Carries.sum_carry_formula|thm"><span>sum_carry_formula</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry_def|fact"><span>bin_carry_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span>div_mult2_eq</span><span> </span><span>div_mult_self4</span><span> </span><span>mod_mult2_eq</span><span> </span><span>power_not_zero</span><span> </span><span>semiring_normalization_rules</span><span class="main"><span class="main"><span>(</span></span></span><span>20</span><span class="main"><span class="main"><span>)</span></span></span><span>
          </span><span>semiring_normalization_rules</span><span class="main"><span class="main"><span>(</span></span></span><span>34</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>semiring_normalization_rules</span><span class="main"><span class="main"><span>(</span></span></span><span>7</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>zero_neq_numeral</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Carries.bin_carry_bounded|fact"><span class="entity_def" id="Carries.bin_carry_bounded|thm"><span>bin_carry_bounded</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span>  </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span>  </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>mult_2</span><span> </span><span>add_strict_mono</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span>  </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>less_mult_imp_div_less</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>div_le_mono</span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry_def|fact"><span>bin_carry_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Carries.carry_bounded|fact"><span class="entity_def" id="Carries.carry_bounded|thm"><span>carry_bounded</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry_bounded|fact"><span>bin_carry_bounded</span></a><span> </span><span>not_mod_2_eq_1_eq_0</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Carries.no_carry|fact"><span class="entity_def" id="Carries.no_carry|thm"><span>no_carry</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>r</span></span></span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span>
          </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="var"><span>?Q</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>ccontr</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_9635..9636">p</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_9652..9654">nq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="var"><span>?Q</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>k</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_9686..9688">k1</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="var"><span>?Q</span></span><span> </span><span class="skolem"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_9701..9703">k2</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>r</span></span></span><span class="main"><span>&lt;</span></span><span class="skolem"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="var"><span>?Q</span></span><span> </span><span class="bound"><span>r</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.obtain_smallest|fact"><span>obtain_smallest</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_9757..9759">c1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="skolem"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_9686..9688"><span>k1</span></a><span> </span><a class="entity_ref" href="Carries.html#Carries.sum_digit_formula|fact"><span>sum_digit_formula</span></a><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry_bounded|fact"><span>bin_carry_bounded</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>add.commute</span><span> </span><span>not_mod2_eq_Suc_0_eq_0</span><span> </span><span>plus_nat.add_0</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.sum_digit_formula|fact"><span>sum_digit_formula</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry_bounded|fact"><span>bin_carry_bounded</span></a><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry_def|fact"><span>bin_carry_def</span></a><span> </span><span>diff_is_0_eq'</span><span> </span><span>diff_less</span><span> </span><span>div_by_1</span><span> </span><span>even_add</span><span>
              </span><span>even_iff_mod_2_eq_zero</span><span> </span><a class="entity_ref" href="Carries.html#offset_9701..9703"><span>k2</span></a><span> </span><span>less_numeral_extra</span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>mod_by_1</span><span> </span><span>neq0_conv</span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_bounded|fact"><span>nth_bit_bounded</span></a><span>
              </span><span>power_0</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10171..10179">moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span>add.right_neutral</span><span> </span><a class="entity_ref" href="Carries.html#offset_9757..9759"><span>c1</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_10171..10179"><span>calculation</span></a><span> </span><span>diff_le_self</span><span> </span><a class="entity_ref" href="Carries.html#offset_9701..9703"><span>k2</span></a><span> </span><span>leI</span><span> </span><span>le_add_diff_inverse2</span><span> </span><span>le_less_trans</span><span>
            </span><span>mod_by_1</span><span> </span><span>mod_if</span><span> </span><span>nat_less_le</span><span> </span><a class="entity_ref" href="Carries.html#offset_9652..9654"><span>nq</span></a><span> </span><span>one_div_two_eq_zero</span><span> </span><span>one_neq_zero</span><span> </span><a class="entity_ref" href="Carries.html#offset_9635..9636"><span>p</span></a><span> </span><a class="entity_ref" href="Carries.html#Carries.sum_carry_formula|fact"><span>sum_carry_formula</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="skolem"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_9701..9703"><span>k2</span></a><span> </span><a class="entity_ref" href="Carries.html#Carries.sum_carry_formula|fact"><span>sum_carry_formula</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Suc_eq_plus1_left</span><span> </span><span>add_diff_inverse_nat</span><span> </span><span>less_imp_diff_less</span><span> </span><span>mod_0</span><span> </span><span>mod_Suc</span><span>
              </span><span>mod_add_self1</span><span> </span><span>mod_div_trivial</span><span> </span><span>mod_less</span><span> </span><span>n_not_Suc_n</span><span> </span><span>plus_nat.add_0</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span>False</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_9757..9759"><span>c1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Carries.no_carry_mult_equiv|fact"><span class="entity_def" id="Carries.no_carry_mult_equiv|thm"><span>no_carry_mult_equiv</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="var"><span>?Q</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_10815..10816">P</span><span class="main"><span>:</span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?P</span></span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>k</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_10815..10816"><span>P</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="skolem"><span>k</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry_def|fact"><span>bin_carry_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.sum_carry_formula|fact"><span>sum_carry_formula</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_10815..10816"><span>P</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>One_nat_def</span><span> </span><span>Suc_eq_plus1</span><span> </span><span>add.right_neutral</span><span> </span><span>div_less</span><span> </span><span>lessI</span><span>
        </span><span>mult_is_0</span><span> </span><span>not_mod_2_eq_0_eq_1</span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><span>numeral_2_eq_2</span><span> </span><span>zero_less_Suc</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>}</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?Q</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_11244..11245">Q</span><span class="main"><span>:</span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?Q</span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>k</span></span><span>
    </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_11244..11245"><span>Q</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="skolem"><span>k</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry_def|fact"><span>bin_carry_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>add_self_div_2</span><span> </span><span>not_mod2_eq_Suc_0_eq_0</span><span> </span><span>power_one_right</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span>  </span><a class="entity_ref" href="Carries.html#Carries.sum_carry_formula|fact"><span>sum_carry_formula</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>One_nat_def</span><span> </span><span>add.right_neutral</span><span> </span><span>add_self_div_2</span><span> </span><span>not_mod_2_eq_1_eq_0</span><span> </span><span>power_Suc</span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>}</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?P</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>


</span><span class="comment1"><span>(</span><span>*</span><span> NEW LEMMAS FROM DIGIT COMPARISON </span><span>*</span><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Carries.carry_digit_impl|fact"><span class="entity_def" id="Carries.carry_digit_impl|thm"><span>carry_digit_impl</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>r</span></span></span><span class="main"><span>&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>ccontr</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>r</span></span></span><span class="main"><span>&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_11884..11889">bound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>r</span></span></span><span class="main"><span>&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span>bk</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_11985..11989">base</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.carry_bounded|fact"><span>carry_bounded</span></a><span> </span><span>le_less</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="main"><span>1</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_12080..12084">step</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>i</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>ccontr</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_12186..12188">ik</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_12211..12216">carry</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry_bounded|fact"><span>bin_carry_bounded</span></a><span> </span><span>not_mod_2_eq_1_eq_0</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span>False</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#offset_12186..12188"><span>ik</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_12211..12216"><span>carry</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_11884..11889"><span>bound</span></a><span> </span><a class="entity_ref" href="Carries.html#Carries.sum_carry_formula|fact"><span>sum_carry_formula</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>a</span></span></span><span> </span><span class="quoted"><span class="free"><span>b</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> 
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Suc_eq_plus1</span><span> </span><span>Suc_pred</span><span> </span><span>add_lessD1</span><span> </span><span>bot_nat_0.not_eq_extremum</span><span> </span><a class="entity_ref" href="Carries.html#offset_12211..12216"><span>carry</span></a><span> </span><span>diff_is_0_eq'</span><span> </span><span>div_le_mono</span><span> </span><span>le_eq_less_or_eq</span><span> </span><span>less_add_one</span><span> </span><span>one_div_two_eq_zero</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>i</span></span></span><span class="main"><span>â¤</span></span><span class="free"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.rev_induct|fact"><span>rev_induct</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> </span><span class="var"><span>?P</span></span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Î»</span></span><span class="bound"><span>c</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>c</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Carries.html#offset_12080..12084"><span>step</span></a><span> </span><a class="entity_ref" href="Carries.html#offset_11985..11989"><span>base</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry_def|fact"><span>bin_carry_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span>False</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>


</span><span class="keyword2"><span class="keyword"><span>end</span></span></span></pre></div><div id='Binary_Operations'>

<body>
<div class="head">
<h1>Theory Binary_Operations</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Binary_Operations</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="Bits_Digits.html"><span>Bits_Digits</span></a><span> </span><a href="Carries.html"><span>Carries</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Digit-wise Operations</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Binary AND</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Binary_Operations.bitAND_nat.elims|fact"><span class="entity_def" id="Binary_Operations.bitAND_nat.induct|fact"><span class="entity_def" id="Binary_Operations.bitAND_nat.simps|fact"><span class="entity_def" id="Binary_Operations.bitAND_nat.pelims|fact"><span class="entity_def" id="Binary_Operations.bitAND_nat.cases|fact"><span class="entity_def" id="Binary_Operations.bitAND_nat.termination|fact"><span class="entity_def" id="Binary_Operations.bitAND_nat.pinduct|fact"><span class="entity_def" id="Binary_Operations.bitAND_nat.psimps|fact"><span class="entity_def" id="Binary_Operations.bitAND_nat_rel.inducts|fact"><span class="entity_def" id="Binary_Operations.bitAND_nat_rel.simps|fact"><span class="entity_def" id="Binary_Operations.bitAND_nat_rel.induct|fact"><span class="entity_def" id="Binary_Operations.bitAND_nat_rel.cases|fact"><span class="entity_def" id="Binary_Operations.bitAND_nat_rel.intros|fact"><span class="entity_def" id="Binary_Operations.bitAND_nat_graph.inducts|fact"><span class="entity_def" id="Binary_Operations.bitAND_nat_graph.simps|fact"><span class="entity_def" id="Binary_Operations.bitAND_nat_graph.induct|fact"><span class="entity_def" id="Binary_Operations.bitAND_nat_graph.cases|fact"><span class="entity_def" id="Binary_Operations.bitAND_nat_graph.intros|fact"><span class="entity_def" id="Binary_Operations.bitAND_nat.elims|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat.induct|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat.simps(2)|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat.simps(1)|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat.pelims|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat.cases|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat.termination|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat.pinduct|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat.psimps(2)|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat.psimps(1)|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat_rel.inducts|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat_rel.simps|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat_rel.induct|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat_rel.cases|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat_rel.intros|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat_graph.inducts|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat_graph.simps|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat_graph.induct|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat_graph.cases|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat_graph.intros(2)|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat_graph.intros(1)|thm"><span class="entity_def" id="Binary_Operations.bitAND_nat_def|axiom"><span class="entity_def" id="Binary_Operations.bitAND_nat_rel_def|axiom"><span class="entity_def" id="Binary_Operations.bitAND_nat_sumC_def|axiom"><span class="entity_def" id="Binary_Operations.bitAND_nat_graph_def|axiom"><span class="entity_def" id="Binary_Operations.bitAND_nat_dom|const"><span class="entity_def" id="Binary_Operations.bitAND_nat_rel|const"><span class="entity_def" id="Binary_Operations.bitAND_nat_sumC|const"><span class="entity_def" id="Binary_Operations.bitAND_nat_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Binary_Operations.bitAND_nat|const"><span>bitAND_nat</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infix</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>&amp;&amp;</span></span><span>"</span></span><span> 64</span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span class="free"><span>&amp;&amp;</span></span></span><span> </span><span class="main"><span class="bound"><span class="entity"><span>_</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span class="free"><span>&amp;&amp;</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span class="free"><span>&amp;&amp;</span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.bitAND_zero|fact"><span class="entity_def" id="Binary_Operations.bitAND_zero|thm"><span>bitAND_zero</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quoted"><span class="free"><span>m</span></span></span><span> </span><span class="quoted"><span class="free"><span>n</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat.induct|fact"><span>bitAND_nat.induct</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.bitAND_1|fact"><span class="entity_def" id="Binary_Operations.bitAND_1|thm"><span>bitAND_1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>a</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.bitAND_rec|fact"><span class="entity_def" id="Binary_Operations.bitAND_rec|thm"><span>bitAND_rec</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>m</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.bitAND_commutes|fact"><span class="entity_def" id="Binary_Operations.bitAND_commutes|thm"><span>bitAND_commutes</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quoted"><span class="free"><span>m</span></span></span><span> </span><span class="quoted"><span class="free"><span>n</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat.induct|fact"><span>bitAND_nat.induct</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_rec|fact"><span>bitAND_rec</span></a><span> </span><span>mult.commute</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.nth_digit_0|fact"><span class="entity_def" id="Binary_Operations.nth_digit_0|thm"><span>nth_digit_0</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.bitAND_zeroone|fact"><span class="entity_def" id="Binary_Operations.bitAND_zeroone|thm"><span>bitAND_zeroone</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.nth_digit_0|fact"><span>nth_digit_0</span></a><span> </span><span>nat_le_linear</span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat.elims|fact"><span>bitAND_nat.elims</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>One_nat_def</span><span> </span><span>add.left_neutral</span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_zero|fact"><span>bitAND_zero</span></a><span> </span><span>div_less</span><span> </span><span>le_zero_eq</span><span> </span><span>lessI</span><span>
             </span><span>mult.right_neutral</span><span> </span><span>mult_0_right</span><span> </span><span>not_mod2_eq_Suc_0_eq_0</span><span> </span><span>numeral_2_eq_2</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.aux1_bitAND_digit_mult|fact"><span class="entity_def" id="Binary_Operations.aux1_bitAND_digit_mult|thm"><span>aux1_bitAND_digit_mult</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>k</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>One_nat_def</span><span> </span><span>add_cancel_left_right</span><span> </span><span>div_mult2_eq</span><span> </span><span>even_succ_div_two</span><span> </span><span>le_0_eq</span><span> </span><span>le_Suc_eq</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.bitAND_digit_mult|fact"><span class="entity_def" id="Binary_Operations.bitAND_digit_mult|thm"><span>bitAND_digit_mult</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>k</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>a</span></span></span><span> </span><span class="quoted"><span class="free"><span>b</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> opaque_lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>Groups.add_ac</span><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_rec|fact"><span>bitAND_rec</span></a><span> </span><span>mod_mod_trivial</span><span>
              </span><span>mod_mult_self2</span><span> </span><span>mult_numeral_1_right</span><span> </span><span>mult_zero_right</span><span> </span><span>not_mod_2_eq_1_eq_0</span><span> </span><span>numeral_One</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_1620..1623">Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="skolem"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_rec|fact"><span>bitAND_rec</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>a</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>Suc</span><span class="main"><span>(</span></span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>One_nat_def</span><span> </span><span>lessI</span><span> </span><span>mult_numeral_1_right</span><span> </span><span>mult_zero_right</span><span> </span><span>not_mod_2_eq_1_eq_0</span><span>
              </span><span>numeral_2_eq_2</span><span> </span><span>numeral_One</span><span> </span><span>power_gt1</span><span> </span><span>zero_less_numeral</span><span> </span><span>zero_less_power</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="skolem"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.aux1_bitAND_digit_mult|fact"><span>aux1_bitAND_digit_mult</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>le_numeral_extra</span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>le_numeral_extra</span><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>mod_mult_self1_is_0</span><span> </span><span>mult_numeral_1_right</span><span>
              </span><span>mult_zero_right</span><span> </span><span>not_mod_2_eq_1_eq_0</span><span> </span><span>numeral_One</span><span> </span><span>zero_less_Suc</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="skolem"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="skolem"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_1620..1623"><span>Suc</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>presburger</span></span><span>

  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>div_mult2_eq</span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><span>power_Suc</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.bitAND_single_bit_mult_equiv|fact"><span class="entity_def" id="Binary_Operations.bitAND_single_bit_mult_equiv|thm"><span>bitAND_single_bit_mult_equiv</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_digit_mult|fact"><span>bitAND_digit_mult</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>a</span></span></span><span> </span><span class="quoted"><span class="free"><span>b</span></span></span><span> </span><span class="quoted"><span class="main"><span>0</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_zeroone|fact"><span>bitAND_zeroone</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.nth_digit_0|fact"><span>nth_digit_0</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.bitAND_mult_equiv|fact"><span class="entity_def" id="Binary_Operations.bitAND_mult_equiv|thm"><span>bitAND_mult_equiv</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>c</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="var"><span>?Q</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?Q</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_digit_mult|fact"><span>bitAND_digit_mult</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?Q</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_digit_mult|fact"><span>bitAND_digit_mult</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.digit_wise_equiv|fact"><span>digit_wise_equiv</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>presburger</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.bitAND_linear|fact"><span class="entity_def" id="Binary_Operations.bitAND_linear|thm"><span>bitAND_linear</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>::</span></span><span class="quoted"><span>nat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>d</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>k</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>a</span></span></span><span> </span><span class="quoted"><span class="free"><span>b</span></span></span><span> </span><span class="quoted"><span class="free"><span>c</span></span></span><span> </span><span class="quoted"><span class="free"><span>d</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_3260..3263">Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_3269..3275">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>m</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>b</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_3310..3316">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>n</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>d</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>bitAND_nat</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_rec|fact"><span>bitAND_rec</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>d</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_3269..3275"><span>m_def</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_3310..3316"><span>n_def</span></a><span> </span><span>add.commute</span><span> </span><span>mod_mult_self2</span><span> </span><span>power_Suc</span><span> </span><span>semiring_normalization_rules</span><span class="main"><span class="main"><span>(</span></span></span><span>19</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_3636..3638">f0</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="skolem"><span>n</span></span><span>
                      </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>d</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span class="skolem"><span>d</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>add.commute</span><span> </span><span>div_mult_self2</span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_3269..3275"><span>m_def</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_3310..3316"><span>n_def</span></a><span> </span><span>power_Suc</span><span> </span><span>semiring_normalization_rules</span><span class="main"><span class="main"><span>(</span></span></span><span>19</span><span class="main"><span class="main"><span>)</span></span></span><span>
              </span><span>zero_neq_numeral</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="skolem"><span>d</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_3260..3263"><span>Suc.prems</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_3968..3970">f1</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="skolem"><span>n</span></span><span>
                </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="skolem"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>d</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>d</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_3636..3638"><span>f0</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_3260..3263"><span>Suc.IH</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="skolem"><span>d</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>d</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>d</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_rec|fact"><span>bitAND_rec</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_3968..3970"><span>f1</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_3269..3275"><span>m_def</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_3310..3316"><span>n_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Binary orthogonality</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>cf. </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>cite</span></span><span> </span><span>h10lecturenotes</span><span class="antiquote"><span>}</span></span></span><span> section 2.6.1 on "Binary orthogonality"</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The following definition differs slightly from the one in the paper. However, we later prove the 
</span><span>     equivalence of the two definitions.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Binary_Operations.orthogonal.elims|fact"><span class="entity_def" id="Binary_Operations.orthogonal.induct|fact"><span class="entity_def" id="Binary_Operations.orthogonal.simps|fact"><span class="entity_def" id="Binary_Operations.orthogonal.pelims|fact"><span class="entity_def" id="Binary_Operations.orthogonal.cases|fact"><span class="entity_def" id="Binary_Operations.orthogonal.termination|fact"><span class="entity_def" id="Binary_Operations.orthogonal.pinduct|fact"><span class="entity_def" id="Binary_Operations.orthogonal.psimps|fact"><span class="entity_def" id="Binary_Operations.orthogonal_rel.inducts|fact"><span class="entity_def" id="Binary_Operations.orthogonal_rel.simps|fact"><span class="entity_def" id="Binary_Operations.orthogonal_rel.induct|fact"><span class="entity_def" id="Binary_Operations.orthogonal_rel.cases|fact"><span class="entity_def" id="Binary_Operations.orthogonal_rel.intros|fact"><span class="entity_def" id="Binary_Operations.orthogonal_graph.inducts|fact"><span class="entity_def" id="Binary_Operations.orthogonal_graph.simps|fact"><span class="entity_def" id="Binary_Operations.orthogonal_graph.induct|fact"><span class="entity_def" id="Binary_Operations.orthogonal_graph.cases|fact"><span class="entity_def" id="Binary_Operations.orthogonal_graph.intros|fact"><span class="entity_def" id="Binary_Operations.orthogonal.elims(3)|thm"><span class="entity_def" id="Binary_Operations.orthogonal.elims(2)|thm"><span class="entity_def" id="Binary_Operations.orthogonal.elims(1)|thm"><span class="entity_def" id="Binary_Operations.orthogonal.induct|thm"><span class="entity_def" id="Binary_Operations.orthogonal.simps|thm"><span class="entity_def" id="Binary_Operations.orthogonal.pelims(3)|thm"><span class="entity_def" id="Binary_Operations.orthogonal.pelims(2)|thm"><span class="entity_def" id="Binary_Operations.orthogonal.pelims(1)|thm"><span class="entity_def" id="Binary_Operations.orthogonal.cases|thm"><span class="entity_def" id="Binary_Operations.orthogonal.termination|thm"><span class="entity_def" id="Binary_Operations.orthogonal.pinduct|thm"><span class="entity_def" id="Binary_Operations.orthogonal.psimps|thm"><span class="entity_def" id="Binary_Operations.orthogonal_rel.inducts|thm"><span class="entity_def" id="Binary_Operations.orthogonal_rel.simps|thm"><span class="entity_def" id="Binary_Operations.orthogonal_rel.induct|thm"><span class="entity_def" id="Binary_Operations.orthogonal_rel.cases|thm"><span class="entity_def" id="Binary_Operations.orthogonal_graph.inducts|thm"><span class="entity_def" id="Binary_Operations.orthogonal_graph.simps|thm"><span class="entity_def" id="Binary_Operations.orthogonal_graph.induct|thm"><span class="entity_def" id="Binary_Operations.orthogonal_graph.cases|thm"><span class="entity_def" id="Binary_Operations.orthogonal_graph.intros|thm"><span class="entity_def" id="Binary_Operations.orthogonal_def|axiom"><span class="entity_def" id="Binary_Operations.orthogonal_rel_def|axiom"><span class="entity_def" id="Binary_Operations.orthogonal_sumC_def|axiom"><span class="entity_def" id="Binary_Operations.orthogonal_graph_def|axiom"><span class="entity_def" id="Binary_Operations.orthogonal_dom|const"><span class="entity_def" id="Binary_Operations.orthogonal_rel|const"><span class="entity_def" id="Binary_Operations.orthogonal_sumC|const"><span class="entity_def" id="Binary_Operations.orthogonal_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Binary_Operations.orthogonal|const"><span>orthogonal</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>bool</span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infix</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>â¥</span></span><span>"</span></span><span> 49</span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>orthogonal</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat|const"><span>&amp;&amp;</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.ortho_mult_equiv|fact"><span class="entity_def" id="Binary_Operations.ortho_mult_equiv|thm"><span>ortho_mult_equiv</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.orthogonal|const"><span>â¥</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="var"><span>?Q</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?Q</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_digit_mult|fact"><span>bitAND_digit_mult</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>div_0</span><span> </span><span>mod_0</span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.orthogonal.simps|fact"><span>orthogonal.simps</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?Q</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_mult_equiv|fact"><span>bitAND_mult_equiv</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>div_0</span><span> </span><span>mod_0</span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.orthogonal.simps|fact"><span>orthogonal.simps</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4959..4964">lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.aux1_1_digit_lt_linear|fact"><span class="entity_def" id="Binary_Operations.aux1_1_digit_lt_linear|thm"><span>aux1_1_digit_lt_linear</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="free"><span>r</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span> </span><span class="main"><span>â¶</span></span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.orthogonal|const"><span>â¥</span></a></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quoted"><span class="free"><span>a</span></span></span><span>  </span><span class="quoted"><span class="free"><span>b</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat.induct|fact"><span>bitAND_nat.induct</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>1</span><span> </span><span class="skolem"><span>uu</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>2</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_linear|fact"><span>bitAND_linear</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="skolem"><span>n</span></span></span><span> </span><span class="quoted"><span class="free"><span>r</span></span></span><span> </span><span class="quoted"><span class="main"><span>0</span></span></span><span> </span><span class="quoted"><span class="main"><span>0</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Suc</span><span class="main"><span>(</span></span><span class="skolem"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_commutes|fact"><span>bitAND_commutes</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.ortho_mult_equiv|fact"><span>ortho_mult_equiv</span></a><span> </span><a class="entity_ref" href="Carries.html#Carries.no_carry_mult_equiv|fact"><span>no_carry_mult_equiv</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_4959..4964"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5386..5391">lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.aux1_digit_lt_linear|fact"><span class="entity_def" id="Binary_Operations.aux1_digit_lt_linear|thm"><span>aux1_digit_lt_linear</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="free"><span>r</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_5386..5391"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>order.strict_trans2</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span>  </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_5386..5391"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_5386..5391"><span>assms</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.aux1_1_digit_lt_linear|fact"><span>aux1_1_digit_lt_linear</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_5386..5391"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.bin_carry_def|fact"><span>bin_carry_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><span>div_add1_eq</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>r</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.aux_digit_shift|fact"><span class="entity_def" id="Binary_Operations.aux_digit_shift|thm"><span>aux_digit_shift</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>l</span></span><span class="main"><span>+</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>l</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quoted"><span class="free"><span>l</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span>div_mult2_eq</span><span> </span><span>mult.commute</span><span> </span><span>nonzero_mult_div_cancel_right</span><span> </span><span>power_add</span><span> </span><span>power_not_zero</span><span> </span><span>zero_neq_numeral</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6113..6118">lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.aux_digit_lt_linear|fact"><span class="entity_def" id="Binary_Operations.aux_digit_lt_linear|thm"><span>aux_digit_lt_linear</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>d</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>d</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>t</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_6327..6331">True</span><span>
  </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_6327..6331"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux2_digit_sum_repr|fact"><span>aux2_digit_sum_repr</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_6113..6118"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_6327..6331"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux2_digit_sum_repr|fact"><span>aux2_digit_sum_repr</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_6113..6118"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_6327..6331"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux2_digit_sum_repr|fact"><span>aux2_digit_sum_repr</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux2_digit_sum_repr|fact"><span>aux2_digit_sum_repr</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_6113..6118"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_6711..6716">False</span><span>
  </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_6711..6716"><span>False</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.aux1_digit_lt_linear|fact"><span>aux1_digit_lt_linear</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_6113..6118"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_6711..6716"><span>False</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.aux1_digit_lt_linear|fact"><span>aux1_digit_lt_linear</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_6113..6118"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_6711..6716"><span>False</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.aux1_digit_lt_linear|fact"><span>aux1_digit_lt_linear</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_6113..6118"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.aux2_digit_lt_linear|fact"><span class="entity_def" id="Binary_Operations.aux2_digit_lt_linear|thm"><span>aux2_digit_lt_linear</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>l</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_7203..7209">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>k</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>t</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>l</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_7203..7209"><span>k_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.aux_digit_shift|fact"><span>aux_digit_shift</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>l</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_7203..7209"><span>k_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.aux_digit_shift|fact"><span>aux_digit_shift</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.aux3_digit_lt_linear|fact"><span class="entity_def" id="Binary_Operations.aux3_digit_lt_linear|thm"><span>aux3_digit_lt_linear</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>l</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>t</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.aux2_digit_sum_repr|fact"><span>aux2_digit_sum_repr</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_7732..7737">False</span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_7740..7746">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>l</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>l</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>t</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_7775..7776">k</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>l</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>t</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_7732..7737"><span>False</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="skolem"><span>l</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_7740..7746"><span>l_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.aux_digit_shift|fact"><span>aux_digit_shift</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_7775..7776"><span>k</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="skolem"><span>l</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_7740..7746"><span>l_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.aux_digit_shift|fact"><span>aux_digit_shift</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_7775..7776"><span>k</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.digit_lt_linear|fact"><span class="entity_def" id="Binary_Operations.digit_lt_linear|thm"><span>digit_lt_linear</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_8098..8099">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_8128..8129">d</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>d</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>l</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>l</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8255..8260">shift</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>l</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>l</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="var"><span>?Q</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_8356..8357">P</span><span class="main"><span>:</span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?P</span></span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?Q</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_8356..8357"><span>P</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.aux2_digit_lt_linear|fact"><span>aux2_digit_lt_linear</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_8429..8430">Q</span><span class="main"><span>:</span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?Q</span></span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?P</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_8429..8430"><span>Q</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.aux3_digit_lt_linear|fact"><span>aux3_digit_lt_linear</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8498..8502">main</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.aux_digit_lt_linear|fact"><span>aux_digit_lt_linear</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_8098..8099"><span>b</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_8128..8129"><span>d</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

  </span><span class="keyword1"><span class="command"><span>from</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_8498..8502"><span>main</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_8255..8260"><span>shift</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Sufficient bitwise (digitwise) condition for the non-strict standard order of natural numbers</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.digitwise_leq|fact"><span class="entity_def" id="Binary_Operations.digitwise_leq|thm"><span>digitwise_leq</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>t</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_8900..8903">asm</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>t</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_8947..8953">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>r</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>â¡</span></span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>&gt;</span></span><span class="free"><span>y</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.digit_gen_sum_repr_variant|fact"><span>digit_gen_sum_repr_variant</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_9097..9098">x</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="skolem"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>atLeast0LessThan</span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_8947..8953"><span>r_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.digit_gen_sum_index_variant|fact"><span>digit_gen_sum_index_variant</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>linorder_neqE_nat</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>&lt;</span></span><span class="free"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.digit_gen_sum_repr_variant|fact"><span>digit_gen_sum_repr_variant</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_9366..9367">y</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="skolem"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>atLeast0LessThan</span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_8947..8953"><span>r_def</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.digit_gen_sum_index_variant|fact"><span>digit_gen_sum_index_variant</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>b</span></span><span class="main"><span>&gt;</span></span><span class="main"><span>1</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_8900..8903"><span>asm</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_9097..9098"><span>x</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_9366..9367"><span>y</span></a><span> 
    </span><span>sum_mono</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit|const"><span>nth_digit</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="bound"><span>k</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Binary masking</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Preliminary result on the standard non-strict of natural numbers</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.bitwise_leq|fact"><span class="entity_def" id="Binary_Operations.bitwise_leq|thm"><span>bitwise_leq</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span>  </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.digitwise_leq|fact"><span>digitwise_leq</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="numeral"><span>2</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_digit_base2_equiv|fact"><span>nth_digit_base2_equiv</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>cf. </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>cite</span></span><span> </span><span>h10lecturenotes</span><span class="antiquote"><span>}</span></span></span><span> section 2.6.2 on "Binary Masking"</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Again, the equivalence to the definition there will be proved in a later lemma.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Binary_Operations.masks.elims|fact"><span class="entity_def" id="Binary_Operations.masks.induct|fact"><span class="entity_def" id="Binary_Operations.masks.simps|fact"><span class="entity_def" id="Binary_Operations.masks.pelims|fact"><span class="entity_def" id="Binary_Operations.masks.cases|fact"><span class="entity_def" id="Binary_Operations.masks.termination|fact"><span class="entity_def" id="Binary_Operations.masks.pinduct|fact"><span class="entity_def" id="Binary_Operations.masks.psimps|fact"><span class="entity_def" id="Binary_Operations.masks_rel.inducts|fact"><span class="entity_def" id="Binary_Operations.masks_rel.simps|fact"><span class="entity_def" id="Binary_Operations.masks_rel.induct|fact"><span class="entity_def" id="Binary_Operations.masks_rel.cases|fact"><span class="entity_def" id="Binary_Operations.masks_rel.intros|fact"><span class="entity_def" id="Binary_Operations.masks_graph.inducts|fact"><span class="entity_def" id="Binary_Operations.masks_graph.simps|fact"><span class="entity_def" id="Binary_Operations.masks_graph.induct|fact"><span class="entity_def" id="Binary_Operations.masks_graph.cases|fact"><span class="entity_def" id="Binary_Operations.masks_graph.intros|fact"><span class="entity_def" id="Binary_Operations.masks.elims(3)|thm"><span class="entity_def" id="Binary_Operations.masks.elims(2)|thm"><span class="entity_def" id="Binary_Operations.masks.elims(1)|thm"><span class="entity_def" id="Binary_Operations.masks.induct|thm"><span class="entity_def" id="Binary_Operations.masks.simps(2)|thm"><span class="entity_def" id="Binary_Operations.masks.simps(1)|thm"><span class="entity_def" id="Binary_Operations.masks.pelims(3)|thm"><span class="entity_def" id="Binary_Operations.masks.pelims(2)|thm"><span class="entity_def" id="Binary_Operations.masks.pelims(1)|thm"><span class="entity_def" id="Binary_Operations.masks.cases|thm"><span class="entity_def" id="Binary_Operations.masks.termination|thm"><span class="entity_def" id="Binary_Operations.masks.pinduct|thm"><span class="entity_def" id="Binary_Operations.masks.psimps(2)|thm"><span class="entity_def" id="Binary_Operations.masks.psimps(1)|thm"><span class="entity_def" id="Binary_Operations.masks_rel.inducts|thm"><span class="entity_def" id="Binary_Operations.masks_rel.simps|thm"><span class="entity_def" id="Binary_Operations.masks_rel.induct|thm"><span class="entity_def" id="Binary_Operations.masks_rel.cases|thm"><span class="entity_def" id="Binary_Operations.masks_rel.intros|thm"><span class="entity_def" id="Binary_Operations.masks_graph.inducts|thm"><span class="entity_def" id="Binary_Operations.masks_graph.simps|thm"><span class="entity_def" id="Binary_Operations.masks_graph.induct|thm"><span class="entity_def" id="Binary_Operations.masks_graph.cases|thm"><span class="entity_def" id="Binary_Operations.masks_graph.intros(2)|thm"><span class="entity_def" id="Binary_Operations.masks_graph.intros(1)|thm"><span class="entity_def" id="Binary_Operations.masks_def|axiom"><span class="entity_def" id="Binary_Operations.masks_rel_def|axiom"><span class="entity_def" id="Binary_Operations.masks_sumC_def|axiom"><span class="entity_def" id="Binary_Operations.masks_graph_def|axiom"><span class="entity_def" id="Binary_Operations.masks_dom|const"><span class="entity_def" id="Binary_Operations.masks_rel|const"><span class="entity_def" id="Binary_Operations.masks_sumC|const"><span class="entity_def" id="Binary_Operations.masks_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Binary_Operations.masks|const"><span>masks</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>bool</span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infix</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>â¼</span></span><span>"</span></span><span> 49</span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>masks</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span class="bound"><span class="entity"><span>_</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>True</span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>masks</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span class="free"><span>â¼</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>b</span></span></span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.masks_substr|fact"><span class="entity_def" id="Binary_Operations.masks_substr|thm"><span>masks_substr</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks|const"><span>â¼</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks|const"><span>â¼</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>k</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>ka</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_10310..10312">a1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>ka</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks|const"><span>â¼</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>ka</span></span><span>"</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10354..10356">f2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="bound"><span>nb</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>nb</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>nb</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>na</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>div_mult2_eq</span><span> </span><span>semiring_normalization_rules</span><span class="main"><span class="main"><span>(</span></span></span><span>7</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10499..10501">f3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="bound"><span>nb</span></span><span> </span><span class="bound"><span>nc</span></span><span class="main"><span>.</span></span><span>
                    </span><span class="main"><span>(</span></span><span class="bound"><span>nc</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>nb</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¨</span></span><span> </span><span class="bound"><span>nc</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>nb</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks|const"><span>â¼</span></a></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¨</span></span><span> </span><span class="main"><span>Â¬</span></span><span> </span><span class="bound"><span>nc</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>nb</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks|const"><span>â¼</span></a></span><span> </span><span class="bound"><span>na</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>n</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks.elims|fact"><span>masks.elims</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>{</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>ka</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>ka</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_10354..10356"><span>f2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>div_0</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>ka</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks|const"><span>â¼</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>ka</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_10499..10501"><span>f3</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_10310..10312"><span>a1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>meson</span></span><span>
    </span><span class="keyword1"><span class="command"><span>}</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>ka</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks|const"><span>â¼</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>ka</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>div_mult2_eq</span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks.simps|fact"><span>masks.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>}</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.masks_digit_leq|fact"><span class="entity_def" id="Binary_Operations.masks_digit_leq|thm"><span>masks_digit_leq</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks|const"><span>â¼</span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>k</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>a</span></span></span><span> </span><span class="quoted"><span class="free"><span>b</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>add_cancel_left_right</span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitAND_nat.elims|fact"><span>bitAND_nat.elims</span></a><span> </span><span>div_by_1</span><span> </span><span>le0</span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks.simps|fact"><span>masks.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>power_0</span><span>
              </span><span>mod_mult_self1_is_0</span><span> </span><span>mod_mult_self4</span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span>
       </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>div_mult2_eq</span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks_substr|fact"><span>masks_substr</span></a><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span> </span><span>pow.simps</span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>power_numeral</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.masks_leq_equiv|fact"><span class="entity_def" id="Binary_Operations.masks_leq_equiv|thm"><span>masks_leq_equiv</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks|const"><span>â¼</span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="var"><span>?Q</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?Q</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks_digit_leq|fact"><span>masks_digit_leq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?Q</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induct</span></span><span> </span><span class="quoted"><span class="free"><span>a</span></span></span><span> </span><span class="quoted"><span class="free"><span>b</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks.induct|fact"><span>masks.induct</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>1</span><span> </span><span class="skolem"><span>uu</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>2</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="skolem"><span>b</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>drop_bit_Suc</span><span> </span><span>drop_bit_eq_div</span><span> </span><span>div_by_1</span><span> </span><span>power.simps</span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.masks_leq|fact"><span class="entity_def" id="Binary_Operations.masks_leq|thm"><span>masks_leq</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks|const"><span>â¼</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks_leq_equiv|fact"><span>masks_leq_equiv</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.bitwise_leq|fact"><span>bitwise_leq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.mask_linear|fact"><span class="entity_def" id="Binary_Operations.mask_linear|thm"><span>mask_linear</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_11975..11976">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_12005..12006">d</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>d</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks|const"><span>â¼</span></a></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks|const"><span>â¼</span></a></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks|const"><span>â¼</span></a></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="var"><span>?Q</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks_leq_equiv|fact"><span>masks_leq_equiv</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>Â¡</span></a></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_11975..11976"><span>b</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_12005..12006"><span>d</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.digit_lt_linear|fact"><span>digit_lt_linear</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks|const"><span>â¼</span></a></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks|const"><span>â¼</span></a></span><span> </span><span class="free"><span>d</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#Binary_Operations.masks_leq_equiv|fact"><span>masks_leq_equiv</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.aux1_lm0241_pow2_up_bound|fact"><span class="entity_def" id="Binary_Operations.aux1_lm0241_pow2_up_bound|thm"><span>aux1_lm0241_pow2_up_bound</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="main"><span>(</span></span><span class="bound"><span>p</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>a</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>use</span></span><span> </span><span>less_exp</span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_12501..12506">lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.aux2_lm0241_single_digit_binom|fact"><span class="entity_def" id="Binary_Operations.aux2_lm0241_single_digit_binom|thm"><span>aux2_lm0241_single_digit_binom</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>choose</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="var"><span>?Q</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_12501..12506"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_12501..12506"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Suc_eq_plus1</span><span> </span><span>add.commute</span><span> </span><span>add_cancel_right_left</span><span> </span><span>add_eq_if</span><span>
              </span><span>binomial_n_0</span><span> </span><span>choose_one</span><span> </span><span>le_add2</span><span> </span><span>le_antisym</span><span> </span><span>zero_neq_one</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_12823..12828">lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.aux3_lm0241_binom_bounds|fact"><span class="entity_def" id="Binary_Operations.aux3_lm0241_binom_bounds|thm"><span>aux3_lm0241_binom_bounds</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="keyword1"><span>choose</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_12823..12828"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_12823..12828"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span>le_Suc_eq</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_12975..12980">lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.aux4_lm0241_prod_one|fact"><span class="entity_def" id="Binary_Operations.aux4_lm0241_prod_one|thm"><span>aux4_lm0241_prod_one</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>::</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="var"><span>?Q</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>ccontr</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_13153..13157">assm</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="var"><span>?Q</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span>f_zero</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>r</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_12975..12980"><span>assms</span></a><span> </span><span>le_antisym</span><span> </span><span>not_less</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_13337..13342">contr</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>n</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span>False</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_13153..13157"><span>assm</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_13337..13342"><span>contr</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Binary_Operations.aux5_lm0241|fact"><span class="entity_def" id="Binary_Operations.aux5_lm0241|thm"><span>aux5_lm0241</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>choose</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¶</span></span><span>
   </span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
   </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="var"><span>?Q</span></span><span> </span><span class="free"><span>i</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>ccontr</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_13597..13601">assm</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><span class="var"><span>?P</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="var"><span>?Q</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¬</span></span><span class="var"><span>?Q</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>i</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_13670..13675">contr</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="var"><span>?Q</span></span><span> </span><span class="skolem"><span>i</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>i_minimal</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>j</span></span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="var"><span>?Q</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.obtain_smallest|fact"><span>obtain_smallest</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¬</span></span><span class="var"><span>?Q</span></span><span> </span><span class="bound"><span>i</span></span><span>âº</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¨</span></span><span>
                            </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¨</span></span><span>
                            </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit_def|fact"><span>nth_bit_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Carries.html#Carries.bin_carry|const"><span>bin_carry</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Carries.html#Carries.no_carry|fact"><span>no_carry</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_13670..13675"><span>contr</span></a><span> </span><span>add_self_mod_2</span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_13597..13601"><span>assm</span></a><span> </span><span>choose_one</span><span> </span><span>one_neq_zero</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_14253..14255">f0</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>mod</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Carries.html#Carries.sum_digit_formula|fact"><span>sum_digit_formula</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_13670..13675"><span>contr</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>choose</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Bits_Digits.html#Bits_Digits.nth_bit|const"><span>nth_bit</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_14253..14255"><span>f0</span></a><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_13670..13675"><span>contr</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span>False</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Binary_Operations.html#offset_13597..13601"><span>assm</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre></div>
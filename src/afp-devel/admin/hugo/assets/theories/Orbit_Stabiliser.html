<div id="Left_Coset">
<div class="head">
<h1>Theory Left_Coset</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">theory</span></span> Left_Coset
<span class="keyword2"><span class="keyword">imports</span></span>
  <span class="quoted">"<a href="../../HOL/HOL-Algebra/Coset.html">HOL-Algebra.Coset</a>"</span>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">LCOSETS</span>  <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="main">_</span><span class="main">,</span> <span class="tfree">'a</span> set<span class="main">]</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span> set<span class="main">)</span>set"</span></span>   <span class="main">(</span><span class="quoted">"<span class="keyword1">lcosets</span>ı _"</span> <span class="main">[</span>81<span class="main">]</span> 80<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">lcosets</span></span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">G</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">a</span><span class="main">∈</span>carrier <span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">.</span> <span class="main">{</span><span class="bound">a</span> <span class="main">&lt;#</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">G</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">LFactGroup</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="main">(</span><span class="tfree">'a</span><span class="main">,</span><span class="tfree">'b</span><span class="main">)</span> monoid_scheme<span class="main">,</span> <span class="tfree">'a</span> set<span class="main">]</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span> set<span class="main">)</span> monoid"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">LMod</span>"</span> 65<span class="main">)</span>
    <span class="comment1">― ‹Actually defined for groups rather than monoids›</span>
   <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">LFactGroup</span> <span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">=</span> <span class="main">⦇</span>carrier <span class="main">=</span> <span class="keyword1">lcosets</span><span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">G</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span><span class="main">,</span> mult <span class="main">=</span> set_mult <span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span> one <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span><span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> lcos_self<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">[|</span> <span class="free">x</span> <span class="main">∈</span> carrier <span class="free">G</span><span class="main">;</span> subgroup <span class="free">H</span> <span class="free">G</span> <span class="main">|]</span> <span class="main">==&gt;</span> <span class="free">x</span> <span class="main">∈</span> <span class="free">x</span> <span class="main">&lt;#</span> <span class="free">H</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> l_coset_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> sym r_one subgroup.subset <span class="main"><span class="main">[</span></span><span class="operator">THEN</span> subsetD<span class="main"><span class="main">]</span></span>
                    subgroup.one_closed<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Elements of a left coset are in the carrier›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> subgroup<span class="main">)</span> elemlcos_carrier<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"group <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> acarr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> a'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a'</span> <span class="main">∈</span> <span class="free">a</span> <span class="main">&lt;#</span> <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a'</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> group <span class="quoted"><span class="free">G</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword1"><span class="command">from</span></span> subset <span class="keyword2"><span class="keyword">and</span></span> acarr
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&lt;#</span> <span class="free">H</span> <span class="main">⊆</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> l_coset_subset_G<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="keyword2"><span class="keyword">and</span></span> a'
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a'</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Step one for lemma <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>rcos_module›</span></span></span></span>›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> subgroup<span class="main">)</span> lcos_module_imp<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"group <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> xcarr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> x'cos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x'</span> <span class="main">∈</span> <span class="free">x</span> <span class="main">&lt;#</span> <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">inv</span> <span class="free">x</span> <span class="main">⊗</span> <span class="free">x'</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> group <span class="quoted"><span class="free">G</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword1"><span class="command">from</span></span> xcarr x'cos
      <span class="keyword1"><span class="command">have</span></span> x'carr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x'</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> elemlcos_carrier<span class="main"><span class="main">[</span></span><span class="operator">OF</span> is_group<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> xcarr
      <span class="keyword1"><span class="command">have</span></span> ixcarr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="free">x</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> x'cos
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> <span class="free">x'</span> <span class="main">=</span> <span class="free">x</span> <span class="main">⊗</span> <span class="bound">h</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> l_coset_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
  <span class="keyword1"><span class="command">from</span></span> this
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">h</span></span>
        <span class="keyword2"><span class="keyword">where</span></span> hH<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> <span class="free">H</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> x'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x'</span> <span class="main">=</span> <span class="free">x</span> <span class="main">⊗</span> <span class="skolem">h</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> hH <span class="keyword2"><span class="keyword">and</span></span> subset
      <span class="keyword1"><span class="command">have</span></span> hcarr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
  <span class="keyword1"><span class="command">note</span></span> carr <span class="main">=</span> xcarr x'carr hcarr
  <span class="keyword1"><span class="command">from</span></span> x' <span class="keyword2"><span class="keyword">and</span></span> carr
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">inv</span> <span class="free">x</span><span class="main">)</span> <span class="main">⊗</span> <span class="free">x'</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="free">x</span><span class="main">)</span> <span class="main">⊗</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊗</span> <span class="skolem">h</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> carr
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">⊗</span> <span class="keyword1">inv</span> <span class="free">x</span><span class="main">)</span> <span class="main">⊗</span> <span class="skolem">h</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ixcarr l_inv m_assoc r_inv<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> carr
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="skolem">h</span> <span class="main">⊗</span> <span class="main">𝟭</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> carr
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="skolem">h</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">inv</span> <span class="free">x</span><span class="main">)</span> <span class="main">⊗</span> <span class="free">x'</span> <span class="main">=</span> <span class="skolem">h</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> hH this
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">inv</span> <span class="free">x</span><span class="main">)</span> <span class="main">⊗</span> <span class="free">x'</span> <span class="main">∈</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Left cosets are subsets of the carrier.›</span></span> 
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> subgroup<span class="main">)</span> lcosets_carrier<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"group <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> XH<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">∈</span> <span class="keyword1">lcosets</span> <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">⊆</span> carrier <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> group <span class="quoted"><span class="free">G</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword1"><span class="command">from</span></span> XH <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">x</span><span class="main">∈</span> carrier <span class="free">G</span><span class="main">.</span> <span class="free">X</span> <span class="main">=</span> <span class="bound">x</span> <span class="main">&lt;#</span> <span class="free">H</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> LCOSETS_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
  <span class="keyword1"><span class="command">from</span></span> this
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span>
        <span class="keyword2"><span class="keyword">where</span></span> xcarr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span> carrier <span class="free">G</span>"</span></span>
        <span class="keyword2"><span class="keyword">and</span></span> X<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">=</span> <span class="skolem">x</span> <span class="main">&lt;#</span> <span class="free">H</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
  <span class="keyword1"><span class="command">from</span></span> subset <span class="keyword2"><span class="keyword">and</span></span> xcarr
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">⊆</span> carrier <span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> X
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> l_coset_subset_G<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> lcosets_part_G<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="free">H</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">(</span><span class="keyword1">lcosets</span> <span class="free">H</span><span class="main">)</span> <span class="main">=</span> carrier <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> subgroup <span class="quoted"><span class="free">H</span></span> <span class="quoted"><span class="free">G</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> equalityI<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LCOSETS_def l_coset_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LCOSETS_def <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> lcos_self assms<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> lcosets_subset_PowG<span class="main">:</span>
     <span class="quoted"><span class="quoted">"subgroup <span class="free">H</span> <span class="free">G</span>  <span class="main">⟹</span> <span class="keyword1">lcosets</span> <span class="free">H</span> <span class="main">⊆</span> Pow<span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LCOSETS_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> l_coset_subset_G subgroup.subset<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> lcos_disjoint<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"subgroup <span class="free">H</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> p<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="keyword1">lcosets</span> <span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> <span class="keyword1">lcosets</span> <span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∩</span> <span class="free">b</span> <span class="main">=</span> <span class="main">{}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> subgroup <span class="quoted"><span class="free">H</span></span> <span class="quoted"><span class="free">G</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fact</span>
  <span class="keyword1"><span class="command">from</span></span> p <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LCOSETS_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> inf.cobounded1 inf.cobounded2 l_repr_independence subgroup_axioms subset_empty subset_iff<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next two lemmas support the proof of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>card_cosets_equal›</span></span></span></span>.›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> inj_on_f'<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">H</span> <span class="main">⊆</span> carrier <span class="free">G</span><span class="main">;</span>  <span class="free">a</span> <span class="main">∈</span> carrier <span class="free">G</span><span class="main">⟧</span> <span class="main">⟹</span> inj_on <span class="main">(</span><span class="main">λ</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">⊗</span> <span class="keyword1">inv</span> <span class="free">a</span><span class="main">)</span> <span class="main">(</span><span class="free">a</span> <span class="main">&lt;#</span> <span class="free">H</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> inj_onI<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subgoal_tac</span> <span class="quoted"><span class="quoted">"<span class="improper">x</span> <span class="main">∈</span> carrier <span class="free">G</span> <span class="main">&amp;</span> <span class="improper">y</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span><span class="main">)</span>
 <span class="keyword1"><span class="command"><span class="improper"><span class="command">prefer</span></span></span></span> 2 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> l_coset_subset_G <span class="main"><span class="main">[</span></span><span class="operator">THEN</span> subsetD<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> subsetD<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> inj_on_f''<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">H</span> <span class="main">⊆</span> carrier <span class="free">G</span><span class="main">;</span>  <span class="free">a</span> <span class="main">∈</span> carrier <span class="free">G</span><span class="main">⟧</span> <span class="main">⟹</span> inj_on <span class="main">(</span><span class="main">λ</span><span class="bound">y</span><span class="main">.</span> <span class="keyword1">inv</span> <span class="free">a</span> <span class="main">⊗</span> <span class="bound">y</span><span class="main">)</span> <span class="main">(</span><span class="free">a</span> <span class="main">&lt;#</span> <span class="free">H</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> inj_onI<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subgoal_tac</span> <span class="quoted"><span class="quoted">"<span class="improper">x</span> <span class="main">∈</span> carrier <span class="free">G</span> <span class="main">&amp;</span> <span class="improper">y</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span><span class="main">)</span>
 <span class="keyword1"><span class="command"><span class="improper"><span class="command">prefer</span></span></span></span> 2 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> l_coset_subset_G <span class="main"><span class="main">[</span></span><span class="operator">THEN</span> subsetD<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> subsetD<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> inj_on_g'<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">H</span> <span class="main">⊆</span> carrier <span class="free">G</span><span class="main">;</span>  <span class="free">a</span> <span class="main">∈</span> carrier <span class="free">G</span><span class="main">⟧</span> <span class="main">⟹</span> inj_on <span class="main">(</span><span class="main">λ</span><span class="bound">y</span><span class="main">.</span> <span class="free">a</span> <span class="main">⊗</span> <span class="bound">y</span><span class="main">)</span> <span class="free">H</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inj_on_def subsetD<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> l_card_cosets_equal<span class="main">:</span>
     <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">c</span> <span class="main">∈</span> <span class="keyword1">lcosets</span> <span class="free">H</span><span class="main">;</span>  <span class="free">H</span> <span class="main">⊆</span> carrier <span class="free">G</span><span class="main">;</span> finite<span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span><span class="main">⟧</span>
      <span class="main">⟹</span> card <span class="free">H</span> <span class="main">=</span> card <span class="free">c</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LCOSETS_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> card_bij_eq<span class="main">)</span>
     <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> inj_on_g'<span class="main"><span class="keyword3">,</span></span> <span class="operator">assumption</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> m_assoc subsetD l_coset_def<span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> inj_on_f''<span class="main"><span class="keyword3">,</span></span> <span class="operator">assumption</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">⊆</span> carrier <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">=</span> <span class="skolem">a</span> <span class="main">&lt;#</span> <span class="free">H</span>"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">(⊗</span><span class="main">)</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">a</span><span class="main">)</span> <span class="main">`</span> <span class="main">(</span><span class="skolem">a</span> <span class="main">&lt;#</span> <span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">⊗</span> <span class="keyword1">inv</span> <span class="skolem">a</span> <span class="main">=</span> <span class="main">𝟭</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">∈</span> carrier <span class="free">G</span>›</span></span><span class="main">)</span> 
  <span class="keyword1"><span class="command">from</span></span> a <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">y</span><span class="main">.</span> <span class="main">∃</span><span class="bound">x</span><span class="main">∈</span><span class="main">⋃</span><span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> <span class="main">{</span><span class="skolem">a</span> <span class="main">⊗</span> <span class="bound">h</span><span class="main">}</span><span class="main">.</span> <span class="bound">y</span> <span class="main">=</span> <span class="keyword1">inv</span> <span class="skolem">a</span> <span class="main">⊗</span> <span class="bound">x</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> l_coset_def image_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∃</span><span class="bound">x'</span><span class="main">∈</span><span class="main">⋃</span><span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> <span class="main">{</span><span class="skolem">a</span> <span class="main">⊗</span> <span class="bound">h</span><span class="main">}</span><span class="main">.</span> <span class="skolem">x</span> <span class="main">=</span> <span class="keyword1">inv</span> <span class="skolem">a</span> <span class="main">⊗</span> <span class="bound">x'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>  
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">H</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">H</span> <span class="main">⊆</span> carrier <span class="free">G</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">∈</span> carrier <span class="free">G</span>›</span></span> is_group
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">clarify</span> <span class="main">(</span><span class="operator">metis</span> inv_solve_left m_closed subsetD<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">a</span><span class="main">.</span> <span class="free">H</span> <span class="main">⊆</span> carrier <span class="free">G</span> <span class="main">⟹</span> finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="main">⟹</span> <span class="bound">a</span> <span class="main">∈</span> carrier <span class="free">G</span> <span class="main">⟹</span> <span class="free">c</span> <span class="main">=</span> <span class="bound">a</span> <span class="main">&lt;#</span> <span class="free">H</span> <span class="main">⟹</span> finite <span class="free">H</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> rev_finite_subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">a</span><span class="main">.</span> <span class="free">H</span> <span class="main">⊆</span> carrier <span class="free">G</span> <span class="main">⟹</span> finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span> <span class="main">⟹</span> <span class="bound">a</span> <span class="main">∈</span> carrier <span class="free">G</span> <span class="main">⟹</span> <span class="free">c</span> <span class="main">=</span> <span class="bound">a</span> <span class="main">&lt;#</span> <span class="free">H</span> <span class="main">⟹</span> finite <span class="main">(</span><span class="bound">a</span> <span class="main">&lt;#</span> <span class="free">H</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> l_coset_subset_G rev_finite_subset<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group<span class="main">)</span> l_lagrange<span class="main">:</span>
     <span class="quoted"><span class="quoted">"<span class="main">⟦</span>finite<span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span><span class="main">;</span> subgroup <span class="free">H</span> <span class="free">G</span><span class="main">⟧</span>
      <span class="main">⟹</span> card<span class="main">(</span><span class="keyword1">lcosets</span> <span class="free">H</span><span class="main">)</span> <span class="main">*</span> card<span class="main">(</span><span class="free">H</span><span class="main">)</span> <span class="main">=</span> order<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">no_asm_simp</span><span class="main"><span class="main">)</span></span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> order_def lcosets_part_G <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> mult.commute<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> card_partition<span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lcosets_subset_PowG <span class="main"><span class="main">[</span></span><span class="operator">THEN</span> finite_subset<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lcosets_part_G<span class="main">)</span>
 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> l_card_cosets_equal subgroup.subset<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lcos_disjoint<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="Orbit_Stabiliser">
<div class="head">
<h1>Theory Orbit_Stabiliser</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">"Orbit-Stabiliser Theorem"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
In this Theory we will prove the orbit-stabiliser theorem, a basic result in the algebra of groups.

›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Orbit_Stabiliser
  <span class="keyword2"><span class="keyword">imports</span></span>
    <a href="Left_Coset.html">Left_Coset</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Imports"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  /HOL/Algebra/Group.thy is used for the definitions of groups and subgroups
›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  Left\_Coset.thy is a copy of /HOL/Algebra/Coset.thy that includes additional theorems about left cosets.

  The version of Coset.thy in the Isabelle library is missing some theorems about left cosets
  that are available for right cosets, so these had to be added by simply replacing the definitions
  of right cosets with those of left cosets.

  Coset.thy is used for definitions of group order, quotient groups (operator LMod), and Lagranges theorem.
›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  /HOL/Fun.thy is used for function composition and the identity function.
›</span></span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Group Actions"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  We begin by augmenting the existing definition of a group with a group action.

  The group action was defined according to <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">cite</span></span> groupaction<span class="antiquote"><span class="antiquote">}</span></span></span></span>.
›</span></span>

<span class="keyword1"><span class="command">locale</span></span> orbit_stabiliser <span class="main">=</span> group <span class="main">+</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">action</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'b</span> <span class="main">⇒</span> <span class="tfree">'b</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">⊙</span>"</span> 51<span class="main">)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> id_act <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">𝟭</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> compat_act<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> carrier <span class="free">G</span> <span class="main">∧</span> <span class="free">h</span> <span class="main">∈</span> carrier <span class="free">G</span> <span class="main">⟶</span> <span class="free">g</span> <span class="main"><span class="free">⊙</span></span> <span class="main">(</span><span class="free">h</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">g</span> <span class="main">⊗</span> <span class="free">h</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span>"</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Orbit and stabiliser"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Next, we define orbit and stabiliser, according to the same Wikipedia article.
›</span></span>

<span class="keyword1"><span class="command">context</span></span> orbit_stabiliser
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">orbit</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'b</span> <span class="main">⇒</span> <span class="tfree">'b</span> set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">orbit</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="main">{</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">g</span> <span class="main">∈</span> carrier <span class="free">G</span><span class="main">.</span> <span class="bound">y</span> <span class="main">=</span> <span class="bound">g</span> <span class="main"><span class="free">⊙</span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">stabiliser</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'b</span> <span class="main">⇒</span> <span class="tfree">'a</span> set"</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">stabiliser</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="main">{</span><span class="bound"><span class="bound">g</span></span> <span class="main">∈</span> carrier <span class="free">G</span><span class="main">.</span> <span class="bound">g</span> <span class="main"><span class="free">⊙</span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">}</span>"</span></span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Stabiliser Theorems"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
We begin our proofs by showing that the stabiliser forms a subgroup.

This proof follows the template from  <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">cite</span></span> stabsub<span class="antiquote"><span class="antiquote">}</span></span></span></span>.
›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> stabiliser_subgroup<span class="main">:</span> <span class="quoted"><span class="quoted">"subgroup <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> subgroupI<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"stabiliser <span class="free">x</span> <span class="main">⊆</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> stabiliser_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">from</span></span> id_act <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">𝟭</span> <span class="main"><span class="free">⊙</span></span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">𝟭</span> <span class="main">∈</span> stabiliser <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> stabiliser_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"stabiliser <span class="skolem">x</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> gStab<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> stabiliser <span class="skolem">x</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> g_car<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> stabiliser_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> invg_car<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="skolem">g</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inv_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main"><span class="free">⊙</span></span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> stabiliser_def gStab <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="skolem">g</span> <span class="main"><span class="free">⊙</span></span> <span class="main">(</span><span class="skolem">g</span> <span class="main"><span class="free">⊙</span></span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1">inv</span> <span class="skolem">g</span> <span class="main"><span class="free">⊙</span></span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">g</span> <span class="main">⊗</span> <span class="skolem">g</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="skolem">x</span> <span class="main">=</span> <span class="keyword1">inv</span> <span class="skolem">g</span> <span class="main"><span class="free">⊙</span></span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compat_act g_car invg_car <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="skolem">g</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> g_car l_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="skolem">g</span> <span class="main">∈</span> stabiliser <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> invg_car stabiliser_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span> <span class="skolem">h</span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> g_stab<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> stabiliser <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> h_stab<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> stabiliser <span class="skolem">x</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> g_car<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> h_car<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> stabiliser_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main"><span class="free">⊙</span></span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main"><span class="free">⊙</span></span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> stabiliser_def g_stab h_stab <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main"><span class="free">⊙</span></span> <span class="main">(</span><span class="skolem">h</span> <span class="main"><span class="free">⊙</span></span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">g</span> <span class="main">⊗</span> <span class="skolem">h</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compat_act g_car h_car <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">g</span> <span class="main">⊗</span> <span class="skolem">h</span><span class="main">)</span> <span class="main">∈</span> stabiliser <span class="skolem">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> g_stab h_stab stabiliser_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
As an intermediate step we formulate a lemma about the relationship between the group action
and the stabiliser.

This proof follows the template from <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">cite</span></span> stabsubcor<span class="antiquote"><span class="antiquote">}</span></span></span></span>.
›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> stabiliser_subgroup_corollary<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> g_car<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    h_car<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">g</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">h</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">inv</span> <span class="free">g</span><span class="main">)</span> <span class="main">⊗</span> <span class="free">h</span><span class="main">)</span> <span class="main">∈</span> stabiliser <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> g_car <span class="keyword1"><span class="command">have</span></span> invg_car<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">inv</span> <span class="free">g</span><span class="main">)</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">g</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">h</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span> <span class="main">⟹</span> <span class="keyword1">inv</span> <span class="free">g</span> <span class="main">⊗</span> <span class="free">h</span> <span class="main">∈</span> stabiliser <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> gh<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">g</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">h</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="keyword1">inv</span> <span class="free">g</span><span class="main">)</span> <span class="main">⊗</span> <span class="free">h</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="free">g</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="main">(</span><span class="free">h</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms compat_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">inv</span> <span class="free">g</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="main">(</span><span class="free">h</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="free">g</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="main">(</span><span class="free">g</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> gh <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">inv</span> <span class="free">g</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="main">(</span><span class="free">g</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">inv</span> <span class="free">g</span><span class="main">)</span> <span class="main">⊗</span> <span class="free">g</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> invg_car g_car compat_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="keyword1">inv</span> <span class="free">g</span><span class="main">)</span> <span class="main">⊗</span> <span class="free">g</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> g_car <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="keyword1">inv</span> <span class="free">g</span><span class="main">)</span> <span class="main">⊗</span> <span class="free">h</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> stabiliser_def assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="free">g</span> <span class="main">⊗</span> <span class="free">h</span> <span class="main">∈</span> stabiliser <span class="free">x</span> <span class="main">⟹</span> <span class="free">g</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span> <span class="main">=</span> <span class="free">h</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> gh_stab<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1">inv</span> <span class="free">g</span> <span class="main">⊗</span> <span class="free">h</span> <span class="main">∈</span> stabiliser <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> stabiliser_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">inv</span> <span class="free">g</span><span class="main">)</span> <span class="main">⊗</span> <span class="free">h</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">𝟭</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">inv</span> <span class="free">g</span><span class="main">)</span> <span class="main">⊗</span> <span class="free">h</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span>"</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="keyword1">inv</span> <span class="free">g</span><span class="main">)</span> <span class="main">⊗</span> <span class="free">g</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="keyword1">inv</span> <span class="free">g</span><span class="main">)</span> <span class="main">⊗</span> <span class="free">h</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> invg_car g_car <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="free">g</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="main">(</span><span class="free">h</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compat_act g_car h_car <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">g</span> <span class="main">⊗</span> <span class="main">(</span><span class="keyword1">inv</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="main">(</span><span class="free">h</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compat_act g_car invg_car <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span> <span class="main">=</span> <span class="free">h</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> compat_act g_car id_act invg_car r_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Using the previous lemma and our proof that the stabiliser forms a subgroup, we can now
show that the elements of the orbit map to left cosets of the stabiliser.

This will later form the basis of showing a bijection between the orbit and those cosets.
›</span></span>

<span class="keyword1" id="Orbit_Stabiliser-stabiliser_cosets_equivalent"><span class="command">lemma</span></span> stabiliser_cosets_equivalent<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> g_car<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    h_car<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">g</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">h</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="free">g</span> <span class="main">&lt;#</span> stabiliser <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">h</span> <span class="main">&lt;#</span> stabiliser <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span> <span class="main">=</span> <span class="free">h</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">g</span> <span class="main">&lt;#</span> stabiliser <span class="free">x</span> <span class="main">=</span> <span class="free">h</span> <span class="main">&lt;#</span> stabiliser <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span> <span class="main">=</span> <span class="free">h</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> stab_elem<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="keyword1">inv</span> <span class="free">g</span><span class="main">)</span> <span class="main">⊗</span> <span class="free">h</span><span class="main">)</span> <span class="main">∈</span> stabiliser <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms stabiliser_subgroup_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> subgroup.lcos_module_rev<span class="main">[</span><span class="operator">OF</span> stabiliser_subgroup<span class="main">]</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> <span class="free">g</span> <span class="main">&lt;#</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms is_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> l_repr_independence <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">&lt;#</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">h</span> <span class="main">&lt;#</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms  stab_elem stabiliser_subgroup <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">&lt;#</span> stabiliser <span class="free">x</span> <span class="main">=</span> <span class="free">h</span> <span class="main">&lt;#</span> stabiliser <span class="free">x</span> <span class="main">⟹</span> <span class="free">g</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span> <span class="main">=</span> <span class="free">h</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">&lt;#</span> stabiliser <span class="free">x</span> <span class="main">=</span> <span class="free">h</span> <span class="main">&lt;#</span> stabiliser <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> subgroup.lcos_module_rev<span class="main">[</span><span class="operator">OF</span> stabiliser_subgroup<span class="main">]</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">h</span> <span class="main">∈</span> <span class="free">g</span> <span class="main">&lt;#</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms is_group l_inv stabiliser_subgroup subgroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">with</span></span> subgroup.lcos_module_imp<span class="main">[</span><span class="operator">OF</span> stabiliser_subgroup<span class="main">]</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="keyword1">inv</span> <span class="free">g</span><span class="main">)</span> <span class="main">⊗</span> <span class="free">h</span><span class="main">)</span> <span class="main">∈</span> stabiliser <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms is_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> stabiliser_subgroup_corollary <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span> <span class="main">=</span> <span class="free">h</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Picking representatives from cosets"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Before we can prove the bijection, we need a few lemmas about representatives from sets.

First we define rep to be an arbitrary element from a left coset of the stabiliser.
›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">rep</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">∈</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">LMod</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">rep</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  The next lemma shows that the representative is always an element of its coset.
›</span></span>
<span class="keyword1" id="Orbit_Stabiliser-quotient_rep_ex"><span class="command">lemma</span></span> quotient_rep_ex  <span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∈</span> <span class="main">(</span>carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">LMod</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> rep <span class="free">H</span> <span class="main">∈</span> <span class="free">H</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">H</span>
  <span class="keyword3"><span class="command">assume</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">∈</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">LMod</span> stabiliser <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">=</span> <span class="skolem">g</span> <span class="main">&lt;#</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> LFactGroup_def LCOSETS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="skolem">H</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lcos_self stabiliser_subgroup someI_ex <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"rep <span class="skolem">H</span> <span class="main">∈</span> <span class="skolem">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> H rep_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
The final lemma about representatives shows that it does not matter which element of the coset
is picked, i.e. all representatives are equivalent.
›</span></span>
<span class="keyword1" id="Orbit_Stabiliser-rep_equivalent"><span class="command">lemma</span></span> rep_equivalent<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">∈</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">LMod</span> stabiliser <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    gH<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">=</span> <span class="free">g</span> <span class="main">&lt;#</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h</span>
  <span class="keyword1"><span class="command">from</span></span> H <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="keyword2"><span class="keyword">where</span></span> hG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> H2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">=</span> <span class="skolem">h</span> <span class="main">&lt;#</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> LFactGroup_def LCOSETS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> H gH <span class="keyword1"><span class="command">have</span></span> gh<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> <span class="skolem">h</span> <span class="main">&lt;#</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> l_repr_independence <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">&lt;#</span> stabiliser <span class="free">x</span> <span class="main">=</span> <span class="free">g</span> <span class="main">&lt;#</span> stabiliser <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> hG gh stabiliser_subgroup <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> H2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="main">=</span> <span class="free">g</span> <span class="main">&lt;#</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Orbit-Stabiliser Theorem"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  We can now establish the bijection between orbit(x) and the quotient group G/(stabiliser(x))

  The idea for this bijection is from <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">cite</span></span> orbitstab<span class="antiquote"><span class="antiquote">}</span></span></span></span>
›</span></span>
<span class="keyword1"><span class="command">theorem</span></span> orbit_stabiliser_bij<span class="main">:</span>
  <span class="quoted"><span class="quoted">"bij_betw <span class="main">(</span><span class="main">λ</span><span class="bound">H</span><span class="main">.</span> rep <span class="bound">H</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">LMod</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>orbit <span class="free">x</span><span class="main">)</span> "</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> bij_betw_imageI<span class="main">)</span>
  <span class="comment1">(* show the function is injective *)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"inj_on <span class="main">(</span><span class="main">λ</span><span class="bound">H</span><span class="main">.</span> rep <span class="bound">H</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span> <span class="main">(</span>carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">LMod</span> stabiliser <span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> inj_onI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">H</span> <span class="skolem">H'</span>
    <span class="keyword3"><span class="command">assume</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">∈</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">LMod</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">assume</span></span> H'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">H'</span> <span class="main">∈</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">LMod</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="skolem"><span class="skolem">h'</span></span> <span class="keyword2"><span class="keyword">where</span></span>  h<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">=</span> rep <span class="skolem">H</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> h'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h'</span> <span class="main">=</span> rep <span class="skolem">H'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">assume</span></span> act_equal<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>rep <span class="skolem">H</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span>rep <span class="skolem">H'</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> H h quotient_rep_ex <span class="keyword1"><span class="command">have</span></span> hH<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> <span class="skolem">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> H' h' quotient_rep_ex <span class="keyword1"><span class="command">have</span></span> hH'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h'</span> <span class="main">∈</span> <span class="skolem">H'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> subgroup.lcosets_carrier<span class="main">[</span><span class="operator">OF</span> stabiliser_subgroup is_group<span class="main">]</span> H <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">⊆</span> carrier <span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> LFactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> hG<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> hH <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> subgroup.lcosets_carrier<span class="main">[</span><span class="operator">OF</span> stabiliser_subgroup is_group<span class="main">]</span> H' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">H'</span> <span class="main">⊆</span> carrier <span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> LFactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> h'G<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h'</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> hH' <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

        <span class="comment1">(* Apply lemma about equivalent cosets *)</span>
    <span class="keyword1"><span class="command">have</span></span> hh'_equiv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">&lt;#</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">h'</span> <span class="main">&lt;#</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> hG h'G h h' act_equal stabiliser_cosets_equivalent <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

    <span class="keyword1"><span class="command">from</span></span> hh'_equiv <span class="keyword1"><span class="command">have</span></span> H2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">=</span> <span class="skolem">h</span> <span class="main">&lt;#</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> H hH rep_equivalent <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> hh'_equiv <span class="keyword1"><span class="command">have</span></span> H3<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">H'</span> <span class="main">=</span> <span class="skolem">h</span> <span class="main">&lt;#</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> H' hH' rep_equivalent <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">=</span> <span class="skolem">H'</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> H2 H3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">H</span><span class="main">.</span> rep <span class="bound">H</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span> <span class="main">`</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">LMod</span> stabiliser <span class="free">x</span><span class="main">)</span> <span class="main">=</span> orbit <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span><span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">H</span><span class="main">.</span> <span class="bound">H</span> <span class="main">∈</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">LMod</span> stabiliser <span class="free">x</span><span class="main">)</span> <span class="main">⟹</span> rep <span class="bound">H</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span> <span class="main">∈</span> orbit <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">H</span>
      <span class="keyword3"><span class="command">assume</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">∈</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">LMod</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="keyword2"><span class="keyword">where</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">=</span> rep <span class="skolem">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> H h quotient_rep_ex <span class="keyword1"><span class="command">have</span></span> hH<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> <span class="skolem">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span> stab_sub<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span> <span class="main">⊆</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> stabiliser_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> subgroup.lcosets_carrier<span class="main">[</span><span class="operator">OF</span> stabiliser_subgroup is_group<span class="main">]</span> H <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">⊆</span> carrier <span class="free">G</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> LFactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> hH <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>rep <span class="skolem">H</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span> <span class="main">∈</span> orbit <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> h orbit_def mem_Collect_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">y</span><span class="main">.</span> <span class="bound">y</span> <span class="main">∈</span> orbit <span class="free">x</span> <span class="main">⟹</span> <span class="bound">y</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span><span class="bound">H</span><span class="main">.</span> rep <span class="bound">H</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span> <span class="main">`</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">LMod</span> stabiliser <span class="free">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span>
      <span class="keyword3"><span class="command">assume</span></span> y<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> orbit <span class="free">x</span>"</span></span>
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span>  <span class="keyword2"><span class="keyword">where</span></span> gG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> <span class="skolem">g</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> y orbit_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">H</span></span> <span class="keyword2"><span class="keyword">where</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">=</span> <span class="skolem">g</span> <span class="main">&lt;#</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> gG <span class="keyword1"><span class="command">have</span></span> H_carr<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">∈</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">LMod</span> stabiliser <span class="free">x</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> LFactGroup_def LCOSETS_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rep <span class="skolem">H</span> <span class="main">∈</span> <span class="skolem">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> quotient_rep_ex <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="keyword2"><span class="keyword">where</span></span> h_stab<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> stabiliser <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> gh<span class="main">:</span><span class="quoted"><span class="quoted">"rep <span class="skolem">H</span> <span class="main">=</span> <span class="skolem">g</span> <span class="main">⊗</span> <span class="skolem">h</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> H l_coset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> hG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> carrier <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> h_stab stabiliser_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> stabiliser_def h_stab <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="skolem">g</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> <span class="skolem">g</span> <span class="main"><span class="free">⊙</span></span> <span class="main">(</span><span class="skolem">h</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">g</span> <span class="main">⊗</span> <span class="skolem">h</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> gG hG compat_act <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> <span class="main">(</span>rep <span class="skolem">H</span><span class="main">)</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> gh <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="main">(</span><span class="main">λ</span><span class="bound">H</span><span class="main">.</span> rep <span class="bound">H</span> <span class="main"><span class="free">⊙</span></span> <span class="free">x</span><span class="main">)</span> <span class="main">`</span> carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">LMod</span> stabiliser <span class="free">x</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> H_carr <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹
  The actual orbit-stabiliser theorem is a consequence of the bijection
   we established in the previous theorem and of Lagrange's theorem
›</span></span>
<span class="keyword1"><span class="command">theorem</span></span> orbit_stabiliser<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> finite<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier <span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"order <span class="free">G</span> <span class="main">=</span> card <span class="main">(</span>orbit <span class="free">x</span><span class="main">)</span> <span class="main">*</span> card <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">LMod</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> card <span class="main">(</span>orbit <span class="free">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> bij_betw_same_card orbit_stabiliser_bij <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>carrier <span class="main">(</span><span class="free">G</span> <span class="keyword1">LMod</span> <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> card <span class="main">(</span>stabiliser <span class="free">x</span><span class="main">)</span>  <span class="main">=</span> order <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> finite stabiliser_subgroup l_lagrange <span class="keyword1"><span class="command">unfolding</span></span> LFactGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="Tetrahedron">
<div class="head">
<h1>Theory Tetrahedron</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">"Rotational Symmetries of the Tetrahedron"</span></span>

<span class="keyword1"><span class="command">theory</span></span> Tetrahedron
<span class="keyword2"><span class="keyword">imports</span></span> <a href="Orbit_Stabiliser.html">Orbit_Stabiliser</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Definition of the Tetrahedron and its Rotations"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  In this section we will use the orbit-stabiliser theorem to count the number of rotational symmetries
  of a tetrahedron.

  The tetrahedron will be defined as a set of four vertices, labelled A, B, C, and D. A rotation
  is defined as a function between the vertices.
›</span></span>

<span class="keyword1"><span class="command">datatype</span></span> Vertex <span class="main">=</span> A <span class="main">|</span> B <span class="main">|</span> C <span class="main">|</span> D
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">vertices</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"Vertex set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">vertices</span> <span class="main">=</span> <span class="main">{</span>A<span class="main">,</span> B<span class="main">,</span> C<span class="main">,</span> D<span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">type_synonym</span></span> Rotation <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Vertex <span class="main">⇒</span> Vertex<span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
We define four primitive rotations explicitly. The axis of each rotation is the line through a vertex
that is perpendicular to the face opposite to the vertex. Every rotation is by 120 degrees counter clockwise.

We also define the identity as a possible rotation.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">rotate_A</span> <span class="main">::</span> <span class="quoted">Rotation</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">rotate_A</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">v</span><span class="main">.</span> <span class="main">(</span><span class="keyword1">case</span> <span class="bound">v</span> <span class="keyword1">of</span> A <span class="main">⇒</span> A <span class="main">|</span> B <span class="main">⇒</span> C <span class="main">|</span> C <span class="main">⇒</span> D <span class="main">|</span> D <span class="main">⇒</span> B<span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">rotate_B</span> <span class="main">::</span> <span class="quoted">Rotation</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">rotate_B</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">v</span><span class="main">.</span> <span class="main">(</span><span class="keyword1">case</span> <span class="bound">v</span> <span class="keyword1">of</span> A <span class="main">⇒</span> D <span class="main">|</span> B <span class="main">⇒</span> B <span class="main">|</span> C <span class="main">⇒</span> A <span class="main">|</span> D <span class="main">⇒</span> C<span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">rotate_C</span> <span class="main">::</span> <span class="quoted">Rotation</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">rotate_C</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">v</span><span class="main">.</span> <span class="main">(</span><span class="keyword1">case</span> <span class="bound">v</span> <span class="keyword1">of</span> A <span class="main">⇒</span> B <span class="main">|</span> B <span class="main">⇒</span> D <span class="main">|</span> C <span class="main">⇒</span> C <span class="main">|</span> D <span class="main">⇒</span> A<span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">rotate_D</span> <span class="main">::</span> <span class="quoted">Rotation</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">rotate_D</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">v</span><span class="main">.</span> <span class="main">(</span><span class="keyword1">case</span> <span class="bound">v</span> <span class="keyword1">of</span> A <span class="main">⇒</span> C <span class="main">|</span> B <span class="main">⇒</span> A <span class="main">|</span> C <span class="main">⇒</span> B <span class="main">|</span> D <span class="main">⇒</span> D<span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">named_theorems</span></span> simple_rotations
<span class="keyword1"><span class="command">declare</span></span> rotate_A_def <span class="main">[</span><span class="operator">simple_rotations</span><span class="main">]</span> rotate_B_def <span class="main">[</span><span class="operator">simple_rotations</span><span class="main">]</span> rotate_C_def <span class="main">[</span><span class="operator">simple_rotations</span><span class="main">]</span> rotate_D_def <span class="main">[</span><span class="operator">simple_rotations</span><span class="main">]</span> 

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">simple_rotations</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"Rotation set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">simple_rotations</span> <span class="main">=</span> <span class="main">{</span>id<span class="main">,</span> rotate_A<span class="main">,</span> rotate_B<span class="main">,</span> rotate_C<span class="main">,</span> rotate_D<span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
All other rotations are combinations of the previously defined simple rotations. We define these
inductively.
›</span></span>
<span class="keyword1"><span class="command">inductive_set</span></span> <span class="entity">complex_rotations</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"Rotation set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  simp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">∈</span> simple_rotations <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">∈</span> <span class="free">complex_rotations</span>"</span></span> <span class="main">|</span>
  comp<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">∈</span> simple_rotations <span class="main">⟹</span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="main">∈</span> <span class="free">complex_rotations</span> <span class="main">⟹</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">∘</span> <span class="free"><span class="bound"><span class="entity">s</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">complex_rotations</span>"</span></span>
  
<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Properties of Rotations"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
In this section we prove some basic properties of rotations that will be useful later.
We begin by showing that rotations are bijections.
›</span></span>

<span class="keyword1" id="Tetrahedron-simple_rotations_inj"><span class="command">lemma</span></span> simple_rotations_inj<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> r<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> simple_rotations"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"inj <span class="free">r</span>"</span></span>  
  <span class="keyword1"><span class="command">using</span></span> r <span class="keyword1"><span class="command">unfolding</span></span> simple_rotations_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">safe</span>
     <span class="main">(</span><span class="operator">rule</span> injI<span class="main"><span class="keyword3">;</span></span> <span class="operator">rename_tac</span> a b<span class="main"><span class="keyword3">;</span></span> <span class="operator">case_tac</span> <span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper">a</span></span></span></span></span></span></span></span></span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">case_tac</span> <span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper">b</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="main"><span class="keyword3">;</span></span>
      <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">simple_rotations</span></span>
     <span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1" id="Tetrahedron-simple_rotations_surj"><span class="command">lemma</span></span> simple_rotations_surj<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> r<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> simple_rotations"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"surj <span class="free">r</span>"</span></span>  
  <span class="keyword1"><span class="command">using</span></span> r <span class="keyword1"><span class="command">unfolding</span></span> simple_rotations_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">safe</span>
     <span class="main">(</span><span class="operator">rename_tac</span> a<span class="main"><span class="keyword3">;</span></span> <span class="operator">case_tac</span> <span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper">a</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="main"><span class="keyword3">;</span></span>
      <span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">simple_rotations</span></span> Vertex.split
     <span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1" id="Tetrahedron-simple_rotations_bij"><span class="command">lemma</span></span> simple_rotations_bij<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> r<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> simple_rotations"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"bij <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> r bij_def simple_rotations_surj simple_rotations_inj<span class="main">)</span>

<span class="keyword1" id="Tetrahedron-complex_rotations_bij"><span class="command">lemma</span></span> complex_rotations_bij<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> complex_rotations <span class="main">⟹</span> bij <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">r</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> complex_rotations.induct<span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>simp <span class="skolem">r</span><span class="main">)</span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> simple_rotations_bij <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>comp <span class="skolem">r</span> <span class="skolem">s</span><span class="main">)</span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> bij_comp simple_rotations_bij <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Tetrahedron-simple_rotation_bij_corollary"><span class="command">lemma</span></span> simple_rotation_bij_corollary<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> simple_rotations <span class="main">⟹</span> <span class="free">r</span> <span class="free">x</span> <span class="main">≠</span> <span class="free">r</span> <span class="free">y</span> <span class="main">⟷</span> <span class="free">x</span> <span class="main">≠</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> bij_def simple_rotations_bij inj_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>

<span class="keyword1" id="Tetrahedron-rotation_bij_corollary"><span class="command">lemma</span></span> rotation_bij_corollary<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> complex_rotations <span class="main">⟹</span> <span class="free">r</span> <span class="free">x</span> <span class="main">≠</span> <span class="free">r</span> <span class="free">y</span> <span class="main">⟷</span> <span class="free">x</span> <span class="main">≠</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> bij_def complex_rotations_bij inj_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    
<span class="keyword1" id="Tetrahedron-complex_rotations_comp"><span class="command">lemma</span></span> complex_rotations_comp<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> complex_rotations <span class="main">⟹</span> <span class="free">s</span> <span class="main">∈</span> complex_rotations <span class="main">⟹</span> <span class="main">(</span><span class="free">r</span> <span class="main">∘</span> <span class="free">s</span><span class="main">)</span> <span class="main">∈</span> complex_rotations"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">induction</span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">s</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> complex_rotations.induct<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> comp_assoc complex_rotations.comp<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
    
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Next, we show that simple rotations (except the identity) keep exactly one vertex fixed.
›</span></span>    

<span class="keyword1" id="Tetrahedron-simple_rotations_fix"><span class="command">lemma</span></span> simple_rotations_fix<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> r<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> simple_rotations"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">v</span><span class="main">.</span> <span class="free">r</span> <span class="bound">v</span> <span class="main">=</span> <span class="bound">v</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> r <span class="keyword1"><span class="command">unfolding</span></span> simple_rotations_def 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">simple_rotations</span></span> <span class="quasi_keyword">split</span><span class="main"><span class="main">:</span></span> Vertex.split<span class="main">)</span>

<span class="keyword1" id="Tetrahedron-simple_rotations_fix_unique"><span class="command">lemma</span></span> simple_rotations_fix_unique<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> r<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> simple_rotations"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">≠</span> id <span class="main">⟹</span> <span class="free">r</span> <span class="free">v</span> <span class="main">=</span> <span class="free">v</span> <span class="main">⟹</span> <span class="free">r</span> <span class="free">w</span> <span class="main">=</span> <span class="free">w</span> <span class="main">⟹</span> <span class="free">v</span> <span class="main">=</span> <span class="free">w</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> r <span class="keyword1"><span class="command">unfolding</span></span> simple_rotations_def 
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">safe</span> 
     <span class="main">(</span><span class="operator">case_tac</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free">v</span></span></span></span></span></span></span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">case_tac</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free">w</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="main"><span class="keyword3">;</span></span> 
      <span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">simple_rotations</span></span>
     <span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
   
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
We also show that simple rotations do not contain cycles of length 2. 
›</span></span>  
   
<span class="keyword1" id="Tetrahedron-simple_rotations_cycle"><span class="command">lemma</span></span> simple_rotations_cycle<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> r<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> simple_rotations"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">≠</span> id <span class="main">⟹</span> <span class="free">r</span> <span class="free">v</span> <span class="main">=</span> <span class="free">w</span> <span class="main">⟹</span> <span class="free">v</span> <span class="main">≠</span> <span class="free">w</span> <span class="main">⟹</span> <span class="free">r</span> <span class="free">w</span> <span class="main">≠</span> <span class="free">v</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> r <span class="keyword1"><span class="command">unfolding</span></span> simple_rotations_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">safe</span>
     <span class="main">(</span><span class="operator">case_tac</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free">v</span></span></span></span></span></span></span></span><span class="main"><span class="keyword3">;</span></span>
      <span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">simple_rotations</span></span>
     <span class="main">)</span><span class="main"><span class="keyword3">+</span></span> 

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
The following lemmas are all variations on the fact that any property that holds for 4 distinct
vertices holds for all vertices. This is necessary to avoid having to use Vertex.exhaust as much
as possible.
›</span></span>  
   
<span class="keyword1" id="Tetrahedron-distinct_vertices"><span class="command">lemma</span></span> distinct_vertices<span class="main">:</span> <span class="quoted"><span class="quoted">"distinct<span class="main">[</span><span class="main">(</span><span class="free">a</span><span class="main">::</span>Vertex<span class="main">)</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">]</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">e</span><span class="main">.</span> <span class="bound">e</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">}</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">safe</span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">case_tac</span> <span class="quoted"><span class="free">a</span></span><span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> distinct_def<span class="main">)</span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">metis</span> Vertex.exhaust<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
<span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>  
  
<span class="keyword1" id="Tetrahedron-distinct_map"><span class="command">lemma</span></span> distinct_map<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> complex_rotations <span class="main">⟹</span> distinct<span class="main">[</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">]</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">e</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">.</span> <span class="free">r</span> <span class="bound">e</span> <span class="main">≠</span> <span class="free">f</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">r</span> <span class="free">d</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> r<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> complex_rotations"</span></span> <span class="keyword2"><span class="keyword">and</span></span> dist<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">]</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> notf<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">e</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">.</span> <span class="free">r</span> <span class="bound">e</span> <span class="main">≠</span> <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span> <span class="bound">v</span><span class="main">.</span> <span class="bound">v</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> distinct_vertices <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> complex_rotations_bij <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">v</span><span class="main">.</span> <span class="free">r</span> <span class="bound">v</span> <span class="main">=</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> r bij_pointE <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">v</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">}</span><span class="main">.</span> <span class="free">r</span> <span class="bound">v</span> <span class="main">=</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="free">d</span> <span class="main">=</span> <span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> notf <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="Tetrahedron-distinct_map'"><span class="command">lemma</span></span> distinct_map'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> complex_rotations <span class="main">⟹</span> distinct<span class="main">[</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">]</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">e</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">.</span> <span class="free">r</span> <span class="free">f</span> <span class="main">≠</span> <span class="bound">e</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">r</span> <span class="free">f</span> <span class="main">=</span> <span class="free">d</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> r<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> complex_rotations"</span></span> <span class="keyword2"><span class="keyword">and</span></span> dist<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">]</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> notf<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">e</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">.</span> <span class="free">r</span> <span class="free">f</span> <span class="main">≠</span> <span class="bound">e</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span> <span class="bound">v</span><span class="main">.</span> <span class="bound">v</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> distinct_vertices <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">v</span><span class="main">.</span> <span class="free">r</span> <span class="free">f</span> <span class="main">=</span> <span class="bound">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">v</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">}</span><span class="main">.</span> <span class="free">r</span> <span class="free">f</span> <span class="main">=</span> <span class="bound">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="free">f</span> <span class="main">=</span> <span class="free">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> notf <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span> 
  
<span class="keyword1" id="Tetrahedron-cycle_map"><span class="command">lemma</span></span> cycle_map<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> complex_rotations <span class="main">⟹</span> distinct<span class="main">[</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">]</span> <span class="main">⟹</span> 
  <span class="free">r</span> <span class="free">a</span> <span class="main">=</span> <span class="free">b</span> <span class="main">⟹</span> <span class="free">r</span> <span class="free">b</span> <span class="main">=</span> <span class="free">a</span> <span class="main">⟹</span> <span class="free">r</span> <span class="free">c</span> <span class="main">=</span> <span class="free">d</span> <span class="main">⟹</span> <span class="free">r</span> <span class="free">d</span> <span class="main">=</span> <span class="free">c</span> <span class="main">⟹</span> <span class="main">∀</span> <span class="bound">v</span> <span class="bound">w</span><span class="main">.</span> <span class="free">r</span> <span class="bound">v</span> <span class="main">=</span> <span class="bound">w</span> <span class="main">⟶</span> <span class="free">r</span> <span class="bound">w</span> <span class="main">=</span> <span class="bound">v</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> distinct_map' rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  
<span class="keyword1" id="Tetrahedron-simple_distinct_map"><span class="command">lemma</span></span> simple_distinct_map<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> simple_rotations <span class="main">⟹</span> distinct<span class="main">[</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">]</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">e</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">.</span> <span class="free">r</span> <span class="bound">e</span> <span class="main">≠</span> <span class="free">f</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">r</span> <span class="free">d</span> <span class="main">=</span> <span class="free">f</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> complex_rotations.simp distinct_map <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Tetrahedron-simple_distinct_map'"><span class="command">lemma</span></span> simple_distinct_map'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> simple_rotations <span class="main">⟹</span> distinct<span class="main">[</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">]</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">e</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">.</span> <span class="free">r</span> <span class="free">f</span> <span class="main">≠</span> <span class="bound">e</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">r</span> <span class="free">f</span> <span class="main">=</span> <span class="free">d</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> complex_rotations.simp distinct_map' <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  
<span class="keyword1" id="Tetrahedron-simple_distinct_ident"><span class="command">lemma</span></span> simple_distinct_ident<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> simple_rotations <span class="main">⟹</span> distinct<span class="main">[</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">]</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">e</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">.</span> <span class="free">r</span> <span class="bound">e</span> <span class="main">≠</span> <span class="bound">e</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">r</span> <span class="free">d</span> <span class="main">=</span> <span class="free">d</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> simple_rotations_fix simple_distinct_map' <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>

<span class="keyword1" id="Tetrahedron-id_decomp"><span class="command">lemma</span></span> id_decomp<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> distinct<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="main">(</span><span class="free">a</span><span class="main">::</span>Vertex<span class="main">)</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">]</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ident<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">}</span><span class="main">.</span> <span class="free">r</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> id"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> distinct_vertices <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">e</span><span class="main">.</span> <span class="bound">e</span> <span class="main">∈</span> set <span class="main">[</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">,</span><span class="free">d</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> distinct <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">e</span><span class="main">.</span> <span class="free">r</span> <span class="bound">e</span> <span class="main">=</span> <span class="bound">e</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ident <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> id"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span> 
 
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Here we show that two invariants hold for rotations. Firstly, any rotation that does not fix a vertex consists
of 2-cycles. Secondly, the only rotation that fixes more than one vertex is the identity.

This proof is very long in part because both invariants have to be proved simultaneously because
they depend on each other.
›</span></span>    
  
<span class="keyword1" id="Tetrahedron-complex_rotations_invariants"><span class="command">lemma</span></span> complex_rotations_invariants<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> complex_rotations <span class="main">⟹</span> <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="main">∀</span> <span class="bound">v</span><span class="main">.</span> <span class="free">r</span> <span class="bound">v</span> <span class="main">≠</span> <span class="bound">v</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">r</span> <span class="free">v</span> <span class="main">=</span> <span class="free">w</span> <span class="main">⟶</span> <span class="free">r</span> <span class="free">w</span> <span class="main">=</span> <span class="free">v</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="free">r</span> <span class="free">v</span> <span class="main">=</span> <span class="free">v</span> <span class="main">⟶</span> <span class="free">r</span> <span class="free">w</span> <span class="main">=</span> <span class="free">w</span> <span class="main">⟶</span> <span class="free">v</span> <span class="main">≠</span> <span class="free">w</span> <span class="main">⟶</span> <span class="free">r</span> <span class="main">=</span> id<span class="main">)</span><span class="main">)</span> "</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">r</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">v</span></span> <span class="quoted"><span class="free">w</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> complex_rotations.induct<span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>simp <span class="skolem">r</span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> r<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> simple_rotations"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">v</span><span class="main">.</span> <span class="skolem">r</span> <span class="bound">v</span> <span class="main">=</span> <span class="bound">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_rotations_fix r <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">v</span><span class="main">.</span> <span class="skolem">r</span> <span class="bound">v</span> <span class="main">≠</span> <span class="bound">v</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span> <span class="bound">v</span><span class="main">.</span> <span class="skolem">r</span> <span class="bound">v</span> <span class="main">≠</span> <span class="bound">v</span><span class="main">)</span> <span class="main">⟶</span> <span class="skolem">r</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">w</span> <span class="main">⟶</span> <span class="skolem">r</span> <span class="skolem">w</span> <span class="main">=</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">v</span> <span class="main">⟶</span> <span class="skolem">r</span> <span class="skolem">w</span> <span class="main">=</span> <span class="skolem">w</span> <span class="main">⟶</span> <span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span> <span class="main">⟶</span> <span class="skolem">r</span> <span class="main">=</span> id"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_rotations_fix_unique simp <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>comp <span class="skolem">r</span> <span class="skolem">s</span><span class="main">)</span>  
  <span class="keyword3"><span class="command">assume</span></span> r<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∈</span> simple_rotations"</span></span>
  <span class="keyword3"><span class="command">assume</span></span> s<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">∈</span> complex_rotations"</span></span>
  <span class="keyword1"><span class="command">have</span></span> fix_unique<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">v</span> <span class="bound">w</span><span class="main">.</span> <span class="skolem">s</span> <span class="bound">v</span> <span class="main">=</span> <span class="bound">v</span> <span class="main">⟶</span> <span class="skolem">s</span> <span class="bound">w</span> <span class="main">=</span> <span class="bound">w</span> <span class="main">⟶</span> <span class="bound">v</span> <span class="main">≠</span> <span class="bound">w</span> <span class="main">⟶</span> <span class="skolem">s</span> <span class="main">=</span> id"</span></span> <span class="keyword1"><span class="command">using</span></span> comp <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> 
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="bound">x</span> <span class="main">≠</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">w</span> <span class="main">⟶</span> <span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">w</span> <span class="main">=</span> <span class="skolem">v</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
      <span class="keyword3"><span class="command">assume</span></span> nofixrs<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span><span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="bound">x</span> <span class="main">≠</span> <span class="bound">x</span>"</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">w</span>"</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">w</span> <span class="main">=</span> <span class="skolem">v</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">s</span> <span class="bound">x</span> <span class="main">≠</span> <span class="bound">x</span>"</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> nofixs<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">s</span> <span class="bound">x</span> <span class="main">≠</span> <span class="bound">x</span>"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> cycle<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="skolem">s</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="skolem">s</span> <span class="bound">y</span> <span class="main">=</span> <span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> comp.IH <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">=</span> id"</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">assume</span></span> id<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">=</span> id"</span></span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">w</span>"</span></span> <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">w</span> <span class="main">=</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cycle <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">w</span> <span class="main">=</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> id <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">assume</span></span> notid<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">≠</span> id"</span></span>
          <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> comp.IH nofixs <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">w</span> <span class="main">=</span> <span class="skolem">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">w</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">w</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> comp.IH nofixs <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> nofixrs <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>    
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> comp.hyps rotation_bij_corollary <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">w</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">w</span>"</span></span><span class="main">)</span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">w</span>"</span></span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">w</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">=</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> rotation_bij_corollary comp.hyps <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">w</span> <span class="main">=</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">w</span> <span class="main">=</span> <span class="skolem">b</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_rotations_fix_unique notid <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> 
                comp.hyps<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="skolem"><span class="skolem">d</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">w</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> comp.hyps<span class="main">(</span>1<span class="main">)</span> simple_rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">w</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">w</span> <span class="main">=</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> comp.hyps<span class="main">(</span>2<span class="main">)</span> rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> comp.IH nofixs <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nofixs <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span><span class="main">)</span>
              <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> simple_rotations_cycle comp.hyps<span class="main">(</span>1<span class="main">)</span> notid <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">w</span>"</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> simple_rotation_bij_corollary comp.hyps<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span>
                comp.hyps<span class="main">(</span>1<span class="main">)</span> simple_rotations_fix_unique notid <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
              <span class="keyword1"><span class="command">have</span></span> dist<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">v</span><span class="main">,</span><span class="skolem">w</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">v</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">v</span><span class="main">,</span><span class="skolem">w</span><span class="main">,</span><span class="skolem">c</span><span class="main">}</span><span class="main">.</span> <span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="bound">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_distinct_map' comp.hyps<span class="main">(</span>1<span class="main">)</span> dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>    
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">c</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> nofixrs <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span>"</span></span> 
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> simple_rotation_bij_corollary comp.hyps<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span>
                comp.hyps<span class="main">(</span>1<span class="main">)</span> simple_rotations_fix_unique notid <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
              <span class="keyword1"><span class="command">have</span></span> dist<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">w</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">v</span><span class="main">,</span><span class="skolem">d</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">w</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">v</span><span class="main">}</span><span class="main">.</span> <span class="skolem">r</span> <span class="skolem">v</span> <span class="main">≠</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_distinct_map' comp.hyps<span class="main">(</span>1<span class="main">)</span> dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> simple_rotations_cycle comp.hyps<span class="main">(</span>1<span class="main">)</span> notid <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>   
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">w</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> simple_rotation_bij_corollary comp.hyps<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span>
                comp.hyps<span class="main">(</span>1<span class="main">)</span> simple_rotations_fix_unique notid <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
              <span class="keyword1"><span class="command">have</span></span> dist'<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">w</span><span class="main">,</span><span class="skolem">v</span><span class="main">,</span><span class="skolem">d</span><span class="main">,</span><span class="skolem">c</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">v</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">w</span><span class="main">,</span><span class="skolem">v</span><span class="main">,</span><span class="skolem">d</span><span class="main">}</span><span class="main">.</span> <span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="bound">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_distinct_map' comp.hyps<span class="main">(</span>1<span class="main">)</span> dist' <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> nofixrs <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">w</span>"</span></span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">w</span> <span class="main">≠</span> <span class="skolem">w</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> comp.hyps<span class="main">(</span>1<span class="main">)</span> simple_rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> nofixs <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">w</span> <span class="main">≠</span> <span class="skolem">w</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> comp.hyps simple_rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>   
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
            <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">b</span>"</span></span><span class="main">)</span>
              <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">b</span>"</span></span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">w</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">w</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> comp.hyps<span class="main">(</span>1<span class="main">)</span> notid simple_rotations_cycle <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
              <span class="keyword1"><span class="command">have</span></span> dist<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">w</span><span class="main">,</span><span class="skolem">v</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">w</span><span class="main">}</span><span class="main">.</span> <span class="skolem">r</span> <span class="bound">x</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">w</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_distinct_map comp.hyps<span class="main">(</span>1<span class="main">)</span> dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">v</span>›</span></span> nofixrs comp_apply <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
            <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span>
              <span class="keyword1"><span class="command">have</span></span> dist<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">w</span><span class="main">,</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">v</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">w</span><span class="main">,</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">}</span><span class="main">.</span> <span class="skolem">r</span> <span class="bound">x</span> <span class="main">≠</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">w</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_distinct_ident comp.hyps<span class="main">(</span>1<span class="main">)</span> dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">w</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> simple_rotations_cycle comp.hyps<span class="main">(</span>1<span class="main">)</span> notid <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">w</span> <span class="main">≠</span> <span class="skolem">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> comp.hyps<span class="main">(</span>1<span class="main">)</span> simple_rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
              <span class="keyword1"><span class="command">have</span></span> dist'<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">v</span><span class="main">,</span><span class="skolem">w</span><span class="main">,</span><span class="skolem">b</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">v</span><span class="main">,</span><span class="skolem">w</span><span class="main">}</span><span class="main">.</span> <span class="skolem">r</span> <span class="skolem">w</span> <span class="main">≠</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">w</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">w</span> <span class="main">≠</span> <span class="skolem">v</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">w</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">w</span> <span class="main">=</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_distinct_map' comp.hyps<span class="main">(</span>1<span class="main">)</span> dist' <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> nofixrs comp_apply <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
            <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">qed</span></span>        
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">v</span><span class="main">.</span> <span class="skolem">s</span> <span class="bound">v</span> <span class="main">≠</span> <span class="bound">v</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> fix1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">v</span><span class="main">.</span> <span class="skolem">s</span> <span class="bound">v</span> <span class="main">=</span> <span class="bound">v</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">=</span> id"</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> id<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">=</span> id"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> nofixrs <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> notid<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">≠</span> id"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> fix1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">v</span><span class="main">.</span> <span class="skolem">r</span> <span class="bound">v</span> <span class="main">=</span> <span class="bound">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_rotations_fix comp.hyps <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="keyword2"><span class="keyword">where</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">b</span>"</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">b</span>"</span></span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a b <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> nofixrs <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> b comp.hyps<span class="main">(</span>1<span class="main">)</span> notid simple_rotations_fix_unique <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> b comp.hyps<span class="main">(</span>1<span class="main">)</span> simple_rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> a comp.hyps<span class="main">(</span>2<span class="main">)</span> rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b nofixrs comp_apply <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">d</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">d</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_rotations_cycle <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">c</span>›</span></span> comp.hyps<span class="main">(</span>1<span class="main">)</span> notid <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> b comp.hyps<span class="main">(</span>1<span class="main">)</span> simple_rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> b comp.hyps<span class="main">(</span>1<span class="main">)</span> notid simple_rotations_fix_unique <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span><span class="main">)</span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> rotation_bij_corollary s <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">e</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">e</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">e</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">e</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">e</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">e</span>"</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> b r simple_rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">c</span>›</span></span> r simple_rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">e</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> b notid r simple_rotations_fix_unique <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>                
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> dist<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">e</span><span class="main">,</span><span class="skolem">a</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">e</span><span class="main">}</span><span class="main">.</span> <span class="skolem">r</span> <span class="skolem">e</span> <span class="main">≠</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">e</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_distinct_map' comp.hyps<span class="main">(</span>1<span class="main">)</span> dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>               
            <span class="keyword1"><span class="command">have</span></span> dist<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">e</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">c</span><span class="main">}</span><span class="main">.</span> <span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">e</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_distinct_map' comp.hyps<span class="main">(</span>1<span class="main">)</span> dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>  
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> a rotation_bij_corollary s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> rotation_bij_corollary s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">e</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> a fix_unique <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>                
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> dist<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">e</span><span class="main">,</span><span class="skolem">b</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">e</span><span class="main">}</span><span class="main">.</span> <span class="skolem">s</span> <span class="skolem">e</span> <span class="main">≠</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">e</span> <span class="main">=</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> distinct_map' comp.hyps<span class="main">(</span>2<span class="main">)</span> dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> a rotation_bij_corollary s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">e</span> <span class="main">=</span> <span class="skolem">b</span>›</span></span> rotation_bij_corollary s <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>        
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> dist<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">e</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">c</span><span class="main">}</span><span class="main">.</span> <span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">e</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> distinct_map' comp.hyps<span class="main">(</span>2<span class="main">)</span> dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>    
            
            <span class="keyword1"><span class="command">have</span></span> rsa<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">c</span>›</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
            <span class="keyword1"><span class="command">have</span></span> rsb<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">e</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">e</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>    
            <span class="keyword1"><span class="command">have</span></span> rsc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">e</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">e</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">have</span></span> rse<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">e</span> <span class="main">=</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">e</span> <span class="main">=</span> <span class="skolem">b</span>›</span></span> b <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> dist<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">e</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">e</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>   
            <span class="keyword1"><span class="command">have</span></span> comprs<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span> <span class="main">∈</span> complex_rotations"</span></span> <span class="keyword1"><span class="command">using</span></span> complex_rotations.comp r s <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> cycle_map<span class="main">[</span><span class="operator">OF</span> comprs dist rsa rsc rsb rse<span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">w</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>            
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">d</span>"</span></span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> dist<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">c</span><span class="main">}</span><span class="main">.</span> <span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_distinct_map' comp.hyps<span class="main">(</span>1<span class="main">)</span> dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> b comp.hyps<span class="main">(</span>1<span class="main">)</span> simple_rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>  
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> comp.hyps<span class="main">(</span>1<span class="main">)</span> notid simple_rotations_cycle <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> comp.hyps<span class="main">(</span>1<span class="main">)</span> simple_rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">have</span></span> dist<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">,</span><span class="skolem">a</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">}</span><span class="main">.</span> <span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_distinct_map' comp.hyps<span class="main">(</span>1<span class="main">)</span> dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>         
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> a comp.hyps<span class="main">(</span>2<span class="main">)</span> rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> nofixrs <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> comp_apply <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> comp.hyps<span class="main">(</span>2<span class="main">)</span> rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">have</span></span> dist<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">,</span><span class="skolem">b</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">}</span><span class="main">.</span> <span class="skolem">s</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> distinct_map' comp.hyps<span class="main">(</span>2<span class="main">)</span> dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> a comp.hyps<span class="main">(</span>2<span class="main">)</span> rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">b</span>›</span></span> comp.hyps<span class="main">(</span>2<span class="main">)</span> rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> comp.hyps<span class="main">(</span>2<span class="main">)</span> rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>  
            <span class="keyword1"><span class="command">have</span></span> dist<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">d</span><span class="main">,</span><span class="skolem">c</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">d</span><span class="main">}</span><span class="main">.</span> <span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> distinct_map' comp.hyps<span class="main">(</span>2<span class="main">)</span> dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> fix_unique <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">v</span> <span class="main">⟶</span> <span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">w</span> <span class="main">=</span> <span class="skolem">w</span> <span class="main">⟶</span> <span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span> <span class="main">⟶</span> <span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span> <span class="main">=</span> id"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword3"><span class="command">assume</span></span> rsv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> rsw<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">w</span> <span class="main">=</span> <span class="skolem">w</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span> <span class="main">=</span> id"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">=</span> id"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> sid<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">=</span> id"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">w</span> <span class="main">=</span> <span class="skolem">w</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">=</span> id"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_rotations_fix_unique rsv rsw <span class="quoted"><span class="quoted">‹<span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> r  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> sid <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> snotid<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">≠</span> id"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">=</span> id"</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> rid<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">=</span> id"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">v</span> <span class="main">=</span> <span class="skolem">v</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">w</span> <span class="main">=</span> <span class="skolem">w</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> rsv rsw <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">=</span> id"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> fix_unique <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
        <span class="keyword1"><span class="command">with</span></span> rid <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> rnotid<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">≠</span> id"</span></span>
        <span class="keyword1"><span class="command">from</span></span> simple_rotations_fix_unique<span class="main">[</span><span class="operator">OF</span> comp.hyps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> rnotid<span class="main">]</span> <span class="keyword1"><span class="command">have</span></span> 
          r_fix_forall<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">v</span> <span class="bound">w</span><span class="main">.</span> <span class="skolem">r</span> <span class="bound">v</span> <span class="main">=</span> <span class="bound">v</span> <span class="main">∧</span> <span class="skolem">r</span> <span class="bound">w</span> <span class="main">=</span> <span class="bound">w</span> <span class="main">⟶</span> <span class="bound">v</span> <span class="main">=</span> <span class="bound">w</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">from</span></span> comp.IH snotid <span class="keyword1"><span class="command">have</span></span>
          s_fix_forall<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">v</span> <span class="bound">w</span><span class="main">.</span> <span class="skolem">s</span> <span class="bound">v</span> <span class="main">=</span> <span class="bound">v</span> <span class="main">∧</span> <span class="skolem">s</span> <span class="bound">w</span> <span class="main">=</span> <span class="bound">w</span> <span class="main">⟶</span> <span class="bound">v</span> <span class="main">=</span> <span class="bound">w</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">have</span></span> fixes_two<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="bound">a</span> <span class="main">=</span> <span class="bound">a</span> <span class="main">∧</span> <span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="bound">b</span> <span class="main">=</span> <span class="bound">b</span> <span class="main">∧</span> <span class="bound">a</span> <span class="main">≠</span> <span class="bound">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">v</span> <span class="main">≠</span> <span class="skolem">w</span>›</span></span> rsv rsw <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">s</span> <span class="bound">x</span> <span class="main">≠</span> <span class="bound">x</span>"</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">assume</span></span> sfix'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">s</span> <span class="bound">x</span> <span class="main">≠</span> <span class="bound">x</span>"</span></span>  
          <span class="keyword1"><span class="command">from</span></span> simple_rotations_fix <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> r <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">from</span></span> sfix' <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a simple_rotation_bij_corollary r <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
          <span class="keyword1"><span class="command">with</span></span> fixes_two <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">with</span></span> fixes_two <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> 
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">b</span>›</span></span> sfix' <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">c</span>›</span></span> sfix' <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
        
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">d</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> complex_rotations_bij s bij_pointE <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a r simple_rotation_bij_corollary <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a r simple_rotation_bij_corollary <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a r simple_rotation_bij_corollary <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>  
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a r simple_rotations_fix_unique rnotid <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a r simple_rotations_fix_unique rnotid <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a r simple_rotations_fix_unique rnotid <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> sfix'
          <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span><span class="main">)</span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> r simple_rotation_bij_corollary <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> r rnotid simple_rotations_cycle <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">c</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> dist<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">v</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">c</span><span class="main">}</span><span class="main">.</span> <span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="bound">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_distinct_map' r dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> r simple_rotation_bij_corollary <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">c</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> r a <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
            <span class="keyword1"><span class="command">have</span></span> dist'<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">,</span><span class="skolem">b</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">v</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">}</span><span class="main">.</span> <span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="bound">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_distinct_map' r dist' <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">b</span>›</span></span> r simple_rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">c</span>›</span></span> r simple_rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> s sfix' <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">b</span>›</span></span> comp<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span>
            <span class="keyword1"><span class="command">have</span></span> dist'<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">v</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">c</span><span class="main">}</span><span class="main">.</span> <span class="skolem">r</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="bound">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_distinct_map' r dist' <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> r simple_rotation_bij_corollary <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> dist''<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">,</span><span class="skolem">b</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">v</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">}</span><span class="main">.</span> <span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="bound">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_distinct_map' r dist'' <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> r simple_rotation_bij_corollary <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> dist'''<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">d</span><span class="main">,</span><span class="skolem">c</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">v</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">d</span><span class="main">}</span><span class="main">.</span> <span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="bound">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_distinct_map' r dist''' <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">b</span>›</span></span> r simple_rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">c</span>›</span></span> r simple_rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> comp<span class="main">(</span>3<span class="main">)</span> s sfix' <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">c</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">s</span> <span class="bound">x</span> <span class="main">≠</span> <span class="bound">x</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">x</span><span class="main">.</span> <span class="skolem">s</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">from</span></span> simple_rotations_fix <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="keyword2"><span class="keyword">where</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> r <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">b</span>"</span></span><span class="main">)</span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span>
            <span class="keyword1"><span class="command">with</span></span> a b <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> r rnotid simple_rotations_fix_unique <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> s_fix_forall <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b simple_rotations_inj r 
                complex_rotations.simp rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>  
            <span class="keyword1"><span class="command">with</span></span> fixes_two <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">from</span></span> fixes_two <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">d</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> 
              <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">b</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> rotation_bij_corollary s <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> rotation_bij_corollary s <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
            
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> r simple_rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> r simple_rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b simple_rotation_bij_corollary <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> r <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>    
        
            <span class="keyword1"><span class="command">have</span></span> dist<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">,</span><span class="skolem">a</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">v</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">}</span><span class="main">.</span> <span class="skolem">r</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="bound">v</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_distinct_map' r dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">a</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">b</span>"</span></span>
            <span class="keyword1"><span class="command">with</span></span> a b <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">from</span></span> fixes_two <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> rsc<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">b</span>›</span></span>r rnotid simple_rotations_fix_unique <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> rsc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">d</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a s rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> s_fix_forall <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> rsc <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> simple_rotations_cycle r rnotid <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">e</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">e</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">b</span>›</span></span> simple_rotation_bij_corollary <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> r <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">e</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>  
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">e</span>›</span></span> simple_rotations_cycle r rnotid <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> b <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> simple_rotation_bij_corollary r <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">e</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">e</span>›</span></span> r simple_rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">have</span></span> dist<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">,</span><span class="skolem">e</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">c</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">d</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">d</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">v</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">}</span><span class="main">.</span> <span class="skolem">r</span> <span class="bound">v</span> <span class="main">≠</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">=</span> <span class="skolem">b</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">e</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="skolem">e</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> simple_distinct_map r dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            
            <span class="keyword1"><span class="command">have</span></span> dist'<span class="main">:</span><span class="quoted"><span class="quoted">"distinct <span class="main">[</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">e</span><span class="main">,</span><span class="skolem">d</span><span class="main">]</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">e</span>"</span></span> <span class="keyword1"><span class="command">using</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">e</span> <span class="main">≠</span> <span class="skolem">a</span>›</span></span> a s_fix_forall <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">v</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">e</span><span class="main">}</span><span class="main">.</span> <span class="skolem">s</span> <span class="bound">v</span> <span class="main">≠</span> <span class="skolem">e</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">e</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> distinct_map s dist' <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>           
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">v</span> <span class="main">∈</span> <span class="main">{</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">}</span><span class="main">.</span> <span class="skolem">s</span> <span class="bound">v</span> <span class="main">≠</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span> ›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="skolem">e</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> distinct_map s dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>          
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">d</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">e</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">e</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">e</span> <span class="main">=</span> <span class="skolem">e</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="skolem">e</span> <span class="main">=</span> <span class="skolem">c</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">e</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="main">=</span> id"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">d</span> <span class="main">=</span> <span class="skolem">d</span>›</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="skolem">c</span> <span class="main">=</span> <span class="skolem">c</span>›</span></span> dist id_decomp <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">qed</span></span>    
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>     
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  This lemma is a simple corollary of the previous result. It is the main result necessary to 
  count stabilisers.
›</span></span>  

<span class="keyword1"><span class="command">corollary</span></span> complex_rotations_fix<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> complex_rotations <span class="main">⟹</span> <span class="free">r</span> <span class="free">a</span> <span class="main">=</span> <span class="free">a</span> <span class="main">⟹</span> <span class="free">r</span> <span class="free">b</span> <span class="main">=</span> <span class="free">b</span> <span class="main">⟹</span> <span class="free">a</span> <span class="main">≠</span> <span class="free">b</span> <span class="main">⟹</span> <span class="free">r</span> <span class="main">=</span> id"</span></span>
  <span class="keyword1"><span class="command">using</span></span> complex_rotations_invariants <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Inversions"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
  In this section we show that inverses exist for each rotation, which we will need to show that
  the rotations we defined indeed form a group.
›</span></span>

<span class="keyword1" id="Tetrahedron-simple_rotations_rotate_id"><span class="command">lemma</span></span> simple_rotations_rotate_id<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> r<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> simple_rotations"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∘</span> <span class="free">r</span> <span class="main">∘</span> <span class="free">r</span> <span class="main">=</span> id"</span></span>  
  <span class="keyword1"><span class="command">using</span></span> r <span class="keyword1"><span class="command">unfolding</span></span> simple_rotations_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">safe</span>
     <span class="main">(</span><span class="operator">rule</span> ext<span class="main"><span class="keyword3">;</span></span> <span class="operator">rename_tac</span> a<span class="main"><span class="keyword3">;</span></span> <span class="operator">case_tac</span> <span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span class="quoted"><span class="improper">a</span></span></span></span></span></span></span></span></span></span><span class="main"><span class="keyword3">;</span></span>
      <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">simple_rotations</span></span>
     <span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1" id="Tetrahedron-simple_rotations_inverses"><span class="command">lemma</span></span> simple_rotations_inverses<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> r<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> simple_rotations"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">y</span><span class="main">∈</span>complex_rotations<span class="main">.</span> <span class="bound">y</span> <span class="main">∘</span> <span class="free">r</span> <span class="main">=</span> id"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?y</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∘</span> <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> r <span class="keyword3"><span class="command">show</span></span> y<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">∈</span> complex_rotations"</span></span> <span class="keyword1"><span class="command">using</span></span> complex_rotations.intros <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> simple_rotations_rotate_id <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?y</span> <span class="main">∘</span> <span class="free">r</span> <span class="main">=</span> id"</span></span> <span class="keyword1"><span class="command">using</span></span> r <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
<span class="keyword1"><span class="command">qed</span></span>  

<span class="keyword1" id="Tetrahedron-complex_rotations_inverses"><span class="command">lemma</span></span> complex_rotations_inverses<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">∈</span> complex_rotations <span class="main">⟹</span> <span class="main">∃</span><span class="bound">y</span><span class="main">∈</span>complex_rotations<span class="main">.</span> <span class="bound">y</span> <span class="main">∘</span> <span class="free">r</span> <span class="main">=</span> id"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">r</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> complex_rotations.induct<span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>simp <span class="skolem">r</span><span class="main">)</span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> simple_rotations_inverses <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>comp <span class="skolem">r</span> <span class="skolem">s</span><span class="main">)</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r'</span></span> <span class="keyword2"><span class="keyword">where</span></span> r'_comp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r'</span><span class="main">∈</span>complex_rotations"</span></span> <span class="keyword2"><span class="keyword">and</span></span> r'_inv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r'</span> <span class="main">∘</span> <span class="skolem">r</span> <span class="main">=</span> id"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> simple_rotations_inverses comp.hyps  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> y_comp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">∈</span>complex_rotations"</span></span> <span class="keyword2"><span class="keyword">and</span></span> y_inv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∘</span> <span class="skolem">s</span> <span class="main">=</span> id"</span></span> <span class="keyword1"><span class="command">using</span></span> comp.IH <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> complex_rotations_comp <span class="keyword1"><span class="command">have</span></span> yr'<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∘</span> <span class="skolem">r'</span> <span class="main">∈</span> complex_rotations"</span></span> <span class="keyword1"><span class="command">using</span></span> r'_comp y_comp <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r'</span> <span class="main">∘</span> <span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">r'</span> <span class="main">∘</span> <span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> comp_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r'</span> <span class="main">∘</span> <span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">s</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> r'_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∘</span> <span class="skolem">r'</span> <span class="main">∘</span> <span class="main">(</span><span class="skolem">r</span> <span class="main">∘</span> <span class="skolem">s</span><span class="main">)</span> <span class="main">=</span> id"</span></span> <span class="keyword1"><span class="command">using</span></span> y_inv comp_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> yr' <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"The Tetrahedral Group"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
We can now define the group of rotational symmetries of a tetrahedron. Since we modeled rotations
as functions, the group operation is functional composition and the identity element of the group is
the identity function
›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">tetrahedral_group</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"Rotation monoid"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">tetrahedral_group</span> <span class="main">=</span> <span class="main">⦇</span>carrier <span class="main">=</span> complex_rotations<span class="main">,</span> mult <span class="main">=</span> <span class="main">(∘)</span><span class="main">,</span> one <span class="main">=</span> id<span class="main">⦈</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
We now prove that this indeed forms a group. Most of the subgoals are trivial, the last goal uses
our results from the previous section about inverses.
›</span></span>

<span class="keyword1" id="Tetrahedron-is_tetrahedral_group"><span class="command">lemma</span></span> is_tetrahedral_group<span class="main">:</span> <span class="quoted"><span class="quoted">"group tetrahedral_group"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> groupI<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">𝟭</span><span class="hidden">⇘</span><sub>tetrahedral_group</sub><span class="hidden">⇙</span> <span class="main">∈</span> carrier tetrahedral_group"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> complex_rotations.intros<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> simple_rotations_def tetrahedral_group_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> carrier tetrahedral_group"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">𝟭</span><span class="hidden">⇘</span><sub>tetrahedral_group</sub><span class="hidden">⇙</span> <span class="main">⊗</span><span class="hidden">⇘</span><sub>tetrahedral_group</sub><span class="hidden">⇙</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> id_comp tetrahedral_group_def monoid.select_convs<span class="main">(</span>1<span class="main">)</span> monoid.select_convs<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">..</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">z</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> carrier tetrahedral_group"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> carrier tetrahedral_group"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="quoted"><span class="quoted">"<span class="skolem">z</span> <span class="main">∈</span> carrier tetrahedral_group"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">⊗</span><span class="hidden">⇘</span><sub>tetrahedral_group</sub><span class="hidden">⇙</span> <span class="skolem">y</span> <span class="main">⊗</span><span class="hidden">⇘</span><sub>tetrahedral_group</sub><span class="hidden">⇙</span> <span class="skolem">z</span> <span class="main">=</span>
             <span class="skolem">x</span> <span class="main">⊗</span><span class="hidden">⇘</span><sub>tetrahedral_group</sub><span class="hidden">⇙</span> <span class="main">(</span><span class="skolem">y</span> <span class="main">⊗</span><span class="hidden">⇘</span><sub>tetrahedral_group</sub><span class="hidden">⇙</span> <span class="skolem">z</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> tetrahedral_group_def monoid.select_convs<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> carrier tetrahedral_group"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> carrier tetrahedral_group"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">⊗</span><span class="hidden">⇘</span><sub>tetrahedral_group</sub><span class="hidden">⇙</span> <span class="skolem">y</span> <span class="main">∈</span> carrier tetrahedral_group"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> complex_rotations.intros<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> tetrahedral_group_def complex_rotations_comp<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> carrier tetrahedral_group"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">y</span><span class="main">∈</span>carrier tetrahedral_group<span class="main">.</span>
            <span class="bound">y</span> <span class="main">⊗</span><span class="hidden">⇘</span><sub>tetrahedral_group</sub><span class="hidden">⇙</span> <span class="skolem">x</span> <span class="main">=</span> <span class="main">𝟭</span><span class="hidden">⇘</span><sub>tetrahedral_group</sub><span class="hidden">⇙</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> complex_rotations_inverses <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> tetrahedral_group_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Having proved that our definition forms a group we can now instantiate our orbit-stabiliser locale.
The group action is the application of a rotation.
›</span></span>

<span class="keyword1"><span class="command">fun</span></span> <span class="entity">apply_rotation</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"Rotation <span class="main">⇒</span> Vertex <span class="main">⇒</span> Vertex"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">apply_rotation</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="free"><span class="bound"><span class="entity">v</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="free"><span class="bound"><span class="entity">v</span></span></span>"</span></span>

<span class="keyword1"><span class="command">interpretation</span></span> tetrahedral<span class="main">:</span> orbit_stabiliser <span class="quoted"><span class="quoted">"tetrahedral_group"</span></span> <span class="quoted"><span class="quoted">"apply_rotation <span class="main">::</span> Rotation <span class="main">⇒</span> Vertex <span class="main">⇒</span> Vertex"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">intro_locales</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Group.monoid tetrahedral_group"</span></span> <span class="keyword1"><span class="command">using</span></span> is_tetrahedral_group <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> group.is_monoid<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"group_axioms tetrahedral_group"</span></span> <span class="keyword1"><span class="command">using</span></span> is_tetrahedral_group <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> group_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"orbit_stabiliser_axioms tetrahedral_group apply_rotation"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"apply_rotation <span class="main">𝟭</span><span class="hidden">⇘</span><sub>tetrahedral_group</sub><span class="hidden">⇙</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> tetrahedral_group_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span> <span class="skolem">h</span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> carrier tetrahedral_group <span class="main">∧</span> <span class="skolem">h</span> <span class="main">∈</span> carrier tetrahedral_group
           <span class="main">⟶</span> apply_rotation <span class="skolem">g</span> <span class="main">(</span>apply_rotation <span class="skolem">h</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> apply_rotation <span class="main">(</span><span class="skolem">g</span> <span class="main">⊗</span><span class="hidden">⇘</span><sub>tetrahedral_group</sub><span class="hidden">⇙</span> <span class="skolem">h</span><span class="main">)</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> tetrahedral_group_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Counting Orbits"</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
We now prove that there is an orbit for each vertex. That is, the group action is transitive.
›</span></span>
<span class="keyword1" id="Tetrahedron-orbit_is_transitive"><span class="command">lemma</span></span> orbit_is_transitive<span class="main">:</span> <span class="quoted"><span class="quoted">"tetrahedral.orbit A <span class="main">=</span> vertices"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"tetrahedral.orbit A <span class="main">⊆</span> vertices"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> vertices_def <span class="keyword1"><span class="command">using</span></span> Vertex.exhaust <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"id <span class="main">∈</span> complex_rotations"</span></span> <span class="keyword1"><span class="command">using</span></span> complex_rotations.intros simple_rotations_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"id <span class="main">∈</span> carrier tetrahedral_group"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> tetrahedral_group_def partial_object.select_convs<span class="main">(</span>1<span class="main">)</span><span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"apply_rotation id A <span class="main">=</span> A"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> A<span class="main">:</span><span class="quoted"><span class="quoted">"A <span class="main">∈</span> <span class="main">(</span>tetrahedral.orbit A<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> tetrahedral.orbit_def mem_Collect_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rotate_C <span class="main">∈</span> simple_rotations"</span></span>
    <span class="keyword1"><span class="command">using</span></span> simple_rotations_def insert_subset subset_insertI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rotate_C <span class="main">∈</span> complex_rotations"</span></span> <span class="keyword1"><span class="command">using</span></span> complex_rotations.intros<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rotate_C <span class="main">∈</span> carrier tetrahedral_group"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> tetrahedral_group_def partial_object.select_convs<span class="main">(</span>1<span class="main">)</span><span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"apply_rotation rotate_C A <span class="main">=</span> B"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rotate_C_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> B<span class="main">:</span><span class="quoted"><span class="quoted">"B <span class="main">∈</span> <span class="main">(</span>tetrahedral.orbit A<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> tetrahedral.orbit_def mem_Collect_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rotate_D <span class="main">∈</span> simple_rotations"</span></span>
    <span class="keyword1"><span class="command">using</span></span> simple_rotations_def insert_subset subset_insertI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rotate_D <span class="main">∈</span> complex_rotations"</span></span> <span class="keyword1"><span class="command">using</span></span> complex_rotations.intros<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rotate_D <span class="main">∈</span> carrier tetrahedral_group"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> tetrahedral_group_def partial_object.select_convs<span class="main">(</span>1<span class="main">)</span><span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"apply_rotation rotate_D A <span class="main">=</span> C"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rotate_D_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> C<span class="main">:</span><span class="quoted"><span class="quoted">"C <span class="main">∈</span> <span class="main">(</span>tetrahedral.orbit A<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> tetrahedral.orbit_def mem_Collect_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rotate_B <span class="main">∈</span> simple_rotations"</span></span>
    <span class="keyword1"><span class="command">using</span></span> simple_rotations_def insert_subset subset_insertI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rotate_B <span class="main">∈</span> complex_rotations"</span></span> <span class="keyword1"><span class="command">using</span></span> complex_rotations.intros<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rotate_B <span class="main">∈</span> carrier tetrahedral_group"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> tetrahedral_group_def partial_object.select_convs<span class="main">(</span>1<span class="main">)</span><span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"apply_rotation rotate_B A <span class="main">=</span> D"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rotate_B_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> D<span class="main">:</span><span class="quoted"><span class="quoted">"D <span class="main">∈</span> <span class="main">(</span>tetrahedral.orbit A<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> tetrahedral.orbit_def mem_Collect_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

  <span class="keyword1"><span class="command">from</span></span> A B C D <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"vertices <span class="main">⊆</span> tetrahedral.orbit A"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vertices_def subsetI<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
It follows from the previous lemma, that the cardinality of the set of orbits for a particular vertex is 4.
›</span></span>
<span class="keyword1" id="Tetrahedron-card_orbit"><span class="command">lemma</span></span> card_orbit<span class="main">:</span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>tetrahedral.orbit A<span class="main">)</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> card.empty card_insert_if <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card vertices <span class="main">=</span> <span class="numeral">4</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> vertices_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> orbit_is_transitive <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>tetrahedral.orbit A<span class="main">)</span> <span class="main">=</span> <span class="numeral">4</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Counting Stabilisers"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Each vertex has three elements in its stabiliser - the identity, a rotation around its axis by 120 degrees,
and a rotation around its axis by 240 degrees. We will prove this next.
›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">stabiliser_A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"Rotation set"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">stabiliser_A</span> <span class="main">=</span> <span class="main">{</span>id<span class="main">,</span> rotate_A<span class="main">,</span> rotate_A <span class="main">∘</span> rotate_A<span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
This lemma shows that our conjectured stabiliser is correct.
›</span></span>
<span class="keyword1" id="Tetrahedron-is_stabiliser"><span class="command">lemma</span></span> is_stabiliser<span class="main">:</span> <span class="quoted"><span class="quoted">"tetrahedral.stabiliser A <span class="main">=</span> stabiliser_A"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"stabiliser_A <span class="main">⊆</span> tetrahedral.stabiliser A"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"id <span class="main">∈</span> complex_rotations"</span></span> <span class="keyword1"><span class="command">using</span></span> complex_rotations.intros simple_rotations_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"id <span class="main">∈</span> carrier tetrahedral_group"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> tetrahedral_group_def partial_object.select_convs<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"apply_rotation id A <span class="main">=</span> A"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> id<span class="main">:</span><span class="quoted"><span class="quoted">"id <span class="main">∈</span> <span class="main">(</span>tetrahedral.stabiliser A<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> tetrahedral.stabiliser_def mem_Collect_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rotate_A <span class="main">∈</span> simple_rotations"</span></span>
      <span class="keyword1"><span class="command">using</span></span> simple_rotations_def insert_subset subset_insertI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rotate_A <span class="main">∈</span> complex_rotations"</span></span> <span class="keyword1"><span class="command">using</span></span> complex_rotations.intros<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rotate_A <span class="main">∈</span> carrier tetrahedral_group"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> tetrahedral_group_def partial_object.select_convs<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"apply_rotation rotate_A A <span class="main">=</span> A"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rotate_A_def<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> A<span class="main">:</span><span class="quoted"><span class="quoted">"rotate_A <span class="main">∈</span> <span class="main">(</span>tetrahedral.stabiliser A<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> tetrahedral.stabiliser_def mem_Collect_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rotate_A <span class="main">∈</span> simple_rotations"</span></span>
      <span class="keyword1"><span class="command">using</span></span> simple_rotations_def insert_subset subset_insertI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rotate_A <span class="main">∘</span> rotate_A <span class="main">∈</span> complex_rotations"</span></span> <span class="keyword1"><span class="command">using</span></span> complex_rotations.intros <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rotate_A <span class="main">∘</span> rotate_A <span class="main">∈</span> carrier tetrahedral_group"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> tetrahedral_group_def partial_object.select_convs<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"apply_rotation <span class="main">(</span>rotate_A <span class="main">∘</span> rotate_A<span class="main">)</span> A <span class="main">=</span> A"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rotate_A_def<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> AA<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span>rotate_A <span class="main">∘</span> rotate_A<span class="main">)</span> <span class="main">∈</span> <span class="main">(</span>tetrahedral.stabiliser A<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> tetrahedral.stabiliser_def mem_Collect_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

    <span class="keyword1"><span class="command">from</span></span> id A AA <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"stabiliser_A <span class="main">⊆</span> tetrahedral.stabiliser A"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> stabiliser_A_def subsetI<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"tetrahedral.stabiliser A <span class="main">⊆</span> stabiliser_A"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> tetrahedral.stabiliser A"</span></span>
    <span class="keyword1"><span class="command">with</span></span> tetrahedral.stabiliser_def <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"apply_rotation <span class="skolem">x</span> A <span class="main">=</span> A"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> apply_rotation.simps <span class="keyword1"><span class="command">have</span></span> xA<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> A <span class="main">=</span> A"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> a <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> carrier tetrahedral_group"</span></span>
      <span class="keyword1"><span class="command">using</span></span> subgroup.mem_carrier<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"tetrahedral.stabiliser A"</span></span><span class="main">]</span> tetrahedral.stabiliser_subgroup <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> xC<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> complex_rotations"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> tetrahedral_group_def partial_object.select_convs<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> B <span class="main">≠</span> A"</span></span> <span class="keyword1"><span class="command">using</span></span> xA xC rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> complex_rotations <span class="main">⟹</span> <span class="skolem">x</span> A <span class="main">=</span> A <span class="main">⟹</span> <span class="skolem">x</span> <span class="main">∈</span> stabiliser_A"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> B"</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> B <span class="main">=</span> B"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> id"</span></span> <span class="keyword1"><span class="command">using</span></span> complex_rotations_fix xC xA <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> stabiliser_A_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> B <span class="main">=</span> C"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≠</span> id"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> D <span class="main">≠</span> D"</span></span> <span class="keyword1"><span class="command">using</span></span> complex_rotations_fix xC xA <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> D <span class="main">≠</span> C"</span></span> <span class="keyword1"><span class="command">using</span></span> xC <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> B <span class="main">=</span> C›</span></span> rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> D <span class="main">≠</span> A"</span></span> <span class="keyword1"><span class="command">using</span></span> xC xA rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> D <span class="main">=</span> B"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> D <span class="main">≠</span> C›</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> D <span class="main">≠</span> D›</span></span> Vertex.exhaust <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> C <span class="main">≠</span> A"</span></span> <span class="keyword1"><span class="command">using</span></span> xC xA rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> C <span class="main">≠</span> B"</span></span> <span class="keyword1"><span class="command">using</span></span> xC <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> D <span class="main">=</span> B›</span></span> rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> C <span class="main">≠</span> C"</span></span> <span class="keyword1"><span class="command">using</span></span> complex_rotations_fix xC xA <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≠</span> id›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> C <span class="main">=</span> D"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> C <span class="main">≠</span> A›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> C <span class="main">≠</span> B›</span></span> Vertex.exhaust <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">v</span><span class="main">.</span> <span class="skolem">x</span> <span class="bound">v</span> <span class="main">=</span> rotate_A <span class="bound">v</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> xA <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> B <span class="main">=</span> C›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> D <span class="main">=</span> B›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> C <span class="main">=</span> D›</span></span> Vertex.exhaust rotate_A_def Vertex.simps <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> rotate_A"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> stabiliser_A_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> B <span class="main">=</span> D"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≠</span> id"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> C <span class="main">≠</span> C"</span></span> <span class="keyword1"><span class="command">using</span></span> complex_rotations_fix xC xA <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> C <span class="main">≠</span> D"</span></span> <span class="keyword1"><span class="command">using</span></span> xC <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> B <span class="main">=</span> D›</span></span> rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> C <span class="main">≠</span> A"</span></span> <span class="keyword1"><span class="command">using</span></span> xC xA rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> C <span class="main">=</span> B"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> C <span class="main">≠</span> D›</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> C <span class="main">≠</span> C›</span></span> Vertex.exhaust <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> D <span class="main">≠</span> A"</span></span> <span class="keyword1"><span class="command">using</span></span> xC xA rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> D <span class="main">≠</span> B"</span></span> <span class="keyword1"><span class="command">using</span></span> xC <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> C <span class="main">=</span> B›</span></span> rotation_bij_corollary <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> D <span class="main">≠</span> D"</span></span> <span class="keyword1"><span class="command">using</span></span> complex_rotations_fix xC xA <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">≠</span> id›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> D <span class="main">=</span> C"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> D <span class="main">≠</span> A›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> D <span class="main">≠</span> B›</span></span> Vertex.exhaust <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">v</span><span class="main">.</span> <span class="skolem">x</span> <span class="bound">v</span> <span class="main">=</span> <span class="main">(</span>rotate_A <span class="main">∘</span> rotate_A<span class="main">)</span> <span class="bound">v</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> xA <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> B <span class="main">=</span> D›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> C <span class="main">=</span> B›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> D <span class="main">=</span> C›</span></span> Vertex.exhaust rotate_A_def Vertex.simps comp_apply <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> rotate_A <span class="main">∘</span> rotate_A"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> stabiliser_A_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> stabiliser_A"</span></span> <span class="keyword1"><span class="command">using</span></span> xA xC <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Using the previous result, we can now show that the cardinality of the stabiliser is 3.
›</span></span>
<span class="keyword1" id="Tetrahedron-card_stabiliser_help"><span class="command">lemma</span></span> card_stabiliser_help<span class="main">:</span> <span class="quoted"><span class="quoted">"card stabiliser_A <span class="main">=</span> <span class="numeral">3</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> idA<span class="main">:</span><span class="quoted"><span class="quoted">"id <span class="main">≠</span> rotate_A"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"id B <span class="main">=</span> B"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rotate_A B <span class="main">=</span> C"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rotate_A_def<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"id <span class="main">≠</span> rotate_A"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> idAA<span class="main">:</span><span class="quoted"><span class="quoted">"id <span class="main">≠</span> rotate_A <span class="main">∘</span> rotate_A"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"id B <span class="main">=</span> B"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>rotate_A <span class="main">∘</span> rotate_A<span class="main">)</span> B <span class="main">=</span> D"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rotate_A_def<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"id <span class="main">≠</span> rotate_A <span class="main">∘</span> rotate_A"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> AAA<span class="main">:</span><span class="quoted"><span class="quoted">"rotate_A <span class="main">≠</span> rotate_A <span class="main">∘</span> rotate_A"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"rotate_A B <span class="main">=</span> C"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rotate_A_def<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>rotate_A <span class="main">∘</span> rotate_A<span class="main">)</span> B <span class="main">=</span> D"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rotate_A_def<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"rotate_A <span class="main">≠</span> rotate_A <span class="main">∘</span> rotate_A"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> idA idAA AAA card.empty card_insert_if <span class="keyword3"><span class="command">show</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span>card stabiliser_A<span class="main">)</span> <span class="main">=</span> <span class="numeral">3</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> stabiliser_A_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Tetrahedron-card_stabiliser"><span class="command">lemma</span></span> card_stabiliser<span class="main">:</span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>tetrahedral.stabiliser A<span class="main">)</span> <span class="main">=</span> <span class="numeral">3</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> is_stabiliser card_stabiliser_help <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Proving Finiteness"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
In order to apply the orbit-stabiliser theorem, we need to prove that the set of rotations is
finite. We first prove that the set of vertices is finite.
›</span></span>
<span class="keyword1" id="Tetrahedron-vertex_set"><span class="command">lemma</span></span> vertex_set<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>UNIV<span class="main">::</span>Vertex set<span class="main">)</span> <span class="main">=</span> <span class="main">{</span>A<span class="main">,</span> B<span class="main">,</span> C<span class="main">,</span> D<span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">metis</span> Vertex.exhaust<span class="main">)</span>

<span class="keyword1" id="Tetrahedron-vertex_finite"><span class="command">lemma</span></span> vertex_finite<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>UNIV <span class="main">::</span> Vertex set<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vertex_set<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Next we need instantiate Vertex as an element of the type class of finite sets in
HOL/Finite\_Set.thy. This will allow us to use the lemma that functions between finite sets
are finite themselves.
›</span></span>

<span class="keyword1"><span class="command">instantiation</span></span> Vertex <span class="main">::</span> <span class="quoted">finite</span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>UNIV <span class="main">::</span> Vertex set<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> vertex_set<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Now we can show that the set of rotations is finite.
›</span></span>
<span class="keyword1" id="Tetrahedron-finite_carrier"><span class="command">lemma</span></span> finite_carrier<span class="main">:</span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier tetrahedral_group<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="comment1">(* This follows from the instantiation above *)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>UNIV <span class="main">::</span> <span class="main">(</span>Vertex <span class="main">⇒</span> Vertex<span class="main">)</span> set<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"complex_rotations <span class="main">⊆</span> <span class="main">(</span>UNIV <span class="main">::</span> <span class="main">(</span>Vertex <span class="main">⇒</span> Vertex<span class="main">)</span> set<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span>carrier tetrahedral_group<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> finite_subset top_greatest <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Order of the Group"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
We can now finally apply the orbit-stabiliser theorem.
Since we have orbits of cardinality 4 and stabilisers of cardinality 3, the order of the tetrahedral group,
and with it the number of rotational symmetries of the tetrahedron, is 12.
›</span></span>
<span class="keyword1"><span class="command">theorem</span></span> <span class="quoted"><span class="quoted">"order tetrahedral_group <span class="main">=</span> <span class="numeral">12</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>tetrahedral.orbit A<span class="main">)</span> <span class="main">*</span> card <span class="main">(</span>tetrahedral.stabiliser A<span class="main">)</span> <span class="main">=</span> <span class="numeral">12</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> card_stabiliser card_orbit <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> tetrahedral.orbit_stabiliser<span class="main">[</span><span class="operator">OF</span> finite_carrier<span class="main">]</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"order tetrahedral_group <span class="main">=</span> <span class="numeral">12</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
  
<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div>
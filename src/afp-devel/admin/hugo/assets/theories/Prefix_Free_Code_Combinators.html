<div id='Examples'>e>
</head>


<body>
<div class="head">
<h1>Theory Prefix_Free_Code_Combinators</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Introduction\label{sec:intro}</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Prefix_Free_Code_Combinators</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> 
    </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Library/Extended_Real.html"><span>HOL-Library.Extended_Real</span></a><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Library/Float.html"><span>HOL-Library.Float</span></a><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Library/FuncSet.html"><span>HOL-Library.FuncSet</span></a><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Library/List_Lexorder.html"><span>HOL-Library.List_Lexorder</span></a><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Library/Log_Nat.html"><span>HOL-Library.Log_Nat</span></a><span>"</span></span><span> 
    </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Library/Sublist.html"><span>HOL-Library.Sublist</span></a><span>"</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The encoders are represented as partial prefix-free functions. The advantage of
</span><span>prefix free codes is that they can be easily combined by concatenation. The approach
</span><span>of using prefix free codes (on the byte-level) for the representation of complex data
</span><span>structures is common in many industry encoding libraries (cf. \cite{rfc8949}).
</span><span>
</span><span>The reason for representing encoders using partial functions, stems from some use-cases
</span><span>where the objects to be encoded may be in a much smaller sets, as their type may suggest.
</span><span>For example a natural number may be known to have a given range, or a function may be
</span><span>encodable because it has a finite domain.
</span><span>
</span><span>Note: Prefix-free codes can also be automatically derived using Huffmans' algorithm, which was 
</span><span>formalized by Blanchette~\cite{Huffman-AFP}. This is especially useful if it is possible to transmit
</span><span>a dictionary before the data. On the other hand these standard codes are useful, when the above is
</span><span>impractical and/or the distribution of the input is unknown or expected to be close to the one's 
</span><span>implied by standard codes.
</span><span>
</span><span>The following section contains general definitions and results, followed by
</span><span>Section~\ref{sec:dep_enc} to \ref{sec:float_enc} where encoders for primitive types 
</span><span>and combinators are defined. Each construct is accompanied by lemmas verifying that they
</span><span>form prefix free codes as well as bounds on the bit count to encode the data.
</span><span>Section~\ref{sec:examples} concludes with a few examples.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Encodings</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.elims|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.induct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.simps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.pelims|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.cases|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.termination|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.pinduct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.psimps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_rel.inducts|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_rel.simps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_rel.induct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_rel.cases|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_rel.intros|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_graph.inducts|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_graph.simps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_graph.induct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_graph.cases|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_graph.intros|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.elims(3)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.elims(2)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.elims(1)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.induct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.simps(3)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.simps(2)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.simps(1)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.pelims(3)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.pelims(2)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.pelims(1)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.cases|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.termination|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.pinduct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.psimps(3)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.psimps(2)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix.psimps(1)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_rel.inducts|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_rel.simps|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_rel.induct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_rel.cases|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_graph.inducts|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_graph.simps|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_graph.induct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_graph.cases|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_graph.intros(3)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_graph.intros(2)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_graph.intros(1)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_rel_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_sumC_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_graph_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_dom|const"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_rel|const"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_sumC|const"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_prefix|const"><span>opt_prefix</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>opt_prefix</span></span><span> </span><span class="main"><span>(</span></span><span>Some</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>Some</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>prefix</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>opt_prefix</span></span><span> </span><span class="main"><span class="bound"><span class="entity"><span>_</span></span></span></span><span> </span><span class="main"><span class="bound"><span class="entity"><span>_</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>False</span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_comp_def|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_comp_def|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_comp_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_comp|const"><span>opt_comp</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_prefix|const"><span>opt_prefix</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span> </span><span class="main"><span>â¨</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_prefix|const"><span>opt_prefix</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.elims|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.induct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.simps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.pelims|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.cases|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.termination|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.pinduct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.psimps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_rel.inducts|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_rel.simps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_rel.induct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_rel.cases|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_rel.intros|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_graph.inducts|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_graph.simps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_graph.induct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_graph.cases|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_graph.intros|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.elims|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.induct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.simps(3)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.simps(2)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.simps(1)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.pelims|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.cases|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.termination|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.pinduct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.psimps(3)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.psimps(2)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append.psimps(1)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_rel.inducts|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_rel.simps|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_rel.induct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_rel.cases|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_graph.inducts|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_graph.simps|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_graph.induct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_graph.cases|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_graph.intros(3)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_graph.intros(2)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_graph.intros(1)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_rel_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_sumC_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_graph_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_dom|const"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_rel|const"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_sumC|const"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_append|const"><span>opt_append</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>bool</span><span> </span><span>list</span><span> </span><span>option</span><span> </span><span class="main"><span>â</span></span><span> </span><span>bool</span><span> </span><span>list</span><span> </span><span>option</span><span> </span><span class="main"><span>â</span></span><span> </span><span>bool</span><span> </span><span>list</span><span> </span><span>option</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>opt_append</span></span><span> </span><span class="main"><span>(</span></span><span>Some</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>Some</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Some</span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>@</span></span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>opt_append</span></span><span> </span><span class="main"><span class="bound"><span class="entity"><span>_</span></span></span></span><span> </span><span class="main"><span class="bound"><span class="entity"><span>_</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>None</span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_comp_sym|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_comp_sym|thm"><span>opt_comp_sym</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp|const"><span>opt_comp</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp|const"><span>opt_comp</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_def|fact"><span>opt_comp_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2148..2153">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_comp_append|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_comp_append|thm"><span>opt_comp_append</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp|const"><span>opt_comp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_append|const"><span>opt_append</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>z</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp|const"><span>opt_comp</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>z</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x'</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y'</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>z'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_2266..2267">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Some</span><span> </span><span class="skolem"><span>x'</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Some</span><span> </span><span class="skolem"><span>y'</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>z</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Some</span><span> </span><span class="skolem"><span>z'</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_2148..2153"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>case_tac</span></span><span class="main"><span class="improper"><span>[</span></span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="improper"><span>]</span></span></span><span> </span><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span>y</span></span></span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>case_tac</span></span><span class="main"><span class="improper"><span>[</span></span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="improper"><span>]</span></span></span><span> </span><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span>z</span></span></span></span></span></span></span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_def|fact"><span>opt_comp_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prefix</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x'</span></span><span class="main"><span>@</span></span><span class="skolem"><span>y'</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>z'</span></span><span> </span><span class="main"><span>â¨</span></span><span> </span><span>prefix</span><span> </span><span class="skolem"><span>z'</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x'</span></span><span class="main"><span>@</span></span><span class="skolem"><span>y'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_2266..2267"><span>a</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_2148..2153"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_def|fact"><span>opt_comp_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prefix</span><span> </span><span class="skolem"><span>x'</span></span><span> </span><span class="skolem"><span>z'</span></span><span> </span><span class="main"><span>â¨</span></span><span> </span><span>prefix</span><span> </span><span class="skolem"><span>z'</span></span><span> </span><span class="skolem"><span>x'</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>prefix_same_cases</span><span> </span><span>append_prefixD</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_2266..2267"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_def|fact"><span>opt_comp_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2640..2645">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_comp_append_2|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_comp_append_2|thm"><span>opt_comp_append_2</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp|const"><span>opt_comp</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_append|const"><span>opt_append</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp|const"><span>opt_comp</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_append|fact"><span>opt_comp_append</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_sym|fact"><span>opt_comp_sym</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_2640..2645"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2781..2786">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_comp_append_3|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.opt_comp_append_3|thm"><span>opt_comp_append_3</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp|const"><span>opt_comp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_append|const"><span>opt_append</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_append|const"><span>opt_append</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp|const"><span>opt_comp</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>z</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_2781..2786"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>case_tac</span></span><span class="main"><span class="improper"><span>[</span></span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="improper"><span>]</span></span></span><span> </span><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span>y</span></span></span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>case_tac</span></span><span class="main"><span class="improper"><span>[</span></span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="improper"><span>]</span></span></span><span> </span><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span>z</span></span></span></span></span></span></span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_def|fact"><span>opt_comp_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>type_synonym</span></span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.encoding|type"><span>encoding</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>bool</span><span> </span><span>list</span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Prefix_Free_Code_Combinators.is_encoding_def|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.is_encoding_def|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.is_encoding_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding|type"><span>encoding</span></a><span> </span><span class="main"><span>â</span></span><span> </span><span>bool</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>is_encoding</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_prefix|const"><span>opt_prefix</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>An encoding function is represented as partial functions into lists of booleans, where
</span><span>each list element represents a bit. Such a function is defined to be an encoding, if it is
</span><span>prefix-free on its domain. This is similar to the formalization by Hibon and
</span><span>Paulson~\cite{Source_Coding_Theorem-AFP} except for the use of partial functions for the
</span><span>practical reasons described in Section~\ref{sec:intro}.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3535..3540">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.is_encodingI|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.is_encodingI|thm"><span>is_encodingI</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>y'</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Some</span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Some</span><span> </span><span class="bound"><span>y'</span></span><span> </span><span class="main"><span>â¹</span></span><span> 
    </span><span>prefix</span><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="bound"><span>y'</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="free"><span>e</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_prefix|const"><span>opt_prefix</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_3535..3540"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>e</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>case_tac</span></span><span class="main"><span class="improper"><span>[</span></span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="improper"><span>]</span></span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="free"><span>e</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y</span></span></span><span>"</span></span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding_def|fact"><span>is_encoding_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3825..3830">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.is_encodingI_2|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.is_encodingI_2|thm"><span>is_encodingI_2</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp|const"><span>opt_comp</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="free"><span>e</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_3825..3830"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_def|fact"><span>opt_comp_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding_def|fact"><span>is_encoding_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.encoding_triv|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encoding_triv|thm"><span>encoding_triv</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span>Map.empty</span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encodingI_2|fact"><span>is_encodingI_2</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_def|fact"><span>opt_comp_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4073..4078">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.is_encodingD|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.is_encodingD|thm"><span>is_encodingD</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="free"><span>e</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp|const"><span>opt_comp</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_4073..4078"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_def|fact"><span>opt_comp_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding_def|fact"><span>is_encoding_def</span></a><span class="main"><span>)</span></span><span> 

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4232..4237">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.encoding_imp_inj|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encoding_imp_inj|thm"><span>encoding_imp_inj</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>dom</span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_4232..4237"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>inj_onI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding_def|fact"><span>is_encoding_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>force</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count.elims|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count.induct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count.simps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count.pelims|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count.cases|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count.termination|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count.pinduct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count.psimps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_rel.inducts|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_rel.simps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_rel.induct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_rel.cases|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_rel.intros|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_graph.inducts|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_graph.simps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_graph.induct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_graph.cases|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_graph.intros|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count.elims|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count.induct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count.simps(2)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count.simps(1)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count.pelims|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count.cases|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count.termination|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count.pinduct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count.psimps(2)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count.psimps(1)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_rel.inducts|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_rel.simps|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_rel.induct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_rel.cases|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_graph.inducts|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_graph.simps|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_graph.induct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_graph.cases|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_graph.intros(2)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_graph.intros(1)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_rel_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_sumC_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_graph_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_dom|const"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_rel|const"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_sumC|const"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>bool</span><span> </span><span>list</span><span> </span><span>option</span><span> </span><span class="main"><span>â</span></span><span> </span><span>ereal</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bit_count</span></span><span> </span><span>None</span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>â</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bit_count</span></span><span> </span><span class="main"><span>(</span></span><span>Some</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_finite_imp_dom|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_finite_imp_dom|thm"><span>bit_count_finite_imp_dom</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>dom</span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_append|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bit_count_append|thm"><span>bit_count_append</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_append|const"><span>opt_append</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>case_tac</span></span><span class="main"><span class="improper"><span>[</span></span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="improper"><span>]</span></span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="free"><span>y</span></span></span><span>"</span></span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>(Dependent) Products\label{sec:dep_enc}</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_dependent_prod_def|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_dependent_prod_def|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_dependent_prod_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span>encode_dependent_prod</span></span></span><span> </span><span class="main"><span>::</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding|type"><span>encoding</span></a><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'b</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding|type"><span>encoding</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="tfree"><span>'b</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding|type"><span>encoding</span></a><span>"</span></span></span><span> 
  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infixr</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>e</sub></span></span><span>"</span></span><span> 65</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>encode_dependent_prod</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_append|const"><span>opt_append</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4980..4985">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.dependent_encoding|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.dependent_encoding|thm"><span>dependent_encoding</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="free"><span>e1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>dom</span><span> </span><span class="free"><span>e1</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e2</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e1</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="free"><span>e2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encodingI_2|fact"><span>is_encodingI_2</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_5162..5163">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp|const"><span>opt_comp</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>e1</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="free"><span>e2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>e1</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="free"><span>e2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_5214..5215">d</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp|const"><span>opt_comp</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e1</span></span><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>e1</span></span><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_5162..5163"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod_def|fact"><span>encode_dependent_prod_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_append|fact"><span>opt_comp_append</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_append_2|fact"><span>opt_comp_append_2</span></a><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_5359..5360">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>fst</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>fst</span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encodingD|fact"><span>is_encodingD</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_4980..4985"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp|const"><span>opt_comp</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e2</span></span><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>e2</span></span><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_5162..5163"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod_def|fact"><span>encode_dependent_prod_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_append_3|fact"><span>opt_comp_append_3</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>fst</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>dom</span><span> </span><span class="free"><span>e1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_5214..5215"><span>d</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_5359..5360"><span>b</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>e1</span></span><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_def|fact"><span>opt_comp_def</span></a><span> </span><span>dom_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_5683..5684">c</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>snd</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>snd</span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encodingD|fact"><span>is_encodingD</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_4980..4985"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_5359..5360"><span>b</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_5683..5684"><span>c</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>prod_eq_iff</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.dependent_bit_count|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.dependent_bit_count|thm"><span>dependent_bit_count</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>e<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="free"><span>e<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span class="free"><span>x<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="free"><span>x<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e<span class="hidden">â©</span><sub>2</sub></span></span><span> </span><span class="free"><span>x<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="free"><span>x<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod_def|fact"><span>encode_dependent_prod_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count_append|fact"><span>bit_count_append</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.dependent_bit_count_2|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.dependent_bit_count_2|thm"><span>dependent_bit_count_2</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>e<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="free"><span>e<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e<span class="hidden">â©</span><sub>2</sub></span></span><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod_def|fact"><span>encode_dependent_prod_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count_append|fact"><span>bit_count_append</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>This abbreviation is for non-dependent products.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_prod|const"><span>encode_prod</span></span></span><span> </span><span class="main"><span>::</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding|type"><span>encoding</span></a><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'b</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding|type"><span>encoding</span></a><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="tfree"><span>'b</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding|type"><span>encoding</span></a><span>"</span></span></span><span>
  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infixr</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>Ã<span class="hidden">â©</span><sub>e</sub></span></span><span>"</span></span><span> 65</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>encode_prod</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e1</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e2</span></span></span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e1</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e2</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Composition</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6405..6410">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.encoding_compose|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encoding_compose|thm"><span>encoding_compose</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span class="free"><span>g</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>if</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span>None</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_6405..6410"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>comp_def</span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding_def|fact"><span>is_encoding_def</span></a><span> </span><span>inj_onD</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6605..6610">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.encoding_compose_2|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encoding_compose_2|thm"><span>encoding_compose_2</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj</span><span> </span><span class="free"><span>g</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_6605..6610"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>comp_def</span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding_def|fact"><span>is_encoding_def</span></a><span> </span><span>inj_onD</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Natural Numbers</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat.elims|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat.induct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat.simps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat.pelims|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat.cases|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat.termination|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat.pinduct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat.psimps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_rel.inducts|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_rel.simps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_rel.induct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_rel.cases|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_rel.intros|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_graph.inducts|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_graph.simps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_graph.induct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_graph.cases|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_graph.intros|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat.elims|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat.induct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat.simps(2)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat.simps(1)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat.pelims|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat.cases|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat.termination|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat.pinduct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat.psimps(2)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat.psimps(1)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_rel.inducts|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_rel.simps|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_rel.induct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_rel.cases|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_rel.intros|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_graph.inducts|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_graph.simps|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_graph.induct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_graph.cases|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_graph.intros(2)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_graph.intros(1)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_rel_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_sumC_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_graph_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_dom|const"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_rel|const"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_sumC|const"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat|const"><span>encode_bounded_nat</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>bool</span><span> </span><span>list</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>encode_bounded_nat</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>#</span></span><span class="free"><span>encode_bounded_nat</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>-</span></span><span>of_bool</span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>encode_bounded_nat</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span class="bound"><span class="entity"><span>_</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[]</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6995..7000">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_prefix_free|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_bounded_nat_prefix_free|thm"><span>encode_bounded_nat_prefix_free</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>u</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>l</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>v</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="free"><span>l</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prefix</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_bounded_nat|const"><span>encode_bounded_nat</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>u</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_bounded_nat|const"><span>encode_bounded_nat</span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>u</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>v</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_6995..7000"><span>assms</span></a><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>l</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>u</span></span></span><span> </span><span class="quoted"><span class="free"><span>v</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_7277..7280">Suc</span><span> </span><span class="skolem"><span>l</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prefix</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_bounded_nat|const"><span>encode_bounded_nat</span></a><span> </span><span class="skolem"><span>l</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_bounded_nat|const"><span>encode_bounded_nat</span></a><span> </span><span class="skolem"><span>l</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_7416..7417">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>l</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>l</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_7277..7280"><span>Suc</span></a><span class="main"><span>(</span></span><span>4</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>Let_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>l</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>l</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_7277..7280"><span>Suc</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>l</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>of_bool_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>l</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>l</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_7277..7280"><span>Suc</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>l</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>of_bool_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>l</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>l</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_7277..7280"><span>Suc</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>v</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_7416..7417"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e_def|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e_def|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><span>Nb<span class="hidden">â©</span><sub>e</sub></span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding|type"><span>encoding</span></a><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Nb<span class="hidden">â©</span><sub>e</sub></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>
    </span><span class="keyword1"><span>if</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> 
      </span><span class="keyword1"><span>then</span></span><span> </span><span>Some</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_bounded_nat|const"><span>encode_bounded_nat</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span>else</span></span><span> </span><span>None</span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><span>Nb<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>l</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> is  encoding for natural numbers strictly smaller than 
</span><span>  </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>l</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> using a fixed length encoding.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.bounded_nat_bit_count|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bounded_nat_bit_count|thm"><span>bounded_nat_bit_count</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><span>Nb<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>l</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8253..8254">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>length</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_bounded_nat|const"><span>encode_bounded_nat</span></a><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="skolem"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>h</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="skolem"><span>m</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="skolem"><span>h</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>m</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>Let_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_8253..8254"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e_def|fact"><span>Nb<span class="hidden">â©</span><sub>e</sub>_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8414..8419">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.bounded_nat_bit_count_2|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bounded_nat_bit_count_2|thm"><span>bounded_nat_bit_count_2</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>l</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><span>Nb<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>l</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>l</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_8414..8419"><span>assms</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bounded_nat_bit_count|fact"><span>bounded_nat_bit_count</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>dom</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><span>Nb<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>l</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e_def|fact"><span>Nb<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><span>dom_def</span><span> </span><span>lessThan_def</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.bounded_nat_encoding|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.bounded_nat_encoding|thm"><span>bounded_nat_encoding</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><span>Nb<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>l</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>l</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>l</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog_leD|fact"><span>floorlog_leD</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog_mono|fact"><span>floorlog_mono</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_bounded_nat_prefix_free|fact"><span>encode_bounded_nat_prefix_free</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encodingI|fact"><span>is_encodingI</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e_def|fact"><span>Nb<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span class="main"><span>:</span></span></span><span>if_splits</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat.elims|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat.induct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat.simps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat.pelims|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat.cases|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat.termination|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat.pinduct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat.psimps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_rel.inducts|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_rel.simps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_rel.induct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_rel.cases|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_rel.intros|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_graph.inducts|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_graph.simps|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_graph.induct|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_graph.cases|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_graph.intros|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat.elims|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat.induct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat.simps(2)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat.simps(1)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat.pelims|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat.cases|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat.termination|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat.pinduct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat.psimps(2)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat.psimps(1)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_rel.inducts|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_rel.simps|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_rel.induct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_rel.cases|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_rel.intros|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_graph.inducts|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_graph.simps|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_graph.induct|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_graph.cases|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_graph.intros(2)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_graph.intros(1)|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_rel_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_sumC_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_graph_def|axiom"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_dom|const"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_rel|const"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_sumC|const"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat|const"><span>encode_unary_nat</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>bool</span><span> </span><span>list</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>encode_unary_nat</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>False</span><span class="main"><span>#</span></span><span class="main"><span>(</span></span><span class="free"><span>encode_unary_nat</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>encode_unary_nat</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span>True</span><span class="main"><span>]</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9071..9076">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_prefix_free|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_unary_nat_prefix_free|thm"><span>encode_unary_nat_prefix_free</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prefix</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_unary_nat|const"><span>encode_unary_nat</span></a><span> </span><span class="free"><span>u</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_unary_nat|const"><span>encode_unary_nat</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>u</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>v</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_9071..9076"><span>assms</span></a><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>u</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>v</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="skolem"><span>v</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span> 
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>u</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="skolem"><span>v</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Prefix_Free_Code_Combinators.Nu\&lt;^sub&gt;e_def|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.Nu\&lt;^sub&gt;e_def|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.Nu\&lt;^sub&gt;e_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Prefix_Free_Code_Combinators.Nu\&lt;^sub&gt;e|const"><span>Nu<span class="hidden">â©</span><sub>e</sub></span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding|type"><span>encoding</span></a><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Nu<span class="hidden">â©</span><sub>e</sub></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Some</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_unary_nat|const"><span>encode_unary_nat</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nu\&lt;^sub&gt;e|const"><span>Nu<span class="hidden">â©</span><sub>e</sub></span></a><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> is encoding for natural numbers using unary encoding. It is 
</span><span>inefficient except for special cases, where the probability of large numbers decreases
</span><span>exponentially with its magnitude.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.unary_nat_bit_count|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.unary_nat_bit_count|thm"><span>unary_nat_bit_count</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nu\&lt;^sub&gt;e|const"><span>Nu<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Suc</span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nu\&lt;^sub&gt;e_def|fact"><span>Nu<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>n</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.unary_encoding|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.unary_encoding|thm"><span>unary_encoding</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nu\&lt;^sub&gt;e|const"><span>Nu<span class="hidden">â©</span><sub>e</sub></span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_unary_nat_prefix_free|fact"><span>encode_unary_nat_prefix_free</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encodingI|fact"><span>is_encodingI</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nu\&lt;^sub&gt;e_def|fact"><span>Nu<span class="hidden">â©</span><sub>e</sub>_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Encoding for positive numbers using Elias-Gamma code.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Prefix_Free_Code_Combinators.Ng\&lt;^sub&gt;e_def|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.Ng\&lt;^sub&gt;e_def|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.Ng\&lt;^sub&gt;e_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Prefix_Free_Code_Combinators.Ng\&lt;^sub&gt;e|const"><span>Ng<span class="hidden">â©</span><sub>e</sub></span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding|type"><span>encoding</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Ng<span class="hidden">â©</span><sub>e</sub></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span> 
      </span><span class="keyword1"><span>then</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nu\&lt;^sub&gt;e|const"><span>Nu<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><span>Nb<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span>else</span></span><span> </span><span>None</span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Ng\&lt;^sub&gt;e|const"><span>Ng<span class="hidden">â©</span><sub>e</sub></span></a><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> is an encoding for positive numbers using Elias-Gamma encoding\cite{elias1975}.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.elias_gamma_bit_count|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.elias_gamma_bit_count|thm"><span>elias_gamma_bit_count</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Ng\&lt;^sub&gt;e|const"><span>Ng<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="main"><span>::</span></span><span>ereal</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_10364..10368">True</span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_10371..10377">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>r</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_10364..10368"><span>True</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog_eq_zero_iff|fact"><span>floorlog_eq_zero_iff</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_10502..10503">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_10364..10368"><span>True</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog_bounds|fact"><span>floorlog_bounds</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_10502..10503"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_10371..10377"><span>r_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_10706..10707">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>r</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>r</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog_leI|fact"><span>floorlog_leI</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="skolem"><span>r</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog_geI|fact"><span>floorlog_geI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10921..10922">c</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>r</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>order_antisym</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Ng\&lt;^sub&gt;e|const"><span>Ng<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nu\&lt;^sub&gt;e|const"><span>Nu<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> 
    </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><span>Nb<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_10364..10368"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Ng\&lt;^sub&gt;e_def|fact"><span>Ng<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_10371..10377"><span>r_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.dependent_bit_count|fact"><span>dependent_bit_count</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_10706..10707"><span>b</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_10921..10922"><span>c</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.unary_nat_bit_count|fact"><span>unary_nat_bit_count</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bounded_nat_bit_count|fact"><span>bounded_nat_bit_count</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_10364..10368"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog_def|fact"><span>floorlog_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_10371..10377"><span>r_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_10364..10368"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Ng\&lt;^sub&gt;e_def|fact"><span>Ng<span class="hidden">â©</span><sub>e</sub>_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.elias_gamma_encoding|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.elias_gamma_encoding|thm"><span>elias_gamma_encoding</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Ng\&lt;^sub&gt;e|const"><span>Ng<span class="hidden">â©</span><sub>e</sub></span></a><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_11573..11574">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>{</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>inj_onI</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_11730..11735">x_pos</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_11791..11796">y_pos</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_11818..11824">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>r</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_11871..11872">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><span class="main"><span>(</span></span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_11984..11985">c</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>Let_def</span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_11818..11824"><span>r_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>r</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_11871..11872"><span>b</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>Let_def</span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_11818..11824"><span>r_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_11984..11985"><span>c</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span>  </span><span>prod_eq_iff</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>r</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_11818..11824"><span>r_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_11730..11735"><span>x_pos</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog_bounds|fact"><span>floorlog_bounds</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>r</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_11984..11985"><span>c</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog_bounds|fact"><span>floorlog_bounds</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_11791..11796"><span>y_pos</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>eq_diff_iff</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Ng\&lt;^sub&gt;e|const"><span>Ng<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Ng\&lt;^sub&gt;e_def|fact"><span>Ng<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_11573..11574"><span>a</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding_compose|fact"><span>encoding_compose</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nu\&lt;^sub&gt;e|const"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nu\&lt;^sub&gt;e|const"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nu\&lt;^sub&gt;e|const"><span>Nu<span class="hidden">â©</span><sub>e</sub></span></a></a></a><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span></a></span></a></span><span> </span><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span class="main"><span class="main"><span class="main"><span>Î»</span></span></span></span><span class="bound"><span class="bound"><span class="bound"><span>r</span></span></span></span><span class="main"><span class="main"><span class="main"><span>.</span></span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><span>Nb<span class="hidden">â©</span><sub>e</sub></span></a></a></a><span> </span><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span class="numeral"><span class="numeral"><span class="numeral"><span>2</span></span></span></span><span class="main"><span class="main"><span class="main"><span>^</span></span></span></span><span class="bound"><span class="bound"><span class="bound"><span>r</span></span></span></span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> 
        </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.dependent_encoding|fact"><span>dependent_encoding</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.unary_encoding|fact"><span>unary_encoding</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bounded_nat_encoding|fact"><span>bounded_nat_encoding</span></a><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e_def|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e_def|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding|type"><span>encoding</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>N<span class="hidden">â©</span><sub>e</sub></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Ng\&lt;^sub&gt;e|const"><span>Ng<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> is an encoding for all natural numbers using exponential Golomb 
</span><span>encoding~\cite{teuhola1978}. Exponential Golomb codes are also used in video compression
</span><span>applications~\cite{richardson2010}.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.exp_golomb_encoding|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.exp_golomb_encoding|thm"><span>exp_golomb_encoding</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e_def|fact"><span>N<span class="hidden">â©</span><sub>e</sub>_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding_compose_2|fact"><span>encoding_compose_2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> g</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span class="main"><span class="main"><span class="main"><span>Î»</span></span></span></span><span class="bound"><span class="bound"><span class="bound"><span>n</span></span></span></span><span class="main"><span class="main"><span class="main"><span>.</span></span></span></span><span> </span><span class="bound"><span class="bound"><span class="bound"><span>n</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>+</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.elias_gamma_encoding|fact"><span>elias_gamma_encoding</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.exp_golomb_bit_count_exact|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.exp_golomb_bit_count_exact|thm"><span>exp_golomb_bit_count_exact</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e_def|fact"><span>N<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.elias_gamma_bit_count|fact"><span>elias_gamma_bit_count</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.exp_golomb_bit_count|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.exp_golomb_bit_count|thm"><span>exp_golomb_bit_count</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.exp_golomb_bit_count_exact|fact"><span>exp_golomb_bit_count_exact</span></a><span> </span><span>add.commute</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_13358..13363">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.exp_golomb_bit_count_est|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.exp_golomb_bit_count_est|thm"><span>exp_golomb_bit_count_est</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>m</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.exp_golomb_bit_count|fact"><span>exp_golomb_bit_count</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>m</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_13358..13363"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Integers</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e_def|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e_def|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e|const"><span>I<span class="hidden">â©</span><sub>e</sub></span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>int</span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding|type"><span>encoding</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I<span class="hidden">â©</span><sub>e</sub></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>â¤</span></span><span class="main"><span>0</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e|const"><span>I<span class="hidden">â©</span><sub>e</sub></span></a><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> is an encoding for integers using exponential Golomb codes by embedding
</span><span>the integers into the natural numbers, specifically the positive numbers are embedded into
</span><span>the odd-numbers and the negative numbers are embedded into the even numbers. The embedding
</span><span>has the benefit, that the bit count for an integer only depends on its absolute value.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.int_encoding|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.int_encoding|thm"><span>int_encoding</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e|const"><span>I<span class="hidden">â©</span><sub>e</sub></span></a><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>inj_onI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>eq_nat_nat_iff</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>presburger</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e_def|fact"><span>I<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.exp_golomb_encoding|fact"><span>exp_golomb_encoding</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding_compose_2|fact"><span>encoding_compose_2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a></a></a><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.int_bit_count|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.int_bit_count|thm"><span>int_bit_count</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e|const"><span>I<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>n</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span> 
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_14538..14539">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¹</span></span><span> 
    </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span>  </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floor_log_eq_if|fact"><span>floor_log_eq_if</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¹</span></span><span> 
    </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span>  </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_14538..14539"><span>a</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> m</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>add.commute</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e_def|fact"><span>I<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.exp_golomb_bit_count_exact|fact"><span>exp_golomb_bit_count_exact</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog_def|fact"><span>floorlog_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_14897..14902">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.int_bit_count_1|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.int_bit_count_1|thm"><span>int_bit_count_1</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>abs</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e|const"><span>I<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>n</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>+</span></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span> 
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_15008..15009">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¹</span></span><span> 
    </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span>  </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floor_log_eq_if|fact"><span>floor_log_eq_if</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¹</span></span><span> 
    </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_15008..15009"><span>a</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> m</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>add.commute</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e|const"><span>I<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span>real_of_int</span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>n</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_14897..14902"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e_def|fact"><span>I<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.exp_golomb_bit_count_exact|fact"><span>exp_golomb_bit_count_exact</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog_def|fact"><span>floorlog_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>n</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_14897..14902"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>log_mult</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_15547..15552">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.int_bit_count_est_1|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.int_bit_count_est_1|thm"><span>int_bit_count_est_1</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¦</span></span><span class="free"><span>n</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>r</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e|const"><span>I<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>abs</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_15677..15681">True</span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real_of_int</span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span>real_of_int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span>  </span><span class="main"><span>Â¦</span></span><span>real_of_int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>Â¦</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>of_int_floor_le</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_int</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_15677..15681"><span>True</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_15547..15552"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span>real_of_int</span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span>real_of_int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_int</span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_15677..15681"><span>True</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_15547..15552"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.int_bit_count_1|fact"><span>int_bit_count_1</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_16043..16048">False</span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>r</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_15547..15552"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_16043..16048"><span>False</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e_def|fact"><span>I<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.exp_golomb_bit_count_exact|fact"><span>exp_golomb_bit_count_exact</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_16208..16213">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.int_bit_count_est|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.int_bit_count_est|thm"><span>int_bit_count_est</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¦</span></span><span class="free"><span>n</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>r</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e|const"><span>I<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span>r</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e|const"><span>I<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>n</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.int_bit_count|fact"><span>int_bit_count</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_16208..16213"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Lists</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e_def|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e_def|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e|const"><span>Lf<span class="hidden">â©</span><sub>e</sub></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Lf<span class="hidden">â©</span><sub>e</sub></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span>length</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> 
      </span><span class="keyword1"><span>then</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_append|const"><span>opt_append</span></a><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>(</span></span><span>Some</span><span> </span><span class="main"><span>[]</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span>else</span></span><span> </span><span>None</span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e|const"><span>Lf<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> is an encoding for lists of length </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span>, 
</span><span>where the elements are encoding using the encoder </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>e</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span>.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_16795..16800">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.fixed_list_encoding|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.fixed_list_encoding|thm"><span>fixed_list_encoding</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="free"><span>e</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e|const"><span>Lf<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>n</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encodingI_2|fact"><span>is_encodingI_2</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e_def|fact"><span>Lf<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_def|fact"><span>opt_comp_def</span></a><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span class="main"><span>:</span></span></span><span>if_splits</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_17022..17025">Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encodingI_2|fact"><span>is_encodingI_2</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_17095..17096">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp|const"><span>opt_comp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e|const"><span>Lf<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e|const"><span>Lf<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17155..17156">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>length</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_17095..17096"><span>a</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>length</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e_def|fact"><span>Lf<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_def|fact"><span>opt_comp_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x1</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x2</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_17284..17289">x_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>x1</span></span><span class="main"><span>@</span></span><span class="main"><span>[</span></span><span class="skolem"><span>x2</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>length</span><span> </span><span class="skolem"><span>x1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>length_append_singleton</span><span> </span><span>lessI</span><span> </span><span>nat.inject</span><span> </span><span>order.refl</span><span> 
          </span><span>take_all</span><span> </span><span>take_hd_drop</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17433..17434">c</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>length</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_17095..17096"><span>a</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>length</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e_def|fact"><span>Lf<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_def|fact"><span>opt_comp_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y1</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y2</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_17562..17567">y_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>y1</span></span><span class="main"><span>@</span></span><span class="main"><span>[</span></span><span class="skolem"><span>y2</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>length</span><span> </span><span class="skolem"><span>y1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>length_append_singleton</span><span> </span><span>lessI</span><span> </span><span>nat.inject</span><span> </span><span>order.refl</span><span>
          </span><span>take_all</span><span> </span><span>take_hd_drop</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17710..17711">d</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp|const"><span>opt_comp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_append|const"><span>opt_append</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e|const"><span>Lf<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="skolem"><span>x1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="skolem"><span>x2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_append|const"><span>opt_append</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e|const"><span>Lf<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="skolem"><span>y1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="skolem"><span>y2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_17095..17096"><span>a</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_17155..17156"><span>b</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_17433..17434"><span>c</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e_def|fact"><span>Lf<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_17284..17289"><span>x_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_17562..17567"><span>y_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp|const"><span>opt_comp</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e|const"><span>Lf<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="skolem"><span>x1</span></span><span class="main"><span>)</span></span><span>  </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e|const"><span>Lf<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="skolem"><span>y1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_append|fact"><span>opt_comp_append</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_append_2|fact"><span>opt_comp_append_2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_17968..17969">e</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>y1</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encodingD|fact"><span>is_encodingD</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_17022..17025"><span>Suc</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp|const"><span>opt_comp</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="skolem"><span>x2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="skolem"><span>y2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.opt_comp_append_3|fact"><span>opt_comp_append_3</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_17710..17711"><span>d</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>y2</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encodingD|fact"><span>is_encodingD</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_16795..16800"><span>assms</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_17968..17969"><span>e</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_17284..17289"><span>x_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_17562..17567"><span>y_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.fixed_list_bit_count|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.fixed_list_bit_count|thm"><span>fixed_list_bit_count</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e|const"><span>Lf<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span>length</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>n</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>0</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e_def|fact"><span>Lf<span class="hidden">â©</span><sub>e</sub>_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_18438..18441">Suc</span><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Suc</span><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x1</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x2</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_18536..18541">x_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>x1</span></span><span class="main"><span>@</span></span><span class="main"><span>[</span></span><span class="skolem"><span>x2</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>length</span><span> </span><span class="skolem"><span>x1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>length_append_singleton</span><span> </span><span>lessI</span><span> </span><span>nat.inject</span><span> </span><span>order.refl</span><span>
          </span><span>take_all</span><span> </span><span>take_hd_drop</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e|const"><span>Lf<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="skolem"><span>x1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="skolem"><span>x1</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_18536..18541"><span>x_def</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_18438..18441"><span>Suc</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e_def|fact"><span>Lf<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_18536..18541"><span>x_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count_append|fact"><span>bit_count_append</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e_def|fact"><span>Lf<span class="hidden">â©</span><sub>e</sub>_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Prefix_Free_Code_Combinators.L\&lt;^sub&gt;e_def|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.L\&lt;^sub&gt;e_def|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.L\&lt;^sub&gt;e_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Prefix_Free_Code_Combinators.L\&lt;^sub&gt;e|const"><span>L<span class="hidden">â©</span><sub>e</sub></span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>L<span class="hidden">â©</span><sub>e</sub></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nu\&lt;^sub&gt;e|const"><span>Nu<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e|const"><span>Lf<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.L\&lt;^sub&gt;e|const"><span>L<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> is an encoding for arbitrary length lists, where the elements are encoding using the
</span><span>encoder </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>e</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span>.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_19126..19131">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.list_encoding|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.list_encoding|thm"><span>list_encoding</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="free"><span>e</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.L\&lt;^sub&gt;e|const"><span>L<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>xs</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>inj_on_def</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>xs</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.L\&lt;^sub&gt;e|const"><span>L<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_19126..19131"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.L\&lt;^sub&gt;e_def|fact"><span>L<span class="hidden">â©</span><sub>e</sub>_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding_compose_2|fact"><span>encoding_compose_2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> g</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span class="main"><span class="main"><span class="main"><span>Î»</span></span></span></span><span class="bound"><span class="bound"><span class="bound"><span>x</span></span></span></span><span class="main"><span class="main"><span class="main"><span>.</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>length</span><span> </span><span class="bound"><span class="bound"><span class="bound"><span>x</span></span></span></span><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span><span> </span><span class="bound"><span class="bound"><span class="bound"><span>x</span></span></span></span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span>
        </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.dependent_encoding|fact"><span>dependent_encoding</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.unary_encoding|fact"><span>unary_encoding</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.fixed_list_encoding|fact"><span>fixed_list_encoding</span></a><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.sum_list_triv_ereal|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.sum_list_triv_ereal|thm"><span>sum_list_triv_ereal</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>ereal</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>length</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>a</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>sum_list_triv</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.list_bit_count|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.list_bit_count|thm"><span>list_bit_count</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.L\&lt;^sub&gt;e|const"><span>L<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.L\&lt;^sub&gt;e|const"><span>L<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="free"><span>xs</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.L\&lt;^sub&gt;e_def|fact"><span>L<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.dependent_bit_count|fact"><span>dependent_bit_count</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.fixed_list_bit_count|fact"><span>fixed_list_bit_count</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.unary_nat_bit_count|fact"><span>unary_nat_bit_count</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="free"><span>xs</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span><span> </span><span>group_cancel.add1</span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.sum_list_triv_ereal|fact"><span>sum_list_triv_ereal</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>sum_list_addf</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Functions</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_fun_def|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_fun_def|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_fun_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Prefix_Free_Code_Combinators.encode_fun|const"><span>encode_fun</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span>list</span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'b</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding|type"><span>encoding</span></a><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'b</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding|type"><span>encoding</span></a><span>"</span></span></span><span> 
  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infixr</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>e</sub></span></span><span>"</span></span><span> 65</span><span class="main"><span>)</span></span><span>  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>encode_fun</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>extensional</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span>then</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e|const"><span>Lf<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span>else</span></span><span> </span><span>None</span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>xs</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="free"><span>e</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> is an encoding for functions whose domain is </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span>set</span><span> </span><span class="free"><span>xs</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span>,
</span><span>where the values are encoding using the encoder </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>e</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span>.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_20600..20605">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.fun_encoding|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.fun_encoding|thm"><span>fun_encoding</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="free"><span>e</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_20694..20695">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>map</span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>extensional</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>inj_onI</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>extensionalityI</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun_def|fact"><span>encode_fun_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding_compose|fact"><span>encoding_compose</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e|const"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e|const"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Lf\&lt;^sub&gt;e|const"><span>Lf<span class="hidden">â©</span><sub>e</sub></span></a></a></a><span> </span><span class="free"><span class="free"><span class="free"><span>e</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>length</span><span> </span><span class="free"><span class="free"><span class="free"><span>xs</span></span></span></span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> 
        </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.fixed_list_encoding|fact"><span>fixed_list_encoding</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_20600..20605"><span>assms</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_20694..20695"><span>a</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.fun_bit_count|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.fun_bit_count|thm"><span>fun_bit_count</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>extensional</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun_def|fact"><span>encode_fun_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.fixed_list_bit_count|fact"><span>fixed_list_bit_count</span></a><span> </span><span>comp_def</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_21189..21194">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.fun_bit_count_est|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.fun_bit_count_est|thm"><span>fun_bit_count_est</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>extensional</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span>  </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span>  </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span>  </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_21189..21194"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.fun_bit_count|fact"><span>fun_bit_count</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sum_list_mono</span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_21189..21194"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.sum_list_triv_ereal|fact"><span>sum_list_triv_ereal</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Finite Sets</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e_def|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e_def|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e|const"><span>S<span class="hidden">â©</span><sub>e</sub></span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding|type"><span>encoding</span></a><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span>set</span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding|type"><span>encoding</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>S<span class="hidden">â©</span><sub>e</sub></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>S</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span>finite</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>S</span></span></span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>S</span></span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>dom</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span> 
      </span><span class="keyword1"><span>then</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.L\&lt;^sub&gt;e|const"><span>L<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span> </span><span class="main"><span>(</span></span><span>linorder.sorted_key_list_of_set</span><span> </span><span class="main"><span>(â¤)</span></span><span> </span><span class="main"><span>(</span></span><span>the</span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>e</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>S</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span>else</span></span><span> </span><span>None</span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e|const"><span>S<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> is an encoding for finite sets whose elements are encoded using the
</span><span>  encoder </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>e</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span>.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_22023..22028">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.set_encoding|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.set_encoding|thm"><span>set_encoding</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="free"><span>e</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e|const"><span>S<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_22114..22115">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span class="main"><span>(</span></span><span>the</span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>dom</span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>inj_on_def</span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>comp_inj_on</span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding_imp_inj|fact"><span>encoding_imp_inj</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_22023..22028"><span>assms</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> </span><span>folding_insort_key</span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(â¤)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(&lt;)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>dom</span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>the</span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_22114..22115"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_22303..22305">by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>unfold_locales</span></span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>S</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e|const"><span>S<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e_def|fact"><span>S<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_22303..22305"><span>sorted_key_list_of_set_inject</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding_compose|fact"><span>encoding_compose</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.L\&lt;^sub&gt;e|const"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.L\&lt;^sub&gt;e|const"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.L\&lt;^sub&gt;e|const"><span>L<span class="hidden">â©</span><sub>e</sub></span></a></a></a><span> </span><span class="free"><span class="free"><span class="free"><span>e</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.list_encoding|fact"><span>list_encoding</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_22023..22028"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>inj_onI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_22535..22540">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.set_bit_count|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.set_bit_count|thm"><span>set_bit_count</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="free"><span>e</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e|const"><span>S<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span>finite</span><span> </span><span class="free"><span>S</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_22703..22704">f</span><span class="main"><span>:</span></span><span>True</span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e|const"><span>S<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="free"><span>S</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>S</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>dom</span><span> </span><span class="free"><span>e</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_22807..22811">True</span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_22822..22823">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span class="main"><span>(</span></span><span>the</span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>dom</span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>inj_on_def</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>comp_inj_on</span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding_imp_inj|fact"><span>encoding_imp_inj</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_22535..22540"><span>assms</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span class="main"><span>)</span></span><span>
  
    </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> </span><span>folding_insort_key</span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(â¤)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(&lt;)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>dom</span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>the</span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_22822..22823"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_23019..23021">by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>unfold_locales</span></span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_23054..23055">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>distinct</span><span> </span><span class="main"><span>(</span></span><span>linorder.sorted_key_list_of_set</span><span> </span><span class="main"><span>(â¤)</span></span><span> </span><span class="main"><span>(</span></span><span>the</span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>distinct</span><span> </span><span class="var"><span>?l</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_23019..23021"><span>distinct_sorted_key_list_of_set</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_22807..22811"><span>True</span></a><span>
        </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_23019..23021"><span>distinct_if_distinct_map</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e|const"><span>S<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>e</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="var"><span>?l</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_22703..22704"><span>f</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_22807..22811"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e_def|fact"><span>S<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.list_bit_count|fact"><span>list_bit_count</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="free"><span>S</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>sum_list_distinct_conv_sum_set</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_23054..23055"><span>b</span></a><span class="main"><span class="main"><span>]</span></span></span><span> 
          </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_23019..23021"><span>set_sorted_key_list_of_set</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_22807..22811"><span>True</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_22703..22704"><span>f</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_23556..23561">False</span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="free"><span>S</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>None</span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="free"><span>S</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>â</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="free"><span>S</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>e</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>â</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>sum_Pinfty</span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_22703..22704"><span>f</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_23556..23561"><span>False</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e_def|fact"><span>S<span class="hidden">â©</span><sub>e</sub>_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_22703..22704"><span>f</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e_def|fact"><span>S<span class="hidden">â©</span><sub>e</sub>_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_23884..23889">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.sum_triv_ereal|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.sum_triv_ereal|thm"><span>sum_triv_ereal</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>ereal</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="main"><span class="bound"><span>_</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>a</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_24053..24057">PInf</span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_23884..23889"><span>assms</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_24053..24057"><span>PInf</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>S</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span>finite_induct</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_24148..24152">MInf</span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_23884..23889"><span>assms</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_24148..24152"><span>MInf</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>S</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span>finite_induct</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_24236..24241">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.set_bit_count_est|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.set_bit_count_est|thm"><span>set_bit_count_est</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e|const"><span>S<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e|const"><span>S<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="free"><span>S</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_24236..24241"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.set_bit_count|fact"><span>set_bit_count</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="free"><span>S</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_24236..24241"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sum_mono</span><span> </span><span>add_mono</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.sum_triv_ereal|fact"><span>sum_triv_ereal</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_24236..24241"><span>assms</span></a><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>2</span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_24236..24241"><span>assms</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>,</span></span><span>4</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><span>ereal_mult_right_mono</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Floating point numbers\label{sec:float_enc}</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e_def|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e_def|thm"><span class="entity_def" id="Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e|const"><span>F<span class="hidden">â©</span><sub>e</sub></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>F<span class="hidden">â©</span><sub>e</sub></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e|const"><span>I<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_prod|const"><span>Ã<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e|const"><span>I<span class="hidden">â©</span><sub>e</sub></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.exponent|const"><span>exponent</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.float_encoding|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.float_encoding|thm"><span>float_encoding</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e|const"><span>F<span class="hidden">â©</span><sub>e</sub></span></a><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.exponent|const"><span>exponent</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj</span><span> </span><span class="var"><span>?g</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>injI</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.exponent|const"><span>exponent</span></a><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.exponent|const"><span>exponent</span></a><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.real_of_float|const"><span>real_of_float</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.real_of_float|const"><span>real_of_float</span></a><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa_exponent|fact"><span>mantissa_exponent</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.real_of_float_inverse|fact"><span>real_of_float_inverse</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>f</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e|const"><span>F<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="bound"><span>f</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e_def|fact"><span>F<span class="hidden">â©</span><sub>e</sub>_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding_compose_2|fact"><span>encoding_compose_2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> g</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span class="var"><span class="var"><span>?g</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span>
        </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.dependent_encoding|fact"><span>dependent_encoding</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.int_encoding|fact"><span>int_encoding</span></a><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.suc_n_le_2_pow_n|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.suc_n_le_2_pow_n|thm"><span>suc_n_le_2_pow_n</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>n</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.float_bit_count_1|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.float_bit_count_1|thm"><span>float_bit_count_1</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e|const"><span>F<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>6</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> 
    </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.exponent|const"><span>exponent</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e|const"><span>I<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> 
    </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e|const"><span>I<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.exponent|const"><span>exponent</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e_def|fact"><span>F<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.dependent_bit_count|fact"><span>dependent_bit_count</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
    </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>3</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> 
    </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.exponent|const"><span>exponent</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>3</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.int_bit_count_est_1|fact"><span>int_bit_count_est_1</span></a><span> </span><span>add_mono</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The following establishes an estimate for the bit count of a floating
</span><span>point number in non-normalized representation:</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_26292..26297">lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.float_bit_count_2|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.float_bit_count_2|thm"><span>float_bit_count_2</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>int</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>e</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>int</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.float_of|const"><span>float_of</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e|const"><span>F<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
    </span><span class="numeral"><span>6</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>m</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>e</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_26485..26486">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>int</span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_26536..26543">b_assms</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>int</span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_26612..26616">True</span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>int</span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>int</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>i</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_26612..26616"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>int</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>int</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>i</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_26536..26543"><span>b_assms</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><span>diff_mono</span><span> </span><span>mult_mono</span><span> </span><span>of_nat_mono</span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.suc_n_le_2_pow_n|fact"><span>suc_n_le_2_pow_n</span></a><span class="main"><span>)</span></span><span> 
        </span><span class="operator"><span>simp_all</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>i</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_26612..26616"><span>True</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>of_nat_mult</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><span>power_add</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> 
        </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>*</span></span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>int</span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>*</span></span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>int</span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>  
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_26536..26543"><span>b_assms</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><span>mult_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27423..27424">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.exponent|const"><span>exponent</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
    </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>m</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>e</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span class="main"><span>=</span></span><span class="main"><span>0</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span> </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_27594..27599">False</span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.Float|const"><span>Float</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>e</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_26292..26297"><span>f_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.Float.abs_eq|fact"><span>Float.abs_eq</span></a><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>i</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_27718..27723">m_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="skolem"><span>i</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_27762..27767">e_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>e</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.exponent|const"><span>exponent</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>i</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.denormalize_shift|fact"><span>denormalize_shift</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27839..27852">mantissa_ge_1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_27594..27599"><span>False</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa_noteq_0|fact"><span>mantissa_noteq_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.exponent|const"><span>exponent</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>e</span></span><span class="main"><span>+</span></span><span class="skolem"><span>i</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_27762..27767"><span>e_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span>  </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>e</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="main"><span>Â¦</span></span><span class="skolem"><span>i</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_mono</span><span> </span><span>add_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>e</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>e</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="skolem"><span>i</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>e</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>i</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_26485..26486"><span>b</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_27839..27852"><span>mantissa_ge_1</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>e</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>i</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> 
      </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>e</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>*</span></span><span>  </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>i</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>e</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><span>mult_left_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>*</span></span><span>  </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>i</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>e</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>*</span></span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="skolem"><span>i</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>e</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>m</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>e</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_27718..27723"><span>m_def</span></a><span> </span><span>abs_mult</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.exponent|const"><span>exponent</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>m</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>e</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span>of_int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.exponent|const"><span>exponent</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
      </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span>of_int</span><span> </span><span class="free"><span>m</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span>of_int</span><span> </span><span class="free"><span>e</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>flip</span></span><span class="main"><span class="main"><span>:</span></span></span><span>of_int_abs</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>mono_tags</span><span class="main"><span class="main"><span>,</span></span></span><span> opaque_lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>numeral_One</span><span> 
          </span><span>of_int_add</span><span> </span><span>of_int_le_iff</span><span> </span><span>of_int_mult</span><span> </span><span>of_int_numeral</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>log_mult</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e|const"><span>F<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
    </span><span class="numeral"><span>6</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.exponent|const"><span>exponent</span></a><span> </span><span class="free"><span>f</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.float_bit_count_1|fact"><span>float_bit_count_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>6</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>m</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>e</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#offset_27423..27424"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Prefix_Free_Code_Combinators.float_bit_count_zero|fact"><span class="entity_def" id="Prefix_Free_Code_Combinators.float_bit_count_zero|thm"><span>float_bit_count_zero</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e|const"><span>F<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.float_of|const"><span>float_of</span></a><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e_def|fact"><span>F<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.dependent_bit_count|fact"><span>dependent_bit_count</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.int_bit_count|fact"><span>int_bit_count</span></a><span> 
      </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.zero_float.abs_eq|fact"><span>zero_float.abs_eq</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>



</span><span class="keyword2"><span class="keyword"><span>end</span></span></span></pre></div><div id='Examples'><div class="head">
<h1>Theory Examples</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Examples\label{sec:examples}</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Examples</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="Prefix_Free_Code_Combinators.html"><span>Prefix_Free_Code_Combinators</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The following introduces a few examples for encoders:</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>notepad</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span> </span><span class="comment1"><span>â</span><span class="quoted"><span>â¹</span><span>tag</span><span> </span><span>visible</span><span>âº</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_196..202">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>example1</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>example1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_prod|const"><span>Ã<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>This is an encoder for a pair of natural numbers using exponential Golomb codes.</span><span>âº</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Given a pair it is possible to estimate the number of bits necessary to
</span><span>    encode it using the </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> lemmas.</span><span>âº</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>example1</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>4</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Examples.html#offset_196..202"><span>example1_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.dependent_bit_count|fact"><span>dependent_bit_count</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.exp_golomb_bit_count_exact|fact"><span>exp_golomb_bit_count_exact</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Note that a finite bit count automatically implies that the encoded element is in the domain
</span><span>  of the encoding function. This means usually it is possible to establish a bound on the size of
</span><span>  the datastructure and verify that the value is encodable simultaneously.</span><span>âº</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>dom</span><span> </span><span class="skolem"><span>example1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count_finite_imp_dom|fact"><span>bit_count_finite_imp_dom</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_944..950">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>example2</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>example2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>42</span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><span>Nb<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="numeral"><span>314</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The second example illustrates the use of the combinator </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>(â<span class="hidden">â©</span><sub>e</sub>)</span></a></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span>, which allows 
</span><span>  encoding functions with a known finite encodable domain, here we assume the values are smaller
</span><span>  than </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="numeral"><span>314</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> on the domain </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="main"><span>{..&lt;</span></span><span class="numeral"><span>42</span></span><span class="main"><span>}</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span>.</span><span>âº</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>example2</span></span><span> </span><span class="skolem"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>42</span></span><span class="main"><span>*</span></span><span class="numeral"><span>9</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_1320..1321">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>42</span></span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>E</sub></span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>314</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>f</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>42</span></span><span class="main"><span>]</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><span>Nb<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="numeral"><span>314</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Examples.html#offset_1320..1321"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Examples.html#offset_944..950"><span>example2_def</span></a><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.fun_bit_count|fact"><span>fun_bit_count</span></a><span> </span><span>PiE_def</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>42</span></span><span class="main"><span>]</span></span><span class="main"><span>.</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="numeral"><span>313</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Examples.html#offset_1320..1321"><span>a</span></a><span> </span><span>Pi_def</span><span> </span><span>PiE_def</span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bounded_nat_bit_count|fact"><span>bounded_nat_bit_count</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>arg_cong</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>sum_list</span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>map_cong</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.compute_floorlog|fact"><span>compute_floorlog</span></a><span> </span><span>sum_list_triv</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword3"><span class="command"><span>define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>example3</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>example3</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="numeral"><span>42</span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><a class="entity_ref" href="Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><span>Nb<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The third example is more complex and illustrates the use of dependent encoders, consider
</span><span>  a function with domain </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="main"><span>{..&lt;</span></span><span class="main"><span>(</span></span><span class="numeral"><span>42</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> whose values are natural numbers in the interval
</span><span>  </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>}</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span>. Let us assume the bound is not known in advance and needs to be encoded
</span><span>  as well. This can be done using a dependent product encoding, where the first component encodes
</span><span>  the bound and the second component is an encoder parameterized by that value.</span><span>âº</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span></pre></div>
<div id="Marriage">
<div class="head">
<h1>Theory Marriage</h1>
</div>
<pre class="source"><span class="comment1">(* Authors: Dongchen Jiang and Tobias Nipkow *)</span>

<span class="keyword1"><span class="command">theory</span></span> Marriage
<span class="keyword2"><span class="keyword">imports</span></span> <a href="https://www.cl.cam.ac.uk/research/hvg/Isabelle/dist/library/HOL/HOL/Main.html">Main</a> 
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">theorem</span></span> marriage_necessary<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'b</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">I</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"finite <span class="free">I</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">i</span><span class="main">∈</span><span class="free">I</span><span class="main">.</span> finite <span class="main">(</span><span class="free">A</span> <span class="bound">i</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">R</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="free">I</span><span class="main">.</span> <span class="bound">R</span> <span class="bound">i</span> <span class="main">∈</span> <span class="free">A</span> <span class="bound">i</span><span class="main">)</span> <span class="main">∧</span> inj_on <span class="bound">R</span> <span class="free">I</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">R</span><span class="main">.</span> <span class="var">?R</span> <span class="bound">R</span> <span class="free">A</span> <span class="main">&amp;</span> <span class="var">?inj</span> <span class="bound">R</span> <span class="free">A</span>"</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">J</span></span><span class="main">⊆</span><span class="free">I</span><span class="main">.</span> card <span class="bound">J</span> <span class="main">≤</span> card <span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="free">A</span> <span class="main">`</span> <span class="bound">J</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">clarify</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">J</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">J</span> <span class="main">⊆</span> <span class="free">I</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">J</span> <span class="main">≤</span> card <span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="free">A</span> <span class="main">`</span> <span class="skolem">J</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">R</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="skolem">R</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?inj</span> <span class="skolem">R</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"inj_on <span class="skolem">R</span> <span class="skolem">J</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> subset_inj_on<span class="main"><span class="main">[</span></span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="var">?inj</span> <span class="skolem">R</span> <span class="free">A</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">J</span><span class="main">⊆</span><span class="free">I</span>›</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">R</span> <span class="main">`</span> <span class="skolem">J</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="free">A</span> <span class="main">`</span> <span class="skolem">J</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">J</span><span class="main">⊆</span><span class="free">I</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?R</span> <span class="skolem">R</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="free">A</span> <span class="main">`</span> <span class="skolem">J</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">J</span><span class="main">⊆</span><span class="free">I</span>›</span></span> assms
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> finite_UN_I finite_subset subsetD<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> card_inj_on_le<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The proof by Halmos and Vaughan:›</span></span>
<span class="keyword1"><span class="command">theorem</span></span> marriage_HV<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'b</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">I</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"finite <span class="free">I</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">i</span><span class="main">∈</span><span class="free">I</span><span class="main">.</span> finite <span class="main">(</span><span class="free">A</span> <span class="bound">i</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">J</span></span><span class="main">⊆</span><span class="free">I</span><span class="main">.</span> card <span class="bound">J</span> <span class="main">≤</span> card <span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="free">A</span> <span class="main">`</span> <span class="bound">J</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?M</span> <span class="free">A</span> <span class="free">I</span>"</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">R</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="free">I</span><span class="main">.</span> <span class="bound">R</span> <span class="bound">i</span> <span class="main">∈</span> <span class="free">A</span> <span class="bound">i</span><span class="main">)</span> <span class="main">∧</span> inj_on <span class="bound">R</span> <span class="free">I</span>"</span></span>
       <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?SDR</span> <span class="free">A</span> <span class="free">I</span>"</span></span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">R</span><span class="main">.</span> <span class="var">?R</span> <span class="bound">R</span> <span class="free">A</span> <span class="free">I</span> <span class="main">&amp;</span> <span class="var">?inj</span> <span class="bound">R</span> <span class="free">A</span> <span class="free">I</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">I</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">I</span> <span class="main">⟹</span> <span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="skolem">I</span><span class="main">.</span> finite <span class="main">(</span><span class="free">A</span> <span class="bound">i</span><span class="main">)</span> <span class="main">⟹</span> <span class="var">?M</span> <span class="free">A</span> <span class="skolem">I</span> <span class="main">⟹</span> <span class="var">?SDR</span> <span class="free">A</span> <span class="skolem">I</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">A</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> finite_psubset_induct<span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>psubset <span class="skolem">I</span><span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">I</span><span class="main">=</span><span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">next</span></span> 
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">I</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="skolem">I</span><span class="main">.</span> <span class="skolem">A</span> <span class="bound">i</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
          <span class="keyword3"><span class="command">assume</span></span>  <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="skolem">I</span><span class="main">.</span> <span class="skolem">A</span> <span class="bound">i</span><span class="main">≠</span><span class="main">{}</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">∈</span><span class="skolem">I</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="skolem">i</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">i</span><span class="main">}</span><span class="main">⊆</span> <span class="skolem">I</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> mp<span class="main">[</span><span class="operator">OF</span> spec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> psubset.prems<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span> this<span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="skolem">i</span><span class="main">=</span><span class="main">{}</span>›</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
          <span class="keyword3"><span class="command">assume</span></span> case1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">K</span></span><span class="main">⊂</span><span class="skolem">I</span><span class="main">.</span> <span class="bound">K</span><span class="main">≠</span><span class="main">{}</span> <span class="main">⟶</span> card <span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="bound">K</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> card <span class="bound">K</span> <span class="main">+</span> <span class="main">1</span>"</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">I</span><span class="main">≠</span><span class="main">{}</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">∈</span><span class="skolem">I</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="skolem">I</span><span class="main">.</span> <span class="skolem">A</span> <span class="bound">i</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="skolem">n</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="skolem">A</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?A'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">i</span><span class="main">.</span> <span class="skolem">A</span> <span class="bound">i</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?I'</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">I</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">n</span><span class="main">}</span>"</span></span>
            <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">∈</span><span class="skolem">I</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?I'</span> <span class="main">⊂</span> <span class="skolem">I</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> DiffD2 Diff_subset insertI1 psubset_eq<span class="main">)</span>
            <span class="keyword1"><span class="command">have</span></span> fin'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="var">?I'</span><span class="main">.</span> finite <span class="main">(</span><span class="var">?A'</span> <span class="bound">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> psubset.prems<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?M</span> <span class="var">?A'</span> <span class="var">?I'</span>"</span></span>
            <span class="keyword1"><span class="command">proof</span></span> <span class="operator">clarify</span>
              <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">J</span>
              <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">J</span> <span class="main">⊆</span> <span class="var">?I'</span>"</span></span>
              <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">J</span> <span class="main">⊂</span> <span class="skolem">I</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted"><span class="quoted">‹<span class="skolem">I</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">n</span><span class="main">}</span> <span class="main">⊂</span> <span class="skolem">I</span>›</span></span> subset_psubset_trans<span class="main">)</span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">J</span> <span class="main">≤</span> card <span class="main">(</span><span class="main">⋃</span><span class="bound">i</span><span class="main">∈</span><span class="skolem">J</span><span class="main">.</span> <span class="skolem">A</span> <span class="bound">i</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
                <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">J</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">next</span></span>
                <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">J</span> <span class="main">≠</span> <span class="main">{}</span>"</span></span>
                <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">J</span> <span class="main">+</span> <span class="main">1</span> <span class="main">≤</span> card<span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="skolem">J</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> case1 <span class="quoted"><span class="quoted">‹<span class="skolem">J</span><span class="main">⊂</span><span class="skolem">I</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                <span class="keyword1"><span class="command">moreover</span></span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card<span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="skolem">J</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">≤</span> card <span class="main">(</span><span class="main">⋃</span><span class="bound">i</span><span class="main">∈</span><span class="skolem">J</span><span class="main">.</span> <span class="skolem">A</span> <span class="bound">i</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?l</span> <span class="main">≤</span> <span class="var">?r</span>"</span></span><span class="main">)</span>
                <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
                  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">J</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">J</span> <span class="main">⊂</span> <span class="skolem">I</span>›</span></span> psubset<span class="main">(</span>1<span class="main">)</span>
                    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> psubset_imp_subset finite_subset<span class="main">)</span>
                  <span class="keyword1"><span class="command">hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"finite<span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="skolem">J</span><span class="main">)</span><span class="main">)</span>"</span></span>
                    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="skolem">I</span><span class="main">.</span> finite<span class="main">(</span><span class="skolem">A</span> <span class="bound">i</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">J</span><span class="main">⊂</span><span class="skolem">I</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
                  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?l</span> <span class="main">=</span> card<span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="skolem">J</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> card<span class="main">{</span><span class="skolem">x</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
                  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">≤</span> card<span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="skolem">J</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1
                    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> diff_card_le_card_Diff finite.intros<span class="main">)</span>
                  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="skolem">J</span><span class="main">)</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">=</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">i</span><span class="main">∈</span><span class="skolem">J</span><span class="main">.</span> <span class="skolem">A</span> <span class="bound">i</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
                  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
                <span class="keyword1"><span class="command">qed</span></span>
                <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
              <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">from</span></span> psubset<span class="main">(</span>2<span class="main">)</span><span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="var">?I'</span><span class="main">⊂</span><span class="skolem">I</span>›</span></span> fin' <span class="quoted"><span class="quoted">‹<span class="var">?M</span> <span class="var">?A'</span> <span class="var">?I'</span>›</span></span><span class="main">]</span>
            <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">R'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="skolem">R'</span> <span class="var">?A'</span> <span class="var">?I'</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="var">?inj</span> <span class="skolem">R'</span> <span class="var">?A'</span> <span class="var">?I'</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?Rx</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">R'</span><span class="main">(</span><span class="skolem">n</span> <span class="main">:=</span> <span class="skolem">x</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="var">?Rx</span> <span class="skolem">A</span> <span class="skolem">I</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span><span class="skolem">A</span> <span class="skolem">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?R</span> <span class="skolem">R'</span> <span class="var">?A'</span> <span class="var">?I'</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="var">?I'</span><span class="main">.</span> <span class="var">?Rx</span> <span class="bound">i</span> <span class="main">≠</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?R</span> <span class="skolem">R'</span> <span class="var">?A'</span> <span class="var">?I'</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?inj</span> <span class="var">?Rx</span> <span class="skolem">A</span> <span class="skolem">I</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?inj</span> <span class="skolem">R'</span> <span class="var">?A'</span> <span class="var">?I'</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> inj_on_def<span class="main">)</span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?R</span> <span class="var">?Rx</span> <span class="skolem">A</span> <span class="skolem">I</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">K</span></span><span class="main">⊂</span><span class="skolem">I</span><span class="main">.</span> <span class="bound">K</span><span class="main">≠</span><span class="main">{}</span> <span class="main">⟶</span> card <span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="bound">K</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> card <span class="bound">K</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">K</span></span> <span class="keyword2"><span class="keyword">where</span></span>
            <span class="quoted"><span class="quoted">"<span class="skolem">K</span><span class="main">⊂</span><span class="skolem">I</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">K</span><span class="main">≠</span><span class="main">{}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> c1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span>card <span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="skolem">K</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> card <span class="skolem">K</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> psubset.prems<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="skolem">K</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> card <span class="skolem">K</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> c1 <span class="keyword1"><span class="command">have</span></span> case2<span class="main">:</span> <span class="quoted"><span class="quoted">"card <span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="skolem">K</span><span class="main">)</span><span class="main">)</span><span class="main">=</span> card <span class="skolem">K</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">K</span><span class="main">⊂</span><span class="skolem">I</span>›</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">I</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">K</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>finite_subset<span class="main">)</span>
          <span class="keyword1"><span class="command">from</span></span> psubset.prems <span class="quoted"><span class="quoted">‹<span class="skolem">K</span><span class="main">⊂</span><span class="skolem">I</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="skolem">K</span><span class="main">.</span> finite <span class="main">(</span><span class="skolem">A</span> <span class="bound">i</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">J</span></span><span class="main">⊆</span><span class="skolem">K</span><span class="main">.</span> card <span class="bound">J</span> <span class="main">≤</span> card<span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="bound">J</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> psubset<span class="main">(</span>2<span class="main">)</span><span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">K</span><span class="main">⊂</span><span class="skolem">I</span>›</span></span> this<span class="main">]</span>
          <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">R1</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="skolem">R1</span> <span class="skolem">A</span> <span class="skolem">K</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="var">?inj</span> <span class="skolem">R1</span> <span class="skolem">A</span> <span class="skolem">K</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?AK</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">i</span><span class="main">.</span> <span class="skolem">A</span> <span class="bound">i</span> <span class="main">-</span> <span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="skolem">K</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?IK</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">I</span> <span class="main">-</span> <span class="skolem">K</span>"</span></span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">K</span><span class="main">≠</span><span class="main">{}</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">K</span><span class="main">⊂</span><span class="skolem">I</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?IK</span><span class="main">⊂</span><span class="skolem">I</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="var">?IK</span><span class="main">.</span> finite <span class="main">(</span><span class="var">?AK</span> <span class="bound">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> psubset.prems<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?M</span> <span class="var">?AK</span> <span class="var">?IK</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">clarify</span>
            <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">J</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">J</span> <span class="main">⊆</span> <span class="var">?IK</span>"</span></span>
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">I</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">J</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> finite_subset<span class="main">)</span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">J</span> <span class="main">≤</span> card <span class="main">(</span><span class="main">⋃</span> <span class="main">(</span><span class="var">?AK</span> <span class="main">`</span> <span class="skolem">J</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
              <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">J</span><span class="main">⊆</span><span class="var">?IK</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">J</span> <span class="main">∩</span> <span class="skolem">K</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
              <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">J</span> <span class="main">=</span> card<span class="main">(</span><span class="skolem">J</span><span class="main">∪</span><span class="skolem">K</span><span class="main">)</span> <span class="main">-</span> card <span class="skolem">K</span>"</span></span>
                <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">J</span>›</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">K</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">J</span><span class="main">∩</span><span class="skolem">K</span><span class="main">=</span><span class="main">{}</span>›</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> card_Un_disjoint<span class="main">)</span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card<span class="main">(</span><span class="skolem">J</span><span class="main">∪</span><span class="skolem">K</span><span class="main">)</span> <span class="main">≤</span> card<span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="main">(</span><span class="skolem">J</span><span class="main">∪</span><span class="skolem">K</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
                <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">J</span><span class="main">⊆</span><span class="var">?IK</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">K</span><span class="main">⊂</span><span class="skolem">I</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">J</span> <span class="main">∪</span> <span class="skolem">K</span> <span class="main">⊆</span> <span class="skolem">I</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">with</span></span> psubset.prems<span class="main">(</span>2<span class="main">)</span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
              <span class="keyword1"><span class="command">qed</span></span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">-</span> card <span class="skolem">K</span> <span class="main">=</span> card<span class="main">(</span><span class="main">⋃</span> <span class="main">(</span><span class="var">?AK</span> <span class="main">`</span> <span class="skolem">J</span><span class="main">)</span> <span class="main">∪</span> <span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="skolem">K</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> card <span class="skolem">K</span>"</span></span>
              <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="main">(</span><span class="skolem">J</span><span class="main">∪</span><span class="skolem">K</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">⋃</span> <span class="main">(</span><span class="var">?AK</span> <span class="main">`</span> <span class="skolem">J</span><span class="main">)</span> <span class="main">∪</span> <span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="skolem">K</span><span class="main">)</span>"</span></span>
                  <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">J</span><span class="main">⊆</span><span class="var">?IK</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">qed</span></span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> card <span class="main">(</span><span class="main">⋃</span> <span class="main">(</span><span class="var">?AK</span> <span class="main">`</span> <span class="skolem">J</span><span class="main">)</span><span class="main">)</span> <span class="main">+</span> card<span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="skolem">K</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> card <span class="skolem">K</span>"</span></span>
              <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
                <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span><span class="main">⋃</span> <span class="main">(</span><span class="var">?AK</span> <span class="main">`</span> <span class="skolem">J</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">J</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">J</span><span class="main">⊆</span><span class="var">?IK</span>›</span></span> psubset<span class="main">(</span>3<span class="main">)</span>
                  <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> finite_UN_I finite_Diff<span class="main">)</span>
                <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="skolem">K</span><span class="main">)</span><span class="main">)</span>"</span></span>
                  <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹finite <span class="skolem">K</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="skolem">K</span><span class="main">.</span> finite <span class="main">(</span><span class="skolem">A</span> <span class="bound">i</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span> <span class="main">(</span><span class="var">?AK</span> <span class="main">`</span> <span class="skolem">J</span><span class="main">)</span> <span class="main">∩</span> <span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="skolem">K</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> card_Un_disjoint <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span>Un_Diff_cancel2<span class="main">)</span>
              <span class="keyword1"><span class="command">qed</span></span>
              <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> card <span class="main">(</span><span class="main">⋃</span> <span class="main">(</span><span class="var">?AK</span> <span class="main">`</span> <span class="skolem">J</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> case2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
              <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">from</span></span> psubset<span class="main">(</span>2<span class="main">)</span><span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="var">?IK</span><span class="main">⊂</span><span class="skolem">I</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="var">?IK</span><span class="main">.</span> finite <span class="main">(</span><span class="var">?AK</span> <span class="bound">i</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound"><span class="bound">J</span></span><span class="main">⊆</span><span class="var">?IK</span><span class="main">.</span> card <span class="bound">J</span> <span class="main">≤</span> card <span class="main">(</span><span class="main">⋃</span><span class="bound">i</span><span class="main">∈</span><span class="bound">J</span><span class="main">.</span> <span class="skolem">A</span> <span class="bound">i</span> <span class="main">-</span> <span class="main">⋃</span> <span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="skolem">K</span><span class="main">)</span><span class="main">)</span>›</span></span><span class="main">]</span>
          <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">R2</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="skolem">R2</span> <span class="var">?AK</span> <span class="var">?IK</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="var">?inj</span> <span class="skolem">R2</span> <span class="var">?AK</span> <span class="var">?IK</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?R12</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">i</span><span class="main">.</span> <span class="keyword1">if</span> <span class="bound">i</span><span class="main">∈</span><span class="skolem">K</span> <span class="keyword1">then</span> <span class="skolem">R1</span> <span class="bound">i</span> <span class="keyword1">else</span> <span class="skolem">R2</span> <span class="bound">i</span>"</span></span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="skolem">I</span><span class="main">.</span> <span class="var">?R12</span> <span class="bound">i</span> <span class="main">∈</span> <span class="skolem">A</span> <span class="bound">i</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?R</span> <span class="skolem">R1</span> <span class="skolem">A</span> <span class="skolem">K</span>›</span></span><span class="quoted"><span class="quoted">‹<span class="var">?R</span> <span class="skolem">R2</span> <span class="var">?AK</span> <span class="var">?IK</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="skolem">I</span><span class="main">.</span> <span class="main">∀</span><span class="bound">j</span><span class="main">∈</span><span class="skolem">I</span><span class="main">.</span> <span class="bound">i</span><span class="main">≠</span><span class="bound">j</span><span class="main">⟶</span><span class="var">?R12</span> <span class="bound">i</span> <span class="main">≠</span> <span class="var">?R12</span> <span class="bound">j</span>"</span></span>
          <span class="keyword1"><span class="command">proof</span></span> <span class="operator">clarify</span>
            <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">i</span> <span class="skolem">j</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">∈</span><span class="skolem">I</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">j</span><span class="main">∈</span><span class="skolem">I</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">≠</span><span class="skolem">j</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R12</span> <span class="skolem">i</span> <span class="main">=</span> <span class="var">?R12</span> <span class="skolem">j</span>"</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span>
            <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
              <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">∈</span><span class="skolem">K</span> <span class="main">∧</span> <span class="skolem">j</span><span class="main">∈</span><span class="skolem">K</span> <span class="main">∨</span> <span class="skolem">i</span><span class="main">∉</span><span class="skolem">K</span><span class="main">∧</span><span class="skolem">j</span><span class="main">∉</span><span class="skolem">K</span>"</span></span>
                <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?inj</span> <span class="skolem">R1</span> <span class="skolem">A</span> <span class="skolem">K</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?inj</span> <span class="skolem">R2</span> <span class="var">?AK</span> <span class="var">?IK</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?R12</span> <span class="skolem">i</span><span class="main">=</span><span class="var">?R12</span> <span class="skolem">j</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">≠</span><span class="skolem">j</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">∈</span><span class="skolem">I</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">j</span><span class="main">∈</span><span class="skolem">I</span>›</span></span>
                <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> inj_on_def<span class="main">)</span>
              <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">moreover</span></span>
              <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">∈</span><span class="skolem">K</span> <span class="main">∧</span> <span class="skolem">j</span><span class="main">∉</span><span class="skolem">K</span> <span class="main">∨</span> <span class="skolem">i</span><span class="main">∉</span><span class="skolem">K</span> <span class="main">∧</span> <span class="skolem">j</span><span class="main">∈</span><span class="skolem">K</span>"</span></span>
                <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?R</span> <span class="skolem">R1</span> <span class="skolem">A</span> <span class="skolem">K</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?R</span> <span class="skolem">R2</span> <span class="var">?AK</span> <span class="var">?IK</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?R12</span> <span class="skolem">i</span><span class="main">=</span><span class="var">?R12</span> <span class="skolem">j</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">j</span><span class="main">∈</span><span class="skolem">I</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">∈</span><span class="skolem">I</span>›</span></span>
                <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> Diff_iff<span class="main">)</span>
              <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> inj_on_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="quoted"><span class="quoted">‹<span class="var">?M</span> <span class="free">A</span> <span class="free">I</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The proof by Rado:›</span></span>
<span class="keyword1"><span class="command">theorem</span></span> marriage_Rado<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'b</span> set"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">I</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> set"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"finite <span class="free">I</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">i</span><span class="main">∈</span><span class="free">I</span><span class="main">.</span> finite <span class="main">(</span><span class="free">A</span> <span class="bound">i</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">J</span></span><span class="main">⊆</span><span class="free">I</span><span class="main">.</span> card <span class="bound">J</span> <span class="main">≤</span> card <span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="free">A</span> <span class="main">`</span> <span class="bound">J</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?M</span> <span class="free">A</span>"</span></span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">R</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="free">I</span><span class="main">.</span> <span class="bound">R</span> <span class="bound">i</span> <span class="main">∈</span> <span class="free">A</span> <span class="bound">i</span><span class="main">)</span> <span class="main">∧</span> inj_on <span class="bound">R</span> <span class="free">I</span>"</span></span>
       <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="var">?SDR</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">R</span><span class="main">.</span> <span class="var">?R</span> <span class="bound">R</span> <span class="free">A</span> <span class="main">&amp;</span> <span class="var">?inj</span> <span class="bound">R</span> <span class="free">A</span>"</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="free">I</span><span class="main">.</span> finite <span class="main">(</span><span class="free">A</span> <span class="bound">i</span><span class="main">)</span> <span class="main">⟹</span> <span class="var">?M</span> <span class="free">A</span> <span class="main">⟹</span> <span class="var">?SDR</span> <span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">induct</span> <span class="skolem">n</span> <span class="main"><span class="main">==</span></span> <span class="quoted"><span class="quoted">"<span class="main">∑</span><span class="bound">i</span><span class="main">∈</span><span class="free">I</span><span class="main">.</span> card<span class="main">(</span><span class="free">A</span> <span class="bound">i</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">A</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> 0
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="free">I</span><span class="main">.</span><span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="skolem">A</span><span class="main">(</span><span class="bound">i</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="bound">a</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span>  <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="free">I</span><span class="main">.</span><span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="skolem">A</span> <span class="bound">i</span> <span class="main">=</span> <span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> i<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">:</span><span class="free">I</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">.</span> <span class="skolem">A</span> <span class="skolem">i</span> <span class="main">≠</span> <span class="main">{</span><span class="bound">a</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">i</span><span class="main">}</span><span class="main">⊆</span> <span class="free">I</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted">"0"</span><span class="main">(</span>1-2<span class="main">)</span> mp<span class="main">[</span><span class="operator">OF</span> spec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> <span class="quoted">"0.prems"</span><span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="skolem">i</span><span class="main">}</span><span class="main">⊆</span><span class="free">I</span>›</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹finite <span class="free">I</span>›</span></span> i
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> card_le_Suc_iff<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">R</span></span> <span class="keyword2"><span class="keyword">where</span></span> R<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="free">I</span><span class="main">.</span> <span class="skolem">A</span> <span class="bound">i</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">R</span> <span class="bound">i</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">i</span><span class="main">∈</span><span class="free">I</span><span class="main">.</span> <span class="skolem">R</span> <span class="bound">i</span> <span class="main">∈</span> <span class="skolem">A</span> <span class="bound">i</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"inj_on <span class="skolem">R</span> <span class="free">I</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> inj_on_def<span class="main">)</span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">I</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="free">I</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">R</span> <span class="skolem">y</span>"</span></span>
        <span class="keyword1"><span class="command">with</span></span> R spec<span class="main">[</span><span class="operator">OF</span> <span class="quoted">"0.prems"</span><span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">}</span>"</span></span><span class="main">]</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="skolem">y</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>le_Suc_eq card_insert_if <span class="quasi_keyword">split</span><span class="main"><span class="main">:</span></span> if_splits<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> Suc.hyps<span class="main">(</span>2<span class="main">)</span><span class="main">[</span><span class="operator">symmetric</span><span class="main">,</span> <span class="operator">THEN</span> sum_SucD<span class="main">]</span>
      <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">i</span></span> <span class="keyword2"><span class="keyword">where</span></span> i<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">:</span><span class="free">I</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="numeral">2</span> <span class="main">≤</span> card<span class="main">(</span><span class="skolem">A</span> <span class="skolem">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x1</span></span> <span class="skolem"><span class="skolem">x2</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x1</span> <span class="main">:</span> <span class="skolem">A</span> <span class="skolem">i</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x2</span> <span class="main">:</span> <span class="skolem">A</span> <span class="skolem">i</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x1</span> <span class="main">≠</span> <span class="skolem">x2</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> Suc<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> card_le_Suc_iff eval_nat_numeral<span class="main">)</span>
      <span class="keyword1"><span class="command">let</span></span> <span class="quoted"><span class="quoted">"<span class="var">?Ai</span> <span class="free">x</span>"</span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="skolem">i</span> <span class="main">-</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">let</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="free">x</span>"</span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">(</span><span class="skolem">i</span><span class="main">:=</span><span class="var">?Ai</span> <span class="free">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="quoted"><span class="quoted">"<span class="var">?U</span> <span class="free">J</span>"</span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="free">J</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">let</span></span> <span class="quoted"><span class="quoted">"<span class="var">?Ui</span> <span class="free">J</span> <span class="free">x</span>"</span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="var">?U</span> <span class="free">J</span> <span class="main">∪</span> <span class="var">?Ai</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> n1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> <span class="main">(</span><span class="main">∑</span><span class="bound">j</span><span class="main">∈</span><span class="free">I</span><span class="main">.</span> card <span class="main">(</span><span class="var">?A</span> <span class="skolem">x1</span> <span class="bound">j</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> Suc.hyps<span class="main">(</span>2<span class="main">)</span> Suc.prems<span class="main">(</span>1<span class="main">)</span> i <span class="quoted"><span class="quoted">‹finite <span class="free">I</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x1</span><span class="main">:</span><span class="skolem">A</span> <span class="skolem">i</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> sum.remove card_Diff_singleton<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> n2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">=</span> <span class="main">(</span><span class="main">∑</span><span class="bound">j</span><span class="main">∈</span><span class="free">I</span><span class="main">.</span> card <span class="main">(</span><span class="var">?A</span> <span class="skolem">x2</span> <span class="bound">j</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> Suc.hyps<span class="main">(</span>2<span class="main">)</span> Suc.prems<span class="main">(</span>1<span class="main">)</span> i <span class="quoted"><span class="quoted">‹finite <span class="free">I</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x2</span><span class="main">:</span><span class="skolem">A</span> <span class="skolem">i</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> sum.remove card_Diff_singleton<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> finx1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">j</span><span class="main">∈</span><span class="free">I</span><span class="main">.</span> finite <span class="main">(</span><span class="var">?A</span> <span class="skolem">x1</span> <span class="bound">j</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Suc<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> finx2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">j</span><span class="main">∈</span><span class="free">I</span><span class="main">.</span> finite <span class="main">(</span><span class="var">?A</span> <span class="skolem">x2</span> <span class="bound">j</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Suc<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="var">?M</span> <span class="main">(</span><span class="skolem">A</span><span class="main">(</span><span class="skolem">i</span><span class="main">:=</span> <span class="var">?Ai</span> <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">with</span></span> Suc.prems<span class="main">(</span>2<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">J</span></span>
          <span class="keyword2"><span class="keyword">where</span></span> J<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">J</span> <span class="main">⊆</span> <span class="free">I</span>"</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">J</span> <span class="main">&gt;</span> card<span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="main">(</span><span class="skolem">A</span><span class="main">(</span><span class="skolem">i</span><span class="main">:=</span> <span class="var">?Ai</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">`</span> <span class="skolem">J</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>not_less_eq_eq Suc_le_eq<span class="main">)</span>
        <span class="keyword1"><span class="command">note</span></span> fJi <span class="main">=</span> finite_Diff<span class="main">[</span><span class="operator">OF</span> finite_subset<span class="main"><span class="main">[</span></span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">J</span><span class="main">⊆</span><span class="free">I</span>›</span></span> <span class="quoted"><span class="quoted">‹finite <span class="free">I</span>›</span></span><span class="main"><span class="main">]</span></span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">i</span><span class="main">}</span>"</span></span><span class="main">]</span>
        <span class="keyword1"><span class="command">have</span></span> fU<span class="main">:</span> <span class="quoted"><span class="quoted">"finite<span class="main">(</span><span class="var">?U</span> <span class="main">(</span><span class="skolem">J</span><span class="main">-</span><span class="main">{</span><span class="skolem">i</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">J</span><span class="main">⊆</span><span class="free">I</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Diff_iff Suc<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> finite_UN<span class="main"><span class="main">[</span></span><span class="operator">OF</span> fJi<span class="main"><span class="main">]</span></span> subsetD<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span> <span class="main">∈</span> <span class="skolem">J</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> J Suc.prems<span class="main">(</span>2<span class="main">)</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> UNION_fun_upd not_le<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> fun_upd_apply <span class="quasi_keyword">split</span><span class="main"><span class="main">:</span></span> if_splits<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"card<span class="main">(</span><span class="skolem">J</span><span class="main">-</span><span class="main">{</span><span class="skolem">i</span><span class="main">}</span><span class="main">)</span> <span class="main">≥</span> card<span class="main">(</span><span class="var">?Ui</span> <span class="main">(</span><span class="skolem">J</span><span class="main">-</span><span class="main">{</span><span class="skolem">i</span><span class="main">}</span><span class="main">)</span> <span class="skolem">x</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> fJi J <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> UNION_fun_upd <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span> fun_upd_apply<span class="main">)</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">J</span></span><span class="main">⊆</span><span class="free">I</span><span class="main">.</span> <span class="skolem">i</span> <span class="main">∉</span> <span class="bound">J</span> <span class="main">∧</span> card<span class="main">(</span><span class="bound">J</span><span class="main">)</span> <span class="main">≥</span> card<span class="main">(</span><span class="var">?Ui</span> <span class="bound">J</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">∧</span> finite<span class="main">(</span><span class="var">?U</span> <span class="bound">J</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> DiffD2 J<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> fU <span class="quoted"><span class="quoted">‹<span class="skolem">i</span> <span class="main">∈</span> <span class="skolem">J</span>›</span></span> insertI1 subset_insertI2 subset_insert_iff<span class="main">)</span>
      <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> lem <span class="main">=</span> this
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?M</span> <span class="main">(</span><span class="var">?A</span> <span class="skolem">x1</span><span class="main">)</span> <span class="main">∨</span> <span class="var">?M</span> <span class="main">(</span><span class="var">?A</span> <span class="skolem">x2</span><span class="main">)</span>"</span></span> <span class="comment1">― ‹Rado's Lemma›</span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> ccontr<span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="var">?M</span> <span class="main">(</span><span class="var">?A</span> <span class="skolem">x1</span><span class="main">)</span> <span class="main">∨</span> <span class="var">?M</span> <span class="main">(</span><span class="var">?A</span> <span class="skolem">x2</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">with</span></span> lem <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">J1</span></span> <span class="skolem"><span class="skolem">J2</span></span> <span class="keyword2"><span class="keyword">where</span></span>
          J1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">J1</span><span class="main">⊆</span><span class="free">I</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">∉</span><span class="skolem">J1</span>"</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">J1</span> <span class="main">≥</span> card<span class="main">(</span><span class="var">?Ui</span> <span class="skolem">J1</span> <span class="skolem">x1</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"finite<span class="main">(</span><span class="var">?U</span> <span class="skolem">J1</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
          J2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">J2</span><span class="main">⊆</span><span class="free">I</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">i</span><span class="main">∉</span><span class="skolem">J2</span>"</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">J2</span> <span class="main">≥</span> card<span class="main">(</span><span class="var">?Ui</span> <span class="skolem">J2</span> <span class="skolem">x2</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"finite<span class="main">(</span><span class="var">?U</span> <span class="skolem">J2</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
        <span class="keyword1"><span class="command">note</span></span> fin1 <span class="main">=</span> finite_subset<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">J1</span><span class="main">⊆</span><span class="free">I</span>›</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">]</span>
        <span class="keyword1"><span class="command">note</span></span> fin2 <span class="main">=</span> finite_subset<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">J2</span><span class="main">⊆</span><span class="free">I</span>›</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">]</span>
        <span class="keyword1"><span class="command">have</span></span> finUi1<span class="main">:</span> <span class="quoted"><span class="quoted">"finite<span class="main">(</span><span class="var">?Ui</span> <span class="skolem">J1</span> <span class="skolem">x1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Suc<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> J1<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> i<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> finUi2<span class="main">:</span> <span class="quoted"><span class="quoted">"finite<span class="main">(</span><span class="var">?Ui</span> <span class="skolem">J2</span> <span class="skolem">x2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Suc<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> J2<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> i<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="skolem">J1</span> <span class="main">+</span> card <span class="skolem">J2</span> <span class="main">+</span> <span class="main">1</span> <span class="main">=</span> card<span class="main">(</span><span class="skolem">J1</span> <span class="main">∪</span> <span class="skolem">J2</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span> <span class="main">+</span> card<span class="main">(</span><span class="skolem">J1</span> <span class="main">∩</span> <span class="skolem">J2</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="main">(</span><span class="operator">metis</span> card_Un_Int fin1 fin2<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card<span class="main">(</span><span class="skolem">J1</span> <span class="main">∪</span> <span class="skolem">J2</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span> <span class="main">=</span> card<span class="main">(</span>insert <span class="skolem">i</span> <span class="main">(</span><span class="skolem">J1</span> <span class="main">∪</span> <span class="skolem">J2</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">∉</span><span class="skolem">J1</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">∉</span><span class="skolem">J2</span>›</span></span> fin1 fin2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">≤</span> card <span class="main">(</span><span class="main">⋃</span> <span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> insert <span class="skolem">i</span> <span class="main">(</span><span class="skolem">J1</span> <span class="main">∪</span> <span class="skolem">J2</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"<span class="main">_</span> <span class="main">≤</span> card <span class="var">?M</span>"</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> J1<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> J2<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> Suc<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> Un_least i<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> insert_subset<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?M</span> <span class="main">=</span> <span class="var">?Ui</span> <span class="skolem">J1</span> <span class="skolem">x1</span> <span class="main">∪</span> <span class="var">?Ui</span> <span class="skolem">J2</span> <span class="skolem">x2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x1</span><span class="main">≠</span><span class="skolem">x2</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card<span class="main">(</span><span class="skolem">J1</span> <span class="main">∩</span> <span class="skolem">J2</span><span class="main">)</span> <span class="main">≤</span> card<span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="skolem">A</span> <span class="main">`</span> <span class="main">(</span><span class="skolem">J1</span> <span class="main">∩</span> <span class="skolem">J2</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> J2<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> Suc<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> le_infI2<span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">≤</span> card<span class="main">(</span><span class="var">?U</span> <span class="skolem">J1</span> <span class="main">∩</span> <span class="var">?U</span> <span class="skolem">J2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> card_mono J1<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">≤</span> card<span class="main">(</span><span class="var">?Ui</span> <span class="skolem">J1</span> <span class="skolem">x1</span> <span class="main">∩</span> <span class="var">?Ui</span> <span class="skolem">J2</span> <span class="skolem">x2</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> Suc<span class="main">(</span>3<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">i</span><span class="main">∈</span><span class="free">I</span>›</span></span> <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> card_mono J1<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> J1<span class="main">(</span>3<span class="main">)</span> J2<span class="main">(</span>3<span class="main">)</span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> card_Un_Int<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">,</span></span> <span class="operator">OF</span> finUi1 finUi2<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> Suc.hyps<span class="main">(</span>1<span class="main">)</span><span class="main">[</span><span class="operator">OF</span> n1 finx1<span class="main">]</span> Suc.hyps<span class="main">(</span>1<span class="main">)</span><span class="main">[</span><span class="operator">OF</span> n2 finx2<span class="main">]</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> DiffD1 fun_upd_def<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">with</span></span> assms <span class="quoted"><span class="quoted">‹<span class="var">?M</span> <span class="free">A</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div>
<div id="recursion">
<div class="head">
<h1>Theory recursion</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:       Recursion theorem
    Author:      Georgy Dunaev &lt;georgedunaev at gmail.com&gt;, 2020
    Maintainer:  Georgy Dunaev &lt;georgedunaev at gmail.com&gt;
*)</span>
<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Recursion Submission"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Recursion Theorem is proved in the following document.
It also contains the addition on natural numbers.
The development is done in the context of Zermelo-Fraenkel set theory.›</span></span>

<span class="keyword1"><span class="command">theory</span></span> recursion
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="https://www.cl.cam.ac.uk/research/hvg/Isabelle/dist/library/https://www.cl.cam.ac.uk/research/hvg/Isabelle/dist/library/ZF.html">ZF</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Basic Set Theory›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Useful lemmas about sets, functions and natural numbers›</span></span>
<span class="keyword1" id="recursion-pisubsig"><span class="command">lemma</span></span> pisubsig <span class="main">:</span> <span class="quoted"><span class="quoted">‹Pi<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">⊆</span>Pow<span class="main">(</span>Sigma<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> Pi<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">f</span><span class="main">∈</span>Pow<span class="main">(</span>Sigma<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">.</span> <span class="free">A</span><span class="main">⊆</span>domain<span class="main">(</span><span class="bound">f</span><span class="main">)</span> <span class="main">&amp;</span> function<span class="main">(</span><span class="bound">f</span><span class="main">)</span><span class="main">}</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> Pi_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> Pow<span class="main">(</span>Sigma<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">P</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> CollectD1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-apparg"><span class="command">lemma</span></span> apparg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span> <span class="free">A</span> <span class="free">B</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> T0<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f</span><span class="main">:</span><span class="free">A</span><span class="main">→</span><span class="free">B</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> T1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">`</span> <span class="free">a</span> <span class="main">=</span> <span class="free">b</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> T2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">a</span> <span class="main">∈</span> <span class="free">A</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="free">a</span><span class="main">,</span> <span class="free">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> iffD2<span class="main"><span class="main">[</span></span><span class="operator">OF</span> func.apply_iff<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> T0<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> T<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">a</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∧</span> <span class="free">f</span> <span class="main">`</span> <span class="free">a</span> <span class="main">=</span> <span class="free">b</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> conjI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> T2 T1<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> nat_induct_bound <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H0<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">P</span><span class="main">(</span><span class="main">0</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">!!</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span>nat <span class="main">⟹</span> <span class="free">P</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">P</span><span class="main">(</span>succ<span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span>nat<span class="main">.</span> <span class="free">P</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> ballI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span>
  <span class="keyword3"><span class="command">assume</span></span> H2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">P</span><span class="main">(</span><span class="skolem">n</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> nat_induct<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">n</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> H2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">∈</span>nat›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">assumption</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">P</span><span class="main">(</span><span class="main">0</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> H0<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">assume</span></span> H3<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span>nat›</span></span>
    <span class="keyword3"><span class="command">assume</span></span> H4<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">P</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">P</span><span class="main">(</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> H1<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H3 H4<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> nat_Tr <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span>nat<span class="main">.</span> <span class="free">m</span><span class="main">∈</span><span class="bound">n</span> <span class="main">⟶</span> <span class="free">m</span><span class="main">∈</span>nat›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> nat_induct_bound<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">∈</span> <span class="main">0</span> <span class="main">⟶</span> <span class="free">m</span> <span class="main">∈</span> nat›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> H0<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> nat›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> H1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">∈</span> <span class="skolem">x</span> <span class="main">⟶</span> <span class="free">m</span> <span class="main">∈</span> nat›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">m</span> <span class="main">∈</span> nat›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> H2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">m</span><span class="main">∈</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">∈</span> nat›</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> succE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H2<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> H3<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">=</span> <span class="skolem">x</span>›</span></span>
      <span class="keyword1"><span class="command">from</span></span> H0 <span class="keyword2"><span class="keyword">and</span></span> H3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">∈</span> nat›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> H4<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">∈</span> <span class="skolem">x</span>›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">∈</span> nat›</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> mp<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H1 H4<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(* Natural numbers are linearly ordered. *)</span>
<span class="keyword1"><span class="command">theorem</span></span> zeroleq <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span>nat<span class="main">.</span> <span class="main">0</span><span class="main">∈</span><span class="bound">n</span> <span class="main">∨</span> <span class="main">0</span><span class="main">=</span><span class="bound">n</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> ballI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span>
  <span class="keyword3"><span class="command">assume</span></span> H1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span><span class="main">∈</span><span class="skolem">n</span><span class="main">∨</span><span class="main">0</span><span class="main">=</span><span class="skolem">n</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> nat_induct<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">n</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> H1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">∈</span> nat›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">assumption</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">∈</span> <span class="main">0</span> <span class="main">∨</span> <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> disjI2<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> refl<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">assume</span></span> H2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span>nat›</span></span>
    <span class="keyword3"><span class="command">assume</span></span> H3<span class="main">:</span><span class="quoted"><span class="quoted">‹ <span class="main">0</span> <span class="main">∈</span> <span class="skolem">x</span> <span class="main">∨</span> <span class="main">0</span> <span class="main">=</span> <span class="skolem">x</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span> <span class="main">0</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> disjE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H3<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> H4<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">0</span><span class="main">∈</span><span class="skolem">x</span>›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span> <span class="main">0</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> disjI1<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> succI2<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H4<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> H4<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">0</span><span class="main">=</span><span class="skolem">x</span>›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span> <span class="main">0</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> disjI1<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> q<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> q <span class="keyword2"><span class="keyword">and</span></span> H4 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> JH2_1ii <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">m</span><span class="main">∈</span>succ<span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">m</span><span class="main">∈</span><span class="free">n</span><span class="main">∨</span><span class="free">m</span><span class="main">=</span><span class="free">n</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">theorem</span></span> nat_transitive<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span>nat<span class="main">.</span> <span class="main">∀</span><span class="bound">k</span><span class="main">.</span> <span class="main">∀</span><span class="bound">m</span><span class="main">.</span>  <span class="bound">k</span> <span class="main">∈</span> <span class="bound">m</span> <span class="main">∧</span> <span class="bound">m</span> <span class="main">∈</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="bound">k</span> <span class="main">∈</span> <span class="bound">n</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> nat_induct_bound<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">k</span><span class="main">.</span> <span class="main">∀</span><span class="bound">m</span><span class="main">.</span> <span class="bound">k</span> <span class="main">∈</span> <span class="bound">m</span> <span class="main">∧</span> <span class="bound">m</span> <span class="main">∈</span> <span class="main">0</span> <span class="main">⟶</span> <span class="bound">k</span> <span class="main">∈</span> <span class="main">0</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">k</span> <span class="skolem">m</span>
    <span class="keyword3"><span class="command">assume</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">k</span> <span class="main">∈</span> <span class="skolem">m</span> <span class="main">∧</span> <span class="skolem">m</span> <span class="main">∈</span> <span class="main">0</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">∈</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">k</span> <span class="main">∈</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span>
  <span class="keyword3"><span class="command">assume</span></span> H0<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">∈</span> nat›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> H1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">k</span><span class="main">.</span>
            <span class="main">∀</span><span class="bound">m</span><span class="main">.</span>
               <span class="bound">k</span> <span class="main">∈</span> <span class="bound">m</span> <span class="main">∧</span> <span class="bound">m</span> <span class="main">∈</span> <span class="skolem">n</span> <span class="main">⟶</span>
               <span class="bound">k</span> <span class="main">∈</span> <span class="skolem">n</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">k</span><span class="main">.</span> <span class="main">∀</span><span class="bound">m</span><span class="main">.</span>
               <span class="bound">k</span> <span class="main">∈</span> <span class="bound">m</span> <span class="main">∧</span>
               <span class="bound">m</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">⟶</span>
               <span class="bound">k</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">k</span> <span class="skolem">m</span>
    <span class="keyword3"><span class="command">assume</span></span> H4<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">k</span> <span class="main">∈</span> <span class="skolem">m</span> <span class="main">∧</span> <span class="skolem">m</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> H4'<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> conjunct2<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> H4''<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">∈</span><span class="skolem">n</span> <span class="main">∨</span> <span class="skolem">m</span><span class="main">=</span><span class="skolem">n</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> succE<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> H4 <span class="keyword1"><span class="command">have</span></span> Q<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">k</span> <span class="main">∈</span> <span class="skolem">m</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> conjunct1<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> H1S<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">m</span><span class="main">.</span> <span class="skolem">k</span> <span class="main">∈</span> <span class="bound">m</span> <span class="main">∧</span> <span class="bound">m</span> <span class="main">∈</span> <span class="skolem">n</span> <span class="main">⟶</span> <span class="skolem">k</span> <span class="main">∈</span> <span class="skolem">n</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> spec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H1<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> H1S<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">k</span> <span class="main">∈</span> <span class="skolem">m</span> <span class="main">∧</span> <span class="skolem">m</span> <span class="main">∈</span> <span class="skolem">n</span> <span class="main">⟶</span> <span class="skolem">k</span> <span class="main">∈</span> <span class="skolem">n</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> spec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H1S<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">k</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> disjE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H4''<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> L<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">∈</span><span class="skolem">n</span>›</span></span>
      <span class="keyword1"><span class="command">from</span></span> Q <span class="keyword2"><span class="keyword">and</span></span> L <span class="keyword1"><span class="command">have</span></span> QL<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">k</span> <span class="main">∈</span> <span class="skolem">m</span> <span class="main">∧</span> <span class="skolem">m</span> <span class="main">∈</span> <span class="skolem">n</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> G<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">k</span> <span class="main">∈</span> <span class="skolem">n</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> mp <span class="main"><span class="main">[</span></span><span class="operator">OF</span> H1S QL<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">k</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> succI2<span class="main"><span class="main">[</span></span><span class="operator">OF</span> G<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> L<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">=</span><span class="skolem">n</span>›</span></span>
      <span class="keyword1"><span class="command">from</span></span> Q <span class="keyword1"><span class="command">have</span></span> F<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">k</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">m</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> L <span class="keyword2"><span class="keyword">and</span></span> Q <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">k</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> nat_xninx <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span>nat<span class="main">.</span> <span class="main">¬</span><span class="main">(</span><span class="bound">n</span><span class="main">∈</span><span class="bound">n</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> nat_induct_bound<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span><span class="main">∉</span><span class="main">0</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> H0<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> H1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∉</span><span class="skolem">x</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∉</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> contrapos<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H1<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> Q<span class="main">:</span><span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> D<span class="main">:</span><span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">∈</span><span class="skolem">x</span> <span class="main">∨</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">=</span><span class="skolem">x</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> JH2_1ii<span class="main"><span class="main">[</span></span><span class="operator">OF</span> Q<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span><span class="skolem">x</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> disjE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> D<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> Y1<span class="main">:</span><span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">∈</span><span class="skolem">x</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> U<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> succI1<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∧</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">x</span> <span class="main">⟶</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="skolem">x</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> spec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> spec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> bspec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> nat_transitive H0<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> R<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∧</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">x</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> conjI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> U Y1<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span><span class="skolem">x</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> mp<span class="main"><span class="main">[</span></span><span class="operator">OF</span> T R<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> Y1<span class="main">:</span><span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">=</span><span class="skolem">x</span>›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span><span class="skolem">x</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> subst<span class="main"><span class="main">[</span></span><span class="operator">OF</span> Y1<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> Q<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> nat_asym <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span>nat<span class="main">.</span> <span class="main">∀</span><span class="bound">m</span><span class="main">.</span> <span class="main">¬</span><span class="main">(</span><span class="bound">n</span><span class="main">∈</span><span class="bound">m</span> <span class="main">∧</span> <span class="bound">m</span><span class="main">∈</span><span class="bound">n</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> ballI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="skolem">m</span>
  <span class="keyword3"><span class="command">assume</span></span> H0<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">∈</span> nat›</span></span>
  <span class="keyword1"><span class="command">have</span></span> Q<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="main">(</span><span class="skolem">n</span><span class="main">∈</span><span class="skolem">n</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> bspec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> nat_xninx H0<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="skolem">n</span> <span class="main">∈</span> <span class="skolem">m</span> <span class="main">∧</span> <span class="skolem">m</span> <span class="main">∈</span> <span class="skolem">n</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> contrapos<span class="main"><span class="main">[</span></span><span class="operator">OF</span> Q<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> W<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">n</span> <span class="main">∈</span> <span class="skolem">m</span> <span class="main">∧</span> <span class="skolem">m</span> <span class="main">∈</span> <span class="skolem">n</span><span class="main">)</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">∈</span><span class="skolem">n</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> mp<span class="main"><span class="main">[</span></span><span class="operator">OF</span> spec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> spec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> bspec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> nat_transitive H0<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span> W<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> zerolesucc <span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span>nat<span class="main">.</span> <span class="main">0</span> <span class="main">∈</span> succ<span class="main">(</span><span class="bound">n</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> nat_induct_bound<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span><span class="main">∈</span><span class="main">1</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> H0<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> H1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">0</span><span class="main">∈</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span><span class="main">∈</span>succ<span class="main">(</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> J<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">∉</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> notE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> J H1<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> succ_le <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span>nat<span class="main">.</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">∈</span>succ<span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">m</span><span class="main">∈</span><span class="bound">n</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> nat_induct_bound<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹ succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">∈</span> <span class="main">1</span> <span class="main">⟶</span> <span class="free">m</span> <span class="main">∈</span> <span class="main">0</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> H0<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> nat›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> H1<span class="main">:</span><span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">m</span> <span class="main">∈</span> <span class="skolem">x</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹ succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">∈</span>
             succ<span class="main">(</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span>
             <span class="free">m</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> J0<span class="main">:</span><span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> succE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> J0<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> R<span class="main">:</span><span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">hence</span></span> R<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">m</span><span class="main">=</span><span class="skolem">x</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> upair.succ_inject<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> R <span class="keyword2"><span class="keyword">and</span></span> succI1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> R<span class="main">:</span><span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> R<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">m</span><span class="main">∈</span><span class="skolem">x</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> mp<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H1 R<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> succ_le2 <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span>nat<span class="main">.</span> <span class="main">∀</span><span class="bound">m</span><span class="main">.</span> succ<span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main">∈</span>succ<span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">⟶</span> <span class="bound">m</span><span class="main">∈</span><span class="bound">n</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span>
  <span class="keyword3"><span class="command">assume</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">m</span><span class="main">.</span> succ<span class="main">(</span><span class="bound">m</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">⟶</span> <span class="bound">m</span> <span class="main">∈</span> <span class="skolem">n</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span>
    <span class="keyword1"><span class="command">from</span></span> succ_le <span class="keyword2"><span class="keyword">and</span></span> H <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">m</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">⟶</span> <span class="skolem">m</span> <span class="main">∈</span> <span class="skolem">n</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> le_succ <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span>nat<span class="main">.</span> <span class="free">m</span><span class="main">∈</span><span class="bound">n</span> <span class="main">⟶</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">∈</span>succ<span class="main">(</span><span class="bound">n</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> nat_induct_bound<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">∈</span> <span class="main">0</span> <span class="main">⟶</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">∈</span> <span class="main">1</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> H0<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> H1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">∈</span> <span class="skolem">x</span> <span class="main">⟶</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">⟶</span>
            succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> HR1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">m</span><span class="main">∈</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> succE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> HR1<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> Q<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">=</span> <span class="skolem">x</span>›</span></span>
      <span class="keyword1"><span class="command">from</span></span> Q <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> Q<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">∈</span> <span class="skolem">x</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> Q<span class="main">:</span><span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> mp<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H1 Q<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> Q <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> succI2<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> nat_linord<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span>nat<span class="main">.</span> <span class="main">∀</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span> <span class="bound">m</span><span class="main">∈</span><span class="bound">n</span><span class="main">∨</span><span class="bound">m</span><span class="main">=</span><span class="bound">n</span><span class="main">∨</span><span class="bound">n</span><span class="main">∈</span><span class="bound">m</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> ballI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span>
  <span class="keyword3"><span class="command">assume</span></span> H1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span> <span class="bound">m</span> <span class="main">∈</span> <span class="skolem">n</span> <span class="main">∨</span> <span class="bound">m</span> <span class="main">=</span> <span class="skolem">n</span> <span class="main">∨</span> <span class="skolem">n</span> <span class="main">∈</span> <span class="bound">m</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> nat_induct<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">n</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> H1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">∈</span>nat›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">assumption</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span> <span class="bound">m</span> <span class="main">∈</span> <span class="main">0</span> <span class="main">∨</span> <span class="bound">m</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="main">0</span> <span class="main">∈</span> <span class="bound">m</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span>
      <span class="keyword3"><span class="command">assume</span></span> J<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">∈</span>nat›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹ <span class="skolem">m</span> <span class="main">∈</span> <span class="main">0</span> <span class="main">∨</span> <span class="skolem">m</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="main">0</span> <span class="main">∈</span> <span class="skolem">m</span>›</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> disjI2<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> Q<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">0</span><span class="main">∈</span><span class="skolem">m</span><span class="main">∨</span><span class="main">0</span><span class="main">=</span><span class="skolem">m</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> bspec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> zeroleq J<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="main">0</span> <span class="main">∈</span> <span class="skolem">m</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> disjE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> Q<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">assume</span></span> K<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span>nat›</span></span>
    <span class="keyword3"><span class="command">assume</span></span> M<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span> <span class="bound">m</span> <span class="main">∈</span> <span class="skolem">x</span> <span class="main">∨</span> <span class="bound">m</span> <span class="main">=</span> <span class="skolem">x</span> <span class="main">∨</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="bound">m</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span>
            <span class="bound">m</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span>
            <span class="bound">m</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span>
            succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="bound">m</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> nat_induct_bound<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span>  <span class="main">0</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="main">0</span>›</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> disjI1<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> bspec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> zerolesucc K<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span>
      <span class="keyword3"><span class="command">assume</span></span> H0<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> nat›</span></span>
      <span class="keyword3"><span class="command">assume</span></span> H1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span> <span class="skolem">y</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">y</span>›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span>
            succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span>
            succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> disjE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H1<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> W<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">y</span><span class="main">∈</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span>
              succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span>
              succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> succE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> W<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">assume</span></span> G<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">y</span><span class="main">=</span><span class="skolem">x</span>›</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span>
    succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span>
    succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> disjI2<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> disjI1<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> subst<span class="main"><span class="main">[</span></span><span class="operator">OF</span> G<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> refl<span class="main">)</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">assume</span></span> G<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="skolem">x</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> R<span class="main">:</span><span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> mp<span class="main"><span class="main">[</span></span><span class="operator">OF</span> bspec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> le_succ K<span class="main"><span class="main">]</span></span> G<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span>
           succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span>
           succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> disjI1<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> R<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> W<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="skolem">y</span>›</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span>
              succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span>
              succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> disjE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> W<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">assume</span></span> W<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">y</span><span class="main">=</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span>
              succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span>
              succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> disjI2<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> disjI2<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> subst<span class="main"><span class="main">[</span></span><span class="operator">OF</span> W<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> succI1<span class="main">)</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">assume</span></span> W<span class="main">:</span><span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">∈</span><span class="skolem">y</span>›</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span>
              succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∨</span>
              succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">y</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> disjI2<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> disjI2<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> succI2<span class="main"><span class="main">[</span></span><span class="operator">OF</span> W<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-tgb"><span class="command">lemma</span></span> tgb<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> knat<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">k</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> D<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">t</span> <span class="main">∈</span> <span class="free">k</span> <span class="main">→</span> <span class="free">A</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">‹<span class="free">t</span> <span class="main">∈</span> Pow<span class="main">(</span>nat <span class="main">×</span> <span class="free">A</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> D
  <span class="keyword1"><span class="command">have</span></span> q<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">t</span><span class="main">∈</span><span class="main">{</span><span class="bound">t</span><span class="main">∈</span>Pow<span class="main">(</span>Sigma<span class="main">(</span><span class="free">k</span><span class="main">,</span><span class="main">%</span><span class="main"><span class="bound">_</span></span><span class="main">.</span><span class="free">A</span><span class="main">)</span><span class="main">)</span><span class="main">.</span> <span class="free">k</span><span class="main">⊆</span>domain<span class="main">(</span><span class="bound">t</span><span class="main">)</span> <span class="main">&amp;</span> function<span class="main">(</span><span class="bound">t</span><span class="main">)</span><span class="main">}</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">unfold</span> Pi_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> J<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">t</span> <span class="main">∈</span> Pow<span class="main">(</span><span class="free">k</span> <span class="main">×</span> <span class="free">A</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> CollectD1<span class="main"><span class="main">[</span></span><span class="operator">OF</span> q<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> G<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">k</span> <span class="main">×</span> <span class="free">A</span> <span class="main">⊆</span> nat <span class="main">×</span> <span class="free">A</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> func.Sigma_mono<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> knat
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">k</span><span class="main">⊆</span>nat›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> QUniv.naturals_subset_nat<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">k</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">⊆</span> <span class="free">A</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">t</span> <span class="main">∈</span> Pow<span class="main">(</span>nat <span class="main">×</span> <span class="free">A</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> subsetD<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> func.Pow_mono<span class="main"><span class="main">[</span></span><span class="operator">OF</span> G<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> J<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Compatible set›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Union of compatible set of functions is a function.›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">compat</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">[</span>i<span class="main">,</span>i<span class="main">]</span><span class="main">⇒</span>o›</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">compat</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">f1</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">f2</span></span></span><span class="main">)</span> <span class="main">==</span> <span class="main">∀</span><span class="bound">x</span><span class="main">.</span><span class="main">∀</span><span class="bound">y1</span><span class="main">.</span><span class="main">∀</span><span class="bound">y2</span><span class="main">.</span><span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">y1</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">f1</span></span></span> <span class="main">∧</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">y2</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">f2</span></span></span> <span class="main">⟶</span> <span class="bound">y1</span><span class="main">=</span><span class="bound">y2</span>"</span></span>

<span class="keyword1" id="recursion-compatI"><span class="command">lemma</span></span> compatI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span> <span class="bound">y1</span> <span class="bound">y2</span><span class="main">.</span><span class="main">⟦</span><span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">y1</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f1</span><span class="main">;</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">y2</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f2</span><span class="main">⟧</span><span class="main">⟹</span><span class="bound">y1</span><span class="main">=</span><span class="bound">y2</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹compat<span class="main">(</span><span class="free">f1</span><span class="main">,</span><span class="free">f2</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> compat_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">x</span> <span class="bound">y1</span> <span class="bound">y2</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span> <span class="bound">y1</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f1</span> <span class="main">∧</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span> <span class="bound">y2</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f2</span> <span class="main">⟶</span> <span class="bound">y1</span> <span class="main">=</span> <span class="bound">y2</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> allI <span class="main"><span class="keyword3">|</span></span> <span class="operator">rule</span> impI<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y1</span> <span class="skolem">y2</span>
    <span class="keyword3"><span class="command">assume</span></span> K<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y1</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f1</span> <span class="main">∧</span> <span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y2</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f2</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> K1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y1</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f1</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> conjunct1<span class="main"><span class="main">[</span></span><span class="operator">OF</span> K<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> K2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y2</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f2</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> conjunct2<span class="main"><span class="main">[</span></span><span class="operator">OF</span> K<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y1</span> <span class="main">=</span> <span class="skolem">y2</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> H<span class="main"><span class="main">[</span></span><span class="operator">OF</span> K1 K2<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-compatD"><span class="command">lemma</span></span> compatD<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H<span class="main">:</span> <span class="quoted"><span class="quoted">‹compat<span class="main">(</span><span class="free">f1</span><span class="main">,</span><span class="free">f2</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span> <span class="bound">y1</span> <span class="bound">y2</span><span class="main">.</span><span class="main">⟦</span><span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">y1</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f1</span><span class="main">;</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">y2</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f2</span><span class="main">⟧</span><span class="main">⟹</span><span class="bound">y1</span><span class="main">=</span><span class="bound">y2</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y1</span> <span class="skolem">y2</span>
  <span class="keyword3"><span class="command">assume</span></span> Q1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y1</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f1</span>›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> Q2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y2</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f2</span>›</span></span>
  <span class="keyword1"><span class="command">from</span></span> H <span class="keyword1"><span class="command">have</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">x</span> <span class="bound">y1</span> <span class="bound">y2</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span> <span class="bound">y1</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f1</span> <span class="main">∧</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span> <span class="bound">y2</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f2</span> <span class="main">⟶</span> <span class="bound">y1</span> <span class="main">=</span> <span class="bound">y2</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> compat_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y1</span><span class="main">=</span><span class="skolem">y2</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> mp<span class="main"><span class="main">[</span></span><span class="operator">OF</span> spec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> spec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> spec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y1</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f1</span> <span class="main">∧</span> <span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y2</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f2</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> conjI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> Q1 Q2<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-compatE"><span class="command">lemma</span></span> compatE<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H<span class="main">:</span> <span class="quoted"><span class="quoted">‹compat<span class="main">(</span><span class="free">f1</span><span class="main">,</span><span class="free">f2</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> W<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋀</span><span class="bound">x</span> <span class="bound">y1</span> <span class="bound">y2</span><span class="main">.</span><span class="main">⟦</span><span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">y1</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f1</span><span class="main">;</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">y2</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f2</span><span class="main">⟧</span><span class="main">⟹</span><span class="bound">y1</span><span class="main">=</span><span class="bound">y2</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">E</span>›</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="free">E</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> W<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> compatD<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">assumption</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>


<span class="keyword1"><span class="command">definition</span></span> <span class="entity">compatset</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹i<span class="main">⇒</span>o›</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">compatset</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">)</span> <span class="main">==</span> <span class="main">∀</span><span class="bound">f1</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">.</span><span class="main">∀</span><span class="bound">f2</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">S</span></span></span><span class="main">.</span> compat<span class="main">(</span><span class="bound">f1</span><span class="main">,</span><span class="bound">f2</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="recursion-compatsetI"><span class="command">lemma</span></span> compatsetI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span> <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> 1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">f1</span> <span class="bound">f2</span><span class="main">.</span> <span class="main">⟦</span><span class="bound">f1</span><span class="main">∈</span><span class="free">S</span><span class="main">;</span><span class="bound">f2</span><span class="main">∈</span><span class="free">S</span><span class="main">⟧</span> <span class="main">⟹</span> compat<span class="main">(</span><span class="bound">f1</span><span class="main">,</span><span class="bound">f2</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹compatset<span class="main">(</span><span class="free">S</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> compatset_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ballI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ballI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> 1<span class="main"><span class="keyword3">,</span></span> <span class="operator">assumption</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>

<span class="keyword1" id="recursion-compatsetD"><span class="command">lemma</span></span> compatsetD<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H<span class="main">:</span> <span class="quoted"><span class="quoted">‹compatset<span class="main">(</span><span class="free">S</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">f1</span> <span class="bound">f2</span><span class="main">.</span><span class="main">⟦</span><span class="bound">f1</span><span class="main">∈</span><span class="free">S</span><span class="main">;</span> <span class="bound">f2</span><span class="main">∈</span><span class="free">S</span><span class="main">⟧</span><span class="main">⟹</span>compat<span class="main">(</span><span class="bound">f1</span><span class="main">,</span><span class="bound">f2</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f1</span> <span class="skolem">f2</span>
  <span class="keyword3"><span class="command">assume</span></span> H1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">f1</span><span class="main">∈</span><span class="free">S</span>›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> H2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">f2</span><span class="main">∈</span><span class="free">S</span>›</span></span>
  <span class="keyword1"><span class="command">from</span></span> H <span class="keyword1"><span class="command">have</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">f1</span><span class="main">∈</span><span class="free">S</span><span class="main">.</span><span class="main">∀</span><span class="bound">f2</span><span class="main">∈</span><span class="free">S</span><span class="main">.</span> compat<span class="main">(</span><span class="bound">f1</span><span class="main">,</span><span class="bound">f2</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> compatset_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹compat<span class="main">(</span><span class="skolem">f1</span><span class="main">,</span><span class="skolem">f2</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> bspec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> bspec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H H1<span class="main"><span class="main">]</span></span> H2<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-compatsetE"><span class="command">lemma</span></span> compatsetE<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H<span class="main">:</span> <span class="quoted"><span class="quoted">‹compatset<span class="main">(</span><span class="free">S</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> W<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋀</span><span class="bound">f1</span> <span class="bound">f2</span><span class="main">.</span><span class="main">⟦</span><span class="bound">f1</span><span class="main">∈</span><span class="free">S</span><span class="main">;</span> <span class="bound">f2</span><span class="main">∈</span><span class="free">S</span><span class="main">⟧</span><span class="main">⟹</span>compat<span class="main">(</span><span class="bound">f1</span><span class="main">,</span><span class="bound">f2</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">E</span>›</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="free">E</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> W<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> compatsetD<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">assumption</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> upairI1 <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">a</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span> <span class="free">b</span><span class="main">}</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="free">a</span> <span class="main">∉</span> <span class="main">{</span><span class="free">b</span><span class="main">}</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">a</span> <span class="main">=</span> <span class="free">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> refl<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> upairI2 <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">b</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span> <span class="free">b</span><span class="main">}</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">b</span> <span class="main">∉</span> <span class="main">{</span><span class="free">b</span><span class="main">}</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> Y<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">b</span> <span class="main">∈</span> <span class="main">{</span><span class="free">b</span><span class="main">}</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> upair.singletonI<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">b</span> <span class="main">=</span> <span class="free">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> notE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H Y<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> sinup <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">∈</span> <span class="main">⟨</span><span class="free">x</span><span class="main">,</span> <span class="free">xa</span><span class="main">⟩</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> Pair_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">∈</span> <span class="main">{</span><span class="main">{</span><span class="free">x</span><span class="main">,</span> <span class="free">x</span><span class="main">}</span><span class="main">,</span> <span class="main">{</span><span class="free">x</span><span class="main">,</span> <span class="free">xa</span><span class="main">}</span><span class="main">}</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> IFOL.subst<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">∈</span> <span class="main">{</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">,</span><span class="main">{</span><span class="free">x</span><span class="main">,</span><span class="free">xa</span><span class="main">}</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> upairI1<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">,</span> <span class="main">{</span><span class="free">x</span><span class="main">,</span> <span class="free">xa</span><span class="main">}</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="main">{</span><span class="free">x</span><span class="main">,</span> <span class="free">x</span><span class="main">}</span><span class="main">,</span> <span class="main">{</span><span class="free">x</span><span class="main">,</span> <span class="free">xa</span><span class="main">}</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> compatsetunionfun <span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">S</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H0<span class="main">:</span><span class="quoted"><span class="quoted">‹compatset<span class="main">(</span><span class="free">S</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹function<span class="main">(</span><span class="main">⋃</span><span class="free">S</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> function_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹ <span class="main">∀</span><span class="bound">x</span> <span class="bound">y1</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span> <span class="bound">y1</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">⋃</span><span class="free">S</span> <span class="main">⟶</span>
          <span class="main">(</span><span class="main">∀</span><span class="bound">y2</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span> <span class="bound">y2</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">⋃</span><span class="free">S</span> <span class="main">⟶</span> <span class="bound">y1</span> <span class="main">=</span> <span class="bound">y2</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y1</span> <span class="skolem">y2</span>
    <span class="keyword3"><span class="command">assume</span></span> F1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y1</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">⋃</span><span class="free">S</span>›</span></span>
    <span class="keyword3"><span class="command">assume</span></span> F2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y2</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">⋃</span><span class="free">S</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y1</span><span class="main">=</span><span class="skolem">y2</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> UnionE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> F1<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> UnionE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> F2<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f1</span> <span class="skolem">f2</span>
      <span class="keyword3"><span class="command">assume</span></span> J1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y1</span><span class="main">⟩</span> <span class="main">∈</span> <span class="skolem">f1</span>›</span></span>
      <span class="keyword3"><span class="command">assume</span></span> J2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y2</span><span class="main">⟩</span> <span class="main">∈</span> <span class="skolem">f2</span>›</span></span>
      <span class="keyword3"><span class="command">assume</span></span> K1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">f1</span> <span class="main">∈</span> <span class="free">S</span>›</span></span>
      <span class="keyword3"><span class="command">assume</span></span> K2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">f2</span> <span class="main">∈</span> <span class="free">S</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> R<span class="main">:</span><span class="quoted"><span class="quoted">‹compat<span class="main">(</span><span class="skolem">f1</span><span class="main">,</span><span class="skolem">f2</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> compatsetD<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H0 K1 K2<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y1</span><span class="main">=</span><span class="skolem">y2</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> compatD<span class="main"><span class="main">[</span></span><span class="operator">OF</span> R J1 J2<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> mkel <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> 1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">A</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> 2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">A</span><span class="main">⟹</span><span class="free">B</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="free">B</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> 2<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> 1<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> valofunion <span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">S</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H0<span class="main">:</span><span class="quoted"><span class="quoted">‹compatset<span class="main">(</span><span class="free">S</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> W<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f</span><span class="main">∈</span><span class="free">S</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Q<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f</span><span class="main">:</span><span class="free">A</span><span class="main">→</span><span class="free">B</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> T<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">a</span><span class="main">∈</span><span class="free">A</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> P<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">`</span> <span class="free">a</span> <span class="main">=</span> <span class="free">v</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> N<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋃</span><span class="free">S</span><span class="main">)</span><span class="main">`</span><span class="free">a</span> <span class="main">=</span> <span class="free">v</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> K<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="free">a</span><span class="main">,</span> <span class="free">v</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> apparg<span class="main"><span class="main">[</span></span><span class="operator">OF</span> Q P T<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> N<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋃</span><span class="free">S</span><span class="main">)</span><span class="main">`</span><span class="free">a</span> <span class="main">=</span> <span class="free">v</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> function_apply_equality<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹function<span class="main">(</span><span class="main">⋃</span><span class="free">S</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> compatsetunionfun<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H0<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="free">a</span><span class="main">,</span> <span class="free">v</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">⋃</span><span class="free">S</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> UnionI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> W K <span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Partial computation"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">satpc</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">[</span>i<span class="main">,</span>i<span class="main">,</span>i<span class="main">]</span> <span class="main">⇒</span> o ›</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="free">satpc</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">α</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span> <span class="main">==</span> <span class="main">∀</span><span class="bound">n</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="main">.</span> <span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">`</span>succ<span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">g</span></span></span> <span class="main">`</span> <span class="main">&lt;</span><span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">`</span><span class="bound">n</span><span class="main">,</span> <span class="bound">n</span><span class="main">&gt;</span>›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹$m$-step computation based on $a$ and $g$›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">partcomp</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">[</span>i<span class="main">,</span>i<span class="main">,</span>i<span class="main">,</span>i<span class="main">,</span>i<span class="main">]</span><span class="main">⇒</span>o›</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="free">partcomp</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">a</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span> <span class="main">==</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">:</span>succ<span class="main">(</span><span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">)</span><span class="main">→</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">`</span><span class="main">0</span><span class="main">=</span><span class="free"><span class="bound"><span class="entity">a</span></span></span><span class="main">)</span> <span class="main">∧</span> satpc<span class="main">(</span><span class="free"><span class="bound"><span class="entity">t</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">m</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span>›</span></span>

<span class="keyword1" id="recursion-partcompI"><span class="command">lemma</span></span> partcompI <span class="main">[</span><span class="operator">intro</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">t</span><span class="main">:</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">→</span><span class="free">A</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">t</span><span class="main">`</span><span class="main">0</span><span class="main">=</span><span class="free">a</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H3<span class="main">:</span><span class="quoted"><span class="quoted">‹satpc<span class="main">(</span><span class="free">t</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">t</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> partcomp_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">t</span> <span class="main">∈</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">→</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> H1<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">t</span><span class="main">`</span><span class="main">0</span><span class="main">=</span><span class="free">a</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> H2<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹satpc<span class="main">(</span><span class="free">t</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> H3<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-partcompD1"><span class="command">lemma</span></span> partcompD1<span class="main">:</span> <span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">t</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">t</span> <span class="main">∈</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">→</span> <span class="free">A</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> partcomp_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="recursion-partcompD2"><span class="command">lemma</span></span> partcompD2<span class="main">:</span> <span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">t</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">t</span><span class="main">`</span><span class="main">0</span><span class="main">=</span><span class="free">a</span><span class="main">)</span>›</span></span>
 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> partcomp_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="recursion-partcompD3"><span class="command">lemma</span></span> partcompD3<span class="main">:</span> <span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">t</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span> <span class="main">⟹</span> satpc<span class="main">(</span><span class="free">t</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> partcomp_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>

<span class="keyword1" id="recursion-partcompE"><span class="command">lemma</span></span> partcompE <span class="main">[</span><span class="operator">elim</span><span class="main">]</span> <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> 1<span class="main">:</span><span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">t</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> 2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟦</span><span class="main">(</span><span class="free">t</span><span class="main">:</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">→</span><span class="free">A</span><span class="main">)</span> <span class="main">;</span> <span class="main">(</span><span class="free">t</span><span class="main">`</span><span class="main">0</span><span class="main">=</span><span class="free">a</span><span class="main">)</span> <span class="main">;</span> satpc<span class="main">(</span><span class="free">t</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">g</span><span class="main">)</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="free">E</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="free">E</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> 2<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> partcompD1<span class="main"><span class="main">[</span></span><span class="operator">OF</span> 1<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> partcompD2<span class="main"><span class="main">[</span></span><span class="operator">OF</span> 1<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> partcompD3<span class="main"><span class="main">[</span></span><span class="operator">OF</span> 1<span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹If we add ordered pair in the middle of partial computation then
it will not change.›</span></span>
<span class="keyword1" id="recursion-addmiddle"><span class="command">lemma</span></span> addmiddle<span class="main">:</span>
<span class="comment1">(*  fixes  t m a g*)</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> mnat<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">m</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> F<span class="main">:</span><span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">t</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> xinm<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">x</span><span class="main">∈</span><span class="free">m</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="free">x</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">x</span><span class="main">,</span> <span class="free">x</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span> <span class="main">=</span> <span class="free">t</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> partcompE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> F<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> F1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">t</span> <span class="main">∈</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">→</span> <span class="free">A</span>›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> F2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">t</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span>›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> F3<span class="main">:</span><span class="quoted"><span class="quoted">‹satpc<span class="main">(</span><span class="free">t</span><span class="main">,</span> <span class="free">m</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">from</span></span> F3
  <span class="keyword1"><span class="command">have</span></span> W<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span><span class="free">m</span><span class="main">.</span> <span class="free">t</span> <span class="main">`</span> succ<span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="bound">n</span><span class="main">,</span> <span class="bound">n</span><span class="main">⟩</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> satpc_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> U<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">t</span> <span class="main">`</span> succ<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">x</span><span class="main">,</span> <span class="free">x</span><span class="main">⟩</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> bspec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> W xinm<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> E<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span>succ<span class="main">(</span><span class="free">x</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">x</span><span class="main">,</span> <span class="free">x</span><span class="main">⟩</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">t</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> apparg<span class="main"><span class="main">[</span></span><span class="operator">OF</span> F1 U<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> mp<span class="main"><span class="main">[</span></span><span class="operator">OF</span> bspec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> le_succ mnat<span class="main"><span class="main">]</span></span> xinm<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> equalities.cons_absorb<span class="main"><span class="main">[</span></span><span class="operator">OF</span> E<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Set of functions ›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹It is denoted as $F$ on page 48 in "Introduction to Set Theory".›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">pcs</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">[</span>i<span class="main">,</span>i<span class="main">,</span>i<span class="main">]</span><span class="main">⇒</span>i›</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="free">pcs</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">a</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span> <span class="main">==</span> <span class="main">{</span><span class="bound">t</span><span class="main">∈</span>Pow<span class="main">(</span>nat<span class="main">*</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span> partcomp<span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">,</span><span class="bound">t</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">a</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span><span class="main">}</span>›</span></span>

<span class="keyword1" id="recursion-pcs_uniq"><span class="command">lemma</span></span> pcs_uniq <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> F1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">m1</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> F2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">m2</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H1<span class="main">:</span> <span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">f1</span><span class="main">,</span><span class="free">m1</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H2<span class="main">:</span> <span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">f2</span><span class="main">,</span><span class="free">m2</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span>nat<span class="main">.</span> <span class="bound">n</span><span class="main">∈</span>succ<span class="main">(</span><span class="free">m1</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">n</span><span class="main">∈</span>succ<span class="main">(</span><span class="free">m2</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">f1</span><span class="main">`</span><span class="bound">n</span> <span class="main">=</span> <span class="free">f2</span><span class="main">`</span><span class="bound">n</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> partcompE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H1<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> partcompE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H2<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> H11<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f1</span> <span class="main">∈</span> succ<span class="main">(</span><span class="free">m1</span><span class="main">)</span> <span class="main">→</span> <span class="free">A</span>›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> H12<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f1</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span> ›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> H13<span class="main">:</span><span class="quoted"><span class="quoted">‹satpc<span class="main">(</span><span class="free">f1</span><span class="main">,</span> <span class="free">m1</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> H21<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f2</span> <span class="main">∈</span> succ<span class="main">(</span><span class="free">m2</span><span class="main">)</span> <span class="main">→</span> <span class="free">A</span>›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> H22<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f2</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span>›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> H23<span class="main">:</span><span class="quoted"><span class="quoted">‹satpc<span class="main">(</span><span class="free">f2</span><span class="main">,</span> <span class="free">m2</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span>nat<span class="main">.</span> <span class="bound">n</span><span class="main">∈</span>succ<span class="main">(</span><span class="free">m1</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">n</span><span class="main">∈</span>succ<span class="main">(</span><span class="free">m2</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">f1</span><span class="main">`</span><span class="bound">n</span> <span class="main">=</span> <span class="free">f2</span><span class="main">`</span><span class="bound">n</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> nat_induct_bound<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> H12 <span class="keyword2"><span class="keyword">and</span></span> H22
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span><span class="main">∈</span>succ<span class="main">(</span><span class="free">m1</span><span class="main">)</span> <span class="main">∧</span> <span class="main">0</span><span class="main">∈</span>succ<span class="main">(</span><span class="free">m2</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">f1</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">f2</span> <span class="main">`</span> <span class="main">0</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> J0<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> J1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> succ<span class="main">(</span><span class="free">m1</span><span class="main">)</span> <span class="main">∧</span> <span class="skolem">x</span> <span class="main">∈</span> succ<span class="main">(</span><span class="free">m2</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">f1</span> <span class="main">`</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">f2</span> <span class="main">`</span> <span class="skolem">x</span>›</span></span>
  <span class="keyword1"><span class="command">from</span></span> H13 <span class="keyword1"><span class="command">have</span></span> G1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span> <span class="main">∈</span> <span class="free">m1</span> <span class="main">.</span> <span class="free">f1</span><span class="main">`</span>succ<span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">&lt;</span><span class="free">f1</span><span class="main">`</span><span class="bound">n</span><span class="main">,</span> <span class="bound">n</span><span class="main">&gt;</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> satpc_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> H23 <span class="keyword1"><span class="command">have</span></span> G2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span> <span class="main">∈</span> <span class="free">m2</span> <span class="main">.</span> <span class="free">f2</span><span class="main">`</span>succ<span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">&lt;</span><span class="free">f2</span><span class="main">`</span><span class="bound">n</span><span class="main">,</span> <span class="bound">n</span><span class="main">&gt;</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> satpc_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="free">m1</span><span class="main">)</span> <span class="main">∧</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="free">m2</span><span class="main">)</span> <span class="main">⟶</span>
        <span class="free">f1</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">f2</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> K<span class="main">:</span><span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="free">m1</span><span class="main">)</span> <span class="main">∧</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="free">m2</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">from</span></span> K <span class="keyword1"><span class="command">have</span></span> K1<span class="main">:</span><span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="free">m1</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> K <span class="keyword1"><span class="command">have</span></span> K2<span class="main">:</span><span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span><span class="free">m2</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> K1'<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="free">m1</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> mp<span class="main"><span class="main">[</span></span><span class="operator">OF</span> bspec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> succ_le F1<span class="main"><span class="main">]</span></span> K1<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> K2'<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="free">m2</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> mp<span class="main"><span class="main">[</span></span><span class="operator">OF</span> bspec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> succ_le F2<span class="main"><span class="main">]</span></span> K2<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> U1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span>succ<span class="main">(</span><span class="free">m1</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Nat.succ_in_naturalD<span class="main"><span class="main">[</span></span><span class="operator">OF</span> K1 Nat.nat_succI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> F1<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> U2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span>succ<span class="main">(</span><span class="free">m2</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Nat.succ_in_naturalD<span class="main"><span class="main">[</span></span><span class="operator">OF</span> K2 Nat.nat_succI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> F2<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> Y1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f1</span><span class="main">`</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">&lt;</span><span class="free">f1</span><span class="main">`</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">&gt;</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> bspec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> G1 K1'<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> Y2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f2</span><span class="main">`</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">&lt;</span><span class="free">f2</span><span class="main">`</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">&gt;</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> bspec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> G2 K2'<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f1</span> <span class="main">`</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">f2</span> <span class="main">`</span> <span class="skolem">x</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> mp<span class="main"><span class="main">[</span></span><span class="operator">OF</span> J1 conjI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> U1 U2<span class="main"><span class="main">]</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> Y<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">g</span> <span class="main">`</span> <span class="main">&lt;</span><span class="free">f1</span><span class="main">`</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">&gt;</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">&lt;</span><span class="free">f2</span><span class="main">`</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">&gt;</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> Y1 <span class="keyword2"><span class="keyword">and</span></span> Y2 <span class="keyword2"><span class="keyword">and</span></span> Y
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f1</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">f2</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-domainsubsetfunc"><span class="command">lemma</span></span> domainsubsetfunc <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> Q<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f1</span><span class="main">⊆</span><span class="free">f2</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹domain<span class="main">(</span><span class="free">f1</span><span class="main">)</span><span class="main">⊆</span>domain<span class="main">(</span><span class="free">f2</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> domain<span class="main">(</span><span class="free">f1</span><span class="main">)</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> domain<span class="main">(</span><span class="free">f2</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> domainE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span>
    <span class="keyword3"><span class="command">assume</span></span> W<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f1</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f2</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> subsetD<span class="main"><span class="main">[</span></span><span class="operator">OF</span> Q W<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> domain<span class="main">(</span><span class="free">f2</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> domainI<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-natdomfunc"><span class="command">lemma</span></span> natdomfunc<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> 1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">q</span><span class="main">∈</span><span class="free">A</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> J0<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f1</span> <span class="main">∈</span> Pow<span class="main">(</span>nat <span class="main">×</span> <span class="free">A</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> U<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">m1</span> <span class="main">∈</span> domain<span class="main">(</span><span class="free">f1</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="free">m1</span><span class="main">∈</span>nat›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> J0 <span class="keyword1"><span class="command">have</span></span> J0 <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">f1</span> <span class="main">⊆</span> nat <span class="main">×</span> <span class="free">A</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> J0<span class="main">:</span><span class="quoted"><span class="quoted">‹domain<span class="main">(</span><span class="free">f1</span><span class="main">)</span> <span class="main">⊆</span> domain<span class="main">(</span>nat <span class="main">×</span> <span class="free">A</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> func.domain_mono<span class="main"><span class="main">[</span></span><span class="operator">OF</span> J0<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> F<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">m1</span> <span class="main">∈</span> domain<span class="main">(</span>nat <span class="main">×</span> <span class="free">A</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> subsetD<span class="main"><span class="main">[</span></span><span class="operator">OF</span> J0 U<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> R<span class="main">:</span><span class="quoted"><span class="quoted">‹domain<span class="main">(</span>nat <span class="main">×</span> <span class="free">A</span><span class="main">)</span> <span class="main">=</span> nat›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> equalities.domain_of_prod<span class="main"><span class="main">[</span></span><span class="operator">OF</span> 1<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">m1</span> <span class="main">∈</span> nat›</span></span>
    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> subst<span class="main"><span class="main">[</span></span><span class="operator">OF</span> R<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> F<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-pcs_lem"><span class="command">lemma</span></span> pcs_lem <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> 1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">q</span><span class="main">∈</span><span class="free">A</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹compatset<span class="main">(</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="comment1">(*(rule compatsetI)*)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f1</span> <span class="skolem">f2</span>
  <span class="keyword3"><span class="command">assume</span></span> H1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">f1</span> <span class="main">∈</span> pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> H1'<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">f1</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">t</span><span class="main">∈</span>Pow<span class="main">(</span>nat<span class="main">*</span><span class="free">A</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="bound">t</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span><span class="main">}</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> pcs_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> H1'A<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">f1</span> <span class="main">∈</span> Pow<span class="main">(</span>nat<span class="main">*</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> H1'A<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">f1</span> <span class="main">⊆</span> <span class="main">(</span>nat<span class="main">*</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">assume</span></span> H2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">f2</span> <span class="main">∈</span> pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> H2'<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">f2</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">t</span><span class="main">∈</span>Pow<span class="main">(</span>nat<span class="main">*</span><span class="free">A</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="bound">t</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span><span class="main">}</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> pcs_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹compat<span class="main">(</span><span class="skolem">f1</span><span class="main">,</span> <span class="skolem">f2</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> compatI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y1</span> <span class="skolem">y2</span>
    <span class="keyword3"><span class="command">assume</span></span> P1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y1</span><span class="main">⟩</span> <span class="main">∈</span> <span class="skolem">f1</span>›</span></span>
    <span class="keyword3"><span class="command">assume</span></span> P2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y2</span><span class="main">⟩</span> <span class="main">∈</span> <span class="skolem">f2</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y1</span> <span class="main">=</span> <span class="skolem">y2</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> CollectE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H1'<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> CollectE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H2'<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> J0<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">f1</span> <span class="main">∈</span> Pow<span class="main">(</span>nat <span class="main">×</span> <span class="free">A</span><span class="main">)</span>›</span></span>
      <span class="keyword3"><span class="command">assume</span></span> J1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">f2</span> <span class="main">∈</span> Pow<span class="main">(</span>nat <span class="main">×</span> <span class="free">A</span><span class="main">)</span>›</span></span>
      <span class="keyword3"><span class="command">assume</span></span> J2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="skolem">f1</span><span class="main">,</span> <span class="bound">m</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
      <span class="keyword3"><span class="command">assume</span></span> J3<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="skolem">f2</span><span class="main">,</span> <span class="bound">m</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y1</span> <span class="main">=</span> <span class="skolem">y2</span>›</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> bexE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> J2<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> bexE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> J3<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m1</span> <span class="skolem">m2</span>
        <span class="keyword3"><span class="command">assume</span></span> K1<span class="main">:</span><span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="skolem">f1</span><span class="main">,</span> <span class="skolem">m1</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
        <span class="keyword3"><span class="command">assume</span></span> K2<span class="main">:</span><span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="skolem">f2</span><span class="main">,</span> <span class="skolem">m2</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">hence</span></span> K2'<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">f2</span><span class="main">:</span>succ<span class="main">(</span><span class="skolem">m2</span><span class="main">)</span><span class="main">→</span><span class="free">A</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="skolem">f2</span><span class="main">`</span><span class="main">0</span><span class="main">=</span><span class="free">a</span><span class="main">)</span> <span class="main">∧</span> satpc<span class="main">(</span><span class="skolem">f2</span><span class="main">,</span><span class="skolem">m2</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> partcomp_def<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> K1 <span class="keyword1"><span class="command">have</span></span> K1'A<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">f1</span><span class="main">:</span>succ<span class="main">(</span><span class="skolem">m1</span><span class="main">)</span><span class="main">→</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> partcompD1<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> K2' <span class="keyword1"><span class="command">have</span></span> K2'A<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">f2</span><span class="main">:</span>succ<span class="main">(</span><span class="skolem">m2</span><span class="main">)</span><span class="main">→</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> K1'A <span class="keyword1"><span class="command">have</span></span> K1'AD<span class="main">:</span><span class="quoted"><span class="quoted">‹domain<span class="main">(</span><span class="skolem">f1</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">m1</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> domain_of_fun<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> K2'A <span class="keyword1"><span class="command">have</span></span> K2'AD<span class="main">:</span><span class="quoted"><span class="quoted">‹domain<span class="main">(</span><span class="skolem">f2</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">m2</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> domain_of_fun<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">f1</span><span class="main">`</span><span class="skolem">x</span><span class="main">=</span><span class="skolem">y1</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> func.apply_equality<span class="main"><span class="main">[</span></span><span class="operator">OF</span> P1<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> K1'A<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">f2</span><span class="main">`</span><span class="skolem">x</span><span class="main">=</span><span class="skolem">y2</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> func.apply_equality<span class="main"><span class="main">[</span></span><span class="operator">OF</span> P2<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> K2'A<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> m1nat<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">m1</span><span class="main">∈</span>nat›</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> natdomfunc<span class="main"><span class="main">[</span></span><span class="operator">OF</span> 1 J0<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m1</span> <span class="main">∈</span> domain<span class="main">(</span><span class="skolem">f1</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ssubst<span class="main"><span class="main">[</span></span><span class="operator">OF</span> K1'AD<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">have</span></span> m2nat<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">m2</span><span class="main">∈</span>nat›</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> natdomfunc<span class="main"><span class="main">[</span></span><span class="operator">OF</span> 1 J1<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m2</span> <span class="main">∈</span> domain<span class="main">(</span><span class="skolem">f2</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ssubst<span class="main"><span class="main">[</span></span><span class="operator">OF</span> K2'AD<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">have</span></span> G1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y1</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">(</span>nat<span class="main">*</span><span class="free">A</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> subsetD<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H1'A P1<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> KK<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span>nat›</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> SigmaE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> G1<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
        <span class="comment1">(*x is in the domain of f1  i.e. succ(m1)
so we can have both  x ∈ ?m1.2 ∧ x ∈ ?m2.2
how to prove that m1 ∈ nat ? from J0 !  f1 is a subset of nat × A*)</span>
        <span class="keyword1"><span class="command">have</span></span> W<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">f1</span><span class="main">`</span><span class="skolem">x</span><span class="main">=</span><span class="skolem">f2</span><span class="main">`</span><span class="skolem">x</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> mp<span class="main"><span class="main">[</span></span><span class="operator">OF</span> bspec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> pcs_uniq KK<span class="main"><span class="main">]</span></span> <span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m1</span> <span class="main">∈</span> nat›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> m1nat<span class="main">)</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">m2</span> <span class="main">∈</span> nat›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> m2nat<span class="main">)</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="skolem">f1</span><span class="main">,</span> <span class="skolem">m1</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> K1<span class="main">)</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="skolem">f2</span><span class="main">,</span> <span class="skolem">m2</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> K2<span class="main">)</span>
        <span class="keyword1"><span class="command">next</span></span>
            <span class="comment1">(*  P1:‹⟨x, y1⟩ ∈ f1›
              K1'A:‹(f1:succ(m1)→A)›
            *)</span>
          <span class="keyword1"><span class="command">have</span></span> U1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">m1</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> func.domain_type<span class="main"><span class="main">[</span></span><span class="operator">OF</span> P1 K1'A<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">have</span></span> U2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">m2</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> func.domain_type<span class="main"><span class="main">[</span></span><span class="operator">OF</span> P2 K2'A<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">m1</span><span class="main">)</span> <span class="main">∧</span> <span class="skolem">x</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">m2</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> conjI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> U1 U2<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">from</span></span> L1 <span class="keyword2"><span class="keyword">and</span></span> W <span class="keyword2"><span class="keyword">and</span></span> L2
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y1</span> <span class="main">=</span> <span class="skolem">y2</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> fuissu <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">∈</span> <span class="free">X</span> <span class="main">-&gt;</span> <span class="free">Y</span> <span class="main">⟹</span> <span class="free">f</span> <span class="main">⊆</span> <span class="free">X</span><span class="main">×</span><span class="free">Y</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">w</span>
  <span class="keyword3"><span class="command">assume</span></span> H1 <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">∈</span> <span class="free">X</span> <span class="main">-&gt;</span> <span class="free">Y</span>›</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> J1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">q</span><span class="main">∈</span>Pow<span class="main">(</span>Sigma<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="main">λ</span><span class="main"><span class="bound">_</span></span><span class="main">.</span><span class="free">Y</span><span class="main">)</span><span class="main">)</span><span class="main">.</span> <span class="free">X</span><span class="main">⊆</span>domain<span class="main">(</span><span class="bound">q</span><span class="main">)</span> <span class="main">&amp;</span> function<span class="main">(</span><span class="bound">q</span><span class="main">)</span><span class="main">}</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> Pi_def<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> J2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">∈</span> Pow<span class="main">(</span>Sigma<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="main">λ</span><span class="main"><span class="bound">_</span></span><span class="main">.</span><span class="free">Y</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> J3<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">⊆</span> Sigma<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="main">λ</span><span class="main"><span class="bound">_</span></span><span class="main">.</span><span class="free">Y</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">assume</span></span> H2 <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">w</span> <span class="main">∈</span> <span class="free">f</span>›</span></span>
  <span class="keyword1"><span class="command">from</span></span> J3 <span class="keyword2"><span class="keyword">and</span></span> H2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">w</span><span class="main">∈</span>Sigma<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="main">λ</span><span class="main"><span class="bound">_</span></span><span class="main">.</span><span class="free">Y</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> J4<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">w</span> <span class="main">∈</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">y</span><span class="main">∈</span><span class="free">Y</span><span class="main">.</span> <span class="main">{</span><span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">⟩</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">w</span> <span class="main">∈</span> <span class="free">X</span><span class="main">*</span><span class="free">Y</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> UN_E<span class="main"><span class="main">[</span></span><span class="operator">OF</span> J4<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">assume</span></span> V1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="free">X</span>›</span></span>
    <span class="keyword3"><span class="command">assume</span></span> V2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">w</span> <span class="main">∈</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">y</span><span class="main">∈</span><span class="free">Y</span><span class="main">.</span> <span class="main">{</span><span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="bound">y</span><span class="main">⟩</span><span class="main">}</span><span class="main">)</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">w</span> <span class="main">∈</span> <span class="free">X</span> <span class="main">×</span> <span class="free">Y</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> UN_E<span class="main"><span class="main">[</span></span><span class="operator">OF</span> V2<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span>
      <span class="keyword3"><span class="command">assume</span></span> V3<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="free">Y</span>›</span></span>
      <span class="keyword3"><span class="command">assume</span></span> V4<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">w</span> <span class="main">∈</span> <span class="main">{</span><span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y</span><span class="main">⟩</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> V4<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">w</span> <span class="main">=</span> <span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y</span><span class="main">⟩</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> v5<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> Sigma<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="main">λ</span><span class="main"><span class="bound">_</span></span><span class="main">.</span><span class="free">Y</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> SigmaI<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="free">X</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> V1<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="free">Y</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> V3<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> V5<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">X</span><span class="main">*</span><span class="free">Y</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> V4 <span class="keyword2"><span class="keyword">and</span></span> V5 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">w</span> <span class="main">∈</span> <span class="free">X</span> <span class="main">×</span> <span class="free">Y</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> recuniq <span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">f</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H0<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">∈</span> nat <span class="main">-&gt;</span> <span class="free">A</span> <span class="main">∧</span> <span class="free">f</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span> <span class="main">∧</span> satpc<span class="main">(</span><span class="free">f</span><span class="main">,</span> nat<span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">t</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">t</span> <span class="main">∈</span> nat <span class="main">-&gt;</span> <span class="free">A</span> <span class="main">∧</span> <span class="free">t</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span> <span class="main">∧</span> satpc<span class="main">(</span><span class="free">t</span><span class="main">,</span> nat<span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">x</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span><span class="main">=</span><span class="free">t</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> H0 <span class="keyword1"><span class="command">have</span></span> H02<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span> <span class="main">∈</span> nat<span class="main">.</span> <span class="free">f</span><span class="main">`</span>succ<span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">&lt;</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="bound">n</span><span class="main">)</span><span class="main">,</span> <span class="bound">n</span><span class="main">&gt;</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> satpc_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> H0 <span class="keyword1"><span class="command">have</span></span> H01<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> H0 <span class="keyword1"><span class="command">have</span></span> H00<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">∈</span> nat <span class="main">-&gt;</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> H1 <span class="keyword1"><span class="command">have</span></span> H12<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span> <span class="main">∈</span> nat<span class="main">.</span> <span class="free">t</span><span class="main">`</span>succ<span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">&lt;</span><span class="main">(</span><span class="free">t</span><span class="main">`</span><span class="bound">n</span><span class="main">)</span><span class="main">,</span> <span class="bound">n</span><span class="main">&gt;</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> satpc_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> H1 <span class="keyword1"><span class="command">have</span></span> H11<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">t</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> H1 <span class="keyword1"><span class="command">have</span></span> H10<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">t</span> <span class="main">∈</span> nat <span class="main">-&gt;</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span><span class="main">=</span><span class="free">t</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> fun_extension<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H00 H10<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">assume</span></span> K<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> nat›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">f</span> <span class="main">`</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">t</span> <span class="main">`</span> <span class="skolem">x</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> nat_induct<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">x</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> nat›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> K<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">from</span></span> H01 <span class="keyword2"><span class="keyword">and</span></span> H11 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">t</span> <span class="main">`</span> <span class="main">0</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
      <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span>nat›</span></span>
      <span class="keyword3"><span class="command">assume</span></span> B<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f</span><span class="main">`</span><span class="skolem">x</span> <span class="main">=</span> <span class="free">t</span><span class="main">`</span><span class="skolem">x</span>›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">t</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">from</span></span> H02 <span class="keyword2"><span class="keyword">and</span></span> A <span class="keyword1"><span class="command">have</span></span> H02'<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f</span><span class="main">`</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">&lt;</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="skolem">x</span><span class="main">&gt;</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> bspec<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> H12 <span class="keyword2"><span class="keyword">and</span></span> A <span class="keyword1"><span class="command">have</span></span> H12'<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">t</span><span class="main">`</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">&lt;</span><span class="main">(</span><span class="free">t</span><span class="main">`</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="skolem">x</span><span class="main">&gt;</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> bspec<span class="main">)</span>
        <span class="keyword1"><span class="command">from</span></span> B <span class="keyword2"><span class="keyword">and</span></span> H12' <span class="keyword1"><span class="command">have</span></span> H12''<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">t</span><span class="main">`</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">&lt;</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="skolem">x</span><span class="main">&gt;</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> H12'' <span class="keyword2"><span class="keyword">and</span></span> H02' <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">t</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Lemmas for recursion theorem›</span></span>

<span class="keyword1"><span class="command">locale</span></span> recthm <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"i"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">a</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"i"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">g</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"i"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> hyp1 <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">a</span> <span class="main">∈</span> <span class="free">A</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> hyp2 <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">g</span> <span class="main">:</span> <span class="main">(</span><span class="main">(</span><span class="free">A</span><span class="main">*</span>nat<span class="main">)</span><span class="main">→</span><span class="free">A</span><span class="main">)</span>›</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1" id="recursion-l3"><span class="command">lemma</span></span> l3<span class="main">:</span><span class="quoted"><span class="quoted">‹function<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> compatsetunionfun<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> pcs_lem<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> hyp1<span class="main">)</span>

<span class="keyword1" id="recursion-l1"><span class="command">lemma</span></span> l1 <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span> <span class="main">⊆</span> nat <span class="main">×</span> <span class="free">A</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">hence</span></span>  H<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> <span class="main">⋃</span><span class="main">{</span><span class="bound">t</span><span class="main">∈</span>Pow<span class="main">(</span>nat<span class="main">*</span><span class="free">A</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="bound">t</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span><span class="main">}</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> pcs_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> nat <span class="main">×</span> <span class="free">A</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> UnionE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">B</span>
    <span class="keyword3"><span class="command">assume</span></span> J1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span><span class="skolem">B</span>›</span></span>
    <span class="keyword3"><span class="command">assume</span></span> J2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">t</span> <span class="main">∈</span> Pow<span class="main">(</span>nat <span class="main">×</span> <span class="free">A</span><span class="main">)</span> <span class="main">.</span>
            <span class="main">∃</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="bound">t</span><span class="main">,</span> <span class="bound">m</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">}</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> J2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> Pow<span class="main">(</span>nat <span class="main">×</span> <span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> J2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">⊆</span> nat <span class="main">×</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> J1 <span class="keyword2"><span class="keyword">and</span></span> J2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> nat <span class="main">×</span> <span class="free">A</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-le1"><span class="command">lemma</span></span> le1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">x</span><span class="main">∈</span><span class="main">1</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="free">x</span><span class="main">=</span><span class="main">0</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">x</span> <span class="main">⊆</span> <span class="main">0</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">z</span>
    <span class="keyword3"><span class="command">assume</span></span> J<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">z</span><span class="main">∈</span><span class="free">x</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">z</span><span class="main">∈</span><span class="main">0</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> succE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> J<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">x</span><span class="main">∈</span><span class="main">0</span>›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">z</span><span class="main">∈</span><span class="main">0</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> notE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> not_mem_empty J<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> K<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">x</span><span class="main">=</span><span class="main">0</span>›</span></span>
      <span class="keyword1"><span class="command">from</span></span> J <span class="keyword2"><span class="keyword">and</span></span> K <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">z</span><span class="main">∈</span><span class="main">0</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">⊆</span> <span class="free">x</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-lsinglfun"><span class="command">lemma</span></span> lsinglfun <span class="main">:</span> <span class="quoted"><span class="quoted">‹function<span class="main">(</span><span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> function_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹ <span class="main">∀</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span> <span class="bound">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span> <span class="main">⟶</span>
          <span class="main">(</span><span class="main">∀</span><span class="bound">y'</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span> <span class="bound">y'</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span> <span class="main">⟶</span>
                <span class="bound">y</span> <span class="main">=</span> <span class="bound">y'</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span><span class="operator">rule</span> impI<span class="main"><span class="keyword3">,</span></span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span><span class="operator">rule</span> impI<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">y'</span>
    <span class="keyword3"><span class="command">assume</span></span> H0<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span>›</span></span>
    <span class="keyword3"><span class="command">assume</span></span> H1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y'</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="skolem">y'</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> upair.singletonE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H0<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span><span class="operator">rule</span> upair.singletonE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H1<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> H0<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span>›</span></span>
      <span class="keyword3"><span class="command">assume</span></span> H1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y'</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span>›</span></span>
      <span class="keyword1"><span class="command">from</span></span> H0 <span class="keyword2"><span class="keyword">and</span></span> H1 <span class="keyword1"><span class="command">have</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y'</span><span class="main">⟩</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">=</span> <span class="skolem">y'</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-singlsatpc"><span class="command">lemma</span></span> singlsatpc<span class="main">:</span><span class="quoted"><span class="quoted">‹satpc<span class="main">(</span><span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span><span class="main">,</span> <span class="main">0</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> satpc_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span><span class="main">0</span><span class="main">.</span> <span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span> <span class="main">`</span> succ<span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">=</span>
           <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span> <span class="main">`</span> <span class="bound">n</span><span class="main">,</span> <span class="bound">n</span><span class="main">⟩</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-zerostep"><span class="command">lemma</span></span> zerostep <span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span><span class="main">,</span> <span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> partcomp_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span> <span class="main">∈</span> <span class="main">1</span> <span class="main">-&gt;</span> <span class="free">A</span> <span class="main">∧</span> <span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span> <span class="main">∧</span> satpc<span class="main">(</span><span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span><span class="main">,</span> <span class="main">0</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span> <span class="main">∈</span> <span class="main">1</span> <span class="main">-&gt;</span> <span class="free">A</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> Pi_def<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">f</span> <span class="main">∈</span> Pow<span class="main">(</span><span class="main">1</span> <span class="main">×</span> <span class="free">A</span><span class="main">)</span> <span class="main">.</span> <span class="main">1</span> <span class="main">⊆</span> domain<span class="main">(</span><span class="bound">f</span><span class="main">)</span> <span class="main">∧</span> function<span class="main">(</span><span class="bound">f</span><span class="main">)</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">proof</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span> <span class="main">∈</span> Pow<span class="main">(</span><span class="main">1</span> <span class="main">×</span> <span class="free">A</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> PowI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> equalities.singleton_subsetI<span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">1</span> <span class="main">×</span> <span class="free">A</span>›</span></span>
          <span class="keyword1"><span class="command">proof</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">∈</span> <span class="main">1</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">a</span> <span class="main">∈</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> hyp1<span class="main">)</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">⊆</span> domain<span class="main">(</span><span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span><span class="main">)</span> <span class="main">∧</span> function<span class="main">(</span><span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">⊆</span> domain<span class="main">(</span><span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">proof</span></span>
            <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
            <span class="keyword3"><span class="command">assume</span></span> W<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span><span class="main">1</span>›</span></span>
            <span class="keyword1"><span class="command">from</span></span> W <span class="keyword1"><span class="command">have</span></span> W<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">=</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> le1<span class="main">)</span>
            <span class="keyword1"><span class="command">have</span></span> Y<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">0</span><span class="main">∈</span>domain<span class="main">(</span><span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span><span class="main">)</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">from</span></span> W <span class="keyword2"><span class="keyword">and</span></span> Y
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span>domain<span class="main">(</span><span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span><span class="main">)</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹function<span class="main">(</span><span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> lsinglfun<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span> <span class="main">∧</span> satpc<span class="main">(</span><span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span><span class="main">,</span> <span class="main">0</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> func.singleton_apply<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹satpc<span class="main">(</span><span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span><span class="main">,</span> <span class="main">0</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> singlsatpc<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-zainupcs"><span class="command">lemma</span></span> zainupcs <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="comment1">(* {⟨0, a⟩} is a 0-step computation *)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span> <span class="main">∈</span> pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> pcs_def<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">t</span> <span class="main">∈</span> Pow<span class="main">(</span>nat <span class="main">×</span> <span class="free">A</span><span class="main">)</span> <span class="main">.</span> <span class="main">∃</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="bound">t</span><span class="main">,</span> <span class="bound">m</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">}</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span> <span class="main">∈</span> Pow<span class="main">(</span>nat <span class="main">×</span> <span class="free">A</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> PowI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> equalities.singleton_subsetI<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span> <span class="main">∈</span> nat <span class="main">×</span> <span class="free">A</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">∈</span> nat›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">a</span> <span class="main">∈</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> hyp1<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span><span class="main">,</span> <span class="bound">m</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">proof</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span><span class="main">,</span> <span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> zerostep<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">∈</span> nat›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-l2'"><span class="command">lemma</span></span> l2'<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">∈</span> domain<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> zainupcs<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Push an ordered pair to the end of partial computation t
and obtain another partial computation.›</span></span>
<span class="keyword1" id="recursion-shortlem"><span class="command">lemma</span></span> shortlem <span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> mnat<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">m</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> F<span class="main">:</span><span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">t</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span>cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">&lt;</span><span class="free">t</span><span class="main">`</span><span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">&gt;</span><span class="main">⟩</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span><span class="main">,</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> partcompE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> F<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> F1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">t</span> <span class="main">∈</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">→</span> <span class="free">A</span>›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> F2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">t</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span>›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> F3<span class="main">:</span><span class="quoted"><span class="quoted">‹satpc<span class="main">(</span><span class="free">t</span><span class="main">,</span> <span class="free">m</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="comment1">(*‹partcomp(A,cons(⟨succ(m), g ` &lt;t`m, m&gt;⟩, t),succ(m),a,g)› *)</span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword1"><span class="command">have</span></span> ljk<span class="main">:</span><span class="quoted"><span class="quoted">‹cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span> <span class="main">∈</span> <span class="main">(</span>cons<span class="main">(</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main">→</span> <span class="free">A</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> func.fun_extend3<span class="main"><span class="main">[</span></span><span class="operator">OF</span> F1<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">∉</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span>  upair.mem_not_refl<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> tmA<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">t</span> <span class="main">`</span> <span class="free">m</span> <span class="main">∈</span> <span class="free">A</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> func.apply_funtype<span class="main"><span class="main">[</span></span><span class="operator">OF</span> F1<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">A</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> func.apply_funtype<span class="main"><span class="main">[</span></span><span class="operator">OF</span> hyp2<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> tmA<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> mnat<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span> <span class="main">∈</span> <span class="main">(</span>cons<span class="main">(</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main">→</span> <span class="free">A</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ljk<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹cons<span class="main">(</span><span class="main">⟨</span>cons<span class="main">(</span><span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span> <span class="main">∈</span> cons<span class="main">(</span>cons<span class="main">(</span><span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">)</span><span class="main">,</span> cons<span class="main">(</span><span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main">→</span> <span class="free">A</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> succ_def<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main">→</span> <span class="free">A</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> succ_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">assumption</span><span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> trans<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> func.fun_extend_apply<span class="main"><span class="main">[</span></span><span class="operator">OF</span> F1<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">∉</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span>  upair.mem_not_refl<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="keyword1">if</span> <span class="main">0</span> <span class="main">=</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="keyword1">then</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span> <span class="keyword1">else</span> <span class="free">t</span> <span class="main">`</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> trans<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> upair.if_not_P<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> F2<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹satpc<span class="main">(</span>cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span><span class="main">,</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> satpc_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ballI<span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span>
      <span class="keyword3"><span class="command">assume</span></span> Q<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">∈</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span>›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span>
<span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span>cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span> <span class="main">`</span> <span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">⟩</span>›</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> trans<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> func.fun_extend_apply<span class="main"><span class="main">[</span></span><span class="operator">OF</span> F1<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> upair.mem_not_refl<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="keyword1">if</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="keyword1">then</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span> <span class="keyword1">else</span> <span class="free">t</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>
    <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span>cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span> <span class="main">`</span> <span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">⟩</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> upair.succE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> Q<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">assume</span></span> Y<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">=</span><span class="free">m</span>›</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="keyword1">if</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="keyword1">then</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span> <span class="keyword1">else</span> <span class="free">t</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>
    <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span>cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span> <span class="main">`</span> <span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">⟩</span>›</span></span>
          <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> trans<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> upair.if_P<span class="main">)</span>
            <span class="keyword1"><span class="command">from</span></span> Y <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">t</span> <span class="main">`</span> <span class="free">m</span> <span class="main">=</span> cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span> <span class="main">`</span> <span class="skolem">n</span>›</span></span>
            <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> sym<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> trans<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> func.fun_extend_apply<span class="main"><span class="main">[</span></span><span class="operator">OF</span> F1<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> upair.mem_not_refl<span class="main">)</span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹ <span class="main">(</span><span class="keyword1">if</span> <span class="skolem">n</span> <span class="main">=</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="keyword1">then</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span> <span class="keyword1">else</span> <span class="free">t</span> <span class="main">`</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">t</span> <span class="main">`</span> <span class="free">m</span>›</span></span>
              <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> trans<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> upair.if_not_P<span class="main">)</span>
                <span class="keyword1"><span class="command">from</span></span> Y <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">t</span> <span class="main">`</span> <span class="skolem">n</span> <span class="main">=</span> <span class="free">t</span> <span class="main">`</span> <span class="free">m</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">≠</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span>›</span></span>
                <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> not_sym<span class="main">)</span>
                  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">≠</span> <span class="skolem">n</span>›</span></span>
                    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> subst<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> sym<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> Y<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> upair.succ_neq_self<span class="main">)</span>
                <span class="keyword1"><span class="command">qed</span></span>
              <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">from</span></span> Y
            <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">=</span> <span class="skolem">n</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">have</span></span> L<span class="main">:</span><span class="quoted"><span class="quoted">‹ <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">⟨</span>cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span> <span class="main">`</span> <span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">⟩</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> subst_context2<span class="main"><span class="main">[</span></span><span class="operator">OF</span> L1 L2<span class="main"><span class="main">]</span></span><span class="main">)</span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹ <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span>cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span> <span class="main">`</span> <span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">⟩</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> subst_context<span class="main"><span class="main">[</span></span><span class="operator">OF</span> L<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">assume</span></span> Y<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">∈</span> <span class="free">m</span>›</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="keyword1">if</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="keyword1">then</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span> <span class="keyword1">else</span> <span class="free">t</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>
                <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span>cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span> <span class="main">`</span> <span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">⟩</span>›</span></span>
          <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> trans<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> upair.if_not_P<span class="main">)</span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">≠</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> contrapos<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> upair.mem_imp_not_eq<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> Y<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> upair.succ_inject<span class="main"><span class="keyword3">,</span></span> <span class="operator">assumption</span><span class="main">)</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword1"><span class="command">have</span></span> X<span class="main">:</span><span class="quoted"><span class="quoted">‹cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span> <span class="main">`</span> <span class="skolem">n</span> <span class="main">=</span> <span class="free">t</span> <span class="main">`</span> <span class="skolem">n</span>›</span></span>
            <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> trans<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> func.fun_extend_apply<span class="main"><span class="main">[</span></span><span class="operator">OF</span> F1<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> upair.mem_not_refl<span class="main">)</span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="keyword1">if</span> <span class="skolem">n</span> <span class="main">=</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="keyword1">then</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span> <span class="keyword1">else</span> <span class="free">t</span> <span class="main">`</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">t</span> <span class="main">`</span> <span class="skolem">n</span>›</span></span>
              <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> upair.if_not_P<span class="main">)</span>
                <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">≠</span> succ<span class="main">(</span><span class="free">m</span><span class="main">)</span>›</span></span>
                <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> contrapos<span class="main">)</span>
                  <span class="keyword3"><span class="command">assume</span></span> q<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">=</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
                  <span class="keyword1"><span class="command">from</span></span> q <span class="keyword2"><span class="keyword">and</span></span> Y <span class="keyword1"><span class="command">have</span></span> M<span class="main">:</span><span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">∈</span><span class="free">m</span>›</span></span>
                    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">m</span><span class="main">∈</span><span class="free">m</span>›</span></span>
                    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> Nat.succ_in_naturalD<span class="main"><span class="main">[</span></span><span class="operator">OF</span> M mnat<span class="main"><span class="main">]</span></span><span class="main">)</span>
                <span class="keyword1"><span class="command">next</span></span>
                  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">m</span> <span class="main">∉</span> <span class="free">m</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span>  upair.mem_not_refl<span class="main">)</span>
                <span class="keyword1"><span class="command">qed</span></span>
              <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">from</span></span> F3
            <span class="keyword1"><span class="command">have</span></span> W<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span><span class="free">m</span><span class="main">.</span> <span class="free">t</span> <span class="main">`</span> succ<span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="bound">n</span><span class="main">,</span> <span class="bound">n</span><span class="main">⟩</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> satpc_def<span class="main">)</span>
            <span class="keyword1"><span class="command">have</span></span> U<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">t</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">⟩</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> bspec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> W Y<span class="main"><span class="main">]</span></span><span class="main">)</span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">t</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span>cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="free">t</span> <span class="main">`</span> <span class="free">m</span><span class="main">,</span> <span class="free">m</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="free">t</span><span class="main">)</span> <span class="main">`</span> <span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">⟩</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> trans<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> U<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> sym<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> subst_context<span class="main"><span class="main">[</span></span><span class="operator">OF</span> X<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-l2"><span class="command">lemma</span></span> l2<span class="main">:</span><span class="quoted"><span class="quoted">‹nat <span class="main">⊆</span> domain<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
  <span class="keyword3"><span class="command">assume</span></span> G<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> domain<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> nat_induct<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">x</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span>nat›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> G<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">assume</span></span> Q1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span>nat›</span></span>
    <span class="keyword3"><span class="command">assume</span></span> Q2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span>domain<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">∈</span>domain<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> domainE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> Q2<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span>
      <span class="keyword3"><span class="command">assume</span></span> W1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">∈</span>domain<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> UnionE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> W1<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">t</span>
        <span class="keyword3"><span class="command">assume</span></span> E1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="skolem">t</span>›</span></span>
        <span class="keyword3"><span class="command">assume</span></span> E2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">∈</span> pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">hence</span></span> E2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">t</span><span class="main">∈</span><span class="main">{</span><span class="bound">t</span><span class="main">∈</span>Pow<span class="main">(</span>nat<span class="main">*</span><span class="free">A</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">m</span> <span class="main">∈</span> nat<span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="bound">t</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span><span class="main">}</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">unfold</span> pcs_def<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> E21<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">t</span><span class="main">∈</span>Pow<span class="main">(</span>nat<span class="main">*</span><span class="free">A</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CollectD1<span class="main"><span class="main">[</span></span><span class="operator">OF</span> E2<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> E22m<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="skolem">t</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> CollectD2<span class="main"><span class="main">[</span></span><span class="operator">OF</span> E2<span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">∈</span>domain<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> bexE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> E22m<span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span>
          <span class="keyword3"><span class="command">assume</span></span> mnat<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">∈</span>nat›</span></span>
          <span class="keyword3"><span class="command">assume</span></span> E22P<span class="main">:</span><span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="skolem">t</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">hence</span></span> E22<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">(</span><span class="skolem">t</span><span class="main">:</span>succ<span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main">→</span><span class="free">A</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="skolem">t</span><span class="main">`</span><span class="main">0</span><span class="main">=</span><span class="free">a</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> satpc<span class="main">(</span><span class="skolem">t</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">unfold</span> partcomp_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
          <span class="keyword1"><span class="command">hence</span></span> E223<span class="main">:</span><span class="quoted"><span class="quoted">‹satpc<span class="main">(</span><span class="skolem">t</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> E223<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span> <span class="main">∈</span> <span class="skolem">m</span> <span class="main">.</span> <span class="skolem">t</span><span class="main">`</span>succ<span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">&lt;</span><span class="skolem">t</span><span class="main">`</span><span class="bound">n</span><span class="main">,</span> <span class="bound">n</span><span class="main">&gt;</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">unfold</span> satpc_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
          <span class="keyword1"><span class="command">from</span></span> E22 <span class="keyword1"><span class="command">have</span></span> E221<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">t</span><span class="main">:</span>succ<span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main">→</span><span class="free">A</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> E221 <span class="keyword1"><span class="command">have</span></span> domt<span class="main">:</span><span class="quoted"><span class="quoted">‹domain<span class="main">(</span><span class="skolem">t</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">m</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> func.domain_of_fun<span class="main">)</span>
          <span class="keyword1"><span class="command">from</span></span> E1 <span class="keyword1"><span class="command">have</span></span> xind<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> domain<span class="main">(</span><span class="skolem">t</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> equalities.domainI<span class="main">)</span>
          <span class="keyword1"><span class="command">from</span></span> xind <span class="keyword2"><span class="keyword">and</span></span> domt <span class="keyword1"><span class="command">have</span></span> xinsm<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">m</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">∈</span>domain<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">proof</span></span>
        <span class="comment1">(*proof(rule exE[OF E22])*)</span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹ <span class="main">⟨</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">&lt;</span><span class="skolem">t</span><span class="main">`</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">&gt;</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="comment1">(*?*)</span>
            <span class="keyword1"><span class="command">proof</span></span>
             <span class="comment1">(*t∪{⟨succ(x), g ` &lt;t`x, x&gt;⟩}*)</span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">&lt;</span><span class="skolem">t</span><span class="main">`</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">&gt;</span><span class="main">⟩</span><span class="main">,</span> <span class="skolem">t</span><span class="main">)</span> <span class="main">∈</span> pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
              <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> pcs_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> CollectI<span class="main">)</span>
                <span class="keyword1"><span class="command">from</span></span> E21
                <span class="keyword1"><span class="command">have</span></span> L1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">⊆</span> nat <span class="main">×</span> <span class="free">A</span>›</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">from</span></span> Q1 <span class="keyword1"><span class="command">have</span></span> J1<span class="main">:</span><span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">∈</span>nat›</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span><span class="comment1">(*Nat.nat_succI*)</span>
                <span class="keyword1"><span class="command">have</span></span> txA<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">`</span> <span class="skolem">x</span> <span class="main">∈</span> <span class="free">A</span>›</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> func.apply_type<span class="main"><span class="main">[</span></span><span class="operator">OF</span> E221 xinsm<span class="main"><span class="main">]</span></span><span class="main">)</span>
                <span class="keyword1"><span class="command">from</span></span> txA <span class="keyword2"><span class="keyword">and</span></span> Q1 <span class="keyword1"><span class="command">have</span></span> txx<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">t</span> <span class="main">`</span> <span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">×</span> nat›</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword1"><span class="command">have</span></span> secp<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">t</span> <span class="main">`</span> <span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">A</span>›</span></span>
                  <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> func.apply_type<span class="main"><span class="main">[</span></span><span class="operator">OF</span> hyp2 txx<span class="main"><span class="main">]</span></span><span class="main">)</span>
                <span class="keyword1"><span class="command">from</span></span> J1 <span class="keyword2"><span class="keyword">and</span></span> secp
                <span class="keyword1"><span class="command">have</span></span> L2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⟨</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span><span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">t</span> <span class="main">`</span> <span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">⟩</span><span class="main">⟩</span> <span class="main">∈</span> nat <span class="main">×</span> <span class="free">A</span>›</span></span>
                  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹ cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span><span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">t</span> <span class="main">`</span> <span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span><span class="skolem">t</span><span class="main">)</span> <span class="main">∈</span> Pow<span class="main">(</span>nat <span class="main">×</span> <span class="free">A</span><span class="main">)</span>›</span></span>
                <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> PowI<span class="main">)</span>
                  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹ cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">t</span> <span class="main">`</span> <span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="skolem">t</span><span class="main">)</span> <span class="main">⊆</span> nat <span class="main">×</span> <span class="free">A</span>›</span></span>
                  <span class="keyword1"><span class="command">proof</span></span>
                    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">t</span> <span class="main">`</span> <span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">⟩</span><span class="main">⟩</span> <span class="main">∈</span> nat <span class="main">×</span> <span class="free">A</span> <span class="main">∧</span> <span class="skolem">t</span> <span class="main">⊆</span> nat <span class="main">×</span> <span class="free">A</span>›</span></span>
                      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> conjI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> L2 L1<span class="main"><span class="main">]</span></span><span class="main">)</span>
                  <span class="keyword1"><span class="command">qed</span></span>
                <span class="keyword1"><span class="command">qed</span></span>
              <span class="keyword1"><span class="command">next</span></span>
                <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">m</span> <span class="main">∈</span> nat<span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">t</span> <span class="main">`</span> <span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="skolem">t</span><span class="main">)</span><span class="main">,</span> <span class="bound">m</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
                <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> succE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> xinsm<span class="main"><span class="main">]</span></span><span class="main">)</span>
                  <span class="keyword3"><span class="command">assume</span></span> xeqm<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">=</span><span class="skolem">m</span>›</span></span>
                  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">m</span> <span class="main">∈</span> nat<span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">t</span> <span class="main">`</span> <span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="skolem">t</span><span class="main">)</span><span class="main">,</span> <span class="bound">m</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
                  <span class="keyword1"><span class="command">proof</span></span>
                    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">t</span> <span class="main">`</span> <span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="skolem">t</span><span class="main">)</span><span class="main">,</span> succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
                    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> shortlem<span class="main"><span class="main">[</span></span><span class="operator">OF</span> Q1<span class="main"><span class="main">]</span></span><span class="main">)</span>
                      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="skolem">t</span><span class="main">,</span> <span class="skolem">x</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
                      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> subst<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">m</span></span></span></span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">x</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> sym<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> xeqm<span class="main">)</span>
                        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="skolem">t</span><span class="main">,</span> <span class="skolem">m</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
                          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> E22P<span class="main">)</span>
                      <span class="keyword1"><span class="command">qed</span></span>
                    <span class="keyword1"><span class="command">qed</span></span>
                  <span class="keyword1"><span class="command">next</span></span>
                    <span class="keyword1"><span class="command">from</span></span> Q1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> nat›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
                  <span class="keyword1"><span class="command">qed</span></span>
                <span class="keyword1"><span class="command">next</span></span>
                  <span class="keyword3"><span class="command">assume</span></span> xinm<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span><span class="skolem">m</span>›</span></span>
                  <span class="keyword1"><span class="command">have</span></span> lmm<span class="main">:</span><span class="quoted"><span class="quoted">‹cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">t</span> <span class="main">`</span> <span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="skolem">t</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">t</span>›</span></span>
                    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> addmiddle<span class="main"><span class="main">[</span></span><span class="operator">OF</span> mnat E22P xinm<span class="main"><span class="main">]</span></span><span class="main">)</span>
                  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">t</span> <span class="main">`</span> <span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="skolem">t</span><span class="main">)</span><span class="main">,</span> <span class="bound">m</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
                    <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> subst<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem">t</span></span></span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> sym<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> lmm<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> E22m<span class="main">)</span>
                <span class="keyword1"><span class="command">qed</span></span>
              <span class="keyword1"><span class="command">qed</span></span>
            <span class="keyword1"><span class="command">next</span></span>
              <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">t</span> <span class="main">`</span> <span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">⟩</span><span class="main">⟩</span> <span class="main">∈</span> cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">t</span> <span class="main">`</span> <span class="skolem">x</span><span class="main">,</span> <span class="skolem">x</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">,</span> <span class="skolem">t</span><span class="main">)</span>›</span></span>
                <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
            <span class="keyword1"><span class="command">qed</span></span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">∈</span> domain<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> l2'<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-useful"><span class="command">lemma</span></span> useful <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span> <span class="main">∃</span><span class="bound">t</span><span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="bound">t</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> nat_induct_bound<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">t</span><span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="bound">t</span><span class="main">,</span> <span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="main">{</span><span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span><span class="main">}</span><span class="main">,</span> <span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> zerostep<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span>
  <span class="keyword3"><span class="command">assume</span></span> mnat<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">m</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> G<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">t</span><span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="bound">t</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">t</span><span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="bound">t</span><span class="main">,</span>succ<span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> exE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> G<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">t</span>
    <span class="keyword3"><span class="command">assume</span></span> G<span class="main">:</span><span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="skolem">t</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">t</span><span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="bound">t</span><span class="main">,</span>succ<span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span>cons<span class="main">(</span><span class="main">⟨</span>succ<span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span> <span class="main">`</span> <span class="main">&lt;</span><span class="skolem">t</span><span class="main">`</span><span class="skolem">m</span><span class="main">,</span> <span class="skolem">m</span><span class="main">&gt;</span><span class="main">⟩</span><span class="main">,</span> <span class="skolem">t</span><span class="main">)</span><span class="main">,</span>succ<span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> shortlem<span class="main"><span class="main">[</span></span><span class="operator">OF</span> mnat G<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-l4"><span class="command">lemma</span></span> l4 <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> nat <span class="main">-&gt;</span> <span class="free">A</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> Pi_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹ <span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">f</span> <span class="main">∈</span> Pow<span class="main">(</span>nat <span class="main">×</span> <span class="free">A</span><span class="main">)</span> <span class="main">.</span> nat <span class="main">⊆</span> domain<span class="main">(</span><span class="bound">f</span><span class="main">)</span> <span class="main">∧</span> function<span class="main">(</span><span class="bound">f</span><span class="main">)</span><span class="main">}</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span> <span class="main">∈</span> Pow<span class="main">(</span>nat <span class="main">×</span> <span class="free">A</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span> <span class="main">⊆</span> nat <span class="main">×</span> <span class="free">A</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> l1<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹nat <span class="main">⊆</span> domain<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> function<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹nat <span class="main">⊆</span> domain<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> l2<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹function<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> l3<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-l5"><span class="command">lemma</span></span> l5<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> func.function_apply_equality<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹function<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> l3<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="main">0</span><span class="main">,</span> <span class="free">a</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> zainupcs<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-ballE2"><span class="command">lemma</span></span> ballE2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">AA</span><span class="main">.</span> <span class="free">P</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">x</span><span class="main">∈</span><span class="free">AA</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">P</span><span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">==&gt;</span> <span class="free">Q</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="free">Q</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> bspec<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹ Recall that
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>satpc(t,α,g) == ∀n ∈ α . t`succ(n) = g ` &lt;t`n, n&gt;›</span></span></span></span>
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>partcomp(A,t,m,a,g) == (t:succ(m)→A) ∧ (t`0=a) ∧ satpc(t,m,g)›</span></span></span></span>
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>pcs(A,a,g) == {t∈Pow(nat*A). ∃m. partcomp(A,t,m,a,g)}›</span></span></span></span>
›</span></span>

<span class="keyword1" id="recursion-l6new"><span class="command">lemma</span></span> l6new<span class="main">:</span> <span class="quoted"><span class="quoted">‹satpc<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">,</span> nat<span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> satpc_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> ballI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span>
  <span class="keyword3"><span class="command">assume</span></span> nnat<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword1"><span class="command">hence</span></span> snnat<span class="main">:</span><span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main">∈</span>nat›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="comment1">(* l2:‹nat ⊆ domain(⋃pcs(A, a, g))› *)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">⟩</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> ballE2<span class="main"><span class="main">[</span></span><span class="operator">OF</span> useful snnat<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">erule</span> exE<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">t</span>
    <span class="keyword3"><span class="command">assume</span></span> Y<span class="main">:</span><span class="quoted"><span class="quoted">‹partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="skolem">t</span><span class="main">,</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">⟩</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> partcompE<span class="main"><span class="main">[</span></span><span class="operator">OF</span> Y<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> Y1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">∈</span> succ<span class="main">(</span>succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">→</span> <span class="free">A</span>›</span></span>
      <span class="keyword3"><span class="command">assume</span></span> Y2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span>›</span></span>
      <span class="keyword3"><span class="command">assume</span></span> Y3<span class="main">:</span><span class="quoted"><span class="quoted">‹satpc<span class="main">(</span><span class="skolem">t</span><span class="main">,</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">hence</span></span> Y3<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">x</span> <span class="main">∈</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">.</span> <span class="skolem">t</span><span class="main">`</span>succ<span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">&lt;</span><span class="skolem">t</span><span class="main">`</span><span class="bound">x</span><span class="main">,</span> <span class="bound">x</span><span class="main">&gt;</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> satpc_def<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> Y3<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">t</span><span class="main">`</span>succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">&lt;</span><span class="skolem">t</span><span class="main">`</span><span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">&gt;</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> bspec<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> e1<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">t</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> valofunion<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> pcs_lem<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> hyp1<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">∈</span> pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> pcs_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> CollectI<span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">∈</span> Pow<span class="main">(</span>nat <span class="main">×</span> <span class="free">A</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> tgb<span class="main">)</span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">∈</span> succ<span class="main">(</span>succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">→</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Y1<span class="main">)</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword1"><span class="command">from</span></span> snnat
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span>succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> nat›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="skolem">t</span><span class="main">,</span> <span class="bound">m</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> bexI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> Y<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> snnat<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">∈</span> succ<span class="main">(</span>succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">→</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Y1<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">∈</span> succ<span class="main">(</span>succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">t</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> refl<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">have</span></span> e2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="skolem">n</span> <span class="main">=</span> <span class="skolem">t</span> <span class="main">`</span> <span class="skolem">n</span>›</span></span>
      <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> valofunion<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> pcs_lem<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> hyp1<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">∈</span> pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> pcs_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> CollectI<span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">∈</span> Pow<span class="main">(</span>nat <span class="main">×</span> <span class="free">A</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> tgb<span class="main">)</span>
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">∈</span> succ<span class="main">(</span>succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">→</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Y1<span class="main">)</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword1"><span class="command">from</span></span> snnat
            <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span>succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> nat›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">m</span><span class="main">∈</span>nat<span class="main">.</span> partcomp<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="skolem">t</span><span class="main">,</span> <span class="bound">m</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> bexI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> Y<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> snnat<span class="main">)</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">∈</span> succ<span class="main">(</span>succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">→</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Y1<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">∈</span> succ<span class="main">(</span>succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">`</span> <span class="skolem">n</span> <span class="main">=</span> <span class="skolem">t</span> <span class="main">`</span> <span class="skolem">n</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> refl<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">have</span></span> e3<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">⟩</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">t</span> <span class="main">`</span> <span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">⟩</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> subst<span class="main"><span class="main">[</span></span><span class="operator">OF</span> e2<span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> refl<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span> <span class="main">`</span> <span class="main">⟨</span><span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">⟩</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> trans<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> e1<span class="main"><span class="keyword3">,</span></span><span class="operator">rule</span> trans<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> Y3<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> sym<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> e3<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Recursion theorem"</span></span>

<span class="keyword1"><span class="command">theorem</span></span> recursionthm<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃!</span><span class="bound">f</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">f</span> <span class="main">∈</span> <span class="main">(</span>nat<span class="main">→</span><span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">(</span><span class="bound">f</span><span class="main">`</span><span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span><span class="main">)</span> <span class="main">∧</span> satpc<span class="main">(</span><span class="bound">f</span><span class="main">,</span>nat<span class="main">,</span><span class="free">g</span><span class="main">)</span><span class="main">)</span>›</span></span>
<span class="comment1">(* where ‹satpc(t,α,g) == ∀n ∈ α . t`succ(n) = g ` &lt;t`n, n&gt;› *)</span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">f</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> nat <span class="main">-&gt;</span> <span class="free">A</span> <span class="main">∧</span> <span class="bound">f</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span> <span class="main">∧</span> satpc<span class="main">(</span><span class="bound">f</span><span class="main">,</span> nat<span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> nat <span class="main">-&gt;</span> <span class="free">A</span> <span class="main">∧</span> <span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span> <span class="main">∧</span> satpc<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">g</span><span class="main">)</span><span class="main">,</span> nat<span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span> <span class="main">∈</span> nat <span class="main">-&gt;</span> <span class="free">A</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> l4<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span> <span class="main">∧</span> satpc<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">,</span> nat<span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">proof</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> l5<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹satpc<span class="main">(</span><span class="main">⋃</span>pcs<span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">a</span><span class="main">,</span> <span class="free">g</span><span class="main">)</span><span class="main">,</span> nat<span class="main">,</span> <span class="free">g</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> l6new<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">f</span> <span class="bound">y</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> nat <span class="main">-&gt;</span> <span class="free">A</span> <span class="main">∧</span>
           <span class="bound">f</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span> <span class="main">∧</span>
           satpc<span class="main">(</span><span class="bound">f</span><span class="main">,</span> nat<span class="main">,</span> <span class="free">g</span><span class="main">)</span> <span class="main">⟹</span>
           <span class="bound">y</span> <span class="main">∈</span> nat <span class="main">-&gt;</span> <span class="free">A</span> <span class="main">∧</span>
           <span class="bound">y</span> <span class="main">`</span> <span class="main">0</span> <span class="main">=</span> <span class="free">a</span> <span class="main">∧</span>
           satpc<span class="main">(</span><span class="bound">y</span><span class="main">,</span> nat<span class="main">,</span> <span class="free">g</span><span class="main">)</span> <span class="main">⟹</span>
           <span class="bound">f</span> <span class="main">=</span> <span class="bound">y</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> recuniq<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Lemmas for addition"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
Let's define function t(x) = (a+x).
Firstly we need to define a function <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>g:nat × nat → nat›</span></span></span></span>, such that
<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>g`⟨t`n, n⟩ = t`succ(n) = a + (n + 1) = (a + n) + 1 = (t`n) + 1›</span></span></span></span>
So <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>g`⟨a, b⟩ = a + 1›</span></span></span></span> and <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>g(p) = succ(pr1(p))›</span></span></span></span>
and <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>satpc(t,α,g) ⟺ ∀n ∈ α . t`succ(n) = succ(t`n)›</span></span></span></span>.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">addg</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹i›</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> addg_def <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">addg</span> <span class="main">==</span> <span class="main">λ</span><span class="bound">x</span><span class="main">∈</span><span class="main">(</span>nat<span class="main">*</span>nat<span class="main">)</span><span class="main">.</span> succ<span class="main">(</span>fst<span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span>›</span></span>

<span class="keyword1" id="recursion-addgfun"><span class="command">lemma</span></span> addgfun<span class="main">:</span> <span class="quoted"><span class="quoted">‹function<span class="main">(</span>addg<span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> addg_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> func.function_lam<span class="main">)</span>

<span class="keyword1" id="recursion-addgsubpow"><span class="command">lemma</span></span> addgsubpow <span class="main">:</span> <span class="quoted"><span class="quoted">‹addg <span class="main">∈</span> Pow<span class="main">(</span><span class="main">(</span>nat <span class="main">×</span> nat<span class="main">)</span> <span class="main">×</span> nat<span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">unfold</span> addg_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> subsetD<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span>nat <span class="main">×</span> nat<span class="main">.</span> succ<span class="main">(</span>fst<span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> nat <span class="main">×</span> nat <span class="main">→</span> nat›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> func.lam_type<span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span>nat <span class="main">×</span> nat›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹fst<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">∈</span>nat›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹succ<span class="main">(</span>fst<span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> nat›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹nat <span class="main">×</span> nat <span class="main">→</span> nat <span class="main">⊆</span> Pow<span class="main">(</span><span class="main">(</span>nat <span class="main">×</span> nat<span class="main">)</span> <span class="main">×</span> nat<span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> pisubsig<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-addgdom"><span class="command">lemma</span></span> addgdom <span class="main">:</span> <span class="quoted"><span class="quoted">‹nat <span class="main">×</span> nat <span class="main">⊆</span> domain<span class="main">(</span>addg<span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> addg_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> e<span class="main">:</span><span class="quoted"><span class="quoted">‹domain<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span>nat <span class="main">×</span> nat<span class="main">.</span> succ<span class="main">(</span>fst<span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> nat <span class="main">×</span> nat›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> domain_lam<span class="main">)</span>  <span class="comment1">(* "domain(Lambda(A,b)) = A" *)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹nat <span class="main">×</span> nat <span class="main">⊆</span>
    domain<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span>nat <span class="main">×</span> nat<span class="main">.</span> succ<span class="main">(</span>fst<span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> subst<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> sym<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> e<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="recursion-plussucc"><span class="command">lemma</span></span> plussucc<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> F<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">∈</span> <span class="main">(</span>nat<span class="main">→</span>nat<span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">‹satpc<span class="main">(</span><span class="free">f</span><span class="main">,</span>nat<span class="main">,</span>addg<span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span> <span class="main">∈</span> nat <span class="main">.</span> <span class="free">f</span><span class="main">`</span>succ<span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="bound">n</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span>
  <span class="keyword3"><span class="command">assume</span></span> J<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword1"><span class="command">from</span></span> H
  <span class="keyword1"><span class="command">have</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">n</span> <span class="main">∈</span> nat <span class="main">.</span> <span class="free">f</span><span class="main">`</span>succ<span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span><span class="main">(</span>nat<span class="main">*</span>nat<span class="main">)</span><span class="main">.</span> succ<span class="main">(</span>fst<span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">`</span> <span class="main">&lt;</span><span class="free">f</span><span class="main">`</span><span class="bound">n</span><span class="main">,</span> <span class="bound">n</span><span class="main">&gt;</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> satpc_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> addg_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f</span><span class="main">`</span>succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span><span class="main">(</span>nat<span class="main">*</span>nat<span class="main">)</span><span class="main">.</span> succ<span class="main">(</span>fst<span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">`</span> <span class="main">&lt;</span><span class="free">f</span><span class="main">`</span><span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">&gt;</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> bspec<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H J<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> Q<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">∈</span><span class="main">(</span>nat<span class="main">*</span>nat<span class="main">)</span><span class="main">.</span> succ<span class="main">(</span>fst<span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">`</span> <span class="main">&lt;</span><span class="free">f</span><span class="main">`</span><span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">&gt;</span> <span class="main">=</span> succ<span class="main">(</span>fst<span class="main">(</span><span class="main">&lt;</span><span class="free">f</span><span class="main">`</span><span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">&gt;</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> func.beta<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="free">f</span> <span class="main">`</span> <span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">⟩</span> <span class="main">∈</span> nat <span class="main">×</span> nat›</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">`</span> <span class="skolem">n</span> <span class="main">∈</span> nat›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> func.apply_funtype<span class="main"><span class="main">[</span></span><span class="operator">OF</span> F J<span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">∈</span> nat›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> J<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> HQ<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">f</span><span class="main">`</span>succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span>fst<span class="main">(</span><span class="main">&lt;</span><span class="free">f</span><span class="main">`</span><span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">&gt;</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> trans<span class="main"><span class="main">[</span></span><span class="operator">OF</span> H Q<span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> K<span class="main">:</span><span class="quoted"><span class="quoted">‹fst<span class="main">(</span><span class="main">&lt;</span><span class="free">f</span><span class="main">`</span><span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">&gt;</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="skolem">n</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> K<span class="main">:</span><span class="quoted"><span class="quoted">‹succ<span class="main">(</span>fst<span class="main">(</span><span class="main">&lt;</span><span class="free">f</span><span class="main">`</span><span class="skolem">n</span><span class="main">,</span> <span class="skolem">n</span><span class="main">&gt;</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="skolem">n</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> subst_context<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span><span class="main">`</span>succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main">=</span> succ<span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="skolem">n</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> trans<span class="main"><span class="main">[</span></span><span class="operator">OF</span> HQ K<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">"Definition of addition"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Theorem that addition of natural numbers exists
and unique in some sense. Due to theorem 'plussucc' the term
 <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>satpc(f,nat,addg)›</span></span></span></span>
  can be replaced here with
 <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>∀n ∈ nat . f`succ(n) = succ(f`n)›</span></span></span></span>.›</span></span>
<span class="keyword1"><span class="command">theorem</span></span> addition<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">a</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>
 <span class="quoted"><span class="quoted">‹<span class="main">∃!</span><span class="bound">f</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">f</span> <span class="main">∈</span> <span class="main">(</span>nat<span class="main">→</span>nat<span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">(</span><span class="bound">f</span><span class="main">`</span><span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span><span class="main">)</span> <span class="main">∧</span> satpc<span class="main">(</span><span class="bound">f</span><span class="main">,</span>nat<span class="main">,</span>addg<span class="main">)</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> recthm.recursionthm<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> recthm_def<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">a</span> <span class="main">∈</span> nat <span class="main">∧</span> addg <span class="main">∈</span> nat <span class="main">×</span> nat <span class="main">→</span> nat›</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">a</span><span class="main">∈</span>nat›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹addg <span class="main">∈</span> nat <span class="main">×</span> nat <span class="main">→</span> nat›</span></span>
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold</span> Pi_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> CollectI<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹addg <span class="main">∈</span> Pow<span class="main">(</span><span class="main">(</span>nat <span class="main">×</span> nat<span class="main">)</span> <span class="main">×</span> nat<span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> addgsubpow<span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword1"><span class="command">have</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">‹nat <span class="main">×</span> nat <span class="main">⊆</span> domain<span class="main">(</span>addg<span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> addgdom<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">‹function<span class="main">(</span>addg<span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> addgfun<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹nat <span class="main">×</span> nat <span class="main">⊆</span> domain<span class="main">(</span>addg<span class="main">)</span> <span class="main">∧</span> function<span class="main">(</span>addg<span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span><span class="main">(</span><span class="operator">rule</span> conjI<span class="main"><span class="main">[</span></span><span class="operator">OF</span> A2 A3<span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div>
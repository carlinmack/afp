<div id="Bondy">
<div class="head">
<h1>Theory Bondy</h1>
</div>
<pre class="source"><span class="keyword1"><span class="command">theory</span></span> Bondy
<span class="keyword2"><span class="keyword">imports</span></span> <a href="https://www.cl.cam.ac.uk/research/hvg/Isabelle/dist/library/HOL/HOL/Main.html">Main</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1" id="Bondy-card_less_if_surj_not_inj"><span class="command">lemma</span></span> card_less_if_surj_not_inj<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> finite <span class="free">A</span><span class="main">;</span> <span class="free">f</span> <span class="main">`</span> <span class="free">A</span> <span class="main">=</span> <span class="free">B</span><span class="main">;</span> <span class="main">¬</span> inj_on <span class="free">f</span> <span class="free">A</span> <span class="main">⟧</span> <span class="main">⟹</span> card <span class="free">B</span> <span class="main">&lt;</span> card <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> card_image_le inj_on_iff_eq_card order_le_neq_trans<span class="main">)</span>

<span class="keyword1"><span class="command">theorem</span></span> Bondy <span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> <span class="free">F</span><span class="main">.</span> <span class="bound">A</span> <span class="main">⊆</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"card <span class="free">X</span> <span class="main">≥</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"card <span class="free">F</span> <span class="main">=</span> card <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">D</span><span class="main">.</span> <span class="bound">D</span> <span class="main">⊆</span> <span class="free">X</span> <span class="main">&amp;</span> card <span class="bound">D</span> <span class="main">&lt;</span> card <span class="free">X</span> <span class="main">&amp;</span> card <span class="main">(</span>inter <span class="bound">D</span> <span class="main">`</span> <span class="free">F</span><span class="main">)</span> <span class="main">=</span> card <span class="free">F</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="free">F</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"finite <span class="free">X</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> card.infinite not_one_le_zero<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">&lt;</span> card <span class="free">F</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">D</span><span class="main">.</span> <span class="bound">D</span> <span class="main">⊆</span> <span class="free">X</span> <span class="main">&amp;</span> card <span class="bound">D</span> <span class="main">≤</span> <span class="skolem">m</span> <span class="main">&amp;</span> card <span class="main">(</span>inter <span class="bound">D</span> <span class="main">`</span> <span class="free">F</span><span class="main">)</span> <span class="main">≥</span> <span class="skolem">m</span> <span class="main">+</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="skolem">m</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> 0
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main">⊆</span> <span class="free">X</span> <span class="main">&amp;</span> card <span class="main">{}</span> <span class="main">≤</span> <span class="main">0</span> <span class="main">&amp;</span> card <span class="main">(</span>inter <span class="main">{}</span> <span class="main">`</span> <span class="free">F</span><span class="main">)</span> <span class="main">≥</span> <span class="main">0</span> <span class="main">+</span> <span class="main">1</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> Suc_leI card_eq_0_iff empty_is_image finite_imageI gr0I<span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">D</span><span class="main">.</span> <span class="main">(</span><span class="bound">D</span> <span class="main">⊆</span> <span class="free">X</span> <span class="main">&amp;</span> card <span class="bound">D</span> <span class="main">≤</span> <span class="main">0</span> <span class="main">&amp;</span> card <span class="main">(</span>inter <span class="bound">D</span> <span class="main">`</span> <span class="free">F</span><span class="main">)</span> <span class="main">≥</span> <span class="main">0</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">m</span><span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">&lt;</span> card <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">arith</span>
      <span class="keyword1"><span class="command">with</span></span> Suc.IH <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">D</span></span>
        <span class="keyword2"><span class="keyword">where</span></span> D<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">⊆</span> <span class="free">X</span> <span class="main">∧</span> card <span class="skolem">D</span> <span class="main">≤</span> <span class="skolem">m</span> <span class="main">∧</span> <span class="skolem">m</span> <span class="main">+</span> <span class="main">1</span> <span class="main">≤</span> card <span class="main">(</span>inter <span class="skolem">D</span> <span class="main">`</span> <span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹finite <span class="free">X</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"finite <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> finite_subset<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>inter <span class="skolem">D</span> <span class="main">`</span> <span class="free">F</span><span class="main">)</span> <span class="main">=</span> card <span class="free">F</span>"</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">case</span></span> True
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">⊆</span> <span class="free">X</span> <span class="main">∧</span> card <span class="skolem">D</span> <span class="main">≤</span> Suc <span class="skolem">m</span> <span class="main">∧</span> Suc <span class="skolem">m</span> <span class="main">+</span> <span class="main">1</span> <span class="main">≤</span> card<span class="main">(</span>inter <span class="skolem">D</span> <span class="main">`</span> <span class="free">F</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> D Suc.prems <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">case</span></span> False
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">~</span> inj_on <span class="main">(</span>inter <span class="skolem">D</span><span class="main">)</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> card_image<span class="main">)</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A1</span></span> <span class="skolem"><span class="skolem">A2</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A1</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A2</span> <span class="main">∈</span> <span class="free">F</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
          <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">∩</span> <span class="skolem">A1</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">∩</span> <span class="skolem">A2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A1</span> <span class="main">≠</span> <span class="skolem">A2</span>"</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> inj_on_def<span class="main">)</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">:</span> <span class="main">(</span><span class="skolem">A1</span> <span class="main">-</span> <span class="skolem">A2</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="skolem">A2</span> <span class="main">-</span> <span class="skolem">A1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> <span class="free">F</span><span class="main">.</span> <span class="bound">A</span> <span class="main">⊆</span> <span class="free">X</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A1</span> <span class="main">∈</span> <span class="free">F</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A2</span> <span class="main">∈</span> <span class="free">F</span>›</span></span> x <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">:</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?E</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"insert <span class="skolem">x</span> <span class="skolem">D</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> D <span class="quoted"><span class="quoted">‹finite <span class="skolem">D</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="var">?E</span> <span class="main">≤</span> Suc <span class="skolem">m</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> Suc_le_mono card_insert_if le_Suc_eq<span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> D <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">:</span><span class="free">X</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?E</span> <span class="main">⊆</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="skolem">m</span> <span class="main">&lt;</span> card <span class="main">(</span>inter <span class="var">?E</span> <span class="main">`</span> <span class="free">F</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">∩</span> <span class="skolem">A1</span> <span class="main">=</span> <span class="skolem">D</span> <span class="main">∩</span> <span class="skolem">A2</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">D</span> <span class="main">∩</span> <span class="main">(</span><span class="var">?E</span> <span class="main">∩</span> <span class="skolem">A1</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">D</span> <span class="main">∩</span> <span class="main">(</span><span class="var">?E</span> <span class="main">∩</span> <span class="skolem">A2</span><span class="main">)</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> x <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?E</span> <span class="keyword1">Int</span> <span class="skolem">A1</span> <span class="main">≠</span> <span class="var">?E</span> <span class="keyword1">Int</span> <span class="skolem">A2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">have</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">"inter <span class="skolem">D</span> <span class="main">∘</span> inter <span class="var">?E</span> <span class="main">=</span> inter <span class="skolem">D</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">have</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">~</span> inj_on <span class="main">(</span>inter <span class="skolem">D</span><span class="main">)</span> <span class="main">(</span>inter <span class="var">?E</span> <span class="main">`</span> <span class="free">F</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">unfolding</span></span> inj_on_def <span class="keyword1"><span class="command">using</span></span> 1 2 <span class="quoted"><span class="quoted">‹<span class="skolem">A1</span> <span class="main">∈</span> <span class="free">F</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A2</span> <span class="main">∈</span> <span class="free">F</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">from</span></span> D <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Suc <span class="skolem">m</span> <span class="main">≤</span> card <span class="main">(</span>inter <span class="skolem">D</span> <span class="main">`</span> <span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">&lt;</span> card <span class="main">(</span>inter <span class="var">?E</span> <span class="main">`</span> <span class="free">F</span><span class="main">)</span>"</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> card_less_if_surj_not_inj<span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"inter <span class="skolem"><span class="skolem"><span class="skolem">D</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
              <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> image_image 3 4 <span class="quoted"><span class="quoted">‹finite <span class="free">F</span>›</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?E</span><span class="main">⊆</span><span class="free">X</span> <span class="main">∧</span> card <span class="var">?E</span> <span class="main">≤</span> Suc <span class="skolem">m</span> <span class="main">∧</span> Suc <span class="skolem">m</span> <span class="main">+</span> <span class="main">1</span> <span class="main">≤</span> card <span class="main">(</span>inter <span class="var">?E</span> <span class="main">`</span> <span class="free">F</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">D</span></span><span class="main">⊆</span><span class="free">X</span><span class="main">.</span> card <span class="bound">D</span> <span class="main">≤</span> Suc <span class="skolem">m</span> <span class="main">∧</span> Suc <span class="skolem">m</span> <span class="main">+</span> <span class="main">1</span> <span class="main">≤</span> card <span class="main">(</span>inter <span class="bound">D</span> <span class="main">`</span> <span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="free">X</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> card <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">D</span></span> <span class="keyword2"><span class="keyword">where</span></span> 
    <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">⊆</span> <span class="free">X</span> <span class="main">&amp;</span> card <span class="skolem">D</span> <span class="main">≤</span> card <span class="free">X</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&amp;</span> card <span class="main">(</span>inter <span class="skolem">D</span> <span class="main">`</span> <span class="free">F</span><span class="main">)</span> <span class="main">≥</span> <span class="main">(</span>card <span class="free">X</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">+</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">with</span></span></span> <span class="quoted"><span class="quoted">‹finite <span class="free">F</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"card <span class="main">(</span>inter <span class="skolem">D</span> <span class="main">`</span> <span class="free">F</span><span class="main">)</span> <span class="main">≤</span> card <span class="free">F</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">elim</span> card_image_le<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">⊆</span> <span class="free">X</span> <span class="main">&amp;</span> card <span class="skolem">D</span> <span class="main">&lt;</span> card <span class="free">X</span> <span class="main">&amp;</span> card <span class="main">(</span>inter <span class="skolem">D</span> <span class="main">`</span> <span class="free">F</span><span class="main">)</span> <span class="main">=</span> card <span class="free">F</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹card <span class="free">F</span> <span class="main">=</span> card <span class="free">X</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

</pre>
</div>
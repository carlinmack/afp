<div id='Roth_Arithmetic_Progressions'>e>
</head>


<body>
<div class="head">
<h1>Theory Roth_Arithmetic_Progressions</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Roth's Theorem on Arithmetic Progressions</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Roth_Arithmetic_Progressions</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="../Szemeredi_Regularity/Szemeredi.html"><span>Szemeredi_Regularity.Szemeredi</span></a><span>
      </span><span class="quoted"><span>"</span><a href="../Random_Graph_Subgraph_Threshold/Subgraph_Threshold.html"><span>Random_Graph_Subgraph_Threshold.Subgraph_Threshold</span></a><span>"</span></span><span>
      </span><span class="quoted"><span>"</span><a href="../Ergodic_Theory/Asymptotic_Density.html"><span>Ergodic_Theory.Asymptotic_Density</span></a><span>"</span></span><span>
      </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Library/Ramsey.html"><span>HOL-Library.Ramsey</span></a><span>"</span></span><span> </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Library/Nat_Bijection.html"><span>HOL-Library.Nat_Bijection</span></a><span>"</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>For the Library</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>declare</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode_eq|fact"><span>prod_encode_eq</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span> 
</span><span class="keyword1"><span class="command"><span>declare</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_decode_eq|fact"><span>prod_decode_eq</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span> 

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.mult_mod_cancel_right|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mult_mod_cancel_right|thm"><span>mult_mod_cancel_right</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span class="main"><span>::</span></span><span class="main"><span>{</span></span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_ring_cancel|class"><span>euclidean_ring_cancel</span></a><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL/GCD.html#GCD.semiring_gcd|class"><span>semiring_gcd</span></a><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_483..485">eq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.algebraic_semidom_class.coprime|const"><span>coprime</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.dvd_class.dvd|const"><span>dvd</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_483..485"><span>eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_ring_cancel_class.mod_eq_dvd_iff|fact"><span>mod_eq_dvd_iff</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.dvd_class.dvd|const"><span>dvd</span></a></span><span> </span><span class="free"><span>a</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span>b</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.algebraic_semidom_class.coprime|const"><span>coprime</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>n</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/GCD.html#GCD.semiring_gcd_class.coprime_dvd_mult_left_iff|fact"><span>coprime_dvd_mult_left_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.comm_semiring_1_cancel_class.left_diff_distrib&apos;|fact"><span>left_diff_distrib'</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_ring_cancel_class.mod_eq_dvd_iff|fact"><span>mod_eq_dvd_iff</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_796..801">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.mult_mod_cancel_left|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mult_mod_cancel_left|thm"><span>mult_mod_cancel_left</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span class="main"><span>::</span></span><span class="main"><span>{</span></span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_ring_cancel|class"><span>euclidean_ring_cancel</span></a><span class="main"><span>,</span></span><a class="entity_ref" href="../../HOL/HOL/GCD.html#GCD.semiring_gcd|class"><span>semiring_gcd</span></a><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.algebraic_semidom_class.coprime|const"><span>coprime</span></a><span> </span><span class="free"><span>m</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="free"><span>m</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_796..801"><span>assms</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_mult_class.mult.commute|fact"><span>mult.commute</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.mult_mod_cancel_right|fact"><span>mult_mod_cancel_right</span></a><span class="main"><span>)</span></span><span>

</span><span class="comment1"><span>(</span><span>*</span><span>Stronger than the one in Szemeredi [now installed in AFP_devel] </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.edge_density_le1|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.edge_density_le1|thm"><span>edge_density_le1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>Y</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_mono|fact"><span>of_nat_mono</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.max_all_edges_between|fact"><span>max_all_edges_between</span></a><span class="main"><span>,</span></span><span> </span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>X</span></span></span><span> </span><span class="quoted"><span class="free"><span>Y</span></span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>fastforce</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density_def|fact"><span>edge_density_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.divide_simps|fact"><span class="dynamic"><span class="dynamic"><span>divide_simps</span></span></span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density_def|fact"><span>edge_density_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.card_3_iff|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.card_3_iff|thm"><span>card_3_iff</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>â·</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span class="bound"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>fastforce</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_Suc_eq|fact"><span>card_Suc_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.numeral_eq_Suc|fact"><span>numeral_eq_Suc</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Miscellaneous Preliminaries</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1534..1539">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.sum_prod_le_prod_sum|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.sum_prod_le_prod_sum|thm"><span>sum_prod_le_prod_sum</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'b</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.linordered_idom|class"><span>linordered_idom</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_1534..1539"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>I</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.infinite_finite_induct|fact"><span>infinite_finite_induct</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.algebra_simps|fact"><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.comm_monoid_add_class.sum.distrib|fact"><span>sum.distrib</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.semiring_0_class.sum_distrib_left|fact"><span>sum_distrib_left</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.real_mult_gt_cube|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.real_mult_gt_cube|thm"><span>real_mult_gt_cube</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>X</span></span><span> </span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>C</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="free"><span>C</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>X</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.ordered_semiring_class.mult_mono&apos;|fact"><span>mult_mono'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.monoid_mult_class.power3_eq_cube|fact"><span>power3_eq_cube</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.min_card_fin_X_elem|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.min_card_fin_X_elem|thm"><span>min_card_fin_X_elem</span></span></span><span class="main"><span>:</span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card.remove|fact"><span>card.remove</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2051..2056">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.card_or_filter_max|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.card_or_filter_max|thm"><span>card_or_filter_max</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>a</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>â¨</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>a</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>a</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2191..2194">fin</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>a</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>a</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_2051..2056"><span>assms</span></a><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2278..2283">equiv</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>a</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>â¨</span></a></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>a</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>a</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>a</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>a</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>a</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>a</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>a</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>â©</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>a</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_Un_Int|fact"><span>card_Un_Int</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_2191..2194"><span>fin</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_2278..2283"><span>equiv</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Presburger.html#Presburger.presburger|method"><span class="operator"><span>presburger</span></span></a><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2563..2568">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.triple_sigma_rewrite_card|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triple_sigma_rewrite_card|thm"><span>triple_sigma_rewrite_card</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>Y</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>Z</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>z</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Z</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_2754..2760">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>W</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>W</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>z</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Z</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>W</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Z</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_2754..2760"><span>W_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>W</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_2563..2568"><span>assms</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_SigmaI|fact"><span>finite_SigmaI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.infinite_super|fact"><span>infinite_super</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2955..2957">eq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="free"><span>X</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="main"><span>(</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="skolem"><span>W</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span class="bound"><span>z</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_2754..2760"><span>W_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_2955..2957"><span>eq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjoint_iff|fact"><span>disjoint_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_2563..2568"><span>assms</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.card_UN_disjoint|fact"><span>card_UN_disjoint</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_2754..2760"><span>W_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_Union1|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_Union1|thm"><span>all_edges_between_Union1</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Union|const"><span>Union</span></a><span> </span><span class="free"><span>ð³</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>X</span></span><span class="main"><span>â</span></span><span class="free"><span>ð³</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="bound"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_Union2|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_Union2|thm"><span>all_edges_between_Union2</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Union|const"><span>Union</span></a><span> </span><span class="free"><span>ð´</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>Y</span></span><span class="main"><span>â</span></span><span class="free"><span>ð´</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3459..3464">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_disjoint1|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_disjoint1|thm"><span>all_edges_between_disjoint1</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.disjoint|const"><span>disjoint</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.disjoint|const"><span>disjoint</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>X</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="bound"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_3459..3464"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.disjoint_def|fact"><span>disjoint_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3638..3643">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_disjoint2|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_disjoint2|thm"><span>all_edges_between_disjoint2</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.disjoint|const"><span>disjoint</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.disjoint|const"><span>disjoint</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Y</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_3638..3643"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.disjoint_def|fact"><span>disjoint_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3817..3822">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_disjoint_family_on1|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_disjoint_family_on1|thm"><span>all_edges_between_disjoint_family_on1</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.disjoint|const"><span>disjoint</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.disjoint_family_on|const"><span>disjoint_family_on</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>X</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="bound"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_disjnt1|fact"><span>all_edges_between_disjnt1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_3817..3822"><span>assms</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjnt_def|fact"><span>disjnt_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.disjoint_family_on_def|fact"><span>disjoint_family_on_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.pairwiseD|fact"><span>pairwiseD</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4056..4061">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_disjoint_family_on2|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_disjoint_family_on2|thm"><span>all_edges_between_disjoint_family_on2</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.disjoint|const"><span>disjoint</span></a><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.disjoint_family_on|const"><span>disjoint_family_on</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Y</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_disjnt2|fact"><span>all_edges_between_disjnt2</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_4056..4061"><span>assms</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjnt_def|fact"><span>disjnt_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.disjoint_family_on_def|fact"><span>disjoint_family_on_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.pairwiseD|fact"><span>pairwiseD</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_mono1|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_mono1|thm"><span>all_edges_between_mono1</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_mono2|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_mono2|thm"><span>all_edges_between_mono2</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.inj_on_mk_uedge|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.inj_on_mk_uedge|thm"><span>inj_on_mk_uedge</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>â©</span></a></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_on|const"><span>inj_on</span></a><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.mk_uedge|const"><span>mk_uedge</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_on_def|fact"><span>inj_on_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4712..4717">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.uwellformed_alt|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.uwellformed_alt|thm"><span>uwellformed_alt</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed_def|fact"><span>uwellformed_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_4712..4717"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4849..4854">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.uwellformed_alt_fst|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.uwellformed_alt_fst|thm"><span>uwellformed_alt_fst</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.uwellformed_alt|fact"><span>uwellformed_alt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_4849..4854"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4985..4990">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.uwellformed_alt_snd|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.uwellformed_alt_snd|thm"><span>uwellformed_alt_snd</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.uwellformed_alt|fact"><span>uwellformed_alt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_4985..4990"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_subset_times|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_subset_times|thm"><span>all_edges_between_subset_times</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>â©</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Union|const"><span>â</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>â©</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Union|const"><span>â</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5266..5271">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.finite_all_edges_between&apos;|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.finite_all_edges_between&apos;|thm"><span>finite_all_edges_between'</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Union|const"><span>â</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Pow_iff|fact"><span>Pow_iff</span></a><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.all_edges_subset_Pow|fact"><span>all_edges_subset_Pow</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_5266..5271"><span>assms</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/FSet.html#FSet.finite_Sup|fact"><span>finite_Sup</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subsetD|fact"><span>subsetD</span></a><span> </span><a class="entity_ref" href="../Random_Graph_Subgraph_Threshold/Ugraph_Lemmas.html#Ugraph_Lemmas.wellformed_all_edges|fact"><span>wellformed_all_edges</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.all_edges_between_subset_times|fact"><span>all_edges_between_subset_times</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_Int|fact"><span>finite_Int</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_SigmaI|fact"><span>finite_SigmaI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_subset|fact"><span>finite_subset</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5626..5631">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.card_all_edges_between|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.card_all_edges_between|thm"><span>card_all_edges_between</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>Y</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span class="main"><span>â</span></span><span class="free"><span>Y</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span class="main"><span>â</span></span><span class="free"><span>Y</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.disjoint_family_on|const"><span>disjoint_family_on</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>Y</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.disjoint_family_on_def|fact"><span>disjoint_family_on_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.disjoint_family_on_def|fact"><span>disjoint_family_on_def</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.card_UN_disjoint&apos;|fact"><span>card_UN_disjoint'</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_5626..5631"><span>assms</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.finite_all_edges_between&apos;|fact"><span>finite_all_edges_between'</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6190..6195">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.max_edges_graph|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.max_edges_graph|thm"><span>max_edges_graph</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Binomial.html#Binomial.binomial|const"><span>choose</span></a></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../Random_Graph_Subgraph_Threshold/Ugraph_Lemmas.html#Ugraph_Lemmas.all_edges_finite|fact"><span>all_edges_finite</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_6190..6195"><span>assms</span></a><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.card_all_edges|fact"><span>card_all_edges</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_mono|fact"><span>card_mono</span></a><span> </span><a class="entity_ref" href="../Random_Graph_Subgraph_Threshold/Ugraph_Lemmas.html#Ugraph_Lemmas.wellformed_all_edges|fact"><span>wellformed_all_edges</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Binomial.html#Binomial.binomial_le_pow|fact"><span>binomial_le_pow</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le0|fact"><span>le0</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.neq0_conv|fact"><span>neq0_conv</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order.trans|fact"><span>order.trans</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Binomial.html#Binomial.zero_less_binomial_iff|fact"><span>zero_less_binomial_iff</span></a><span class="main"><span>)</span></span><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_ss_uedges|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_ss_uedges|thm"><span>all_edges_between_ss_uedges</span></span></span><span class="main"><span>:</span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.mk_uedge|const"><span>mk_uedge</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_betw_D1|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_betw_D1|thm"><span>all_edges_betw_D1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_betw_D2|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_betw_D2|thm"><span>all_edges_betw_D2</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="free"><span>Y</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_betw_D3|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_betw_D3|thm"><span>all_edges_betw_D3</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_betw_I|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_betw_I|thm"><span>all_edges_betw_I</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_E_diff|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_E_diff|thm"><span>all_edges_between_E_diff</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>V</span></span><span class="main"><span>,</span></span><span class="free"><span>E</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span>E'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>V</span></span><span class="main"><span>,</span></span><span class="free"><span>E</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>V</span></span><span class="main"><span>,</span></span><span class="free"><span>E'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_E_Un|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_E_Un|thm"><span>all_edges_between_E_Un</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>V</span></span><span class="main"><span>,</span></span><span class="free"><span>E</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span class="free"><span>E'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>V</span></span><span class="main"><span>,</span></span><span class="free"><span>E</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>V</span></span><span class="main"><span>,</span></span><span class="free"><span>E'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_E_UN|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_between_E_UN|thm"><span>all_edges_between_E_UN</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>V</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>E</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>V</span></span><span class="main"><span>,</span></span><span class="free"><span>E</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_betw_prod_def|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_betw_prod_def|thm"><span>all_edges_betw_prod_def</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>thm</span></span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.in_mk_uedge_img|fact"><span>in_mk_uedge_img</span></a><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.in_mk_uedge_img_iff|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.in_mk_uedge_img_iff|thm"><span>in_mk_uedge_img_iff</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>a</span></span><span class="main"><span>,</span></span><span class="free"><span>b</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.mk_uedge|const"><span>mk_uedge</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>â·</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>,</span></span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>â¨</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span class="main"><span>,</span></span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.rev_image_eqI|fact"><span>rev_image_eqI</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_preserved|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_preserved|thm"><span>all_edges_preserved</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>A</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="free"><span>G'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>A</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>;</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>â§</span></span><span>
    </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8124..8129">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.subgraph_edge_wf|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.subgraph_edge_wf|thm"><span>subgraph_edge_wf</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>H</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>H</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>H</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_8124..8129"><span>assms</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subsetD|fact"><span>subsetD</span></a><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed_def|fact"><span>uwellformed_def</span></a><span class="main"><span>)</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Preliminaries on Neighbors in Graphs</span><span>âº</span></span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="Roth_Arithmetic_Progressions.neighbor_in_graph_def|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.neighbor_in_graph_def|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.neighbor_in_graph_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Roth_Arithmetic_Progressions.neighbor_in_graph|const"><span>neighbor_in_graph</span></span></span><span class="main"><span>::</span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span> </span><span class="main"><span>â</span></span><span>  </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>neighbor_in_graph</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="main"><span>{</span></span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Roth_Arithmetic_Progressions.neighbors_def|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.neighbors_def|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.neighbors_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Roth_Arithmetic_Progressions.neighbors|const"><span>neighbors</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>neighbors</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span>  </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbor_in_graph|const"><span>neighbor_in_graph</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Roth_Arithmetic_Progressions.neighbors_ss_def|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.neighbors_ss_def|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.neighbors_ss_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></span></span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>neighbors_ss</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Y</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Y</span></span></span></span><span> </span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbor_in_graph|const"><span>neighbor_in_graph</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_betw_prod_def_neighbors|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_betw_prod_def_neighbors|thm"><span>all_edges_betw_prod_def_neighbors</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>â¹</span></span><span> 
  </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbor_in_graph|const"><span>neighbor_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbor_in_graph_def|fact"><span>neighbor_in_graph_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.uwellformed_alt_fst|fact"><span>uwellformed_alt_fst</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.uwellformed_alt_snd|fact"><span>uwellformed_alt_snd</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_betw_sigma_neighbor|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_betw_sigma_neighbor|thm"><span>all_edges_betw_sigma_neighbor</span></span></span><span class="main"><span>:</span></span><span> 
</span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>SIGMA</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>:</span></span><span class="free"><span>X</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss_def|fact"><span>neighbors_ss_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbor_in_graph_def|fact"><span>neighbor_in_graph_def</span></a><span> 
      </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.uwellformed_alt_fst|fact"><span>uwellformed_alt_fst</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.uwellformed_alt_snd|fact"><span>uwellformed_alt_snd</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9232..9237">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.card_all_edges_betw_neighbor|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.card_all_edges_betw_neighbor|thm"><span>card_all_edges_betw_neighbor</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>Y</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="free"><span>X</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.all_edges_betw_sigma_neighbor|fact"><span>all_edges_betw_sigma_neighbor</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_9232..9237"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss_def|fact"><span>neighbors_ss_def</span></a><span class="main"><span>)</span></span><span>



</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Preliminaries on Triangles in Graphs</span><span>âº</span></span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_in_graph_def|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_in_graph_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></span></span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>triangle_in_graph</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>z</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> 
         </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>z</span></span></span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>z</span></span></span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_triples_def|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_triples_def|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_triples_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_triples|const"><span>triangle_triples</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>triangle_triples</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>X</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Y</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Z</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>z</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>X</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Y</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Z</span></span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.card_triangle_triples_rotate|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.card_triangle_triples_rotate|thm"><span>card_triangle_triples_rotate</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_triples|const"><span>triangle_triples</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_triples|const"><span>triangle_triples</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_triples|const"><span>triangle_triples</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span class="bound"><span>z</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span class="bound"><span>z</span></span><span class="main"><span>,</span></span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_triples|const"><span>triangle_triples</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_triples_def|fact"><span>triangle_triples_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.case_prod_unfold|fact"><span>case_prod_unfold</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_iff|fact"><span>image_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert_commute|fact"><span>insert_commute</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_on|const"><span>inj_on</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_triples|const"><span>triangle_triples</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_on_def|fact"><span>inj_on_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_image|fact"><span>card_image</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10289..10294">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_commu1|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_commu1|thm"><span>triangle_commu1</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_10289..10294"><span>assms</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert_commute|fact"><span>insert_commute</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_vertices_distinct1|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_vertices_distinct1|thm"><span>triangle_vertices_distinct1</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_10503..10505">wf</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_10533..10536">tri</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ccontr|fact"><span>ccontr</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_10611..10612">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Â¬</span></a></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>{</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_10533..10536"><span>tri</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_10503..10505"><span>wf</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed_def|fact"><span>uwellformed_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span> 
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_10611..10612"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10754..10759">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_vertices_distinct2|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_vertices_distinct2|thm"><span>triangle_vertices_distinct2</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="free"><span>z</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_10754..10759"><span>assms</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_vertices_distinct1|fact"><span>triangle_vertices_distinct1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span class="main"><span>)</span></span><span> 

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10931..10936">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_vertices_distinct3|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_vertices_distinct3|thm"><span>triangle_vertices_distinct3</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_10931..10936"><span>assms</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_vertices_distinct1|fact"><span>triangle_vertices_distinct1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span class="main"><span>)</span></span><span> 

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11108..11113">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_in_graph_edge_point|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_in_graph_edge_point|thm"><span>triangle_in_graph_edge_point</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>â·</span></a></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbor_in_graph|const"><span>neighbor_in_graph</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbor_in_graph|const"><span>neighbor_in_graph</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbor_in_graph_def|fact"><span>neighbor_in_graph_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_11108..11113"><span>assms</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.uwellformed_alt_fst|fact"><span>uwellformed_alt_fst</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.uwellformed_alt_snd|fact"><span>uwellformed_alt_snd</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Roth_Arithmetic_Progressions.unique_triangles_def|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.unique_triangles_def|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.unique_triangles_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Roth_Arithmetic_Progressions.unique_triangles|const"><span>unique_triangles</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> 
    </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>e</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â!</span></span><span class="bound"><span>T</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="bound"><span>T</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span class="bound"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="bound"><span>T</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_free_graph_def|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_free_graph_def|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_free_graph_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_free_graph|const"><span>triangle_free_graph</span></span></span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>triangle_free_graph</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Â¬</span></a></span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_free_graph_empty|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_free_graph_empty|thm"><span>triangle_free_graph_empty</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_free_graph|const"><span>triangle_free_graph</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_free_graph_def|fact"><span>triangle_free_graph_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11771..11776">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.edge_vertices_not_equal|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.edge_vertices_not_equal|thm"><span>edge_vertices_not_equal</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span class="free"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_11771..11776"><span>assms</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_vertices_distinct1|fact"><span>triangle_vertices_distinct1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11938..11943">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.edge_btw_vertices_not_equal|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.edge_btw_vertices_not_equal|thm"><span>edge_btw_vertices_not_equal</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.edge_vertices_not_equal|fact"><span>edge_vertices_not_equal</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.all_edges_betw_D3|fact"><span>all_edges_betw_D3</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_11938..11943"><span>assms</span></a><span class="main"><span>)</span></span><span> 

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_12144..12149">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_from_ss_edges|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_from_ss_edges|thm"><span>mk_triangle_from_ss_edges</span></span></span><span class="main"><span>:</span></span><span> 
</span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> 
</span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.all_edges_betw_D3|fact"><span>all_edges_betw_D3</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_12144..12149"><span>assms</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_12396..12401">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_in_graph_verts|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_in_graph_verts(3)|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_in_graph_verts(2)|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_in_graph_verts(1)|thm"><span>triangle_in_graph_verts</span></span></span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>z</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_12560..12561">1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_12396..12401"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.uwellformed_alt_fst|fact"><span>uwellformed_alt_fst</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_12396..12401"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_12560..12561"><span>1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.uwellformed_alt_snd|fact"><span>uwellformed_alt_snd</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_12396..12401"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_12396..12401"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.uwellformed_alt_snd|fact"><span>uwellformed_alt_snd</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_12396..12401"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_set_def|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_set_def|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_set_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>triangle_set</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>{</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span class="bound"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set.elims|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set.induct|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set.simps|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set.pelims|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set.cases|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set.termination|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set.pinduct|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set.psimps|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_rel.inducts|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_rel.simps|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_rel.induct|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_rel.cases|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_rel.intros|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_graph.inducts|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_graph.simps|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_graph.induct|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_graph.cases|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_graph.intros|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set.elims|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set.induct|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set.simps|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set.pelims|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set.cases|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set.termination|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set.pinduct|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set.psimps|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_rel.inducts|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_rel.simps|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_rel.induct|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_rel.cases|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_graph.inducts|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_graph.simps|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_graph.induct|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_graph.cases|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_graph.intros|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_def|axiom"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_rel_def|axiom"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_sumC_def|axiom"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_graph_def|axiom"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_dom|const"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_rel|const"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_sumC|const"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Roth_Arithmetic_Progressions.mk_triangle_set|const"><span>mk_triangle_set</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>Ã</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>Ã</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>mk_triangle_set</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>z</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>z</span></span></span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.convert_triangle_rep_ss|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.convert_triangle_rep_ss|thm"><span>convert_triangle_rep_ss</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.mk_triangle_set|const"><span>mk_triangle_set</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span class="bound"><span>z</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subsetI|fact"><span>subsetI</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_def|fact"><span>triangle_set_def</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.finite_triangle_set|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.finite_triangle_set|thm"><span>finite_triangle_set</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_13494..13497">fin</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_13523..13525">wf</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Pow|const"><span>Pow</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert_iff|fact"><span>insert_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_13523..13525"><span>local.wf</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_def|fact"><span>triangle_set_def</span></a><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed_def|fact"><span>uwellformed_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_13494..13497"><span>fin</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_Pow_iff|fact"><span>finite_Pow_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.infinite_super|fact"><span>infinite_super</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_13791..13796">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.card_triangle_3|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.card_triangle_3|thm"><span>card_triangle_3</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>t</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>t</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_13791..13796"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_def|fact"><span>triangle_set_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.edge_vertices_not_equal|fact"><span>edge_vertices_not_equal</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_set_power_set_ss|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_set_power_set_ss|thm"><span>triangle_set_power_set_ss</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Pow|const"><span>Pow</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_def|fact"><span>triangle_set_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.uwellformed_alt_fst|fact"><span>uwellformed_alt_fst</span></a><span>  </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.uwellformed_alt_snd|fact"><span>uwellformed_alt_snd</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_14186..14191">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_set_finite|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_set_finite|thm"><span>triangle_set_finite</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_power_set_ss|fact"><span>triangle_set_power_set_ss</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_14186..14191"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_Pow_iff|fact"><span>finite_Pow_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.rev_finite_subset|fact"><span>rev_finite_subset</span></a><span class="main"><span>)</span></span><span> 

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_14393..14398">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_in_graph_ss|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_in_graph_ss|thm"><span>triangle_in_graph_ss</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>Gnew</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="free"><span>Gnew</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_14393..14398"><span>assms</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_14393..14398"><span>assms</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_14393..14398"><span>assms</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> 
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><span>{</span></span><span class="free"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><span>{</span></span><span class="free"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span class="main"><span>)</span></span><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_14898..14903">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_set_graph_edge_ss|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_set_graph_edge_ss|thm"><span>triangle_set_graph_edge_ss</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>Gnew</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>Gnew</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subsetI|fact"><span>subsetI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>t</span></span><span> </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>t</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>Gnew</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>z</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>t</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="free"><span>Gnew</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_def|fact"><span>triangle_set_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_14898..14903"><span>assms</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.mem_Collect_eq|fact"><span>mem_Collect_eq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_14898..14903"><span>assms</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_ss|fact"><span>triangle_in_graph_ss</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>t</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_def|fact"><span>triangle_set_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_14898..14903"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>t</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>}</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_15491..15496">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_set_graph_edge_ss_bound|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_set_graph_edge_ss_bound|thm"><span>triangle_set_graph_edge_ss_bound</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>Gnew</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>Gnew</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_graph_edge_ss|fact"><span>triangle_set_graph_edge_ss</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_finite|fact"><span>triangle_set_finite</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_15491..15496"><span>assms</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_mono|fact"><span>card_mono</span></a><span class="main"><span>)</span></span><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The Triangle Counting Lemma and the Triangle Removal Lemma</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span class="quoted"><span class="plain_text"><span>â¹</span><span>We begin with some more auxiliary material to be used in the main lemmas.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_16005..16010">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.regular_pairI|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.regular_pairI|thm"><span>regular_pairI</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><span>::</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_pair|const"><span>regular_pair</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>xss</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>yss</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Y'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="free"><span>Y</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.abs_class.abs|const"><span>Â¦</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X'</span></span><span> </span><span class="free"><span>Y'</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.abs_class.abs|const"><span>Â¦</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_pair_def|fact"><span>regular_pair_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_16005..16010"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>meson</span></span><span> 

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.edge_density_zero|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.edge_density_zero|thm"><span>edge_density_zero</span></span></span><span class="main"><span>:</span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density_def|fact"><span>edge_density_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_16438..16443">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.regular_pair_neighbor_bound|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.regular_pair_neighbor_bound|thm"><span>regular_pair_neighbor_bound</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>::</span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>finG</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span>xss</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>yss</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_16605..16607">wf</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_16633..16636">eg0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_pair|const"><span>regular_pair</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_16677..16679">ed</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>X</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span> 
           </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="var"><span>?X'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>_</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_16877..16881">True</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_16877..16881"><span>True</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_16633..16636"><span>eg0</span></a><span class="main"><span>)</span></span><span>
 </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_16956..16961">False</span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ccontr|fact"><span>ccontr</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Â¬</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="var"><span>?X'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span>  </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span class="main"><span>)</span></span><span> </span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17064..17065">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span class="main"><span>(</span></span><span class="var"><span>?X'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span>  </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span class="main"><span>)</span></span><span> </span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17115..17118">fin</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>Y</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_16438..16443"><span>assms</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_subset|fact"><span>finite_subset</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17187..17193">ebound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_16677..16679"><span>ed</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.edge_density_le1|fact"><span>edge_density_le1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.le_divide_eq_numeral1|fact"><span>le_divide_eq_numeral1</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_mult_class.mult.commute|fact"><span>mult.commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17305..17309">finx</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="var"><span>?X'</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_17115..17118"><span>fin</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="var"><span>?X'</span></span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="var"><span>?X'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="var"><span>?X'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_16956..16961"><span>False</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.strict_ordered_comm_monoid_add_class.sum_strict_mono|fact"><span>sum_strict_mono</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> del_insts</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_17305..17309"><span>finx</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.semiring_1_class.of_nat_sum|fact"><span>of_nat_sum</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17661..17666">upper</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="var"><span>?X'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.sum_bounded_above|fact"><span>sum_bounded_above</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>sumge0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="var"><span>?X'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17888..17892">xge0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_17115..17118"><span>fin</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_16956..16961"><span>False</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17958..17962">yge0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_16956..16961"><span>False</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>xyge0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_17888..17892"><span>xge0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_18090..18095">xyne0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>fracg0</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_0_eq|fact"><span>card_0_eq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_17305..17309"><span>finx</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_16956..16961"><span>False</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_17958..17962"><span>yge0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_18245..18251">upper2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="var"><span>?X'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_17661..17666"><span>upper</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.linordered_ring_strict_class.mult_less_cancel_left_pos|fact"><span>mult_less_cancel_left_pos</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="var"><span>?X'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_18591..18597">minuse</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span> 
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>z3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.field_class.divide_divide_eq_right|fact"><span>divide_divide_eq_right</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.semiring_1_class.of_nat_mult|fact"><span>of_nat_mult</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.field_class.times_divide_eq_left|fact"><span>times_divide_eq_left</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
        </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.field_class.divide_eq_1_iff|fact"><span>divide_eq_1_iff</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_18090..18095"><span>xyne0</span></a><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_17305..17309"><span>finx</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_16956..16961"><span>False</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span> 
        </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
        </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_19426..19431">edlt1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_16633..16636"><span>eg0</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_19586..19591">edlt2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="var"><span>?X'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_18245..18251"><span>upper2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.abs_class.abs|const"><span>Â¦</span></a></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="var"><span>?X'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.abs_class.abs|const"><span>Â¦</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="var"><span>?X'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="var"><span>?X'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_19426..19431"><span>edlt1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_19586..19591"><span>edlt2</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_18245..18251"><span>upper2</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>  
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="var"><span>?X'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span>  </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_18591..18597"><span>minuse</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_20371..20374">con</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="var"><span>?X'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_20484..20486">ye</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_17187..17193"><span>ebound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_17958..17962"><span>yge0</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_20556..20559">xe'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_17064..17065"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.abs_class.abs|const"><span>Â¦</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.abs_class.abs|const"><span>Â¦</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.regular_pairI|fact"><span>regular_pairI</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>X</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Y</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?X'</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Y</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_16438..16443"><span>assms</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_20484..20486"><span>ye</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_20556..20559"><span>xe'</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.abs_class.abs|const"><span>Â¦</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.abs_class.abs|const"><span>Â¦</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density_def|fact"><span>edge_density_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.abs_class.abs|const"><span>Â¦</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.abs_class.abs|const"><span>Â¦</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.abs_class.abs|const"><span>Â¦</span></a></span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="var"><span>?X'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.abs_class.abs|const"><span>Â¦</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.card_all_edges_betw_neighbor|fact"><span>card_all_edges_betw_neighbor</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_17115..17118"><span>fin</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_16605..16607"><span>wf</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_21233..21235">lt</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.abs_class.abs|const"><span>Â¦</span></a></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?X'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="var"><span>?X'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.abs_class.abs|const"><span>Â¦</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_21233..21235"><span>lt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_20371..20374"><span>con</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span> Following Gowers's proof - more in depth with reasoning on contradiction </span><span>*</span><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_21479..21484">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.neighbor_set_meets_e_reg_cond|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.neighbor_set_meets_e_reg_cond|thm"><span>neighbor_set_meets_e_reg_cond</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>::</span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_21581..21586">enot0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>fin</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>Y</span></span><span>"</span></span></span><span>  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>    
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>rp1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_pair|const"><span>regular_pair</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_21700..21703">ed1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span>  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_21479..21484"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_SIG</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.ordered_semiring_class.mult_right_mono|fact"><span>mult_right_mono</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_less_0_iff|fact"><span>of_nat_less_0_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_21700..21703"><span>ed1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_21581..21586"><span>enot0</span></a><span class="main"><span>)</span></span><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_22048..22053">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_btwn_neighbour_sets_lower_bound|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.all_edges_btwn_neighbour_sets_lower_bound|thm"><span>all_edges_btwn_neighbour_sets_lower_bound</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>::</span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>finG</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>wf</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_22257..22260">fin</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>Y</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>Z</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>  </span><span>rp1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_pair|const"><span>regular_pair</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>rp2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_pair|const"><span>regular_pair</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>  </span><span>rp3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_pair|const"><span>regular_pair</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>ed1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span>  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>ed2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span>  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>ed3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span>  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_22522..22527">cond1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_22601..22606">cond2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Z</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="var"><span>?Y'</span></span><span> </span><span class="var"><span>?Z'</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?Y'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?Z'</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_22967..22971">yss'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?Y'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="free"><span>Y</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss_def|fact"><span>neighbors_ss_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_23021..23025">zss'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?Z'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="free"><span>Z</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss_def|fact"><span>neighbors_ss_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_23075..23084">min_sizeY</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?Y'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbor_set_meets_e_reg_cond|fact"><span>neighbor_set_meets_e_reg_cond</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_22522..22527"><span>cond1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_22048..22053"><span>assms</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_22257..22260"><span>fin</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>meson</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>min_sizeZ</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?Z'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Z</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbor_set_meets_e_reg_cond|fact"><span>neighbor_set_meets_e_reg_cond</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_22601..22606"><span>cond2</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_22048..22053"><span>assms</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_22257..22260"><span>fin</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>meson</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.abs_class.abs|const"><span>Â¦</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="var"><span>?Y'</span></span><span> </span><span class="var"><span>?Z'</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.abs_class.abs|const"><span>Â¦</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_23075..23084"><span>min_sizeY</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.regular_pairI|fact"><span>regular_pairI</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Y</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Z</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?Y'</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?Z'</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_22967..22971"><span>yss'</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_23021..23025"><span>zss'</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_22048..22053"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.uminus_class.uminus|const"><span>-</span></a></span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="var"><span>?Y'</span></span><span> </span><span class="var"><span>?Z'</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="var"><span>?Y'</span></span><span> </span><span class="var"><span>?Z'</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="var"><span>?Y'</span></span><span> </span><span class="var"><span>?Z'</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?Y'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?Z'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density_def|fact"><span>edge_density_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?Y'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?Z'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="var"><span>?Y'</span></span><span> </span><span class="var"><span>?Z'</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_idom_class.abs_of_nat|fact"><span>abs_of_nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.division_ring_class.division_ring_divide_zero|fact"><span>division_ring_divide_zero</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.linordered_field_class.le_divide_eq|fact"><span>le_divide_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.semiring_1_class.mult_of_nat_commute|fact"><span>mult_of_nat_commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_0_le_iff|fact"><span>of_nat_0_le_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.division_ring_class.times_divide_eq_right|fact"><span>times_divide_eq_right</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ordered_ab_group_add_abs_class.zero_less_abs_iff|fact"><span>zero_less_abs_iff</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_mult_class.mult_ac|fact"><span>ab_semigroup_mult_class.mult_ac</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.semiring_1_class.mult_of_nat_commute|fact"><span>mult_of_nat_commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.semiring_1_class.of_nat_mult|fact"><span>of_nat_mult</span></a><span class="main"><span>)</span></span><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_24088..24093">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.edge_density_implies_edge_exists|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.edge_density_implies_edge_exists|thm"><span>edge_density_implies_edge_exists</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>::</span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>obtains</span></span></span><span> </span><span class="free"><span>e</span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density_def|fact"><span>edge_density_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24088..24093"><span>assms</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.field_class.divide_eq_0_iff|fact"><span>divide_eq_0_iff</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span> 
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card.empty|fact"><span>card.empty</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty_subsetI|fact"><span>empty_subsetI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subsetI|fact"><span>subsetI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_antisym|fact"><span>subset_antisym</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24088..24093"><span>that</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span class="quoted"><span class="plain_text"><span>â¹</span><span>We are now ready to show the Triangle Counting Lemma (Theorem 3.13 in Zhao's notes):</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_24700..24707">theorem</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_counting_lemma|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_counting_lemma|thm"><span>triangle_counting_lemma</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>::</span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_24760..24763">xss</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_24784..24787">yss</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_24808..24811">zss</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_24832..24835">en0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_24853..24857">finG</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_24883..24885">wf</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>    
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_24915..24918">rp1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_pair|const"><span>regular_pair</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_24948..24951">rp2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_pair|const"><span>regular_pair</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>  </span><span class="entity_def" id="offset_24981..24984">rp3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_pair|const"><span>regular_pair</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_25017..25020">ed1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span>  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_25054..25057">ed2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_25090..25093">ed3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span>  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_triples|const"><span>triangle_triples</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="numeral"><span>2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span>
        </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Z</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?T_all</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>z</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Z</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_25379..25385">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>XF</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>XF</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>Y</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>X</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="bound"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>Y</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_25485..25488">fin</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>Y</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="free"><span>Z</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24853..24857"><span>finG</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.rev_finite_subset|fact"><span>rev_finite_subset</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24760..24763"><span>xss</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24784..24787"><span>yss</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24808..24811"><span>zss</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_0_eq|fact"><span>card_0_eq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25017..25020"><span>ed1</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density_def|fact"><span>edge_density_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24832..24835"><span>en0</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25485..25488"><span>fin</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>ebound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25017..25020"><span>ed1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.edge_density_le1|fact"><span>edge_density_le1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25485..25488"><span>fin</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.le_divide_eq_numeral1|fact"><span>le_divide_eq_numeral1</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_mult_class.mult.commute|fact"><span>mult.commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>ebound2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span> 
  
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span class="quoted"><span class="plain_text"><span>â¹</span><span> </span><span>Obtain a subset of </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span class="free"><span>X</span></span></span><span class="antiquote"><span>}</span></span></span><span> where all elements meet minimum numbers for neighborhood size
</span><span>in </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span class="free"><span>Y</span></span></span><span class="antiquote"><span>}</span></span></span><span> and </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span class="free"><span>Z</span></span></span><span class="antiquote"><span>}</span></span></span><span>.</span><span>âº</span></span></span><span>
  
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_25970..25976">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>X2</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>X2</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>XF</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>XF</span></span><span> </span><span class="free"><span>Z</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_26018..26021">xss</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>X2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25970..25976"><span>X2_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_26065..26070">finx2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="skolem"><span>X2</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25970..25976"><span>X2_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25485..25488"><span>fin</span></a><span class="main"><span>)</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Reasoning on the minimum size of </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span class="skolem"><span>X2</span></span></span><span class="antiquote"><span>}</span></span></span><span>:</span><span>âº</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_26181..26186">part1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>XF</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>XF</span></span><span> </span><span class="free"><span>Z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>X2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25379..25385"><span>XF_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25970..25976"><span>X2_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_26254..26262">card_XFY</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>XF</span></span><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span>  </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.regular_pair_neighbor_bound|fact"><span>regular_pair_neighbor_bound</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24700..24707"><span>assms</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25379..25385"><span>XF_def</span></a><span class="main"><span>)</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span class="quoted"><span class="plain_text"><span>â¹</span><span> </span><span>We now repeat the same argument as above to the regular pair </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span class="free"><span>X</span></span></span><span class="antiquote"><span>}</span></span></span><span> </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span class="free"><span>Z</span></span></span><span class="antiquote"><span>}</span></span></span><span> in </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span class="free"><span>G</span></span></span><span class="antiquote"><span>}</span></span></span><span>.</span><span>âº</span></span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_26489..26497">card_XFZ</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>XF</span></span><span> </span><span class="free"><span>Z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span>  </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.regular_pair_neighbor_bound|fact"><span>regular_pair_neighbor_bound</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24700..24707"><span>assms</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25379..25385"><span>XF_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>XF</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>XF</span></span><span> </span><span class="free"><span>Z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_26254..26262"><span>card_XFY</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_26489..26497"><span>card_XFZ</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_Un_le|fact"><span>card_Un_le</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.comm_semiring_class.distrib|fact"><span>comm_semiring_class.distrib</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.semiring_1_class.of_nat_add|fact"><span>of_nat_add</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_mono|fact"><span>of_nat_mono</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>minx2help</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>X2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span>  </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_26181..26186"><span>part1</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> del_insts</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_Un_le|fact"><span>card_Un_le</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.semiring_1_class.of_nat_add|fact"><span>of_nat_add</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_mono|fact"><span>of_nat_mono</span></a><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_26905..26910">minx2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>X2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_mult_class.mult.commute|fact"><span>mult.commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.ring_1_no_zero_divisors_class.mult_cancel_left2|fact"><span>mult_cancel_left2</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.ring_class.right_diff_distrib|fact"><span>right_diff_distrib</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27017..27028">edmultbound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>  
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25090..25093"><span>ed3</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25017..25020"><span>ed1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25054..25057"><span>ed2</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24700..24707"><span>assms</span></a><span class="main"><span>(</span></span><span>4</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> 
  
  </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Reasoning on the minimum number of edges between neighborhoods of </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span class="free"><span>X</span></span></span><span class="antiquote"><span>}</span></span></span><span> in </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span class="free"><span>Y</span></span></span><span class="antiquote"><span>}</span></span></span><span> 
</span><span>and </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span class="free"><span>Z</span></span></span><span class="antiquote"><span>}</span></span></span><span>.</span><span>âº</span></span></span><span>
 
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27305..27312">edyzgt0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
   </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_27354..27361">edxygt0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25017..25020"><span>ed1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25090..25093"><span>ed3</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>cardnzgt0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>cardnygt0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> 
             </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>X2</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27579..27591">card_y_bound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>X2</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25379..25385"><span>XF_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25970..25976"><span>X2_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27715..27727">card_z_bound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>X2</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Z</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25379..25385"><span>XF_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25970..25976"><span>X2_def</span></a><span class="main"><span>)</span></span><span>   
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27854..27867">card_y_bound'</span><span class="main"><span>:</span></span><span> 
          </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>X2</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span>
           </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>X2</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.ordered_comm_monoid_add_class.sum_mono|fact"><span>sum_mono</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.mult_ac|fact"><span>Groups.mult_ac</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_27579..27591"><span>card_y_bound</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_27305..27312"><span>edyzgt0</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_mult_class.mult.commute|fact"><span>mult.commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.ordered_semiring_class.mult_right_mono|fact"><span>mult_right_mono</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_0_le_iff|fact"><span>of_nat_0_le_iff</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_28234..28241">x2_card</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>X2</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
                    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.all_edges_btwn_neighbour_sets_lower_bound|fact"><span>all_edges_btwn_neighbour_sets_lower_bound</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24700..24707"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_27579..27591"><span>card_y_bound</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_27715..27727"><span>card_z_bound</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25017..25020"><span>ed1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25054..25057"><span>ed2</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25090..25093"><span>ed3</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24832..24835"><span>en0</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25485..25488"><span>fin</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24853..24857"><span>finG</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24883..24885"><span>local.wf</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24915..24918"><span>rp1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24948..24951"><span>rp2</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24981..24984"><span>rp3</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subsetD|fact"><span>subsetD</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_26018..26021"><span>xss</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24784..24787"><span>yss</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24808..24811"><span>zss</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_28601..28614">card_z_bound'</span><span class="main"><span>:</span></span><span> 
         </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>X2</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span>
          </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>X2</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Z</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_27715..27727"><span>card_z_bound</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.ordered_semiring_class.mult_left_mono|fact"><span>mult_left_mono</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_27354..27361"><span>edxygt0</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_27305..27312"><span>edyzgt0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>fastforce</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.ordered_comm_monoid_add_class.sum_mono|fact"><span>sum_mono</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_28951..28957">eq_set</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbor_in_graph|const"><span>neighbor_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbor_in_graph|const"><span>neighbor_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> 
</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.mem_Collect_eq|fact"><span>mem_Collect_eq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss_def|fact"><span>neighbors_ss_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?T_all</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>z</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Z</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triple_sigma_rewrite_card|fact"><span>triple_sigma_rewrite_card</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25485..25488"><span>fin</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>  
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>z</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Z</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span class="bound"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbor_in_graph|const"><span>neighbor_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbor_in_graph|const"><span>neighbor_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_edge_point|fact"><span>triangle_in_graph_edge_point</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24700..24707"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbor_in_graph|const"><span>neighbor_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbor_in_graph|const"><span>neighbor_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?T_all</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_28951..28957"><span>eq_set</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_29860..29861">l</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?T_all</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>X2</span></span><span> </span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25485..25488"><span>fin</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_26018..26021"><span>xss</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.ordered_comm_monoid_add_class.sum_mono2|fact"><span>sum_mono2</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>X2</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> 
        </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>X2</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_28234..28241"><span>x2_card</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_26065..26070"><span>finx2</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.ordered_comm_monoid_add_class.sum_mono|fact"><span>sum_mono</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?T_all</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>X2</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_29860..29861"><span>l</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_le_iff|fact"><span>of_nat_le_iff</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>,</span></span><span> </span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> </span><span class="tfree"><span>'a</span></span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?T_all</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>X2</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.neighbors_ss|const"><span>neighbors_ss</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_27854..27867"><span>card_y_bound'</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_30605..30612">tall_gt</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?T_all</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>X2</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Z</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_28601..28614"><span>card_z_bound'</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>X2</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Z</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> 
    </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>X2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Z</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Real_Vector_Spaces.html#Real_Vector_Spaces.of_real|const"><span>of_real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?T_all</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>X2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> 
      </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Z</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_30605..30612"><span>tall_gt</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Real_Vector_Spaces.html#Real_Vector_Spaces.of_real|const"><span>of_real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?T_all</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>X</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> 
      </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span>Z</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_26905..26910"><span>minx2</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_27017..27028"><span>edmultbound</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.dual_order.trans|fact"><span>dual_order.trans</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_mult_class.mult.commute|fact"><span>mult.commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.ordered_comm_semiring_class.comm_mult_left_mono|fact"><span>ordered_comm_semiring_class.comm_mult_left_mono</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_SIG</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_24700..24707"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25017..25020"><span>ed1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_25054..25057"><span>ed2</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.semiring_no_zero_divisors_cancel_class.mult_cancel_right|fact"><span>mult_cancel_right</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.linordered_ring_strict_class.mult_less_cancel_right|fact"><span>mult_less_cancel_right</span></a><span> 
</span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.linordered_semiring_strict_class.mult_pos_neg2|fact"><span>mult_pos_neg2</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.semiring_char_0_class.of_nat_0_eq_iff|fact"><span>of_nat_0_eq_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_le_0_iff|fact"><span>of_nat_le_0_iff</span></a><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_triples_def|fact"><span>triangle_triples_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_mult_class.mult.commute|fact"><span>mult.commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_mult_class.mult.left_commute|fact"><span>mult.left_commute</span></a><span class="main"><span>)</span></span><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Roth_Arithmetic_Progressions.regular_graph_def|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.regular_graph_def|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.regular_graph_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Roth_Arithmetic_Progressions.regular_graph|const"><span>regular_graph</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>regular_graph</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Îµ</span></span></span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>â</span></a></span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="bound"><span>R</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>â¶</span></a></span><span> </span><span class="bound"><span>S</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>â¶</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_pair|const"><span>regular_pair</span></a><span> </span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Îµ</span></span></span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>::</span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>A minimum density, but empty edge sets are excluded.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Roth_Arithmetic_Progressions.edge_dense_def|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.edge_dense_def|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.edge_dense_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Roth_Arithmetic_Progressions.edge_dense|const"><span>edge_dense</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>edge_dense</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>X</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Y</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Îµ</span></span></span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>X</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Y</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>â¨</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>X</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Y</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Îµ</span></span></span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Roth_Arithmetic_Progressions.dense_graph_def|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.dense_graph_def|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.dense_graph_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Roth_Arithmetic_Progressions.dense_graph|const"><span>dense_graph</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>dense_graph</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Îµ</span></span></span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>â</span></a></span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="bound"><span>R</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>â¶</span></a></span><span> </span><span class="bound"><span>S</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>â¶</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.edge_dense|const"><span>edge_dense</span></a><span> </span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Îµ</span></span></span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>::</span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Roth_Arithmetic_Progressions.decent_def|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.decent_def|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.decent_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Roth_Arithmetic_Progressions.decent|const"><span>decent</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>decent</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>X</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Y</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î·</span></span></span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>X</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Y</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>â¨</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>X</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î·</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>Y</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î·</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Roth_Arithmetic_Progressions.decent_graph_def|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.decent_graph_def|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.decent_graph_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Roth_Arithmetic_Progressions.decent_graph|const"><span>decent_graph</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uvert|type"><span>uvert</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>decent_graph</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î·</span></span></span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>â</span></a></span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="bound"><span>R</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>â¶</span></a></span><span> </span><span class="bound"><span>S</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="free"><span class="bound"><span class="entity"><span>P</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>â¶</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.decent|const"><span>decent</span></a><span> </span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>G</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î·</span></span></span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>::</span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The proof of the triangle counting lemma requires ordered triples. For each unordered triple 
</span><span>there are six permutations, hence the factor of $1/6$ here. This is mentioned briefly on pg 57 of 
</span><span>Zhao's notes towards the end of the proof.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_32783..32788">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.card_convert_triangle_rep|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.card_convert_triangle_rep|thm"><span>card_convert_triangle_rep</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_32906..32909">fin</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
</span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_32936..32938">wf</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span class="bound"><span>z</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
         </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>_</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?TT</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_33101..33107">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>tofl</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>tofl</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>l</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.hd|const"><span>hd</span></a><span> </span><span class="bound"><span>l</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.hd|const"><span>hd</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.tl|const"><span>tl</span></a><span> </span><span class="bound"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.hd|const"><span>hd</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.tl|const"><span>tl</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.tl|const"><span>tl</span></a><span> </span><span class="bound"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_33175..33179">have</span></span></span><span> </span><span class="entity_def" id="offset_33180..33187">in_tofl</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>tofl</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Combinatorics/Multiset_Permutations.html#Multiset_Permutations.permutations_of_set|const"><span>permutations_of_set</span></a><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span class="skolem"><span>y</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span class="skolem"><span>z</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span class="skolem"><span>z</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>z</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.distinct|const"><span>distinct</span></a><span class="main"><span>[</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>]</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_33175..33179"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_33101..33107"><span>tofl_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_iff|fact"><span>image_iff</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.sel|fact"><span>list.sel</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.sel|fact"><span>list.sel</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.simps|fact"><span>list.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>15</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Combinatorics/Multiset_Permutations.html#Multiset_Permutations.permutations_of_setI|fact"><span>permutations_of_setI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.set_empty|fact"><span>set_empty</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?TT</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>t</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>tofl</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Combinatorics/Multiset_Permutations.html#Multiset_Permutations.permutations_of_set|const"><span>permutations_of_set</span></a><span> </span><span class="bound"><span>t</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>clarsimp</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_def|fact"><span>triangle_set_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="skolem"><span>w</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_33698..33699">t</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="skolem"><span>w</span></span><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>u</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>w</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>tofl</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Combinatorics/Multiset_Permutations.html#Multiset_Permutations.permutations_of_set|const"><span>permutations_of_set</span></a><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>u</span></span><span class="main"><span>,</span></span><span class="skolem"><span>v</span></span><span class="main"><span>,</span></span><span class="skolem"><span>w</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_33180..33187"><span>in_tofl</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_32936..32938"><span>local.wf</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_commu1|fact"><span>triangle_commu1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_vertices_distinct1|fact"><span>triangle_vertices_distinct1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_vertices_distinct2|fact"><span>triangle_vertices_distinct2</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_33698..33699"><span>t</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>t</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>u</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>w</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>tofl</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Combinatorics/Multiset_Permutations.html#Multiset_Permutations.permutations_of_set|const"><span>permutations_of_set</span></a><span> </span><span class="bound"><span>t</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?TT</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>t</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>tofl</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Combinatorics/Multiset_Permutations.html#Multiset_Permutations.permutations_of_set|const"><span>permutations_of_set</span></a><span> </span><span class="bound"><span>t</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?TT</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>t</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>tofl</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Combinatorics/Multiset_Permutations.html#Multiset_Permutations.permutations_of_set|const"><span>permutations_of_set</span></a><span> </span><span class="bound"><span>t</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_mono|fact"><span>card_mono</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_UN_I|fact"><span>finite_UN_I</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.finite_triangle_set|fact"><span>finite_triangle_set</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_32783..32788"><span>assms</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>t</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>tofl</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Combinatorics/Multiset_Permutations.html#Multiset_Permutations.permutations_of_set|const"><span>permutations_of_set</span></a><span> </span><span class="bound"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.card_UN_le|fact"><span>card_UN_le</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_32906..32909"><span>fin</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.finite_triangle_set|fact"><span>finite_triangle_set</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_32936..32938"><span>local.wf</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>t</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Combinatorics/Multiset_Permutations.html#Multiset_Permutations.permutations_of_set|const"><span>permutations_of_set</span></a><span> </span><span class="bound"><span>t</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_image_le|fact"><span>card_image_le</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Combinatorics/Multiset_Permutations.html#Multiset_Permutations.finite_permutations_of_set|fact"><span>finite_permutations_of_set</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.ordered_comm_monoid_add_class.sum_mono|fact"><span>sum_mono</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>t</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Factorial.html#Factorial.semiring_char_0_class.fact|const"><span>fact</span></a><span> </span><span class="numeral"><span>3</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.ordered_comm_monoid_add_class.sum_mono|fact"><span>sum_mono</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card.infinite|fact"><span>card.infinite</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Combinatorics/Multiset_Permutations.html#Multiset_Permutations.card_permutations_of_set|fact"><span>card_permutations_of_set</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.card_triangle_3|fact"><span>card_triangle_3</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.eq_refl|fact"><span>eq_refl</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_32936..32938"><span>local.wf</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat.simps|fact"><span>nat.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.numeral_3_eq_3|fact"><span>numeral_3_eq_3</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="numeral"><span>6</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.eval_nat_numeral|fact"><span>eval_nat_numeral</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?TT</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="numeral"><span>6</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.divide_simps|fact"><span class="dynamic"><span class="dynamic"><span>divide_simps</span></span></span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_34928..34933">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.card_convert_triangle_rep_bound|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.card_convert_triangle_rep_bound|thm"><span>card_convert_triangle_rep_bound</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.ugraph|type"><span>ugraph</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span class="bound"><span>z</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>t</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>fin</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
</span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>wf</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="free"><span>G</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="free"><span>t</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_35247..35253">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>t'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>t'</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span class="bound"><span>z</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="free"><span>Z</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>t'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>t</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_34928..34933"><span>assms</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_35247..35253"><span>t'_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_35384..35387">tgt</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="skolem"><span>t'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="free"><span>t</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="free"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="skolem"><span>t'</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_35247..35253"><span>t'_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.card_convert_triangle_rep|fact"><span>card_convert_triangle_rep</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_34928..34933"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_35384..35387"><span>tgt</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

 </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_35555..35560">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.edge_density_eq0|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.edge_density_eq0|thm"><span>edge_density_eq0</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>A</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="free"><span>B</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.all_edges_between_mono1|fact"><span>all_edges_between_mono1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.all_edges_between_mono2|fact"><span>all_edges_between_mono2</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_35555..35560"><span>assms</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_empty|fact"><span>subset_empty</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density_def|fact"><span>edge_density_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The following is the Triangle Removal Lemma (Theorem 3.15 in Zhao's notes).</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theorem</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_removal_lemma|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.triangle_removal_lemma|thm"><span>triangle_removal_lemma</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_36006..36009">egt</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>Î´</span></span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>â</span></a></span><span class="bound"><span>G</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>â¶</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="bound"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>â¶</span></a></span><span> 
          </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="bound"><span>Î´</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>â¶</span></a></span><span>
          </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>Gnew</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_free_graph|const"><span>triangle_free_graph</span></a><span> </span><span class="bound"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="bound"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="bound"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="bound"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> 
          </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="bound"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="bound"><span>Gnew</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power2|const"><span><span class="hidden">â§</span><sup>2</sup></span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>Î´</span></span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>â</span></a></span><span class="bound"><span>G</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>â¶</span></a></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>â¶</span></a></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>â¶</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>Gnew</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="var"><span>?Î¦</span></span><span> </span><span class="bound"><span>G</span></span><span> </span><span class="bound"><span>Gnew</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_36398..36403">False</span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_36406..36412">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Gnew</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>G</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedge|type"><span>uedge</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exI|fact"><span>exI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.strip|fact"><span>strip</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>G</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_36533..36534">G</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_free_graph|const"><span>triangle_free_graph</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Gnew</span></span><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Gnew</span></span><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Gnew</span></span><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_36406..36412"><span>Gnew_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_free_graph_empty|fact"><span>triangle_free_graph_empty</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power2|const"><span><span class="hidden">â§</span><sup>2</sup></span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_36533..36534"><span>G</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_gt_0_iff|fact"><span>card_gt_0_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.max_edges_graph|fact"><span>max_edges_graph</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_le_iff|fact"><span>of_nat_le_iff</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power2|const"><span><span class="hidden">â§</span><sup>2</sup></span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_36398..36403"><span>False</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.linordered_idom_class.mult_le_cancel_right1|fact"><span>mult_le_cancel_right1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Gnew</span></span><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power2|const"><span><span class="hidden">â§</span><sup>2</sup></span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_36406..36412"><span>Gnew_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.zero_less_one_class.zero_less_one|fact"><span>zero_less_one</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_37111..37115">True</span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_37123..37127">e4gt</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>M0</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
    </span><span class="entity_def" id="offset_37189..37191">M0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>G</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>P</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_partition|const"><span>regular_partition</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>G</span></span><span> </span><span class="bound"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="skolem"><span>M0</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M0</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.Szemeredi_Regularity_Lemma|fact"><span>Szemeredi_Regularity_Lemma</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le0|fact"><span>le0</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.neq0_conv|fact"><span>neq0_conv</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.not_le|fact"><span>not_le</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.linordered_nonzero_semiring_class.not_numeral_le_zero|fact"><span>not_numeral_le_zero</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_37368..37374">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>D0</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>D0</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="skolem"><span>M0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>D0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>M0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37368..37374"><span>D0_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.linordered_ring_strict_class.zero_less_mult_iff|fact"><span>zero_less_mult_iff</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Î´</span></span></span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_37556..37557">Î´</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>Î´</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Î´</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>D0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.dense_order_class.dense|fact"><span>dense</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exI|fact"><span>exI</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.strip|fact"><span>strip</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>G</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_37696..37698">wf</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_37730..37733">fin</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_gt_0_iff|fact"><span>card_gt_0_iff</span></a><span class="main"><span>)</span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Assume that, for a yet to be determined $\delta$, we have:</span><span>âº</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_37875..37879">ineq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="skolem"><span>Î´</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span> </span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Step 1: Partition: Using Szemer\'{e}di's Regularity Lemma, we get an $\epsilon/4$ partition.</span><span> </span><span>âº</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?n</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_38092..38095">vne</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>ngt0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37730..37733"><span>fin</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_gt_0_iff|fact"><span>card_gt_0_iff</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37189..37191"><span>M0</span></a><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>P</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_38252..38253">M</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_partition|const"><span>regular_partition</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="skolem"><span>P</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="skolem"><span>M0</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_38322..38328">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>M</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>P</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="skolem"><span>P</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38252..38253"><span>M</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37730..37733"><span>fin</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.finite_elements|fact"><span>finite_elements</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_partition_def|fact"><span>regular_partition_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37189..37191"><span>M0</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38322..38328"><span>M_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38252..38253"><span>M</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_gt_0_iff|fact"><span>card_gt_0_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.partition_onD1|fact"><span>partition_onD1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.partition_on_empty|fact"><span>partition_on_empty</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_partition_def|fact"><span>regular_partition_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38092..38095"><span>vne</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?e4M</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_38609..38615">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>D</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>D</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?e4M</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>D</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38609..38615"><span>D_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.linordered_ring_strict_class.zero_less_mult_iff|fact"><span>zero_less_mult_iff</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>D0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="skolem"><span>D</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37368..37374"><span>D0_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38609..38615"><span>D_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="skolem"><span>M0</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.ordered_semiring_class.mult_mono|fact"><span>mult_mono</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.linordered_field_class.frac_le|fact"><span>frac_le</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38322..38328"><span>M_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="comment1"><span>(</span><span>*</span><span> a reminder: as it is implied we have: </span><span>*</span><span>)</span></span><span>  
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_38968..38976">fin_part</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.finite_graph_partition|const"><span>finite_graph_partition</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38252..38253"><span>M</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_partition_def|fact"><span>regular_partition_def</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.finite_graph_partition_def|fact"><span>finite_graph_partition_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38322..38328"><span>M_def</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_gt_0_iff|fact"><span>card_gt_0_iff</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_39145..39149">have</span></span></span><span> </span><span class="entity_def" id="offset_39150..39155">fin_P</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="skolem"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_39172..39182">card_P_gt0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>R</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="skolem"><span>P</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>R</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37730..37733"><span>fin</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.finite_graph_partition_finite|fact"><span>finite_graph_partition_finite</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.finite_graph_partition_gt0|fact"><span>finite_graph_partition_gt0</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_39145..39149"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_39302..39306">have</span></span></span><span> </span><span class="entity_def" id="offset_39307..39316">card_P_le</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="var"><span>?n</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>R</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="skolem"><span>P</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>R</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37730..37733"><span>fin</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38968..38976"><span>fin_part</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.finite_graph_partition_le|fact"><span>finite_graph_partition_le</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_39302..39306"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>meson</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_39421..39429">P_disjnt</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â¦</span></span><span class="bound"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="bound"><span>S</span></span><span class="main"><span>;</span></span><span> </span><span class="bound"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span class="main"><span>;</span></span><span> </span><span class="bound"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>â©</span></a></span><span> </span><span class="bound"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38968..38976"><span>fin_part</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjnt_def|fact"><span>disjnt_def</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.finite_graph_partition_def|fact"><span>finite_graph_partition_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert_absorb|fact"><span>insert_absorb</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.pairwise_insert|fact"><span>pairwise_insert</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.partition_on_def|fact"><span>partition_on_def</span></a><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_39607..39617">sum_card_P</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>R</span></span><span class="main"><span>â</span></span><span class="skolem"><span>P</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>R</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?n</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.card_finite_graph_partition|fact"><span>card_finite_graph_partition</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37730..37733"><span>fin</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38968..38976"><span>fin_part</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>meson</span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Step 2. Cleaning. For each ordered pair of parts $(P_i,P_j)$, remove all edges between 
</span><span>      $P_i$ and $P_j$ if (a) it is an irregular pair, (b) its edge density ${} &lt; \epsilon/2$, 
</span><span>      (c) either $P_i$ or $P_j$ is small (${}\le(\epsilon/4M)n$)
</span><span>    Process (a) removes at most $(\epsilon/4)n^2$ edges. 
</span><span>    Process (b) removes at most $(\epsilon/2)n^2$ edges.
</span><span>    Process (c) removes at most $(\epsilon/4)n^2$ edges. 
</span><span>   The remaining graph is triangle-free for some choice of $\delta$.
</span><span>   We call the graph obtained after this process </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span class="free"><span>Gnew</span></span></span><span class="antiquote"><span>}</span></span></span><span>.</span><span>  </span><span>âº</span></span></span><span>
    
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_40282..40288">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>edge</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>edge</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.mk_uedge|const"><span>mk_uedge</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_40361..40373">edge_commute</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>edge</span></span><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>edge</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>force</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40282..40288"><span>edge_def</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_swap|fact"><span>all_edges_between_swap</span></a><span> </span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="skolem"><span>S</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.split|fact"><span>prod.split</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_40498..40515">card_edge_le_card</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>edge</span></span><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_image_le|fact"><span>card_image_le</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40282..40288"><span>edge_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37730..37733"><span>fin</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.finite_all_edges_between&apos;|fact"><span>finite_all_edges_between'</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37696..37698"><span>local.wf</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_40663..40667">have</span></span></span><span> </span><span class="entity_def" id="offset_40668..40680">card_edge_le</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>edge</span></span><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>S</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>R</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="skolem"><span>P</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>S</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="skolem"><span>P</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40498..40515"><span>card_edge_le_card</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_39150..39155"><span>fin_P</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_trans|fact"><span>le_trans</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.max_all_edges_between|fact"><span>max_all_edges_between</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40663..40667"><span>that</span></a><span class="main"><span>)</span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Obtain the set of edges meeting condition (a).</span><span>âº</span></span></span><span>
    
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_40890..40896">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>irreg_pairs</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>irreg_pairs</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>R</span></span><span class="main"><span>,</span></span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.irregular_pair|const"><span>irregular_pair</span></a><span> </span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_40987..40993">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Ea</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ea</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="main"><span>(</span></span><span class="bound"><span>R</span></span><span class="main"><span>,</span></span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>irreg_pairs</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>edge</span></span><span> </span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Obtain the set of edges meeting condition (b).</span><span>âº</span></span></span><span>
    
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_41115..41121">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>low_density_pairs</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>low_density_pairs</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>R</span></span><span class="main"><span>,</span></span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Â¬</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.edge_dense|const"><span>edge_dense</span></a><span> </span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_41228..41234">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Eb</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Eb</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>low_density_pairs</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>edge</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Obtain the set of edges meeting condition (c).</span><span>âº</span></span></span><span>
    
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_41362..41368">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>small</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>small</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>R</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="var"><span>?e4M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?SMALL</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Collect|const"><span>Collect</span></a><span> </span><span class="skolem"><span>small</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_41459..41465">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>small_pairs</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>small_pairs</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>R</span></span><span class="main"><span>,</span></span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>small</span></span><span> </span><span class="bound"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>â¨</span></a></span><span> </span><span class="skolem"><span>small</span></span><span> </span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_41549..41555">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Ec</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ec</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>R</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="var"><span>?SMALL</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>S</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>P</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>edge</span></span><span> </span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_41613..41620">Ec_def'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ec</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>small_pairs</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>edge</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>force</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40361..40373"><span>edge_commute</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41459..41465"><span>small_pairs_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41362..41368"><span>small_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41549..41555"><span>Ec_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_41740..41747">eabound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>Ea</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>  </span><span class="comment1"><span>ââ¹</span><span>Count the edge bound for </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span class="skolem"><span>Ea</span></span></span><span class="antiquote"><span>}</span></span></span><span>âº</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_41838..41839">Â§</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â¦</span></span><span class="bound"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span class="main"><span>;</span></span><span> </span><span class="bound"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>edge</span></span><span> </span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>S</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40282..40288"><span>edge_def</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_image_le|fact"><span>card_image_le</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_39150..39155"><span>fin_P</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.finite_all_edges_between|fact"><span>finite_all_edges_between</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.max_all_edges_between|fact"><span>max_all_edges_between</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>irreg_pairs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="skolem"><span>P</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40890..40896"><span>irreg_pairs_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="skolem"><span>irreg_pairs</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="skolem"><span>P</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_SigmaI|fact"><span>finite_SigmaI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_subset|fact"><span>finite_subset</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>Ea</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="main"><span>(</span></span><span class="bound"><span>R</span></span><span class="main"><span>,</span></span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="skolem"><span>irreg_pairs</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>edge</span></span><span> </span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40987..40993"><span>Ea_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.card_UN_le|fact"><span>card_UN_le</span></a><span> </span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="skolem"><span>irreg_pairs</span></span><span>âº</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.case_prod_unfold|fact"><span>case_prod_unfold</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="main"><span>(</span></span><span class="bound"><span>R</span></span><span class="main"><span>,</span></span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>R</span></span><span class="main"><span>,</span></span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>R</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="skolem"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>S</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="skolem"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.irregular_pair|const"><span>irregular_pair</span></a><span> </span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40890..40896"><span>irreg_pairs_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41838..41839"><span>Â§</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>force</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.ordered_comm_monoid_add_class.sum_mono|fact"><span>sum_mono</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="main"><span>(</span></span><span class="bound"><span>R</span></span><span class="main"><span>,</span></span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.irregular_set|const"><span>irregular_set</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="skolem"><span>P</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.irregular_set_def|fact"><span>irregular_set_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>Ea</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="main"><span>(</span></span><span class="bound"><span>R</span></span><span class="main"><span>,</span></span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.irregular_set|const"><span>irregular_set</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="skolem"><span>P</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38252..38253"><span>M</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_partition_def|fact"><span>regular_partition_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_42801..42808">ebbound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>Eb</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  </span><span class="comment1"><span>ââ¹</span><span>Count the edge bound for </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span class="skolem"><span>Eb</span></span></span><span class="antiquote"><span>}</span></span></span><span>.</span><span>âº</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_42902..42906">subs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>low_density_pairs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="skolem"><span>P</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41115..41121"><span>low_density_pairs_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="skolem"><span>low_density_pairs</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="skolem"><span>P</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_SigmaI|fact"><span>finite_SigmaI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_subset|fact"><span>finite_subset</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>Eb</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="skolem"><span>low_density_pairs</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>edge</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41228..41234"><span>Eb_def</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_SIG</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="skolem"><span>low_density_pairs</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.card_UN_le|fact"><span>card_UN_le</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_mono|fact"><span>of_nat_mono</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.semiring_1_class.of_nat_sum|fact"><span>of_nat_sum</span></a><span> 
 </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.case_prod_unfold|fact"><span>case_prod_unfold</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.ordered_comm_monoid_add_class.sum_mono|fact"><span>sum_mono</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="main"><span>(</span></span><span class="bound"><span>R</span></span><span class="main"><span>,</span></span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="skolem"><span>low_density_pairs</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.ordered_comm_monoid_add_class.sum_mono|fact"><span>sum_mono</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.divide_simps|fact"><span class="dynamic"><span class="dynamic"><span>divide_simps</span></span></span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_39172..39182"><span>card_P_gt0</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41115..41121"><span>low_density_pairs_def</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density_def|fact"><span>edge_density_def</span></a><span> 
 </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.edge_dense_def|fact"><span>edge_dense_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40498..40515"><span>card_edge_le_card</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_le_iff|fact"><span>of_nat_le_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.semigroup_mult_class.mult.assoc|fact"><span>mult.assoc</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="main"><span>(</span></span><span class="bound"><span>R</span></span><span class="main"><span>,</span></span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="skolem"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="skolem"><span>P</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_42902..42906"><span>subs</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.ordered_comm_monoid_add_class.sum_mono2|fact"><span>sum_mono2</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="skolem"><span>P</span></span><span>âº</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="main"><span>(</span></span><span class="bound"><span>R</span></span><span class="main"><span>,</span></span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="skolem"><span>P</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="skolem"><span>P</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.semiring_0_class.sum_distrib_left|fact"><span>sum_distrib_left</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.case_prod_unfold|fact"><span>case_prod_unfold</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.mult_ac|fact"><span>mult_ac</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.sum_prod_le_prod_sum|fact"><span>sum_prod_le_prod_sum</span></a><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.monoid_mult_class.power2_eq_square|fact"><span>power2_eq_square</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.sum_product|fact"><span>sum_product</span></a><span> </span><span class="quasi_keyword"><span>flip</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.comm_monoid_add_class.sum.cartesian_product|fact"><span>sum.cartesian_product</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_39607..39617"><span>sum_card_P</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_44072..44079">ecbound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>Ec</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  </span><span class="comment1"><span>ââ¹</span><span>Count the edge bound for </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span class="skolem"><span>Ec</span></span></span><span class="antiquote"><span>}</span></span></span><span>.</span><span>âº</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span> 
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_44168..44172">have</span></span></span><span> </span><span>edge_bound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>edge</span></span><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="var"><span>?e4M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>small</span></span><span> </span><span class="skolem"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span>
      </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>R</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_44168..44172"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41362..41368"><span>small_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_39307..39316"><span>card_P_le</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>S</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="skolem"><span>P</span></span><span>âº</span></span></span><span class="main"><span>]</span></span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>*</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>R</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.ordered_semiring_class.mult_mono|fact"><span>mult_mono</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_0_le_iff|fact"><span>of_nat_0_le_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_mono|fact"><span>of_nat_mono</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order.trans|fact"><span>order.trans</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?e4M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.monoid_mult_class.power2_eq_square|fact"><span>power2_eq_square</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40668..40680"><span>card_edge_le</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_mono|fact"><span>of_nat_mono</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.semiring_1_class.of_nat_mult|fact"><span>of_nat_mult</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41362..41368"><span>small_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_44168..44172"><span>that</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>subs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?SMALL</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41362..41368"><span>small_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="entity_def" id="offset_44842..44849">card_sp</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="var"><span>?SMALL</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="var"><span>?SMALL</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38322..38328"><span>M_def</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="skolem"><span>P</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_mono|fact"><span>card_mono</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_subset|fact"><span>finite_subset</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>Ec</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>R</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="var"><span>?SMALL</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>S</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>P</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>edge</span></span><span> </span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41549..41555"><span>Ec_def</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_SIG</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="var"><span>?SMALL</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.card_UN_le|fact"><span>card_UN_le</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_mono|fact"><span>of_nat_mono</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.semiring_1_class.of_nat_sum|fact"><span>of_nat_sum</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.case_prod_unfold|fact"><span>case_prod_unfold</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.ordered_comm_monoid_add_class.sum_mono|fact"><span>sum_mono</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>R</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="var"><span>?SMALL</span></span><span class="main"><span>.</span></span><span> </span><span class="var"><span>?e4M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.ordered_comm_monoid_add_class.sum_mono|fact"><span>sum_mono</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span>i</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Collect|const"><span>Collect</span></a><span> </span><span class="skolem"><span>small</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>R</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="skolem"><span>P</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_45319..45326">card_Pi</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="var"><span>?e4M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41362..41368"><span>small_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?UE</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Union|const"><span>â</span></a></span><span class="main"><span>(</span></span><span class="skolem"><span>edge</span></span><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>P</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>*</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?UE</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
          </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?UE</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.mk_uedge|const"><span>mk_uedge</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40282..40288"><span>edge_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.UN_subset_iff|fact"><span>UN_subset_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Ball_def|fact"><span>Ball_def</span></a><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.all_edges_between_mono2|fact"><span>all_edges_between_mono2</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38968..38976"><span>fin_part</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.finite_graph_partition_subset|fact"><span>finite_graph_partition_subset</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_mono|fact"><span>image_mono</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?UE</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_image_le|fact"><span>card_image_le</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_mono|fact"><span>card_mono</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37730..37733"><span>fin</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.finite_all_edges_between&apos;|fact"><span>finite_all_edges_between'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_imageI|fact"><span>finite_imageI</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37696..37698"><span>wf</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.le_trans|fact"><span>le_trans</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_mono|fact"><span>of_nat_mono</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37730..37733"><span>fin</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_39150..39155"><span>fin_P</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.max_all_edges_between|fact"><span>max_all_edges_between</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order.trans|fact"><span>order.trans</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>R</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="skolem"><span>P</span></span><span>âº</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="var"><span>?e4M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power2|const"><span><span class="hidden">â§</span><sup>2</sup></span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_45319..45326"><span>card_Pi</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="var"><span>?n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>force</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.divide_simps|fact"><span class="dynamic"><span class="dynamic"><span>divide_simps</span></span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.monoid_mult_class.power2_eq_square|fact"><span>power2_eq_square</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?UE</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="var"><span>?e4M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power2|const"><span><span class="hidden">â§</span><sup>2</sup></span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?SMALL</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?e4M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?e4M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_36006..36009"><span>egt</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.ordered_semiring_class.mult_right_mono|fact"><span>mult_right_mono</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_44842..44849"><span>card_sp</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="comment1"><span>ââ¹</span><span>total count</span><span>âº</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>prev1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Ea</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>Eb</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>Ec</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Ea</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>Eb</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>Ec</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_Un_le|fact"><span>card_Un_le</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>Ea</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>Eb</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>Ec</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_Un_le|fact"><span>card_Un_le</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>prev</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41740..41747"><span>eabound</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_42801..42808"><span>ebbound</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_44072..44079"><span>ecbound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_46828..46841">cutedgesbound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Ea</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>Eb</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>Ec</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_46891..46897">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Gnew</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Ea</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>Eb</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>Ec</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>Gnew</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="var"><span>?Î¦</span></span><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="bound"><span>Gnew</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exI|fact"><span>exI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="entity_def" id="offset_47023..47028">verts</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_46891..46897"><span>Gnew_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_47090..47095">allij</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>edge</span></span><span> </span><span class="bound"><span>R</span></span><span> </span><span class="bound"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.all_edges_between_ss_uedges|fact"><span>all_edges_between_ss_uedges</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40282..40288"><span>edge_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Presburger.html#Presburger.presburger|method"><span class="operator"><span>presburger</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_47207..47210">eae</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ea</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40987..40993"><span>Ea_def</span></a><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_47263..47266">eab</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Eb</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_47090..47095"><span>allij</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41228..41234"><span>Eb_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ec</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_47090..47095"><span>allij</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41549..41555"><span>Ec_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_47397..47406">diffedges</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>Ea</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>Eb</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>Ec</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_47207..47210"><span>eae</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_47263..47266"><span>eab</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="entity_def" id="offset_47483..47488">edges</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span>  
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_46891..46897"><span>Gnew_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>â©</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Ea</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>Eb</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>Ec</span></span><span class="main"><span>)</span></span><span> </span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_46891..46897"><span>Gnew_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Diff_Diff_Int|fact"><span>Diff_Diff_Int</span></a><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Ea</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>Eb</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>Ec</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_47397..47406"><span>diffedges</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Int_absorb1|fact"><span>Int_absorb1</span></a><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_47797..47806">cardbound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_46828..46841"><span>cutedgesbound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_47901..47920">graph_partition_new</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.finite_graph_partition|const"><span>finite_graph_partition</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_47023..47028"><span>verts</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38968..38976"><span>fin_part</span></a><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_48021..48027">new_wf</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.subgraph_edge_wf|fact"><span>subgraph_edge_wf</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_47023..47028"><span>verts</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_47483..47488"><span>edges</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37696..37698"><span>wf</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_48105..48112">new_fin</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_47023..47028"><span>verts</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37730..37733"><span>fin</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      
      </span><span class="keyword1"><span class="command"><span>text</span></span></span><span class="quoted"><span class="plain_text"><span>â¹</span><span> </span><span>The notes by Bell and Grodzicki are quite useful for understanding the lines below.
</span><span>         See pg 4 in the middle after the summary of the min edge counts.</span><span>âº</span></span></span><span>
      
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>irreg_pairs_swap</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>R</span></span><span class="main"><span>,</span></span><span class="skolem"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>irreg_pairs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>â·</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>S</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>R</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>irreg_pairs</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40890..40896"><span>irreg_pairs_def</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_pair_commute|fact"><span>regular_pair_commute</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>low_density_pairs_swap</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>R</span></span><span class="main"><span>,</span></span><span class="skolem"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>low_density_pairs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>â·</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>S</span></span><span class="main"><span>,</span></span><span class="skolem"><span>R</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>low_density_pairs</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41115..41121"><span>low_density_pairs_def</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density_commute|fact"><span>edge_density_commute</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.edge_dense_def|fact"><span>edge_dense_def</span></a><span class="main"><span>)</span></span><span>
           </span><span class="main"><span>(</span></span><span class="operator"><span>use</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_swap|fact"><span>all_edges_between_swap</span></a><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>small_pairs_swap</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>R</span></span><span class="main"><span>,</span></span><span class="skolem"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>small_pairs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>â·</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>S</span></span><span class="main"><span>,</span></span><span class="skolem"><span>R</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>small_pairs</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41459..41465"><span>small_pairs_def</span></a><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_48846..48850">have</span></span></span><span> </span><span class="entity_def" id="offset_48851..48863">all_edges_if</span><span class="main"><span>:</span></span><span> 
        </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> 
         </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>R</span></span><span class="main"><span>,</span></span><span class="skolem"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>irreg_pairs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>low_density_pairs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>small_pairs</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span> 
            </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
        </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_49063..49065">ij</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span>
      </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
        </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_48846..48850"><span>that</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38968..38976"><span>fin_part</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_46891..46897"><span>Gnew_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40987..40993"><span>Ea_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41228..41234"><span>Eb_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41613..41620"><span>Ec_def'</span></a><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.all_edges_between_E_diff|fact"><span>all_edges_between_E_diff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.all_edges_between_E_Un|fact"><span>all_edges_between_E_Un</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.all_edges_between_E_UN|fact"><span>all_edges_between_E_UN</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40282..40288"><span>edge_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.in_mk_uedge_img_iff|fact"><span>in_mk_uedge_img_iff</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_49414..49418">have</span></span></span><span> </span><span class="entity_def" id="offset_49419..49421">Ea</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>V</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>Ea</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>  
          </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>R</span></span><span class="main"><span>,</span></span><span class="skolem"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>irreg_pairs</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>V</span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_49063..49065"><span>ij</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_49414..49418"><span>that</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_39421..39429"><span>P_disjnt</span></a><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40987..40993"><span>Ea_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40282..40288"><span>edge_def</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40890..40896"><span>irreg_pairs_def</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> 
              </span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_pair_commute|fact"><span>regular_pair_commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjoint_iff_not_equal|fact"><span>disjoint_iff_not_equal</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_49707..49711">have</span></span></span><span> </span><span class="entity_def" id="offset_49712..49714">Eb</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>V</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>Eb</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>  
          </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>R</span></span><span class="main"><span>,</span></span><span class="skolem"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>low_density_pairs</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>V</span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_49063..49065"><span>ij</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_49707..49711"><span>that</span></a><span>  
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41228..41234"><span>Eb_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40282..40288"><span>edge_def</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41115..41121"><span>low_density_pairs_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.edge_dense_def|fact"><span>edge_dense_def</span></a><span class="main"><span>)</span></span><span>
           </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.IntI|fact"><span>IntI</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_39421..39429"><span>P_disjnt</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density_commute|fact"><span>edge_density_commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.equals0D|fact"><span>equals0D</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_50045..50049">have</span></span></span><span> </span><span class="entity_def" id="offset_50050..50052">Ec</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between|const"><span>all_edges_between</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>V</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>Ec</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>
          </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>R</span></span><span class="main"><span>,</span></span><span class="skolem"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>small_pairs</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>V</span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_49063..49065"><span>ij</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_50045..50049"><span>that</span></a><span> 
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41613..41620"><span>Ec_def'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40282..40288"><span>edge_def</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41459..41465"><span>small_pairs_def</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span>
              </span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_39421..39429"><span>P_disjnt</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjoint_iff|fact"><span>disjoint_iff</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?rhs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="var"><span>?lhs</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_46891..46897"><span>Gnew_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_49419..49421"><span>Ea</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_49712..49714"><span>Eb</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_50050..50052"><span>Ec</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.all_edges_between_E_diff|fact"><span>all_edges_between_E_diff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.all_edges_between_E_Un|fact"><span>all_edges_between_E_Un</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

      </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_50438..50442">have</span></span></span><span> </span><span class="entity_def" id="offset_50443..50445">rp</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_pair|const"><span>regular_pair</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_50480..50482">ij</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span>"</span></span></span><span>  </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span>
      </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>R</span></span><span class="main"><span>,</span></span><span class="skolem"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>irreg_pairs</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_50564..50569">False</span><span>
        </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_50578..50582">have</span></span></span><span> </span><span class="entity_def" id="offset_50583..50585">ed</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>X</span></span><span> </span><span class="skolem"><span>Y</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span>
            </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>R</span></span><span class="main"><span>,</span></span><span class="skolem"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>irreg_pairs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>low_density_pairs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>small_pairs</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>
             </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>X</span></span><span> </span><span class="skolem"><span>Y</span></span><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
          </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>R</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>S</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>X</span></span><span> </span><span class="skolem"><span>Y</span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_48851..48863"><span>all_edges_if</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_50578..50582"><span>that</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_50480..50482"><span>ij</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_50564..50569"><span>False</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.all_edges_preserved|fact"><span>all_edges_preserved</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.edge_density_eq0|fact"><span>edge_density_eq0</span></a><span> 
</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density_def|fact"><span>edge_density_def</span></a><span class="main"><span>)</span></span><span> 
        </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_50438..50442"><span>that</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_50564..50569"><span>False</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_40890..40896"><span>irreg_pairs_def</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_pair_def|fact"><span>regular_pair_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.order_class.less_le|fact"><span>less_le</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_50583..50585"><span>ed</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
        </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_51054..51058">have</span></span></span><span> </span><span class="entity_def" id="offset_51059..51061">ed</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>X</span></span><span> </span><span class="skolem"><span>Y</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>  </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>R</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>S</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>X</span></span><span> </span><span class="skolem"><span>Y</span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.edge_density_eq0|fact"><span>edge_density_eq0</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_48851..48863"><span>all_edges_if</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_51054..51058"><span>that</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UnCI|fact"><span>UnCI</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_36006..36009"><span>egt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_50438..50442"><span>that</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.regular_pair_def|fact"><span>regular_pair_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_51059..51061"><span>ed</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>reg_pairs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.regular_graph|const"><span>regular_graph</span></a><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.regular_graph_def|fact"><span>regular_graph_def</span></a><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_51387..51391">have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.edge_dense|const"><span>edge_dense</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
        </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>P</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span>
      </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>R</span></span><span class="main"><span>,</span></span><span class="skolem"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>low_density_pairs</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_51517..51522">False</span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>ed</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span>
            </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>if</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>R</span></span><span class="main"><span>,</span></span><span class="skolem"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>irreg_pairs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>low_density_pairs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>small_pairs</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>then</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>
             </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.If|const"><span>else</span></a></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_48851..48863"><span>all_edges_if</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_51387..51391"><span>that</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_51387..51391"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density_def|fact"><span>edge_density_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_51387..51391"><span>that</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_51517..51522"><span>False</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41115..41121"><span>low_density_pairs_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.edge_dense_def|fact"><span>edge_dense_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_48851..48863"><span>all_edges_if</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
        </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_51898..51902">True</span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_48851..48863"><span>all_edges_if</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density_def|fact"><span>edge_density_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_51387..51391"><span>that</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_51387..51391"><span>that</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_51898..51902"><span>True</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_48851..48863"><span>all_edges_if</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.edge_dense_def|fact"><span>edge_dense_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_52133..52146">density_bound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.dense_graph|const"><span>dense_graph</span></a><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.dense_graph_def|fact"><span>dense_graph_def</span></a><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_52222..52237">min_subset_size</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.decent_graph|const"><span>decent_graph</span></a><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?e4M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.decent_graph_def|fact"><span>decent_graph_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41459..41465"><span>small_pairs_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_41362..41368"><span>small_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.decent_def|fact"><span>decent_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_48851..48863"><span>all_edges_if</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_free_graph|const"><span>triangle_free_graph</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ccontr|fact"><span>ccontr</span></a><span class="main"><span>)</span></span><span> 
        </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_52467..52470">non</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Â¬</span></a></span><span class="var"><span>?thesis</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>z</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_52515..52522">trig_ex</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span>"</span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_free_graph_def|fact"><span>triangle_free_graph_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52467..52470"><span>non</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_52626..52629">xin</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_52655..52658">yin</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_52684..52687">zin</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_verts|fact"><span>triangle_in_graph_verts</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_48021..48027"><span>new_wf</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>R</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_52793..52797">xinp</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>R</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_52811..52814">ilt</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>R</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="skolem"><span>P</span></span><span>"</span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_47901..47920"><span>graph_partition_new</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.finite_graph_partition_obtain|fact"><span>finite_graph_partition_obtain</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52626..52629"><span>xin</span></a><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>S</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_52931..52935">yinp</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>S</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_52949..52952">jlt</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>S</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="skolem"><span>P</span></span><span>"</span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_47901..47920"><span>graph_partition_new</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.finite_graph_partition_obtain|fact"><span>finite_graph_partition_obtain</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52655..52658"><span>yin</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>T</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_53068..53072">zinp</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>T</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_53086..53089">klt</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>T</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="skolem"><span>P</span></span><span>"</span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_47901..47920"><span>graph_partition_new</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.finite_graph_partition_obtain|fact"><span>finite_graph_partition_obtain</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52684..52687"><span>zin</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>finitesubsets</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="skolem"><span>R</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="skolem"><span>S</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="skolem"><span>T</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52811..52814"><span>ilt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52949..52952"><span>jlt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_53086..53089"><span>klt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_48105..48112"><span>new_fin</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38968..38976"><span>fin_part</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.finite_graph_partition_finite|fact"><span>finite_graph_partition_finite</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37730..37733"><span>fin</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_53338..53345">subsets</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>T</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span>"</span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.finite_graph_partition_subset|fact"><span>finite_graph_partition_subset</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52811..52814"><span>ilt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52949..52952"><span>jlt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_53086..53089"><span>klt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_47901..47920"><span>graph_partition_new</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_53501..53510">min_sizes</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="var"><span>?e4M</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="var"><span>?n</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="var"><span>?e4M</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="var"><span>?n</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="var"><span>?e4M</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="var"><span>?n</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52515..52522"><span>trig_ex</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52222..52237"><span>min_subset_size</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52793..52797"><span>xinp</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52931..52935"><span>yinp</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_53068..53072"><span>zinp</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52811..52814"><span>ilt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52949..52952"><span>jlt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_53086..53089"><span>klt</span></a><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.decent_graph_def|fact"><span>decent_graph_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.decent_def|fact"><span>decent_def</span></a><span> </span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.all_edges_between_def|fact"><span>all_edges_between_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>min_dens</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>2</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>2</span></span><span>"</span></span></span><span> 
</span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>2</span></span><span>"</span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52133..52146"><span>density_bound</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_53338..53345"><span>subsets</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52811..52814"><span>ilt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52949..52952"><span>jlt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_53086..53089"><span>klt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52793..52797"><span>xinp</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52931..52935"><span>yinp</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_53068..53072"><span>zinp</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.dense_graph_def|fact"><span>dense_graph_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.edge_dense_def|fact"><span>edge_dense_def</span></a><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.all_edges_betw_I|fact"><span>all_edges_betw_I</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.equals0D|fact"><span>equals0D</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52515..52522"><span>trig_ex</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_54051..54064">min_dens_diff</span><span class="main"><span>:</span></span><span> 
          </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span>"</span></span></span><span> 
</span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span>"</span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_54218..54226">mincard0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>R</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>T</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_54283..54289">gtcube</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_54051..54064"><span>min_dens_diff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37123..37127"><span>e4gt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.real_mult_gt_cube|fact"><span>real_mult_gt_cube</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> 
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_54480..54482">c1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37123..37127"><span>e4gt</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.linordered_semidom_class.zero_less_power|fact"><span>zero_less_power</span></a><span class="main"><span>)</span></span><span> 
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?e4M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_36006..36009"><span>egt</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?e4M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><span class="var"><span>?e4M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?e4M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_0_le_iff|fact"><span>of_nat_0_le_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.semiring_1_class.of_nat_mult|fact"><span>of_nat_mult</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_53501..53510"><span>min_sizes</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.ordered_semiring_class.mult_mono|fact"><span>mult_mono</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>R</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>T</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?e4M</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.monoid_mult_class.power3_eq_cube|fact"><span>power3_eq_cube</span></a><span class="main"><span>)</span></span><span> 
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_54982..54993">cardgtbound</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="var"><span>?e4M</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.semiring_1_class.of_nat_power|fact"><span>of_nat_power</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.comm_monoid_mult_class.power_mult_distrib|fact"><span>power_mult_distrib</span></a><span class="main"><span>)</span></span><span>

        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>T</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_54982..54993"><span>cardgtbound</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.ordered_comm_semiring_class.comm_mult_left_mono|fact"><span>ordered_comm_semiring_class.comm_mult_left_mono</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37111..37115"><span>True</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37123..37127"><span>e4gt</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
        </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="numeral"><span>2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Szemeredi_Regularity/Szemeredi.html#Szemeredi.edge_density|const"><span>edge_density</span></a><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>T</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_54283..54289"><span>gtcube</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_54480..54482"><span>c1</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_54218..54226"><span>mincard0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_mult_class.mult.commute|fact"><span>mult.commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_mult_class.mult.left_commute|fact"><span>mult.left_commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.ordered_semiring_class.mult_left_mono|fact"><span>mult_left_mono</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_triples|const"><span>triangle_triples</span></a><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>S</span></span><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37123..37127"><span>e4gt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52811..52814"><span>ilt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_52949..52952"><span>jlt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_53086..53089"><span>klt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_54051..54064"><span>min_dens_diff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_48105..48112"><span>new_fin</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_48021..48027"><span>new_wf</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_50443..50445"><span>rp</span></a><span>
 </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_53338..53345"><span>subsets</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_counting_lemma|fact"><span>triangle_counting_lemma</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="skolem"><span>D</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.card_convert_triangle_rep_bound|fact"><span>card_convert_triangle_rep_bound</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_48021..48027"><span>new_wf</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_48105..48112"><span>new_fin</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_53338..53345"><span>subsets</span></a><span> 
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_triples_def|fact"><span>triangle_triples_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38609..38615"><span>D_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_55933..55945">g_tset_bound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="skolem"><span>D</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_graph_edge_ss_bound|fact"><span>triangle_set_graph_edge_ss_bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_47483..47488"><span>edges</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37730..37733"><span>fin</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37696..37698"><span>local.wf</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_mono|fact"><span>of_nat_mono</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_47023..47028"><span>verts</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="skolem"><span>Î´</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
          </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_gt_0_iff|fact"><span>card_gt_0_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37730..37733"><span>fin</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37556..37557"><span>Î´</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>D0</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="skolem"><span>D</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>D</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="skolem"><span>Î´</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
          </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="skolem"><span>Î´</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span> 
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_55933..55945"><span>g_tset_bound</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_38609..38615"><span>D_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span> 
        </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
        </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_37875..37879"><span>ineq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
      </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power2|const"><span><span class="hidden">â§</span><sup>2</sup></span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_47797..47806"><span>cardbound</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_47483..47488"><span>edges</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_47023..47028"><span>verts</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>Î´</span></span><span>âº</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Roth's Theorem</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span class="quoted"><span class="plain_text"><span>â¹</span><span>We will first need the following corollary of the Triangle Removal Lemma.
</span><span>This is Corollary 3.18 in Zhao's notes:</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_56811..56820">corollary</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.corollary_triangle_removal|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.corollary_triangle_removal|thm"><span>corollary_triangle_removal</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>N</span></span></span><span class="main"><span>&gt;</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>â</span></a></span><span class="bound"><span>G</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="bound"><span>N</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>â¶</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="bound"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>â¶</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.unique_triangles|const"><span>unique_triangles</span></a><span> </span><span class="bound"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>â¶</span></a></span><span>
          </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power2|const"><span><span class="hidden">â§</span><sup>2</sup></span></a></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_56811..56820"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Î´</span></span></span><span class="main"><span>::</span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Î´</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_57109..57110">Î´</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>G</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â¦</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>;</span></span><span>
          </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="skolem"><span>Î´</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span> </span><span class="numeral"><span>3</span></span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>â¹</span></span><span>
          </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>Gnew</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_free_graph|const"><span>triangle_free_graph</span></a><span> </span><span class="bound"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="bound"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="bound"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="bound"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> 
          </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="bound"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="bound"><span>Gnew</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power2|const"><span><span class="hidden">â§</span><sup>2</sup></span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_removal_lemma|fact"><span>triangle_removal_lemma</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>N</span></span></span><span class="main"><span>::</span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_57445..57446">N</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="skolem"><span>N</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>â¥</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>3</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="skolem"><span>Î´</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Archimedean_Field.html#Archimedean_Field.real_arch_simple|fact"><span>real_arch_simple</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exI|fact"><span>exI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.strip|fact"><span>strip</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>N</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57445..57446"><span>N</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>Î´</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.canonically_ordered_monoid_add_class.zero_less_iff_neq_zero|fact"><span>zero_less_iff_neq_zero</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>G</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?n</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_57676..57682">G_gt_N</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>N</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="var"><span>?n</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_57703..57705">wf</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_57733..57737">uniq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.unique_triangles|const"><span>unique_triangles</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_57769..57773">G_ne</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57676..57682"><span>G_gt_N</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
    </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>TF</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_57835..57837">TF</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>e</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="skolem"><span>TF</span></span><span> </span><span class="bound"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span class="bound"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>TF</span></span><span> </span><span class="bound"><span>e</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57733..57737"><span>uniq</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.unique_triangles_def|fact"><span>unique_triangles_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
    </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?TWO</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>t</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Ramsey.html#Ramsey.nsets|const"><span>[</span></a></span><span class="bound"><span>t</span></span><span>]â</span><span class="numeral"><span>2</span></span><span>â</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_58013..58017">have</span></span></span><span> </span><span class="entity_def" id="offset_58018..58029">tri_nsets_2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Ramsey.html#Ramsey.nsets|const"><span>[</span></a></span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>}</span></span><span>]â</span><span class="numeral"><span>2</span></span><span>â </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>}</span></span><span class="main"><span>,</span></span><span class="main"><span>{</span></span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>}</span></span><span class="main"><span>,</span></span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>}</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>z</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_58013..58017"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Ramsey.html#Ramsey.nsets_def|fact"><span>nsets_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.card_2_iff|fact"><span>card_2_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>blast</span></span><span> </span><span class="quasi_keyword"><span>dest</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.edge_vertices_not_equal|fact"><span>edge_vertices_not_equal</span></a><span> </span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57703..57705"><span>wf</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_58256..58260">have</span></span></span><span> </span><span class="entity_def" id="offset_58261..58272">tri_nsets_3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>}</span></span><span class="main"><span>,</span></span><span class="main"><span>{</span></span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>}</span></span><span class="main"><span>,</span></span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>}</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Ramsey.html#Ramsey.nsets|const"><span>[</span></a></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span>]â</span><span class="numeral"><span>3</span></span><span>â</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>z</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_58256..58260"><span>that</span></a><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Ramsey.html#Ramsey.nsets_def|fact"><span>nsets_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.card_3_iff|fact"><span>card_3_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span> 
</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.edge_vertices_not_equal|fact"><span>edge_vertices_not_equal</span></a><span> </span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57703..57705"><span>wf</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_58502..58505">sub</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?TWO</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Ramsey.html#Ramsey.nsets|const"><span>[</span></a></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span>]â</span><span class="numeral"><span>3</span></span><span>â</span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_58018..58029"><span>tri_nsets_2</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_58261..58272"><span>tri_nsets_3</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_def|fact"><span>triangle_set_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="var"><span>?TWO</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_58018..58029"><span>tri_nsets_2</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_def|fact"><span>triangle_set_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_58723..58727">dfam</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.disjoint_family_on|const"><span>disjoint_family_on</span></a><span> </span><span class="var"><span>?TWO</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_58502..58505"><span>sub</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>unfolded</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_subset_iff|fact"><span>image_subset_iff</span></a><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57733..57737"><span>uniq</span></a><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.disjoint_family_on_def|fact"><span>disjoint_family_on_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_def|fact"><span>triangle_set_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Ramsey.html#Ramsey.nsets_def|fact"><span>nsets_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.unique_triangles_def|fact"><span>unique_triangles_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjoint_iff_not_equal|fact"><span>disjoint_iff_not_equal</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert_subset|fact"><span>insert_subset</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.mem_Collect_eq|fact"><span>mem_Collect_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.mk_disjoint_insert|fact"><span>mk_disjoint_insert</span></a><span> </span><span class="main"><span>)</span></span><span>  
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>inj</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_on|const"><span>inj_on</span></a><span> </span><span class="var"><span>?TWO</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.disjoint_family_on_iff_disjoint_image|fact"><span>disjoint_family_on_iff_disjoint_image</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_59124..59128">have</span></span></span><span> </span><span>Â§</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>T</span></span><span class="main"><span>â</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Ramsey.html#Ramsey.nsets|const"><span>[</span></a></span><span class="bound"><span>T</span></span><span>]â</span><span class="numeral"><span>2</span></span><span>â</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>e</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57733..57737"><span>uniq</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>unfolded</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.unique_triangles_def|fact"><span>unique_triangles_def</span></a><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_59124..59128"><span>that</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57703..57705"><span>local.wf</span></a><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_def|fact"><span>triangle_set_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Ramsey.html#Ramsey.nsets_def|fact"><span>nsets_def</span></a><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed_def|fact"><span>uwellformed_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>mono_tags</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite.emptyI|fact"><span>finite.emptyI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite.insertI|fact"><span>finite.insertI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_subset|fact"><span>finite_subset</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_58502..58505"><span>sub</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Union|const"><span>â</span></a></span><span class="main"><span>(</span></span><span class="var"><span>?TWO</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_subset_iff|fact"><span>image_subset_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Ramsey.html#Ramsey.nsets_def|fact"><span>nsets_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Union|const"><span>â</span></a></span><span class="main"><span>(</span></span><span class="var"><span>?TWO</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Complete_Lattices.html#Complete_Lattices.Union|const"><span>â</span></a></span><span class="main"><span>(</span></span><span class="var"><span>?TWO</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Disjoint_Sets.html#Disjoint_Sets.card_UN_disjoint&apos;|fact"><span>card_UN_disjoint'</span></a><span> </span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_58723..58727"><span>dfam</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_59738..59742">show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Ramsey.html#Ramsey.nsets|const"><span>[</span></a></span><span class="skolem"><span>i</span></span><span>]â</span><span class="numeral"><span>2</span></span><span>â</span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>i</span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_59738..59742"><span>that</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_58018..58029"><span>tri_nsets_2</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_def|fact"><span>triangle_set_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
      </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57769..57773"><span>G_ne</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_gt_0_iff|fact"><span>card_gt_0_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57703..57705"><span>local.wf</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_finite|fact"><span>triangle_set_finite</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_59963..59967">have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Ramsey.html#Ramsey.nsets|const"><span>[</span></a></span><span class="skolem"><span>i</span></span><span>]â</span><span class="numeral"><span>2</span></span><span>â</span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="numeral"><span>3</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>i</span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_59963..59967"><span>that</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57703..57705"><span>wf</span></a><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_def|fact"><span>triangle_set_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed_def|fact"><span>uwellformed_def</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>z3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_subset_iff|fact"><span>image_subset_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.mem_Collect_eq|fact"><span>mem_Collect_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Ramsey.html#Ramsey.nsets_def|fact"><span>nsets_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_58502..58505"><span>sub</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_59963..59967"><span>that</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Ramsey.html#Ramsey.nsets|const"><span>[</span></a></span><span class="bound"><span>i</span></span><span>]â</span><span class="numeral"><span>2</span></span><span>â</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_60311..60312">A</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.all_edges|const"><span>all_edges</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57769..57773"><span>G_ne</span></a><span> </span><a class="entity_ref" href="../Random_Graph_Subgraph_Threshold/Ugraph_Lemmas.html#Ugraph_Lemmas.all_edges_finite|fact"><span>all_edges_finite</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_gt_0_iff|fact"><span>card_gt_0_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_mono|fact"><span>card_mono</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57703..57705"><span>local.wf</span></a><span> </span><a class="entity_ref" href="../Random_Graph_Subgraph_Threshold/Ugraph_Lemmas.html#Ugraph_Lemmas.wellformed_all_edges|fact"><span>wellformed_all_edges</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Binomial.html#Binomial.binomial|const"><span>choose</span></a></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57769..57773"><span>G_ne</span></a><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.card_all_edges|fact"><span>card_all_edges</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_eq_0_iff|fact"><span>card_eq_0_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.not_less0|fact"><span>not_less0</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.divide_class.divide|const"><span>div</span></a></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Girth_Chromatic_Misc.html#Girth_Chromatic_Misc.n_choose_2_nat|fact"><span>n_choose_2_nat</span></a><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power2|const"><span><span class="hidden">â§</span><sup>2</sup></span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57769..57773"><span>G_ne</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_imp_diff_less|fact"><span>less_imp_diff_less</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.less_mult_imp_div_less|fact"><span>less_mult_imp_div_less</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.monoid_mult_class.power2_eq_square|fact"><span>power2_eq_square</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_60871..60872">B</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power2|const"><span><span class="hidden">â§</span><sup>2</sup></span></a></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power2|const"><span><span class="hidden">â§</span><sup>2</sup></span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_60311..60312"><span>A</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_60871..60872"><span>B</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="skolem"><span>Î´</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span> </span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="skolem"><span>Î´</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="skolem"><span>N</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57445..57446"><span>N</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>Î´</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.field_simps|fact"><span class="dynamic"><span class="dynamic"><span>field_simps</span></span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="skolem"><span>Î´</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57676..57682"><span>G_gt_N</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>Î´</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="skolem"><span>Î´</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57769..57773"><span>G_ne</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.eval_nat_numeral|fact"><span>eval_nat_numeral</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.mult_ac|fact"><span>mult_ac</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="skolem"><span>Î´</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power|const"><span>^</span></a></span><span> </span><span class="numeral"><span>3</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Gnew</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_61451..61455">Gnew</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_free_graph|const"><span>triangle_free_graph</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> 
      </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_61545..61559">card_edge_diff</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power2|const"><span><span class="hidden">â§</span><sup>2</sup></span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57769..57773"><span>G_ne</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57109..57110"><span>Î´</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57703..57705"><span>local.wf</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>meson</span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Deleting an edge removes at most one triangle from the graph by assumption,
</span><span>         so the number of edges removed in this process is at least the number of triangles.</span><span>âº</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a></span><span>
      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_61856..61859">non</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>e</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="skolem"><span>TF</span></span><span> </span><span class="bound"><span>e</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_61923..61926">tri</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>z</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>Â¬</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>z</span></span><span> </span><span class="skolem"><span>Gnew</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_61451..61455"><span>Gnew</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_free_graph_def|fact"><span>triangle_free_graph_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
      </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_61923..61926"><span>tri</span></a><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>e</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_62104..62106">eG</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>esub</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert_commute|fact"><span>insert_commute</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.DiffD1|fact"><span>DiffD1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57835..57837"><span>TF</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_61923..61926"><span>tri</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57733..57737"><span>uniq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.unique_triangles_def|fact"><span>unique_triangles_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_61856..61859"><span>non</span></a><span> </span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_62104..62106"><span>eG</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>TF</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set_def|fact"><span>triangle_set_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57769..57773"><span>G_ne</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_gt_0_iff|fact"><span>card_gt_0_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_Diff|fact"><span>finite_Diff</span></a><span> </span><a class="entity_ref" href="../Random_Graph_Subgraph_Threshold/Ugraph_Lemmas.html#Ugraph_Lemmas.finite_graph_def|fact"><span>finite_graph_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_57703..57705"><span>wf</span></a><span> </span><a class="entity_ref" href="../Random_Graph_Subgraph_Threshold/Ugraph_Lemmas.html#Ugraph_Lemmas.wellformed_finite|fact"><span>wellformed_finite</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_set|const"><span>triangle_set</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>Gnew</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.surj_card_le|fact"><span>surj_card_le</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power2|const"><span><span class="hidden">â§</span><sup>2</sup></span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_60311..60312"><span>A</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_61545..61559"><span>card_edge_diff</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span class="quoted"><span class="plain_text"><span>â¹</span><span>We are now ready to proceed to the proof of Roth's Theorem for Arithmetic Progressions.</span><span> </span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Roth_Arithmetic_Progressions.progression3_def|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.progression3_def|thm"><span class="entity_def" id="Roth_Arithmetic_Progressions.progression3_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Roth_Arithmetic_Progressions.progression3|const"><span>progression3</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.comm_monoid_add|class"><span>comm_monoid_add</span></a><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>progression3</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.p3_int_iff|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.p3_int_iff|thm"><span>p3_int_iff</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.progression3|const"><span>progression3</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>â·</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.progression3|const"><span>progression3</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.progression3_def|fact"><span>progression3_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_iff|fact"><span>image_iff</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/SMT.html#SMT.int_plus|fact"><span>int_plus</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.semiring_char_0_class.of_nat_eq_iff|fact"><span>of_nat_eq_iff</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span class="quoted"><span class="plain_text"><span>â¹</span><span>We assume that a set of naturals $A \subseteq \{...&lt;N \}$ does not have any arithmetic progression. 
</span><span>We will then show that </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span class="free"><span>A</span></span></span><span class="antiquote"><span>}</span></span></span><span> is of cardinality $o(N)$.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_63315..63320">lemma</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.RothArithmeticProgressions_aux|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.RothArithmeticProgressions_aux|thm"><span>RothArithmeticProgressions_aux</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>::</span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|type"><span>real</span></a></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>obtains</span></span></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>N</span></span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="free"><span>X</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>A</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>{..&lt;</span></a></span><span class="bound"><span>N</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>d</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.progression3|const"><span>progression3</span></a><span> </span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="bound"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>â¶</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="bound"><span>N</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>X</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>X</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_63524..63525">X</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>G</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â¦</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="skolem"><span>X</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>;</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.unique_triangles|const"><span>unique_triangles</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>â§</span></span><span> 
                </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>12</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="bound"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power2|const"><span><span class="hidden">â§</span><sup>2</sup></span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63315..63320"><span>assms</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.corollary_triangle_removal|fact"><span>corollary_triangle_removal</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.less_divide_eq_numeral1|fact"><span>less_divide_eq_numeral1</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.semiring_no_zero_divisors_class.mult_eq_0_iff|fact"><span>mult_eq_0_iff</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="free"><span>thesis</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.strip|fact"><span>strip</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63315..63320"><span>that</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>N</span></span><span> </span><span class="skolem"><span>A</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="skolem"><span>N</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_63818..63819">A</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>{..&lt;</span></a></span><span class="skolem"><span>N</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>}</span></a></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_63844..63847">non</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>d</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.progression3|const"><span>progression3</span></a><span> </span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>N</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>X</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_63938..63944">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>M</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="skolem"><span>N</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_63978..63989">M_mod_bound</span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63938..63944"><span>M_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Parity.html#Parity.semiring_parity_class.odd|const"><span>odd</span></a><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>N</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63938..63944"><span>M_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.algebraic_semidom_class.coprime|const"><span>coprime</span></a><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="skolem"><span>N</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63938..63944"><span>M_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_add_class.add.commute|fact"><span>add.commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/GCD.html#GCD.coprime_Suc_right_nat|fact"><span>coprime_Suc_right_nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/GCD.html#GCD.semiring_gcd_class.coprime_mult_right_iff|fact"><span>coprime_mult_right_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.semiring_numeral_class.mult_2|fact"><span>mult_2</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat_arith.suc1|fact"><span>nat_arith.suc1</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_64256..64259">cop</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.algebraic_semidom_class.coprime|const"><span>coprime</span></a><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>N</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.coprime_int_iff|fact"><span>coprime_int_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.semiring_1_class.of_nat_Suc|fact"><span>of_nat_Suc</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>A_sub_M</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="skolem"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>{..&lt;</span></a></span><span class="skolem"><span>M</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>}</span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63818..63819"><span>A</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>force</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63938..63944"><span>M_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>non_img_A</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>d</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.progression3|const"><span>progression3</span></a><span> </span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.p3_int_iff|fact"><span>p3_int_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63844..63847"><span>non</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.pos_int_cases|fact"><span>pos_int_cases</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.zero_le_imp_eq_int|fact"><span>zero_le_imp_eq_int</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.imageE|fact"><span>imageE</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert_subset|fact"><span>insert_subset</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.linordered_nonzero_semiring_class.of_nat_0_le_iff|fact"><span>of_nat_0_le_iff</span></a><span> 
</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.progression3_def|fact"><span>progression3_def</span></a><span class="main"><span>)</span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Construct a tripartite graph </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span class="free"><span>G</span></span></span><span class="antiquote"><span>}</span></span></span><span> whose three parts are copies of </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>text</span></span><span class="raw_text"><span>"â¤/Mâ¤"</span></span><span class="antiquote"><span>}</span></span></span><span>.</span><span>âº</span></span></span><span>
    
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_64696..64702">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>part_of</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>part_of</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>Î¾</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Î¾</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>{..&lt;</span></a></span><span class="skolem"><span>M</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>}</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_64770..64776">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>label_of_part</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>label_of_part</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>p</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.fst|const"><span>fst</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_decode|const"><span>prod_decode</span></a><span> </span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_64843..64849">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>from_part</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>from_part</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>p</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.snd|const"><span>snd</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_decode|const"><span>prod_decode</span></a><span> </span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_64913..64920">enc_iff</span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a</span></span><span class="main"><span>,</span></span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>â·</span></a></span><span> </span><span class="skolem"><span>a'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>a'</span></span><span> </span><span class="skolem"><span>i</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>clarsimp</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64696..64702"><span>part_of_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_iff|fact"><span>image_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Bex_def|fact"><span>Bex_def</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Presburger.html#Presburger.presburger|method"><span class="operator"><span>presburger</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_65076..65085">part_of_M</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>p</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>from_part</span></span><span> </span><span class="skolem"><span>p</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>p</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64843..64849"><span>from_part_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64696..64702"><span>part_of_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_65189..65203">disjnt_part_of</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjnt|const"><span>disjnt</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>b</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>b</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64696..64702"><span>part_of_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjnt_iff|fact"><span>disjnt_iff</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_65308..65316">from_enc</span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>from_part</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a</span></span><span class="main"><span>,</span></span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>i</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>i</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64843..64849"><span>from_part_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_65413..65420">finpart</span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>iff</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>a</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64696..64702"><span>part_of_def</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>cardpart</span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>a</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64696..64702"><span>part_of_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.eq_nat_nat_iff|fact"><span>eq_nat_nat_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_on_def|fact"><span>inj_on_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_image|fact"><span>card_image</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?X</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>part_of</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?Y</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>part_of</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?Z</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>part_of</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_65738..65744">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>diff</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>diff</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_65808..65819">inj_on_diff</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_on|const"><span>inj_on</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>diff</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>{..&lt;</span></a></span><span class="skolem"><span>M</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>}</span></a></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>a</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>clarsimp</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65738..65744"><span>diff_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_on_def|fact"><span>inj_on_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.group_add_class.diff_add_cancel|fact"><span>diff_add_cancel</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_add_left_eq|fact"><span>mod_add_left_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.mod_less|fact"><span>mod_less</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.nat_int|fact"><span>nat_int</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.unique_euclidean_semiring_with_nat_class.of_nat_mod|fact"><span>of_nat_mod</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_65993..66001">eq_mod_M</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>x'</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>x'</span></span><span> </span><span class="skolem"><span>y</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_ring_cancel_class.mod_eq_dvd_iff|fact"><span>mod_eq_dvd_iff</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_66125..66129">have</span></span></span><span> </span><span class="entity_def" id="offset_66130..66141">diff_invert</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>diff</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>â·</span></a></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="skolem"><span>A</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>a</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63818..63819"><span>A</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>N</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_66125..66129"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
        </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>diff</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_66125..66129"><span>that</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65738..65744"><span>diff_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_SIG</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65993..66001"><span>eq_mod_M</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.mod_less|fact"><span>mod_less</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.semiring_1_class.of_nat_add|fact"><span>of_nat_add</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Divides.html#Divides.zmod_int|fact"><span>zmod_int</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_66125..66129"><span>that</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.nat_int|fact"><span>nat_int</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Divides.html#Divides.zmod_int|fact"><span>zmod_int</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65738..65744"><span>diff_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_ring_cancel_class.mod_diff_left_eq|fact"><span>mod_diff_left_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Divides.html#Divides.zmod_int|fact"><span>zmod_int</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_66654..66660">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>diff2</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>diff2</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>b</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="bound"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="skolem"><span>N</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_66741..66753">inj_on_diff2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_on|const"><span>inj_on</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>diff2</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>{..&lt;</span></a></span><span class="skolem"><span>M</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>}</span></a></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>a</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>clarsimp</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_66654..66660"><span>diff2_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_on_def|fact"><span>inj_on_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65993..66001"><span>eq_mod_M</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.mult_mod_cancel_right|fact"><span>mult_mod_cancel_right</span></a><span> </span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> _ </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64256..64259"><span>cop</span></a><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int_int_eq|fact"><span>int_int_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.mod_less|fact"><span>mod_less</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Divides.html#Divides.zmod_int|fact"><span>zmod_int</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>N</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>N</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63938..63944"><span>M_def</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>N</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_67027..67036">diff2_by2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>diff2</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>diff</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>b</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>b</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.dvd_class.dvd|const"><span>dvd</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.dvd_class.dvd|const"><span>dvd</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="skolem"><span>N</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63938..63944"><span>M_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.algebra_simps|fact"><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_66654..66660"><span>diff2_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65738..65744"><span>diff_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_ring_cancel_class.mod_eq_dvd_iff|fact"><span>mod_eq_dvd_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_mult_left_eq|fact"><span>mod_mult_left_eq</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_67390..67394">have</span></span></span><span> </span><span class="entity_def" id="offset_67395..67407">diff2_invert</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>diff2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="skolem"><span>A</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>a</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_67495..67496">1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.group_cancel.add1|fact"><span>group_cancel.add1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_add_left_eq|fact"><span>mod_add_left_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.semiring_numeral_class.mult_2|fact"><span>mult_2</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>N</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span> 
             </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>N</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_ring_cancel_class.mod_diff_left_eq|fact"><span>mod_diff_left_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_mult_cong|fact"><span>mod_mult_cong</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.unique_euclidean_semiring_with_nat_class.of_nat_mod|fact"><span>of_nat_mod</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span>Suc</span></a><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.algebra_simps|fact"><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63938..63944"><span>M_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63818..63819"><span>A</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63938..63944"><span>M_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subsetD|fact"><span>subsetD</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_67390..67394"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_67390..67394"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_67495..67496"><span>1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_66654..66660"><span>diff2_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_68103..68109">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Edges</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Edges</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>X</span></span><span> </span><span class="bound"><span>Y</span></span><span> </span><span class="bound"><span>df</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span class="main"><span>|</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="bound"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="bound"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>df</span></span><span class="main"><span>(</span></span><span class="skolem"><span>from_part</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>from_part</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="skolem"><span>A</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_68220..68232">Edges_subset</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Edges</span></span><span> </span><span class="skolem"><span>X</span></span><span> </span><span class="skolem"><span>Y</span></span><span> </span><span class="skolem"><span>df</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Pow|const"><span>Pow</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>Y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>X</span></span><span> </span><span class="skolem"><span>Y</span></span><span> </span><span class="skolem"><span>df</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_68310..68316">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>XY</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>XY</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="skolem"><span>Edges</span></span><span> </span><span class="var"><span>?X</span></span><span> </span><span class="var"><span>?Y</span></span><span> </span><span class="skolem"><span>diff</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_68354..68360">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>YZ</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>YZ</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="skolem"><span>Edges</span></span><span> </span><span class="var"><span>?Y</span></span><span> </span><span class="var"><span>?Z</span></span><span> </span><span class="skolem"><span>diff</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_68398..68404">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>XZ</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>XZ</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="skolem"><span>Edges</span></span><span> </span><span class="var"><span>?X</span></span><span> </span><span class="var"><span>?Z</span></span><span> </span><span class="skolem"><span>diff2</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="skolem"><span>XY</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="skolem"><span>YZ</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="skolem"><span>XZ</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68220..68232"><span>Edges_subset</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68310..68316"><span>XY_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68354..68360"><span>YZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68398..68404"><span>XZ_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_Pow_iff|fact"><span>finite_Pow_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_UnI|fact"><span>finite_UnI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite_subset|fact"><span>finite_subset</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65413..65420"><span>finpart</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_68619..68625">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>G</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>G</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="var"><span>?Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="var"><span>?Z</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>XY</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>YZ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>âª</span></a></span><span> </span><span class="skolem"><span>XZ</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>finG</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_68708..68713">cardG</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="numeral"><span>3</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68619..68625"><span>G_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_Un_disjnt|fact"><span>card_Un_disjnt</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65189..65203"><span>disjnt_part_of</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="skolem"><span>X</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63938..63944"><span>M_def</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="skolem"><span>N</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>fastforce</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_insert_if|fact"><span>card_insert_if</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64696..64702"><span>part_of_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68619..68625"><span>G_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68310..68316"><span>XY_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68354..68360"><span>YZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68398..68404"><span>XZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed_def|fact"><span>uwellformed_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î¾</span></span><span class="main"><span>,</span></span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î¾</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>XY</span></span><span>"</span></span></span><span>  
                 </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î¾</span></span><span class="main"><span>,</span></span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î¾</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>YZ</span></span><span>"</span></span></span><span>
                 </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î¾</span></span><span class="main"><span>,</span></span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î¾</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>XZ</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68310..68316"><span>XY_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68354..68360"><span>YZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68398..68404"><span>XZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_69281..69285">have</span></span></span><span> </span><span>label_ne_XY</span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>label_of_part</span></span><span> </span><span class="skolem"><span>p</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="skolem"><span>label_of_part</span></span><span> </span><span class="skolem"><span>q</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>XY</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>p</span></span><span> </span><span class="skolem"><span>q</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_69281..69285"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68310..68316"><span>XY_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64696..64702"><span>part_of_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64770..64776"><span>label_of_part_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>XY</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>p</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert_absorb2|fact"><span>insert_absorb2</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_69542..69546">have</span></span></span><span> </span><span>label_ne_YZ</span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>label_of_part</span></span><span> </span><span class="skolem"><span>p</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="skolem"><span>label_of_part</span></span><span> </span><span class="skolem"><span>q</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>YZ</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>p</span></span><span> </span><span class="skolem"><span>q</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_69542..69546"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68354..68360"><span>YZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64696..64702"><span>part_of_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64770..64776"><span>label_of_part_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>YZ</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>p</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert_absorb2|fact"><span>insert_absorb2</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_69803..69807">have</span></span></span><span> </span><span>label_ne_XZ</span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>label_of_part</span></span><span> </span><span class="skolem"><span>p</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="skolem"><span>label_of_part</span></span><span> </span><span class="skolem"><span>q</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>XZ</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>p</span></span><span> </span><span class="skolem"><span>q</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_69803..69807"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68398..68404"><span>XZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64696..64702"><span>part_of_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64770..64776"><span>label_of_part_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>XZ</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>p</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert_absorb2|fact"><span>insert_absorb2</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_70064..70068">have</span></span></span><span> </span><span>label012</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>label_of_part</span></span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="numeral"><span>3</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>v</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_70064..70068"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68619..68625"><span>G_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.eval_nat_numeral|fact"><span>eval_nat_numeral</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64696..64702"><span>part_of_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64770..64776"><span>label_of_part_def</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_70225..70239">Edges_distinct</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>q</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="bound"><span>Î¾</span></span><span> </span><span class="bound"><span>Î¶</span></span><span> </span><span class="bound"><span>Î³</span></span><span> </span><span class="bound"><span>Î²</span></span><span> </span><span class="bound"><span>df</span></span><span> </span><span class="bound"><span>df'</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â¦</span></span><span class="main"><span>{</span></span><span class="bound"><span>p</span></span><span class="main"><span>,</span></span><span class="bound"><span>q</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>Edges</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="bound"><span>Î¾</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="bound"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>df</span></span><span class="main"><span>;</span></span><span>
           </span><span class="main"><span>{</span></span><span class="bound"><span>q</span></span><span class="main"><span>,</span></span><span class="bound"><span>r</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>Edges</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="bound"><span>Î¾</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="bound"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>df</span></span><span class="main"><span>;</span></span><span>
           </span><span class="main"><span>{</span></span><span class="bound"><span>p</span></span><span class="main"><span>,</span></span><span class="bound"><span>r</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>Edges</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="bound"><span>Î³</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="bound"><span>Î²</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>df'</span></span><span class="main"><span>;</span></span><span> </span><span class="bound"><span>Î¾</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="bound"><span>Î¶</span></span><span class="main"><span>;</span></span><span> </span><span class="bound"><span>Î³</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="bound"><span>Î²</span></span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjnt_iff|fact"><span>disjnt_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj_disj_distribR|fact"><span>conj_disj_distribR</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ex_disj_distrib|fact"><span>ex_disj_distrib</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjnt_iff|fact"><span>disjnt_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65189..65203"><span>disjnt_part_of</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_70603..70607">uniq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>i</span></span></span><span class="main"><span>&lt;</span></span><span class="skolem"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>d</span></span><span class="main"><span>â</span></span><span class="skolem"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>z</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> 
                   </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>
                 </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span>
                 </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="bound"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_70820..70821">T</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="skolem"><span>p</span></span><span> </span><span class="skolem"><span>q</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>p</span></span><span> </span><span class="skolem"><span>q</span></span><span> </span><span class="skolem"><span>r</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>z</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_70898..70900">xy</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>XY</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_70919..70921">yz</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>YZ</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_70940..70942">xz</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>XZ</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_70969..70970">x</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_70990..70991">y</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_71011..71012">z</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_70820..70821"><span>T</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68619..68625"><span>G_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68310..68316"><span>XY_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68354..68360"><span>YZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68398..68404"><span>XZ_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_SIG</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_70225..70239"><span>Edges_distinct</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Zero_not_Suc|fact"><span>Zero_not_Suc</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert_commute|fact"><span>insert_commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.n_not_Suc_n|fact"><span>n_not_Suc_n</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="var"><span>?X</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="var"><span>?Y</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="var"><span>?Z</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68310..68316"><span>XY_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68354..68360"><span>YZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68398..68404"><span>XZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjnt_iff|fact"><span>disjnt_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65189..65203"><span>disjnt_part_of</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>i</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>j</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>k</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_71380..71381">i</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>,</span></span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_71410..71411">j</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>,</span></span><span class="skolem"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
</span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_71441..71442">k</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>,</span></span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.One_nat_def|fact"><span>One_nat_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.Suc_1|fact"><span>Suc_1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64913..64920"><span>enc_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_decode_aux.cases|fact"><span>prod_decode_aux.cases</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_decode_inverse|fact"><span>prod_decode_inverse</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>a1</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_71589..71591">a1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a1</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_70898..70900"><span>xy</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="var"><span>?X</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_71380..71381"><span>i</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_71410..71411"><span>j</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68310..68316"><span>XY_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65738..65744"><span>diff_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>a3</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_71758..71760">a3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a3</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_70919..70921"><span>yz</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="var"><span>?X</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_71410..71411"><span>j</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_71441..71442"><span>k</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68354..68360"><span>YZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65738..65744"><span>diff_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>a2</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_71927..71929">a2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_70940..70942"><span>xz</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="var"><span>?X</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_71380..71381"><span>i</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_71441..71442"><span>k</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68398..68404"><span>XZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_67027..67036"><span>diff2_by2</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65738..65744"><span>diff_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/SMT.html#SMT.int_plus|fact"><span>int_plus</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.semiring_numeral_class.mult_2_right|fact"><span>mult_2_right</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a1</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>N</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>N</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a3</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>N</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63818..63819"><span>A</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a1</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63938..63944"><span>M_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>a3</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_71589..71591"><span>a1</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_71927..71929"><span>a2</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_71758..71760"><span>a3</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> del_insts</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/SMT.html#SMT.int_plus|fact"><span>int_plus</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_add_eq|fact"><span>mod_add_eq</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a1</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a3</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>a3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>a1</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a3</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Presburger.html#Presburger.presburger|method"><span class="operator"><span>presburger</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="entity_def" id="offset_72620..72625">equal</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="skolem"><span>a1</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="skolem"><span>a3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>a1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="skolem"><span>a2</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_cancel|fact"><span>Nat.diff_cancel</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_cancel2|fact"><span>diff_cancel2</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.semiring_numeral_class.mult_2_right|fact"><span>mult_2_right</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.progression3|const"><span>progression3</span></a><span> </span><span class="skolem"><span>a1</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="skolem"><span>a1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>clarsimp</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.progression3_def|fact"><span>progression3_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_is_0_eq&apos;|fact"><span>diff_is_0_eq'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.linordered_semidom_class.le_add_diff_inverse|fact"><span>le_add_diff_inverse</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_class.nle_le|fact"><span>nle_le</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63844..63847"><span>non</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_72620..72625"><span>equal</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>a1</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.progression3_def|fact"><span>progression3_def</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.monoid_add_class.add.right_neutral|fact"><span>add.right_neutral</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_is_0_eq|fact"><span>diff_is_0_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.insert_subset|fact"><span>insert_subset</span></a><span> 
</span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.linordered_semidom_class.le_add_diff_inverse|fact"><span>le_add_diff_inverse</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.canonically_ordered_monoid_add_class.not_gr_zero|fact"><span>not_gr_zero</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>a2</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>a1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>a3</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>k_minus_j</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a1</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>a1</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>a2</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_71758..71760"><span>a3</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_73281..73287">i_to_j</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>j</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a1</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_71589..71591"><span>a1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.cancel_ab_semigroup_add_class.add_diff_cancel_left&apos;|fact"><span>add_diff_cancel_left'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.group_add_class.add_diff_eq|fact"><span>add_diff_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_add_right_eq|fact"><span>mod_add_right_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.nat_int|fact"><span>nat_int</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.semiring_1_class.of_nat_add|fact"><span>of_nat_add</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.unique_euclidean_semiring_with_nat_class.of_nat_mod|fact"><span>of_nat_mod</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_73428..73434">j_to_k</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>k</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a1</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>a1</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>a2</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_71758..71760"><span>a3</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.cancel_ab_semigroup_add_class.add_diff_cancel_left&apos;|fact"><span>add_diff_cancel_left'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.group_add_class.add_diff_eq|fact"><span>add_diff_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_add_right_eq|fact"><span>mod_add_right_eq</span></a><span> 
</span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.nat_int|fact"><span>nat_int</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.semiring_1_class.of_nat_add|fact"><span>of_nat_add</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.unique_euclidean_semiring_with_nat_class.of_nat_mod|fact"><span>of_nat_mod</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="var"><span>?X</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_71380..71381"><span>i</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_71380..71381"><span>i</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_71410..71411"><span>j</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_71441..71442"><span>k</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_70969..70970"><span>x</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_70990..70991"><span>y</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_71011..71012"><span>z</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a1</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="var"><span>?Y</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="var"><span>?Z</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64913..64920"><span>enc_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_73281..73287"><span>i_to_j</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_73428..73434"><span>j_to_k</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_add_left_eq|fact"><span>mod_add_left_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.mod_less|fact"><span>mod_less</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    
    </span><span class="keyword1"><span class="command"><span>text</span></span></span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Every edge of the graph G lies in exactly one triangle.</span><span>âº</span></span></span><span>
    
</span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.unique_triangles|const"><span>unique_triangles</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.unique_triangles_def|fact"><span>unique_triangles_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.strip|fact"><span>strip</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>e</span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>consider</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>XY</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>YZ</span></span><span>"</span></span></span><span> </span><span class="main"><span>|</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>XZ</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68619..68625"><span>G_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â!</span></span><span class="bound"><span>T</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="bound"><span>T</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="bound"><span>T</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>cases</span></span><span>
        </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>1</span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>i</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>j</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>a</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_74218..74221">eeq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>,</span></span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>,</span></span><span class="skolem"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
          </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
          </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_74310..74312">df</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>diff</span></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68310..68316"><span>XY_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64696..64702"><span>part_of_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?x</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?y</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?z</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_74537..74540">yeq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_66130..66141"><span>diff_invert</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_74310..74312"><span>df</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
        </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="var"><span>?y</span></span><span class="main"><span>,</span></span><span class="var"><span>?z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>YZ</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>fastforce</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68354..68360"><span>YZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_iff|fact"><span>image_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_66130..66141"><span>diff_invert</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="var"><span>?x</span></span><span class="main"><span>,</span></span><span class="var"><span>?z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>XZ</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>fastforce</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68398..68404"><span>XZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_74537..74540"><span>yeq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_67395..67407"><span>diff2_invert</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_74883..74884">T</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="var"><span>?x</span></span><span> </span><span class="var"><span>?y</span></span><span> </span><span class="var"><span>?z</span></span><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>force</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68619..68625"><span>G_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_74218..74221"><span>eeq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ex1I|fact"><span>ex1I</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="main"><span>{</span></span><span class="var"><span>?x</span></span><span class="main"><span>,</span></span><span class="var"><span>?y</span></span><span class="main"><span>,</span></span><span class="var"><span>?z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="var"><span>?x</span></span><span class="main"><span>,</span></span><span class="var"><span>?y</span></span><span class="main"><span>,</span></span><span class="var"><span>?z</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_74883..74884"><span>T</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_74218..74221"><span>eeq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
          </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>T</span></span><span>
          </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>q</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>p</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>q</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>q</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>T</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>p</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>q</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>r</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_75302..75305">Teq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>T</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
            </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>tri</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="skolem"><span>p</span></span><span> </span><span class="skolem"><span>q</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>T</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
          </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_70603..70607"><span>uniq</span></a><span>
          </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>i'</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>a'</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>z</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span>  
                 </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>x</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>y</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>z</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
                 </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_75577..75580">xeq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>i'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
                 </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_75628..75631">yeq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
                 </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_75690..75693">zeq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_75775..75782">sets_eq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
          </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_75302..75305"><span>Teq</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>T</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_75844..75849">esub'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
          </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63818..63819"><span>A</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>N</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
          </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>e</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>e</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_74218..74221"><span>eeq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?x</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_75844..75849"><span>esub'</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_74218..74221"><span>eeq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_75628..75631"><span>yeq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_75690..75693"><span>zeq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?y</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_75844..75849"><span>esub'</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_74218..74221"><span>eeq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_75690..75693"><span>zeq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
          </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="entity_def" id="offset_76156..76159">eq'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>i</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>j</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?x</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_75577..75580"><span>xeq</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="var"><span>?y</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_75628..75631"><span>yeq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>diff</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>i'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a'</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65738..65744"><span>diff_def</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_76156..76159"><span>eq'</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_74310..74312"><span>df</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65738..65744"><span>diff_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_ring_cancel_class.mod_diff_left_eq|fact"><span>mod_diff_left_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.nat_int|fact"><span>nat_int</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Divides.html#Divides.zmod_int|fact"><span>zmod_int</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?z</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?y</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_add_left_eq|fact"><span>mod_add_left_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode_eq|fact"><span>prod_encode_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.snd_conv|fact"><span>snd_conv</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_75628..75631"><span>yeq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_75690..75693"><span>zeq</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>T</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="var"><span>?x</span></span><span class="main"><span>,</span></span><span class="var"><span>?y</span></span><span class="main"><span>,</span></span><span class="var"><span>?z</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_75302..75305"><span>Teq</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?x</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?y</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_75775..75782"><span>sets_eq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Presburger.html#Presburger.presburger|method"><span class="operator"><span>presburger</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
        </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>2</span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>j</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>k</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>a</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_76719..76722">eeq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>,</span></span><span class="skolem"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>,</span></span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
          </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>k</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
          </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_76807..76809">df</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>diff</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68354..68360"><span>YZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64696..64702"><span>part_of_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.numeral_2_eq_2|fact"><span>numeral_2_eq_2</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?x</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>M</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?y</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?z</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_77051..77054">zeq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_66130..66141"><span>diff_invert</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_76807..76809"><span>df</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>k</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
        </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>k</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="var"><span>?x</span></span><span class="main"><span>,</span></span><span class="var"><span>?z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>XZ</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68398..68404"><span>XZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_iff|fact"><span>image_iff</span></a><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>clarsimp</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_add_left_eq|fact"><span>mod_add_left_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj_disj_distribR|fact"><span>conj_disj_distribR</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ex_disj_distrib|fact"><span>ex_disj_distrib</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_threshold</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63818..63819"><span>A</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>N</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_67395..67407"><span>diff2_invert</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.linordered_semidom_class.le_add_diff_inverse2|fact"><span>le_add_diff_inverse2</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan_iff|fact"><span>lessThan_iff</span></a><span> 
</span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.linorder_not_less|fact"><span>linorder_not_less</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_add_left_eq|fact"><span>mod_add_left_eq</span></a><span> 
                     </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_add_self1|fact"><span>mod_add_self1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.not_add_less1|fact"><span>not_add_less1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order.strict_trans|fact"><span>order.strict_trans</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subsetD|fact"><span>subsetD</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>done</span></span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>N</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63818..63819"><span>A</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
        </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>N</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_add_left_eq|fact"><span>mod_add_left_eq</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="var"><span>?x</span></span><span class="main"><span>,</span></span><span class="var"><span>?y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>XY</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>force</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68310..68316"><span>XY_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_77051..77054"><span>zeq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_iff|fact"><span>image_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_66130..66141"><span>diff_invert</span></a><span> 
</span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ex_disj_distrib|fact"><span>ex_disj_distrib</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_77927..77928">T</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="var"><span>?x</span></span><span> </span><span class="var"><span>?y</span></span><span> </span><span class="var"><span>?z</span></span><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68619..68625"><span>G_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_76719..76722"><span>eeq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ex1I|fact"><span>ex1I</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="main"><span>{</span></span><span class="var"><span>?x</span></span><span class="main"><span>,</span></span><span class="var"><span>?y</span></span><span class="main"><span>,</span></span><span class="var"><span>?z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="var"><span>?x</span></span><span class="main"><span>,</span></span><span class="var"><span>?y</span></span><span class="main"><span>,</span></span><span class="var"><span>?z</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_77927..77928"><span>T</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_76719..76722"><span>eeq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
          </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>T</span></span><span>
          </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>q</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>p</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>q</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>q</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>T</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>p</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>q</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>r</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_78341..78344">Teq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>T</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>tri</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="skolem"><span>p</span></span><span> </span><span class="skolem"><span>q</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>T</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
          </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_70603..70607"><span>uniq</span></a><span>
          </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>i'</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>a'</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>z</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span>  
                 </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>x</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>y</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>z</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
                 </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_78604..78607">xeq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>i'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
                 </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_78655..78658">yeq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
                 </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_78717..78720">zeq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_78802..78809">sets_eq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
          </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_78341..78344"><span>Teq</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>T</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_78871..78876">esub'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
          </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63818..63819"><span>A</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>N</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
          </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>e</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>e</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_76719..76722"><span>eeq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?y</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_78871..78876"><span>esub'</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_76719..76722"><span>eeq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_78604..78607"><span>xeq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_78717..78720"><span>zeq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?z</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_78871..78876"><span>esub'</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_76719..76722"><span>eeq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_78604..78607"><span>xeq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
          </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="entity_def" id="offset_79195..79198">eq'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>j</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>k</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?y</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_78655..78658"><span>yeq</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="var"><span>?z</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_78717..78720"><span>zeq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>diff</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a'</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65738..65744"><span>diff_def</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63978..63989"><span>M_mod_bound</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_76807..76809"><span>df</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_66130..66141"><span>diff_invert</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_79195..79198"><span>eq'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_add_eq|fact"><span>mod_add_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.mod_if|fact"><span>mod_if</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.semiring_char_0_class.of_nat_eq_iff|fact"><span>of_nat_eq_iff</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="skolem"><span>a'</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>i'</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.add_diff_assoc2|fact"><span>Nat.add_diff_assoc2</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>i'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_add_class.add.left_commute|fact"><span>add.left_commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.cancel_comm_monoid_add_class.add_implies_diff|fact"><span>add_implies_diff</span></a><span> 
</span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.less_imp_le_nat|fact"><span>less_imp_le_nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_add_right_eq|fact"><span>mod_add_right_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_add_self2|fact"><span>mod_add_self2</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.mod_less|fact"><span>mod_less</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>a</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_79195..79198"><span>eq'</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>i'</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
          </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_78604..78607"><span>xeq</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?x</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>T</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="var"><span>?x</span></span><span class="main"><span>,</span></span><span class="var"><span>?y</span></span><span class="main"><span>,</span></span><span class="var"><span>?z</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_78341..78344"><span>Teq</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?z</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?y</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_78802..78809"><span>sets_eq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Presburger.html#Presburger.presburger|method"><span class="operator"><span>presburger</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
        </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>3</span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>i</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>k</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>a</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_80021..80024">eeq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>,</span></span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>,</span></span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
          </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>k</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
          </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_80113..80115">df</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>diff2</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68398..68404"><span>XZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64696..64702"><span>part_of_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.eval_nat_numeral|fact"><span>eval_nat_numeral</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?x</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?y</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?z</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_80358..80361">keq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>k</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_67395..67407"><span>diff2_invert</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="skolem"><span>i</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_80113..80115"><span>df</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>k</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_66741..66753"><span>inj_on_diff2</span></a><span> </span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="skolem"><span>i</span></span></span><span class="main"><span>]</span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_on_def|fact"><span>inj_on_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Ball_def|fact"><span>Ball_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_add_left_eq|fact"><span>mod_add_left_eq</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span>  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="var"><span>?x</span></span><span class="main"><span>,</span></span><span class="var"><span>?y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>XY</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>k</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68310..68316"><span>XY_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63978..63989"><span>M_mod_bound</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_66130..66141"><span>diff_invert</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64913..64920"><span>enc_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65308..65316"><span>from_enc</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.imageI|fact"><span>imageI</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="var"><span>?y</span></span><span class="main"><span>,</span></span><span class="var"><span>?z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>YZ</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68354..68360"><span>YZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_iff|fact"><span>image_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.eval_nat_numeral|fact"><span>eval_nat_numeral</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63978..63989"><span>M_mod_bound</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_66130..66141"><span>diff_invert</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64913..64920"><span>enc_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65308..65316"><span>from_enc</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_add_left_eq|fact"><span>mod_add_left_eq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_80358..80361"><span>keq</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_80934..80935">T</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="var"><span>?x</span></span><span> </span><span class="var"><span>?y</span></span><span> </span><span class="var"><span>?z</span></span><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>force</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68619..68625"><span>G_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_80021..80024"><span>eeq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph_def|fact"><span>triangle_in_graph_def</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ex1I|fact"><span>ex1I</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="main"><span>{</span></span><span class="var"><span>?x</span></span><span class="main"><span>,</span></span><span class="var"><span>?y</span></span><span class="main"><span>,</span></span><span class="var"><span>?z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="var"><span>?x</span></span><span class="main"><span>,</span></span><span class="var"><span>?y</span></span><span class="main"><span>,</span></span><span class="var"><span>?z</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_80934..80935"><span>T</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_80021..80024"><span>eeq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
          </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>T</span></span><span>
          </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>q</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="skolem"><span>T</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>p</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>q</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>q</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="skolem"><span>G</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>T</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>p</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>q</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>r</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_81353..81356">Teq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>T</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>tri</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.triangle_in_graph|const"><span>triangle_in_graph</span></a><span> </span><span class="skolem"><span>p</span></span><span> </span><span class="skolem"><span>q</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="skolem"><span>G</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>T</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
          </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_70603..70607"><span>uniq</span></a><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>i'</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>a'</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>z</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span>  
                 </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>x</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>y</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span>z</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
                 </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_81606..81609">xeq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>i'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
                 </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_81657..81660">yeq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
                 </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_81719..81722">zeq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_81804..81811">sets_eq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>p</span></span><span class="main"><span>,</span></span><span class="skolem"><span>q</span></span><span class="main"><span>,</span></span><span class="skolem"><span>r</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
          </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_81353..81356"><span>Teq</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>T</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_81873..81878">esub'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span class="skolem"><span>z</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
          </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63818..63819"><span>A</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>N</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
          </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>e</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>e</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_80021..80024"><span>eeq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?x</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_81873..81878"><span>esub'</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_80021..80024"><span>eeq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_81657..81660"><span>yeq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_81719..81722"><span>zeq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?z</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_81873..81878"><span>esub'</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_80021..80024"><span>eeq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_81657..81660"><span>yeq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
          </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="entity_def" id="offset_82185..82188">eq'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>i</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>k</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?x</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_81606..81609"><span>xeq</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="var"><span>?z</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_81719..81722"><span>zeq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>diff</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="skolem"><span>a'</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>i'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a'</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65738..65744"><span>diff_def</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_add_class.add.commute|fact"><span>add.commute</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_80113..80115"><span>df</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_67395..67407"><span>diff2_invert</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_82185..82188"><span>eq'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_add_right_eq|fact"><span>mod_add_right_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.nat_int|fact"><span>nat_int</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?y</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?x</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode_eq|fact"><span>prod_encode_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.snd_conv|fact"><span>snd_conv</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_81657..81660"><span>yeq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_81606..81609"><span>xeq</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>T</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="var"><span>?x</span></span><span class="main"><span>,</span></span><span class="var"><span>?y</span></span><span class="main"><span>,</span></span><span class="var"><span>?z</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_81353..81356"><span>Teq</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?x</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>z</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="var"><span>?z</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_81804..81811"><span>sets_eq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Presburger.html#Presburger.presburger|method"><span class="operator"><span>presburger</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_82720..82721">*</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span class="numeral"><span>12</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.power_class.power2|const"><span><span class="hidden">â§</span><sup>2</sup></span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63524..63525"><span>X</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>X</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uverts|const"><span>uverts</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.unique_triangles|const"><span>unique_triangles</span></a><span> </span><span class="skolem"><span>G</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uwellformed|const"><span>uwellformed</span></a><span> </span><span class="skolem"><span>G</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_82857..82861">have</span></span></span><span> </span><span class="entity_def" id="offset_82862..82873">diff_cancel</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>j</span></span></span><span class="main"><span>&lt;</span></span><span class="skolem"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>diff</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="skolem"><span>a</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63818..63819"><span>A</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63938..63944"><span>M_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_82857..82861"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_ring_cancel_class.mod_diff_left_eq|fact"><span>mod_diff_left_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.unique_euclidean_semiring_with_nat_class.of_nat_mod|fact"><span>of_nat_mod</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65738..65744"><span>diff_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.mod_less_divisor|fact"><span>mod_less_divisor</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_83203..83207">have</span></span></span><span> </span><span class="entity_def" id="offset_83208..83220">diff2_cancel</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>j</span></span></span><span class="main"><span>&lt;</span></span><span class="skolem"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>diff2</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="skolem"><span>a</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_83203..83207"><span>that</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63938..63944"><span>M_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63818..63819"><span>A</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>N</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span>
        </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>N</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Divides.html#Divides.zmod_int|fact"><span>zmod_int</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>N</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>smt</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_ring_cancel_class.mod_diff_left_eq|fact"><span>mod_diff_left_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_mult_eq|fact"><span>mod_mult_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_semiring_cancel_class.mod_mult_right_eq|fact"><span>mod_mult_right_eq</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>N</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63938..63944"><span>M_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.algebra_simps|fact"><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.dvd_class.dvd|const"><span>dvd</span></a></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>N</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.euclidean_ring_cancel_class.mod_eq_dvd_iff|fact"><span>mod_eq_dvd_iff</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
      </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_66654..66660"><span>diff2_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.mod_less_divisor|fact"><span>mod_less_divisor</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.semiring_1_class.of_nat_Suc|fact"><span>of_nat_Suc</span></a><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_84099..84103">have</span></span></span><span> </span><span class="entity_def" id="offset_84104..84114">card_Edges</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Edges</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="var"><span>?E</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>_</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="skolem"><span>Î¶</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_84211..84220">df_cancel</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span class="main"><span>â</span></span><span class="skolem"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>i</span></span></span><span class="main"><span>&lt;</span></span><span class="skolem"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>j</span></span></span><span class="main"><span>&lt;</span></span><span class="skolem"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>df</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="bound"><span>a</span></span><span>"</span></span></span><span> 
                 </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_84279..84285">df_inj</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>â</span></a></span><span class="bound"><span>a</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_on|const"><span>inj_on</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>df</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>{..&lt;</span></a></span><span class="skolem"><span>M</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>}</span></a></span><span>"</span></span></span><span>  </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span> </span><span class="skolem"><span>df</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_84350..84356">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>R</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>R</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>Î¾</span></span><span> </span><span class="bound"><span>Y</span></span><span> </span><span class="bound"><span>df</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="bound"><span>p</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>p</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Î¾</span></span><span class="main"><span>,</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> 
                                          </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="bound"><span>Y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="bound"><span>df</span></span><span class="main"><span>(</span></span><span class="skolem"><span>from_part</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>from_part</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="bound"><span>a</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_84550..84556">R_uniq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="skolem"><span>p</span></span><span class="main"><span>;</span></span><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="skolem"><span>p'</span></span><span class="main"><span>;</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>p'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>p</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="skolem"><span>p</span></span><span> </span><span class="skolem"><span>p'</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span> </span><span class="skolem"><span>df</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84350..84356"><span>R_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_84701..84707">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>f</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>Î¾</span></span><span> </span><span class="bound"><span>Y</span></span><span> </span><span class="bound"><span>df</span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>@</span></span><span class="bound"><span>p</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>R</span></span><span> </span><span class="bound"><span>Î¾</span></span><span> </span><span class="bound"><span>Y</span></span><span> </span><span class="bound"><span>df</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="bound"><span>p</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_84756..84760">have</span></span></span><span> </span><span class="entity_def" id="offset_84761..84767">f_if_R</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>p</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="skolem"><span>p</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="skolem"><span>Î¶</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="skolem"><span>p</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span> </span><span class="skolem"><span>df</span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84550..84556"><span>R_uniq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84701..84707"><span>f_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84756..84760"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.bij_betw|const"><span>bij_betw</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span class="main"><span>)</span></span><span> </span><span class="var"><span>?E</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>{..&lt;</span></a></span><span class="skolem"><span>M</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="skolem"><span>A</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.bij_betw_def|fact"><span>bij_betw_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_on_def|fact"><span>inj_on_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.strip|fact"><span>strip</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="skolem"><span>u'</span></span><span>
        </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="var"><span>?E</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>u'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="var"><span>?E</span></span><span>"</span></span></span><span> 
          </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_85091..85093">eq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span> </span><span class="skolem"><span>u'</span></span><span>"</span></span></span><span>
        </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>a</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_85169..85170">u</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span> 
          </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_85239..85241">df</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>df</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>from_part</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>from_part</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="var"><span>?E</span></span><span>âº</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>force</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_iff|fact"><span>image_iff</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>i</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_85388..85389">i</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î¾</span></span><span class="main"><span>,</span></span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64696..64702"><span>part_of_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
        </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_85169..85170"><span>u</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_85239..85241"><span>df</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84350..84356"><span>R_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84761..84767"><span>f_if_R</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84099..84103"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_85493..85495">fu</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span class="main"><span>,</span></span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
        </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x'</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y'</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>a'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_85577..85579">u'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>u'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x'</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y'</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span class="skolem"><span>A</span></span><span>"</span></span></span><span> 
           </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_85653..85656">df'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>df</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>from_part</span></span><span> </span><span class="skolem"><span>y'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>from_part</span></span><span> </span><span class="skolem"><span>x'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a'</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>u'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="var"><span>?E</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>force</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_iff|fact"><span>image_iff</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>i'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_85798..85800">i'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î¾</span></span><span class="main"><span>,</span></span><span class="skolem"><span>i'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64696..64702"><span>part_of_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
        </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_85577..85579"><span>u'</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_85653..85656"><span>df'</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84350..84356"><span>R_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84761..84767"><span>f_if_R</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84099..84103"><span>that</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_85908..85911">fu'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span> </span><span class="skolem"><span>u'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i'</span></span><span class="main"><span>,</span></span><span class="skolem"><span>a'</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span class="skolem"><span>i</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_85493..85495"><span>fu</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_85908..85911"><span>fu'</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_85091..85093"><span>eq</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
        </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_85388..85389"><span>i</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_85798..85800"><span>i'</span></a><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>x'</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>meson</span></span><span>
        </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>from_part</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>from_part</span></span><span> </span><span class="skolem"><span>y'</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_85239..85241"><span>df</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_85653..85656"><span>df'</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>x'</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>a</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84279..84285"><span>df_inj</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_85577..85579"><span>u'</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_85169..85170"><span>u</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> 
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>clarsimp</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_on_def|fact"><span>inj_on_def</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65076..65085"><span>part_of_M</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan_iff|fact"><span>lessThan_iff</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>y'</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64696..64702"><span>part_of_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_85577..85579"><span>u'</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_85169..85170"><span>u</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
        </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>u'</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_85577..85579"><span>u'</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_85169..85170"><span>u</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
      </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="var"><span>?E</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>{..&lt;</span></a></span><span class="skolem"><span>M</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>clarsimp</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>b</span></span><span>
          </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>df</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>from_part</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>from_part</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>b</span></span><span>"</span></span></span><span>
            </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_86658..86661">feq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>R</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>from_part</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>b</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84350..84356"><span>R_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64696..64702"><span>part_of_def</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>from_part</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84761..84767"><span>f_if_R</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_86658..86661"><span>feq</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64843..64849"><span>from_part_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84099..84103"><span>that</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65076..65085"><span>part_of_M</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
        </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>{..&lt;</span></a></span><span class="skolem"><span>M</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="skolem"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="var"><span>?E</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>clarsimp</span></span><span>
          </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>j</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>j</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_87214..87215">j</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>df</span></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Int.html#Int.int|const"><span>int</span></a><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84211..84220"><span>df_cancel</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_87291..87293">fj</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î¾</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î¶</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span class="main"><span>,</span></span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84350..84356"><span>R_def</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64913..64920"><span>enc_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84761..84767"><span>f_if_R</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65308..65316"><span>from_enc</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>â </span></a></span><span> </span><span class="skolem"><span>Î¶</span></span><span>âº</span></span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î¾</span></span><span class="main"><span>,</span></span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Nat_Bijection.html#Nat_Bijection.prod_encode|const"><span>prod_encode</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î¶</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>j</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>Edges</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>clarsimp</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span class="main"><span>)</span></span><span>
            </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_64913..64920"><span>enc_iff</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65308..65316"><span>from_enc</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_eqI|fact"><span>image_eqI</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_87214..87215"><span>j</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Division.html#Euclidean_Division.mod_if|fact"><span>mod_if</span></a><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>i</span></span><span class="main"><span>,</span></span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>â</span></a></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="skolem"><span>Edges</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span>"</span></span></span><span>
            </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_87291..87293"><span>fj</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_iff|fact"><span>image_iff</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
        </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>Î¾</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>part_of</span></span><span> </span><span class="skolem"><span>Î¶</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>df</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="var"><span>?E</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>{..&lt;</span></a></span><span class="skolem"><span>M</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>}</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Times|const"><span>Ã</span></a></span><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
      </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.bij_betw_same_card|fact"><span>bij_betw_same_card</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups_Big.html#Groups_Big.card_cartesian_product|fact"><span>card_cartesian_product</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjnt|const"><span>disjnt</span></a><span> </span><span class="skolem"><span>XY</span></span><span> </span><span class="skolem"><span>YZ</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjnt|const"><span>disjnt</span></a><span> </span><span class="skolem"><span>XY</span></span><span> </span><span class="skolem"><span>XZ</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjnt|const"><span>disjnt</span></a><span> </span><span class="skolem"><span>YZ</span></span><span> </span><span class="skolem"><span>XZ</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65189..65203"><span>disjnt_part_of</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68310..68316"><span>XY_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68354..68360"><span>YZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68398..68404"><span>XZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68103..68109"><span>Edges_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjnt_def|fact"><span>disjnt_def</span></a><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>clarsimp</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjoint_iff|fact"><span>disjoint_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.doubleton_eq_iff|fact"><span>doubleton_eq_iff</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjnt_iff|fact"><span>disjnt_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.n_not_Suc_n|fact"><span>n_not_Suc_n</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat.discI|fact"><span>nat.discI</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>XY</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>YZ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68310..68316"><span>XY_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68354..68360"><span>YZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84104..84114"><span>card_Edges</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_82862..82873"><span>diff_cancel</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_65808..65819"><span>inj_on_diff</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>XZ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68398..68404"><span>XZ_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_84104..84114"><span>card_Edges</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_83208..83220"><span>diff2_cancel</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_66741..66753"><span>inj_on_diff2</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_88507..88517">card_edges</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Girth_Chromatic/Ugraphs.html#Ugraphs.uedges|const"><span>uedges</span></a><span> </span><span class="skolem"><span>G</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68619..68625"><span>G_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card_Un_disjnt|fact"><span>card_Un_disjnt</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_82720..82721"><span>*</span></a><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="skolem"><span>M</span></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_68708..68713"><span>cardG</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_88507..88517"><span>card_edges</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Power.html#Power.monoid_mult_class.power2_eq_square|fact"><span>power2_eq_square</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â¦</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="skolem"><span>N</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>â¹</span><span class="skolem"><span>N</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>âº</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63938..63944"><span>M_def</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_63315..63320"><span>assms</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="skolem"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="skolem"><span>N</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span class="quoted"><span class="plain_text"><span>â¹</span><span>We finally present the main statement formulated using the upper asymptotic density condition.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_88924..88931">theorem</span></span></span><span> </span><span class="entity_def" id="Roth_Arithmetic_Progressions.RothArithmeticProgressions|fact"><span class="entity_def" id="Roth_Arithmetic_Progressions.RothArithmeticProgressions|thm"><span>RothArithmeticProgressions</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Ergodic_Theory/Asymptotic_Density.html#Asymptotic_Density.upper_asymptotic_density|const"><span>upper_asymptotic_density</span></a><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>â</span></a></span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.progression3|const"><span>progression3</span></a><span> </span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.ccontr|fact"><span>ccontr</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_89075..89078">non</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>d</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.progression3|const"><span>progression3</span></a><span> </span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>X</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span>X</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>N</span></span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="skolem"><span>X</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>A'</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>{..&lt;</span></a></span><span class="bound"><span>N</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>}</span></a></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>d</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>d</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>â§</span></a></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.progression3|const"><span>progression3</span></a><span> </span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>d</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>â</span></a></span><span> </span><span class="bound"><span>A'</span></span><span class="main"><span>)</span></span><span> 
                          </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>â¶</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="bound"><span>A'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../Ergodic_Theory/Asymptotic_Density.html#Asymptotic_Density.upper_asymptotic_density|const"><span>upper_asymptotic_density</span></a><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.real|const"><span>real</span></a><span> </span><span class="bound"><span>N</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.linordered_field_class.half_gt_zero|fact"><span>half_gt_zero</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#Roth_Arithmetic_Progressions.RothArithmeticProgressions_aux|fact"><span>RothArithmeticProgressions_aux</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_88924..88931"><span>assms</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span class="bound"><span>N</span></span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="skolem"><span>X</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.card|const"><span>card</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>â©</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>{..&lt;</span></a></span><span class="bound"><span>N</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set_Interval.html#Set_Interval.ord_class.lessThan|const"><span>}</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../Ergodic_Theory/Asymptotic_Density.html#Asymptotic_Density.upper_asymptotic_density|const"><span>upper_asymptotic_density</span></a><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="bound"><span>N</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_trans|fact"><span>order_trans</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.semilattice_inf_class.inf_le1|fact"><span>inf_le1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.semilattice_inf_class.inf_le2|fact"><span>inf_le2</span></a><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_89075..89078"><span>non</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Ergodic_Theory/Asymptotic_Density.html#Asymptotic_Density.upper_asymptotic_density|const"><span>upper_asymptotic_density</span></a><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>â¤</span></a></span><span> </span><a class="entity_ref" href="../Ergodic_Theory/Asymptotic_Density.html#Asymptotic_Density.upper_asymptotic_density|const"><span>upper_asymptotic_density</span></a><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fields.html#Fields.inverse_class.inverse_divide|const"><span>/</span></a></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>force</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Filter.html#Filter.eventually_sequentially|fact"><span>eventually_sequentially</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Real.html#Real.less_eq_real_def|fact"><span>less_eq_real_def</span></a><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Ergodic_Theory/Asymptotic_Density.html#Asymptotic_Density.upper_asymptotic_densityI|fact"><span>upper_asymptotic_densityI</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>with</span></span></span><span> </span><a class="entity_ref" href="Roth_Arithmetic_Progressions.html#offset_88924..88931"><span>assms</span></a><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span>False</span></a></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>



</span></pre></div>
<div id="RatPower">
<div class="head">
<h1>Theory RatPower</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:      RealPower/RatPower.thy
    Authors:    Jacques D. Fleuriot
                University of Edinburgh, 2021          
*)</span>

<span class="keyword1"><span class="command">theory</span></span> RatPower
<span class="keyword2"><span class="keyword">imports</span></span> <a href="https://www.cl.cam.ac.uk/research/hvg/Isabelle/dist/library/HOL/HOL/NthRoot.html">HOL.NthRoot</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Rational Exponents›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A few lemmas about nth-root.›</span></span>

<span class="keyword1" id="RatPower-real_root_mult_exp_cancel"><span class="command">lemma</span></span> real_root_mult_exp_cancel<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">;</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">m</span><span class="main">;</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">⟧</span> 
   <span class="main">⟹</span> root <span class="main">(</span><span class="free">m</span> <span class="main">*</span> <span class="free">n</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="main">(</span><span class="free">k</span> <span class="main">*</span> <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> root <span class="free">m</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="free">k</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power_mult real_root_pos_unique<span class="main">)</span> 

<span class="keyword1" id="RatPower-real_root_mult_exp_cancel1"><span class="command">lemma</span></span> real_root_mult_exp_cancel1<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">;</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">⟧</span> <span class="main">⟹</span> root <span class="free">n</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="main">(</span><span class="free">k</span> <span class="main">*</span> <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span> <span class="main">^</span> <span class="free">k</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> real_root_mult_exp_cancel <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="main">1</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1" id="RatPower-real_root_mult_exp_cancel2"><span class="command">lemma</span></span> real_root_mult_exp_cancel2<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">;</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">m</span><span class="main">;</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">⟧</span> 
   <span class="main">⟹</span> root <span class="main">(</span><span class="free">n</span> <span class="main">*</span> <span class="free">m</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="main">(</span><span class="free">n</span> <span class="main">*</span> <span class="free">k</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> root <span class="free">m</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="free">k</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult.commute real_root_mult_exp_cancel<span class="main">)</span> 

<span class="keyword1" id="RatPower-real_root_mult_exp_cancel3"><span class="command">lemma</span></span> real_root_mult_exp_cancel3<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">;</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">⟧</span> <span class="main">⟹</span> root <span class="free">n</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="main">(</span><span class="free">n</span> <span class="main">*</span> <span class="free">k</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span> <span class="main">^</span> <span class="free">k</span>"</span></span> 
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> real_root_mult_exp_cancel2 <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="main">1</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Definition of rational exponents,›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">powrat</span>  <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span>real<span class="main">,</span>rat<span class="main">]</span> <span class="main">=&gt;</span> real"</span></span>     <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span>"</span> 80<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1"><span class="free">pow<span class="hidden">⇩</span><sub>ℚ</sub></span></span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">&gt;</span> <span class="main">0</span> 
               <span class="keyword1">then</span> root <span class="main">(</span>nat <span class="main">(</span>snd<span class="main">(</span>quotient_of <span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> 
                          <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">^</span> <span class="main">(</span>nat <span class="main">(</span>fst<span class="main">(</span>quotient_of <span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
               <span class="keyword1">else</span> root <span class="main">(</span>nat <span class="main">(</span>snd<span class="main">(</span>quotient_of <span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span> 
                          <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">^</span> <span class="main">(</span>nat <span class="main">(</span><span class="main">-</span> fst<span class="main">(</span>quotient_of <span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="comment1">(* Why isn't this a default simp rule?  *)</span>
<span class="keyword1"><span class="command">declare</span></span> quotient_of_denom_pos' <span class="main">[</span><span class="operator">simp</span><span class="main">]</span>

<span class="keyword1" id="RatPower-powrat_one_eq_one"><span class="command">lemma</span></span> powrat_one_eq_one <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_def<span class="main">)</span>

<span class="keyword1" id="RatPower-powrat_zero_eq_one"><span class="command">lemma</span></span> powrat_zero_eq_one <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">0</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_def<span class="main">)</span>

<span class="keyword1" id="RatPower-powrat_one"><span class="command">lemma</span></span> powrat_one <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">1</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_def<span class="main">)</span>

<span class="keyword1" id="RatPower-powrat_mult_base"><span class="command">lemma</span></span> powrat_mult_base<span class="main">:</span> 
      <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">y</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">y</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">r</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Fract <span class="skolem">a</span> <span class="skolem">b</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">using</span></span> powrat_def quotient_of_Fract real_root_mult <span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> 
          power_mult_distrib <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-powrat_divide"><span class="command">lemma</span></span> powrat_divide<span class="main">:</span>
     <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">/</span> <span class="free">y</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span><span class="main">/</span><span class="main">(</span><span class="free">y</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">r</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Fract <span class="skolem">a</span> <span class="skolem">b</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">using</span></span> powrat_def quotient_of_Fract real_root_divide <span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> 
          power_divide <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-powrat_zero_base"><span class="command">lemma</span></span> powrat_zero_base <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">r</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Fract <span class="skolem">a</span> <span class="skolem">b</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
      <span class="keyword1"><span class="command">using</span></span> Fract powrat_def quotient_of_Fract zero_less_Fract_iff 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword1"><span class="command">then</span></span>  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Fract<span class="main">(</span>1<span class="main">)</span> assms rat_number_collapse<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">then</span></span> 
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> Fract powrat_def quotient_of_Fract zero_less_Fract_iff 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="comment1">(* That's the one we want *)</span>
<span class="keyword1" id="RatPower-powrat_inverse"><span class="command">lemma</span></span> powrat_inverse<span class="main">:</span>
      <span class="quoted"><span class="quoted">"<span class="main">(</span>inverse <span class="free">y</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">=</span> inverse<span class="main">(</span><span class="free">y</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">=</span><span class="main">0</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> True 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inverse_eq_divide powrat_divide<span class="main">)</span>  
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-powrat_minus"><span class="command">lemma</span></span> powrat_minus<span class="main">:</span>
   <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="main">-</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> inverse <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">r</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Fract <span class="skolem">a</span> <span class="skolem">b</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_def divide_inverse real_root_inverse 
                       quotient_of_Fract zero_less_Fract_iff<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-powrat_gt_zero"><span class="command">lemma</span></span> powrat_gt_zero<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">r</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Fract <span class="skolem">a</span> <span class="skolem">b</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms powrat_def<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-powrat_not_zero"><span class="command">lemma</span></span> powrat_not_zero<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">r</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Fract <span class="skolem">a</span> <span class="skolem">b</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms powrat_def<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(* Not in GCD.thy *)</span>
<span class="keyword1" id="RatPower-gcd_add_mult_commute"><span class="command">lemma</span></span> gcd_add_mult_commute<span class="main">:</span> <span class="quoted"><span class="quoted">"gcd <span class="main">(</span><span class="free">m</span><span class="main">::</span><span class="tfree">'a</span><span class="main">::</span>semiring_gcd<span class="main">)</span> <span class="main">(</span><span class="free">n</span> <span class="main">+</span> <span class="free">k</span> <span class="main">*</span> <span class="free">m</span><span class="main">)</span> <span class="main">=</span> gcd <span class="free">m</span> <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add.commute gcd_add_mult<span class="main">)</span>

<span class="keyword1" id="RatPower-coprime_add_mult_iff1"><span class="command">lemma</span></span> coprime_add_mult_iff1 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
     <span class="quoted"><span class="quoted">"coprime <span class="main">(</span><span class="free">n</span> <span class="main">+</span> <span class="free">k</span> <span class="main">*</span> <span class="free">m</span><span class="main">)</span> <span class="main">(</span><span class="free">m</span><span class="main">::</span><span class="tfree">'a</span><span class="main">::</span>semiring_gcd<span class="main">)</span> <span class="main">=</span> coprime <span class="free">n</span> <span class="free">m</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> coprime_iff_gcd_eq_1 gcd.commute gcd_add_mult_commute<span class="main">)</span>

<span class="keyword1" id="RatPower-coprime_add_mult_iff2"><span class="command">lemma</span></span> coprime_add_mult_iff2 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
     <span class="quoted"><span class="quoted">"coprime <span class="main">(</span><span class="free">k</span> <span class="main">*</span> <span class="free">m</span> <span class="main">+</span> <span class="free">n</span><span class="main">)</span> <span class="main">(</span><span class="free">m</span><span class="main">::</span><span class="tfree">'a</span><span class="main">::</span>semiring_gcd<span class="main">)</span> <span class="main">=</span> coprime <span class="free">n</span> <span class="free">m</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> add.commute<span class="main">)</span>

<span class="comment1">(* Not proved before?? *)</span>
<span class="keyword1" id="RatPower-gcd_mult_div_cancel_left1"><span class="command">lemma</span></span> gcd_mult_div_cancel_left1 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"gcd <span class="free">a</span> <span class="free">b</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">div</span> gcd <span class="free">a</span> <span class="free">b</span><span class="main">)</span>  <span class="main">=</span> <span class="main">(</span><span class="free">a</span><span class="main">::</span><span class="tfree">'a</span><span class="main">::</span>semiring_gcd<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="RatPower-gcd_mult_div_cancel_left2"><span class="command">lemma</span></span> gcd_mult_div_cancel_left2 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"gcd <span class="free">b</span> <span class="free">a</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">div</span> gcd <span class="free">b</span> <span class="free">a</span><span class="main">)</span>  <span class="main">=</span> <span class="main">(</span><span class="free">a</span><span class="main">::</span><span class="tfree">'a</span><span class="main">::</span>semiring_gcd<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="RatPower-gcd_mult_div_cancel_right1"><span class="command">lemma</span></span> gcd_mult_div_cancel_right1 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="keyword1">div</span> gcd <span class="free">a</span> <span class="free">b</span><span class="main">)</span> <span class="main">*</span> gcd <span class="free">a</span> <span class="free">b</span>  <span class="main">=</span> <span class="main">(</span><span class="free">a</span><span class="main">::</span><span class="tfree">'a</span><span class="main">::</span>semiring_gcd<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="RatPower-gcd_mult_div_cancel_right2"><span class="command">lemma</span></span> gcd_mult_div_cancel_right2 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="keyword1">div</span> gcd <span class="free">b</span> <span class="free">a</span><span class="main">)</span> <span class="main">*</span> gcd <span class="free">b</span> <span class="free">a</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span><span class="main">::</span><span class="tfree">'a</span><span class="main">::</span>semiring_gcd<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="comment1">(* END: Not in GCD.thy *)</span>

<span class="keyword1" id="RatPower-real_root_normalize_cancel"><span class="command">lemma</span></span> real_root_normalize_cancel<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"root <span class="main">(</span>nat<span class="main">(</span>snd<span class="main">(</span>Rat.normalize<span class="main">(</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> 
               <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat<span class="main">(</span>fst<span class="main">(</span>Rat.normalize<span class="main">(</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> 
         root <span class="main">(</span>nat <span class="free">b</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="main">(</span>nat <span class="free">a</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"root <span class="main">(</span>nat <span class="main">(</span><span class="free">b</span> <span class="keyword1">div</span> gcd <span class="free">a</span> <span class="free">b</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="free">a</span> <span class="keyword1">div</span> gcd <span class="free">a</span> <span class="free">b</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> 
        root <span class="main">(</span>nat <span class="free">b</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="free">a</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"coprime <span class="free">a</span> <span class="free">b</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> gcd <span class="free">a</span> <span class="free">b</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> gcd_pos_int <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat <span class="main">(</span>gcd <span class="free">a</span> <span class="free">b</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span> 
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"nat <span class="main">(</span><span class="free">b</span> <span class="keyword1">div</span> gcd <span class="free">a</span> <span class="free">b</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> nonneg1_imp_zdiv_pos_iff assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span>
       <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"root <span class="main">(</span>nat <span class="free">b</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="free">a</span><span class="main">)</span> <span class="main">=</span> 
             root <span class="main">(</span>nat <span class="main">(</span>gcd <span class="free">a</span> <span class="free">b</span> <span class="main">*</span> <span class="main">(</span><span class="free">b</span> <span class="keyword1">div</span> gcd <span class="free">a</span> <span class="free">b</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> 
                   <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span>gcd <span class="free">a</span> <span class="free">b</span> <span class="main">*</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">div</span> gcd <span class="free">a</span> <span class="free">b</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
         <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
       <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
         <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> gcd_ge_0_int nat_mult_distrib real_root_mult_exp_cancel2 
         <span class="keyword1"><span class="command">by</span></span> <span class="operator">presburger</span>
     <span class="keyword1"><span class="command">qed</span></span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
       <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> fst_conv normalize_def snd_conv<span class="main">)</span> 
  <span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-powrat_add_pos"><span class="command">lemma</span></span> powrat_add_pos<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">r</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">s</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">+</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">r</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Fract <span class="skolem">a</span> <span class="skolem">b</span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> b0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> rf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> Fract <span class="skolem">a</span> <span class="skolem">b</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> a0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Fract<span class="main">(</span>1<span class="main">)</span> assms<span class="main">(</span>2<span class="main">)</span> zero_less_Fract_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">s</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Fract <span class="skolem">c</span> <span class="skolem">d</span><span class="main">)</span> 
      <span class="keyword3"><span class="command">assume</span></span> d0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">d</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> sf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">=</span> Fract <span class="skolem">c</span> <span class="skolem">d</span>"</span></span> 
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> c0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> zero_less_Fract_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> bd0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">*</span> <span class="skolem">d</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>  
          <span class="keyword1"><span class="command">using</span></span> b0 zero_less_mult_iff Fract<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
          <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">*</span> <span class="skolem">d</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">∧</span> <span class="skolem">c</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span><span class="main">)</span>
            <span class="keyword3"><span class="command">case</span></span> True
            <span class="keyword3"><span class="command">assume</span></span> abcd<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">*</span> <span class="skolem">d</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">∧</span> <span class="skolem">c</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> adcb0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">*</span> <span class="skolem">d</span> <span class="main">+</span> <span class="skolem">c</span> <span class="main">*</span> <span class="skolem">b</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="skolem">a</span> <span class="main">*</span> <span class="skolem">d</span> <span class="main">+</span> <span class="skolem">c</span> <span class="main">*</span> <span class="skolem">b</span><span class="main">)</span> <span class="main">=</span> 
                  <span class="main">(</span><span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="main">(</span>nat <span class="skolem">a</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> nat <span class="skolem">d</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="main">(</span>nat <span class="skolem">c</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> nat <span class="skolem">b</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> abcd nat_mult_distrib nat_add_distrib 
                    zero_less_Fract_iff Fract<span class="main">(</span>3<span class="main">)</span> a0 c0 
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power_mult power_add<span class="main">)</span>
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"root <span class="main">(</span>nat <span class="skolem">b</span><span class="main">)</span> 
                        <span class="main">(</span>root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> 
                           <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="skolem">a</span> <span class="main">*</span> <span class="skolem">d</span> <span class="main">+</span> <span class="skolem">c</span> <span class="main">*</span> <span class="skolem">b</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>
                       root <span class="main">(</span>nat <span class="skolem">b</span><span class="main">)</span> 
                        <span class="main">(</span>root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> 
                          <span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="main">(</span>nat <span class="skolem">a</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> nat <span class="skolem">d</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="main">(</span>nat <span class="skolem">c</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> nat <span class="skolem">b</span><span class="main">)</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>   
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> root <span class="main">(</span>nat <span class="skolem">b</span><span class="main">)</span> 
                              <span class="main">(</span>root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="main">(</span>nat <span class="skolem">a</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> nat <span class="skolem">d</span><span class="main">)</span> <span class="main">*</span> 
                               root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="main">(</span>nat <span class="skolem">c</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> nat <span class="skolem">b</span><span class="main">)</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Fract<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> real_root_mult<span class="main">)</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> root <span class="main">(</span>nat <span class="skolem">b</span><span class="main">)</span> 
                              <span class="main">(</span>root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="main">(</span>nat <span class="skolem">a</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> nat <span class="skolem">d</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span>
                             root <span class="main">(</span>nat <span class="skolem">b</span><span class="main">)</span> 
                              <span class="main">(</span>root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="main">(</span>nat <span class="skolem">c</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> nat <span class="skolem">b</span><span class="main">)</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> real_root_mult <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> root <span class="main">(</span>nat <span class="skolem">b</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="main">(</span>nat <span class="skolem">a</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> 
                             root <span class="main">(</span>nat <span class="skolem">b</span><span class="main">)</span> 
                              <span class="main">(</span>root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> <span class="main">(</span><span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="main">(</span>nat <span class="skolem">c</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> nat <span class="skolem">b</span><span class="main">)</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span> real_root_power_cancel Fract<span class="main">(</span>2<span class="main">)</span> zero_less_nat_eq assms<span class="main">(</span>1<span class="main">)</span> 
                    less_imp_le <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
            <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> 
                       root <span class="main">(</span>nat <span class="skolem">b</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="skolem">a</span><span class="main">)</span> <span class="main">*</span>  root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="skolem">c</span><span class="main">)</span>"</span></span>
              <span class="keyword1"><span class="command">using</span></span>  real_root_power <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"nat <span class="skolem">d</span>"</span></span><span class="main">]</span> real_root_power_cancel 
                     real_root_pos_pos_le zero_less_nat_eq
                     Fract<span class="main">(</span>2<span class="main">)</span> zero_less_nat_eq b0 assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
            <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"root <span class="main">(</span>nat <span class="skolem">b</span><span class="main">)</span> <span class="main">(</span>root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="skolem">a</span> <span class="main">*</span> <span class="skolem">d</span> <span class="main">+</span> <span class="skolem">c</span> <span class="main">*</span> <span class="skolem">b</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> 
                          root <span class="main">(</span>nat <span class="skolem">b</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="skolem">a</span><span class="main">)</span> <span class="main">*</span>  root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="skolem">c</span><span class="main">)</span>"</span></span> 
              <span class="keyword1"><span class="command">by</span></span> <span class="operator">assumption</span>        
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> a0 b0 c0 d0 bd0 abcd adcb0 assms<span class="main">(</span>1<span class="main">)</span> sf rf 
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  powrat_def quotient_of_Fract 
                      real_root_mult_exp nat_mult_distrib 
                      zero_less_Fract_iff real_root_normalize_cancel<span class="main">)</span>
          <span class="keyword1"><span class="command">next</span></span>
            <span class="keyword3"><span class="command">case</span></span> False
            <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> a0 b0 c0 d0<span class="main">)</span> 
          <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-powrat_add_neg"><span class="command">lemma</span></span> powrat_add_neg<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">+</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="main">-</span> <span class="free">r</span> <span class="main">+</span> <span class="main">-</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">-</span> <span class="free">r</span> <span class="main">*</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">-</span> <span class="free">s</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> assms powrat_add_pos neg_0_less_iff_less <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inverse_eq_imp_eq inverse_mult_distrib 
         minus_add_distrib powrat_minus<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-powrat_add_neg_pos"><span class="command">lemma</span></span> powrat_add_neg_pos<span class="main">:</span> 
    <span class="keyword2"><span class="keyword">assumes</span></span> pos_x<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  
            neg_r<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
            pos_s<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">s</span>"</span></span> 
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">+</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">+</span> <span class="free">s</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> exp_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">+</span> <span class="free">s</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">r</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> neg_r <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">+</span> <span class="free">s</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">-</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span>  <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> exp_pos pos_x powrat_add_pos <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">+</span> <span class="free">s</span><span class="main">)</span> <span class="main">*</span> inverse <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="main">=</span>  <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_minus<span class="main">)</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">+</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Groups.mult_ac<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> mult.right_neutral 
          order_less_irrefl powrat_gt_zero right_inverse<span class="main">)</span>  
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> exp_pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">r</span> <span class="main">+</span> <span class="free">s</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>   
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">+</span> <span class="free">s</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="free">r</span> <span class="main">+</span> <span class="free">s</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> neq_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>   
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">+</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span> 
    <span class="keyword3"><span class="command">assume</span></span> exp_zero<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">+</span> <span class="free">s</span> <span class="main">=</span> <span class="main">0</span>"</span></span> 
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">+</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="main">*</span> inverse <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> pos_x powrat_not_zero <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">...</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">-</span> <span class="free">r</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_minus<span class="main">)</span> 
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">+</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span>"</span></span>  
      <span class="keyword1"><span class="command">using</span></span> exp_zero minus_unique <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
   <span class="keyword1"><span class="command">next</span></span> 
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">+</span> <span class="free">s</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">s</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> pos_s <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">+</span> <span class="free">s</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">-</span><span class="free">s</span><span class="main">)</span> <span class="main">=</span>  <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="free">r</span> <span class="main">+</span> <span class="free">s</span> <span class="main">&lt;</span> <span class="main">0</span>›</span></span> pos_x powrat_add_neg <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">+</span> <span class="free">s</span><span class="main">)</span> <span class="main">*</span> inverse <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span>  <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_minus<span class="main">)</span> 
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">+</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> divide_eq_eq divide_real_def 
            less_irrefl pos_x powrat_not_zero<span class="main">)</span> 
    <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-powrat_add_pos_neg"><span class="command">lemma</span></span> powrat_add_pos_neg<span class="main">:</span> 
 <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">;</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">r</span><span class="main">;</span> <span class="free">s</span> <span class="main">&lt;</span> <span class="main">0</span> <span class="main">⟧</span> 
  <span class="main">⟹</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">+</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add.commute mult.commute powrat_add_neg_pos<span class="main">)</span>

<span class="keyword1" id="RatPower-powrat_add"><span class="command">lemma</span></span> powrat_add<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">+</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">r</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">∨</span> <span class="free">r</span> <span class="main">≤</span> <span class="main">0</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="free">s</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">∨</span> <span class="free">s</span> <span class="main">≤</span> <span class="main">0</span><span class="main">)</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> powrat_add_pos powrat_add_neg powrat_add_neg_pos 
           powrat_add_pos_neg <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_less<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-powrat_diff"><span class="command">lemma</span></span> powrat_diff<span class="main">:</span> 
     <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span>  <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">a</span> <span class="main">-</span> <span class="free">b</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">a</span> <span class="main">/</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add_uminus_conv_diff divide_inverse powrat_add powrat_minus<span class="main">)</span>

<span class="keyword1" id="RatPower-powrat_mult_pos"><span class="command">lemma</span></span> powrat_mult_pos<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">r</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">s</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">r</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Fract <span class="skolem">a</span> <span class="skolem">b</span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> b0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> rf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> Fract <span class="skolem">a</span> <span class="skolem">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> coab<span class="main">:</span> <span class="quoted"><span class="quoted">"coprime <span class="skolem">a</span> <span class="skolem">b</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> a0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> b0 rf zero_less_Fract_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">s</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Fract <span class="skolem">c</span> <span class="skolem">d</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> d0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">d</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> sf<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">=</span> Fract <span class="skolem">c</span> <span class="skolem">d</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> coad<span class="main">:</span> <span class="quoted"><span class="quoted">"coprime <span class="skolem">c</span> <span class="skolem">d</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> c0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> zero_less_Fract_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">*</span> <span class="skolem">d</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> b0 d0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> a0 c0 b0 d0 rf sf coab coad assms
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> mult_pos_pos <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_def quotient_of_Fract
            zero_less_Fract_iff real_root_normalize_cancel real_root_power
            real_root_mult_exp <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> nat_mult_distrib power_mult 
            mult.commute<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-powrat_mult_neg"><span class="command">lemma</span></span> powrat_mult_neg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">" <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="main">-</span> <span class="free">r</span> <span class="main">*</span> <span class="main">-</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">-</span> <span class="free">r</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">-</span> <span class="free">s</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> powrat_mult_pos assms neg_0_less_iff_less <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_inverse powrat_minus<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span> 


<span class="keyword1" id="RatPower-powrat_mult_neg_pos"><span class="command">lemma</span></span> powrat_mult_neg_pos<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">s</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="main">-</span> <span class="free">r</span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">-</span> <span class="free">r</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> powrat_mult_pos assms neg_0_less_iff_less <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_inverse powrat_minus<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-powrat_mult_pos_neg"><span class="command">lemma</span></span> powrat_mult_pos_neg<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">r</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">*</span> <span class="main">-</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">-</span> <span class="free">s</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> powrat_mult_pos assms neg_0_less_iff_less <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_minus<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-powrat_mult"><span class="command">lemma</span></span> powrat_mult<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">q</span><span class="main">::</span><span class="quoted">rat</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="skolem">q</span> <span class="main">*</span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="skolem">q</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms linorder_neqE_linordered_idom mult_zero_right 
         powrat_mult_neg powrat_mult_neg_pos powrat_mult_pos 
         powrat_mult_pos_neg powrat_zero_eq_one<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-powrat_less_mono"><span class="command">lemma</span></span> powrat_less_mono<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">&lt;</span> <span class="free">s</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span>  <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">r</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Fract <span class="skolem">a</span> <span class="skolem">b</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> r_assms<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> Fract <span class="skolem">a</span> <span class="skolem">b</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">b</span>"</span></span> <span class="quoted"><span class="quoted">"coprime <span class="skolem">a</span> <span class="skolem">b</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">s</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Fract <span class="skolem">c</span> <span class="skolem">d</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> s_assms<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">=</span> Fract <span class="skolem">c</span> <span class="skolem">d</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">d</span>"</span></span> <span class="quoted"><span class="quoted">"coprime <span class="skolem">c</span> <span class="skolem">d</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> adcb<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">*</span> <span class="skolem">d</span> <span class="main">&lt;</span> <span class="skolem">c</span> <span class="main">*</span> <span class="skolem">b</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> assms r_assms s_assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> b_ba<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> nat <span class="main">(</span><span class="skolem">b</span> <span class="main">*</span> <span class="skolem">d</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> r_assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> s_assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> root0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="skolem">c</span><span class="main">)</span>"</span></span> 
                <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="main">-</span> <span class="skolem">c</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> real_root_pos_pos_le <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_def quotient_of_Fract zero_less_Fract_iff 
                          s_assms r_assms<span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> ac0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="skolem">a</span><span class="main">)</span> <span class="main">^</span> nat <span class="skolem">d</span> <span class="main">&lt;</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="skolem">c</span><span class="main">)</span> <span class="main">^</span> nat <span class="skolem">b</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> adcb assms<span class="main">(</span>2<span class="main">)</span> r_assms<span class="main">(</span>2<span class="main">)</span> less_imp_le mult_pos_pos 
              nat_mono_iff nat_mult_distrib power_mult 
              power_strict_increasing 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"root <span class="main">(</span>nat <span class="skolem">b</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="skolem">a</span><span class="main">)</span> <span class="main">^</span> nat <span class="main">(</span><span class="skolem">b</span> <span class="main">*</span> <span class="skolem">d</span><span class="main">)</span> <span class="main">&lt;</span>
                  root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="skolem">c</span><span class="main">)</span> <span class="main">^</span> nat <span class="main">(</span><span class="skolem">b</span> <span class="main">*</span> <span class="skolem">d</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> assms r_assms s_assms ac0 real_root_power 
              <span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> nat_mult_distrib
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  power_mult<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"root <span class="main">(</span>nat <span class="skolem">b</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="skolem">a</span><span class="main">)</span> <span class="main">&lt;</span> root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="skolem">c</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> power_less_imp_less_base root0<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"root <span class="main">(</span>nat <span class="skolem">b</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="skolem">a</span><span class="main">)</span> <span class="main">&lt;</span> 
                  root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="main">-</span> <span class="skolem">c</span><span class="main">)</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> less_trans r_assms<span class="main">(</span>1<span class="main">)</span> r_assms<span class="main">(</span>2<span class="main">)</span> s_assms<span class="main">(</span>1<span class="main">)</span> 
              s_assms<span class="main">(</span>2<span class="main">)</span> zero_less_Fract_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span> 
      <span class="keyword3"><span class="command">assume</span></span> ac0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="skolem">a</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"root <span class="main">(</span>nat <span class="skolem">b</span><span class="main">)</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="main">-</span> <span class="skolem">a</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span>
                  root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="skolem">c</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> 
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ac0<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> r_assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> s_assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> a0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span>  
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="main">-</span> <span class="skolem">a</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> nat <span class="skolem">d</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> a0 s_assms<span class="main">(</span>2<span class="main">)</span> assms<span class="main">(</span>2<span class="main">)</span> adcb power_mult <span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> 
                power_one_over nat_mult_distrib <span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">)</span></span> eq_divide_eq_1 inverse_eq_divide inverse_le_1_iff
              le_less neg_0_less_iff_less one_less_power power_one_over
              zero_less_nat_eq<span class="main">)</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="skolem">c</span><span class="main">)</span> <span class="main">^</span> nat <span class="skolem">b</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ac0<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> r_assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span> 
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="main">-</span> <span class="skolem">a</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> nat <span class="skolem">d</span> <span class="main">&lt;</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="skolem">c</span><span class="main">)</span> <span class="main">^</span> nat <span class="skolem">b</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"root <span class="main">(</span>nat <span class="skolem">b</span><span class="main">)</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="main">-</span> <span class="skolem">a</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> nat <span class="main">(</span><span class="skolem">b</span> <span class="main">*</span> <span class="skolem">d</span><span class="main">)</span>
                    <span class="main">&lt;</span> root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> nat <span class="skolem">c</span><span class="main">)</span> <span class="main">^</span> nat <span class="main">(</span><span class="skolem">b</span> <span class="main">*</span> <span class="skolem">d</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span>  assms r_assms s_assms ac0 real_root_power <span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> nat_mult_distrib
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  power_mult<span class="main">)</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">using</span></span> power_less_imp_less_base root0<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> ac0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">c</span>"</span></span>   
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"root <span class="main">(</span>nat <span class="skolem">b</span><span class="main">)</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="main">-</span> <span class="skolem">a</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> 
                  root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="main">-</span> <span class="skolem">c</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="skolem">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="skolem">c</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
          <span class="keyword1"><span class="command">using</span></span> assms r_assms s_assms adcb ac0  
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> not_less le_less<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span><span class="skolem">a</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="skolem">c</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span>"</span></span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> ac00<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ac0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">/</span> <span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="main">-</span> <span class="main">(</span><span class="skolem">a</span> <span class="main">*</span> <span class="skolem">d</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> 
                    <span class="main">1</span> <span class="main">/</span> <span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="main">-</span> <span class="main">(</span><span class="skolem">c</span> <span class="main">*</span> <span class="skolem">b</span><span class="main">)</span><span class="main">)</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> ac00 r_assms s_assms assms 
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> divide_inverse mult_pos_neg2<span class="main">)</span> 
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="main">-</span> <span class="skolem">a</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> nat <span class="skolem">d</span> <span class="main">&lt;</span> 
                    <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="main">-</span> <span class="skolem">c</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> nat <span class="skolem">b</span>"</span></span> 
          <span class="keyword1"><span class="command">using</span></span> s_assms r_assms  ac00
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> power_mult <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> 
                power_one_over nat_mult_distrib <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"root <span class="main">(</span>nat <span class="skolem">b</span><span class="main">)</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="main">-</span> <span class="skolem">a</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> nat <span class="main">(</span><span class="skolem">b</span> <span class="main">*</span> <span class="skolem">d</span><span class="main">)</span>
                   <span class="main">&lt;</span> root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="main">-</span> <span class="skolem">c</span><span class="main">)</span><span class="main">)</span> <span class="main">^</span> nat <span class="main">(</span><span class="skolem">b</span> <span class="main">*</span> <span class="skolem">d</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms r_assms s_assms ac0 real_root_power <span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> 
                nat_mult_distrib
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  power_mult<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"root <span class="main">(</span>nat <span class="skolem">b</span><span class="main">)</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="main">-</span> <span class="skolem">a</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> 
                  root <span class="main">(</span>nat <span class="skolem">d</span><span class="main">)</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="main">-</span> <span class="skolem">c</span><span class="main">)</span><span class="main">)</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> power_less_imp_less_base root0<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-power_le_imp_le_base2"><span class="command">lemma</span></span> power_le_imp_le_base2<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">(</span><span class="free">a</span><span class="main">::</span><span class="tfree">'a</span><span class="main">::</span>linordered_semidom<span class="main">)</span> <span class="main">^</span> <span class="free">n</span> <span class="main">≤</span> <span class="free">b</span> <span class="main">^</span> <span class="free">n</span><span class="main">;</span> <span class="main">0</span> <span class="main">≤</span> <span class="free">b</span><span class="main">;</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">⟧</span> 
   <span class="main">⟹</span> <span class="free">a</span> <span class="main">≤</span> <span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> power_le_imp_le_base <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">-</span> <span class="main">1</span>"</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1" id="RatPower-powrat_le_mono"><span class="command">lemma</span></span> powrat_le_mono<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">≤</span> <span class="free">s</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span>  <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">≤</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> assms le_less powrat_less_mono powrat_one_eq_one<span class="main">)</span>

<span class="keyword1" id="RatPower-powrat_less_cancel"><span class="command">lemma</span></span> powrat_less_cancel<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">x</span>  <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">&lt;</span> <span class="free">x</span>  <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">;</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">r</span> <span class="main">&lt;</span> <span class="free">s</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> not_less_iff_gr_or_eq powrat_less_mono<span class="main">)</span>

<span class="comment1">(* Monotonically increasing *)</span>
<span class="keyword1" id="RatPower-powrat_less_cancel_iff"><span class="command">lemma</span></span> powrat_less_cancel_iff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">r</span> <span class="main">&lt;</span> <span class="free">s</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> powrat_less_cancel powrat_less_mono<span class="main">)</span>

<span class="keyword1" id="RatPower-powrat_le_cancel_iff"><span class="command">lemma</span></span> powrat_le_cancel_iff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">x</span>  <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">≤</span> <span class="free">x</span>  <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">r</span> <span class="main">≤</span> <span class="free">s</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> linorder_not_less <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="comment1">(* Next 2 theorems should be in Power.thy *)</span>
<span class="keyword1" id="RatPower-power_inject_exp_less_one"><span class="command">lemma</span></span> power_inject_exp_less_one <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span><span class="main">;</span> <span class="main">(</span><span class="free">a</span><span class="main">::</span><span class="tfree">'a</span><span class="main">::</span><span class="main">{</span>linordered_field<span class="main">}</span><span class="main">)</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">⟧</span> 
   <span class="main">⟹</span> <span class="free">a</span> <span class="main">^</span> <span class="free">m</span> <span class="main">=</span> <span class="free">a</span> <span class="main">^</span> <span class="free">n</span> <span class="main">⟷</span> <span class="free">m</span> <span class="main">=</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> less_irrefl nat_neq_iff power_strict_decreasing<span class="main">)</span>

<span class="keyword1" id="RatPower-power_inject_exp_strong"><span class="command">lemma</span></span> power_inject_exp_strong <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span><span class="main">;</span> <span class="main">(</span><span class="free">a</span><span class="main">::</span><span class="tfree">'a</span><span class="main">::</span><span class="main">{</span>linordered_field<span class="main">}</span><span class="main">)</span> <span class="main">≠</span> <span class="main">1</span> <span class="main">⟧</span> 
   <span class="main">⟹</span> <span class="free">a</span> <span class="main">^</span> <span class="free">m</span> <span class="main">=</span> <span class="free">a</span> <span class="main">^</span> <span class="free">n</span> <span class="main">⟷</span> <span class="free">m</span> <span class="main">=</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">case_tac</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> not_less<span class="main">)</span>

<span class="comment1">(* Not proved elsewhere? *)</span>
<span class="keyword1" id="RatPower-nat_eq_cancel"><span class="command">lemma</span></span> nat_eq_cancel<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">⟹</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">b</span> <span class="main">⟹</span> <span class="main">(</span>nat <span class="free">a</span> <span class="main">=</span> nat <span class="free">b</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span> <span class="main">=</span> <span class="free">b</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="RatPower-powrat_inject_exp"><span class="command">lemma</span></span> powrat_inject_exp <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">x</span>  <span class="main">⟹</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">=</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">s</span> <span class="main">=</span> <span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> neq_iff powrat_less_cancel_iff<span class="main">)</span>

<span class="keyword1" id="RatPower-powrat_inject_exp_less_one"><span class="command">lemma</span></span> powrat_inject_exp_less_one <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">=</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">s</span> <span class="main">=</span> <span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> inverse <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms one_less_inverse <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> powrat_inject_exp powrat_inverse <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-powrat_inject_exp_strong"><span class="command">lemma</span></span> powrat_inject_exp_strong <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
   <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">;</span> <span class="free">x</span> <span class="main">≠</span> <span class="main">1</span> <span class="main">⟧</span>  <span class="main">⟹</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">=</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">s</span> <span class="main">=</span> <span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> powrat_inject_exp_less_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="comment1">(* Monotonically decreasing *)</span>
<span class="keyword1" id="RatPower-powrat_less_1_cancel_iff"><span class="command">lemma</span></span> powrat_less_1_cancel_iff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> x0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">s</span> <span class="main">&lt;</span> <span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">assume</span></span> xrs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span>"</span></span> 
  <span class="keyword1"><span class="command">have</span></span> invx<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">/</span><span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">&lt;</span> <span class="free">s</span> <span class="main">∨</span> <span class="free">r</span> <span class="main">≥</span> <span class="free">s</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> leI <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">&lt;</span> <span class="free">r</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">&lt;</span> <span class="free">s</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">" inverse <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">&lt;</span> inverse <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> invx
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inverse_eq_divide<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">" <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_gt_zero powrat_inverse x0<span class="main">)</span> 
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> xrs <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span> 
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">≥</span> <span class="free">s</span>"</span></span>   
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> less_eq_rat_def xrs <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span> 
  <span class="keyword3"><span class="command">assume</span></span> sr<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">&lt;</span> <span class="free">r</span>"</span></span> 
  <span class="keyword1"><span class="command">have</span></span> invx<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">/</span><span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">" inverse <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span> <span class="main">&lt;</span> inverse <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> invx sr
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inverse_eq_divide<span class="main">)</span> 
  <span class="keyword1"><span class="command">then</span></span>  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_gt_zero powrat_inverse x0<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
 
<span class="keyword1" id="RatPower-powrat_le_1_cancel_iff"><span class="command">lemma</span></span> powrat_le_1_cancel_iff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
   <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">;</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">≤</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">s</span> <span class="main">≤</span> <span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_less<span class="main">)</span>

<span class="keyword1" id="RatPower-powrat_ge_one"><span class="command">lemma</span></span> powrat_ge_one<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">1</span> <span class="main">⟹</span> <span class="free">r</span> <span class="main">≥</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="main">≥</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> powrat_le_mono powrat_zero_eq_one<span class="main">)</span>

<span class="keyword1" id="RatPower-isCont_powrat"><span class="command">lemma</span></span> isCont_powrat<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"isCont <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span><span class="main">)</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">r</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Fract <span class="skolem">a</span> <span class="skolem">b</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> fract_assms<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> Fract <span class="skolem">a</span> <span class="skolem">b</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">b</span>"</span></span> <span class="quoted"><span class="quoted">"coprime <span class="skolem">a</span> <span class="skolem">b</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">a</span>"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> True
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
        <span class="keyword1"><span class="command">using</span></span> fract_assms isCont_o2 <span class="main">[</span><span class="operator">OF</span> isCont_power <span class="main"><span class="main">[</span></span><span class="operator">OF</span> continuous_ident<span class="main"><span class="main">]</span></span><span class="main">]</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> isCont_real_root <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_def zero_less_Fract_iff<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">case</span></span> False
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
          <span class="keyword1"><span class="command">using</span></span> fract_assms assms isCont_real_root  real_root_gt_zero
                continuous_at_within_inverse <span class="main">[</span><span class="operator">intro</span><span class="main"><span class="main">!</span></span><span class="main">]</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> isCont_o2 <span class="main"><span class="main">[</span></span><span class="operator">OF</span> isCont_power <span class="main"><span class="main"><span class="main">[</span></span></span><span class="operator">OF</span> continuous_ident<span class="main"><span class="main"><span class="main">]</span></span></span><span class="main"><span class="main">]</span></span>
                   <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_def zero_less_Fract_iff divide_inverse 
                      real_root_inverse<span class="main">)</span>
      <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-LIMSEQ_powrat_base"><span class="command">lemma</span></span> LIMSEQ_powrat_base<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">X</span> <span class="main">⇢</span> <span class="free">a</span><span class="main">;</span> <span class="free">a</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">X</span> <span class="bound">n</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">q</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">q</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> isCont_tendsto_compose <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> g<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main"><span class="main">λ</span></span></span><span class="bound"><span class="bound"><span class="bound">x</span></span></span><span class="main"><span class="main"><span class="main">.</span></span></span> <span class="bound"><span class="bound"><span class="bound">x</span></span></span> <span class="keyword1"><span class="keyword1"><span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span></span></span> <span class="free"><span class="free"><span class="free">q</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span> isCont_powrat<span class="main">)</span>

<span class="keyword1" id="RatPower-powrat_inverse_of_nat_ge_one"><span class="command">lemma</span></span> powrat_inverse_of_nat_ge_one <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
      <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_ge_one<span class="main">)</span>

<span class="keyword1" id="RatPower-powrat_inverse_of_nat_le_self"><span class="command">lemma</span></span> powrat_inverse_of_nat_le_self <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> inverse <span class="main">(</span>rat_of_nat <span class="free">n</span><span class="main">)</span> <span class="main">≤</span> <span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"inverse <span class="main">(</span>rat_of_nat <span class="free">n</span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>  
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inverse_le_1_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">1</span> <span class="main">≤</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> assms powrat_le_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(* This lemma used to be in Limits.thy *)</span>
<span class="keyword1" id="RatPower-BseqI2'"><span class="command">lemma</span></span> BseqI2'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="free">N</span><span class="main">.</span> norm <span class="main">(</span><span class="free">X</span> <span class="bound">n</span><span class="main">)</span> <span class="main">≤</span> <span class="free">K</span> <span class="main">⟹</span> Bseq <span class="free">X</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> BfunI eventually_sequentially <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="RatPower-Bseq_powrat_inverse_of_nat_ge_one"><span class="command">lemma</span></span> Bseq_powrat_inverse_of_nat_ge_one<span class="main">:</span>
      <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span> <span class="main">⟹</span> Bseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> BseqI2' <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="main">1</span></span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="free">a</span></span><span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> less_imp_le powrat_gt_zero<span class="main">)</span>

<span class="keyword1" id="RatPower-decseq_powrat_inverse_of_nat_ge_one"><span class="command">lemma</span></span> decseq_powrat_inverse_of_nat_ge_one<span class="main">:</span>
      <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span> <span class="main">⟹</span> decseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> decseq_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> powrat_le_mono<span class="main">)</span>

<span class="keyword1" id="RatPower-convergent_powrat_inverse_Suc_of_nat_ge_one"><span class="command">lemma</span></span> convergent_powrat_inverse_Suc_of_nat_ge_one<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"convergent <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Bseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> inverse <span class="main">(</span>rat_of_nat <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> Bseq_powrat_inverse_of_nat_ge_one assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Bseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> inverse <span class="main">(</span>rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Bseq_ignore_initial_segment <span class="main">[</span><span class="operator">of</span> <span class="main">_</span> <span class="quoted"><span class="main">1</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"monoseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> inverse <span class="main">(</span>rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms decseq_imp_monoseq decseq_powrat_inverse_of_nat_ge_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> Bseq_monoseq_convergent <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-convergent_powrat_inverse_of_nat_ge_one"><span class="command">lemma</span></span> convergent_powrat_inverse_of_nat_ge_one<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"convergent <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"convergent <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> inverse <span class="main">(</span>rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> convergent_powrat_inverse_Suc_of_nat_ge_one assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> inverse <span class="main">(</span><span class="main">1</span> <span class="main">+</span> rat_of_nat <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">L</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> convergent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> inverse <span class="main">(</span>rat_of_nat <span class="main">(</span><span class="bound">n</span> <span class="main">+</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">L</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> inverse <span class="main">(</span>rat_of_nat <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">L</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> LIMSEQ_offset  <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="main"><span class="quoted"><span class="main"><span class="quoted"><span class="main">1</span></span></span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> convergent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-LIMSEQ_powrat_inverse_of_nat_ge_one"><span class="command">lemma</span></span> LIMSEQ_powrat_inverse_of_nat_ge_one<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"convergent<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> inverse <span class="main">(</span>rat_of_nat <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>  
    <span class="keyword1"><span class="command">using</span></span> convergent_powrat_inverse_of_nat_ge_one assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">L</span><span class="main">.</span> <span class="bound">L</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="bound">L</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms convergent_def powrat_inverse_of_nat_ge_one 
          LIMSEQ_le_const not_one_le_zero
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> 
       <span class="keyword2"><span class="keyword">where</span></span> l0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> 
       <span class="keyword2"><span class="keyword">and</span></span> liml<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">L</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> 
                   <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">L</span> <span class="main">*</span> <span class="skolem">L</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  tendsto_mult<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> inverse <span class="main">(</span>of_nat <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span>  <span class="skolem">L</span> <span class="main">*</span> <span class="skolem">L</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> powrat_add <span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> inverse <span class="main">(</span>of_nat <span class="main">(</span><span class="bound">n</span> <span class="main">*</span> <span class="numeral">2</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span>  <span class="skolem">L</span> <span class="main">*</span> <span class="skolem">L</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> LIMSEQ_linear <span class="main">[</span><span class="operator">of</span> <span class="main">_</span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span> <span class="main">*</span> <span class="skolem">L</span>"</span></span> <span class="quoted"><span class="numeral">2</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span>  <span class="skolem">L</span> <span class="main">*</span> <span class="skolem">L</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> liml <span class="keyword1"><span class="command">using</span></span> LIMSEQ_unique l0 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-LIMSEQ_powrat_inverse_of_nat_pos_less_one"><span class="command">lemma</span></span> LIMSEQ_powrat_inverse_of_nat_pos_less_one<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> a0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> a1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"inverse <span class="free">a</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> a0 a1
    <span class="keyword1"><span class="command">using</span></span> one_less_inverse <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> inverse <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> inverse <span class="main">(</span>rat_of_nat <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> LIMSEQ_powrat_inverse_of_nat_ge_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> inverse <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> inverse <span class="main">(</span>rat_of_nat <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> powrat_inverse <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="main">1</span> <span class="main">/</span> inverse <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> inverse <span class="main">(</span>rat_of_nat <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span><span class="main">/</span><span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> tendsto_divide <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> divide_inverse<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-LIMSEQ_powrat_inverse_of_nat"><span class="command">lemma</span></span> LIMSEQ_powrat_inverse_of_nat<span class="main">:</span> 
   <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> LIMSEQ_powrat_inverse_of_nat_ge_one 
       LIMSEQ_powrat_inverse_of_nat_pos_less_one leI<span class="main">)</span>


<span class="keyword1" id="RatPower-real_root_eq_powrat_inverse"><span class="command">lemma</span></span> real_root_eq_powrat_inverse<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"root <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> 0
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">m</span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> nSuc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">=</span> Suc <span class="skolem">m</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"root <span class="main">(</span>Suc <span class="skolem">m</span><span class="main">)</span> <span class="free">x</span> <span class="main">=</span> root <span class="main">(</span>nat <span class="main">(</span><span class="main">1</span> <span class="main">+</span> int <span class="skolem">m</span><span class="main">)</span><span class="main">)</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> nat_int of_nat_Suc<span class="main">)</span>    
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> nSuc powrat_def of_nat_rat 
          zero_less_Fract_iff quotient_of_Fract<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RatPower-powrat_power_eq"><span class="command">lemma</span></span> powrat_power_eq<span class="main">:</span> 
   <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> rat_of_nat <span class="free">n</span> <span class="main">=</span> <span class="free">a</span> <span class="main">^</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span>
<span class="keyword3"><span class="command">case</span></span> 0
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> powrat_add <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span></pre>
</div><div id="RealPower">
<div class="head">
<h1>Theory RealPower</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:      RealPower/RealPower.thy
    Authors:    Jacques D. Fleuriot
                University of Edinburgh, 2021          
*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Real Exponents via Limits›</span></span>

<span class="keyword1"><span class="command">theory</span></span> RealPower
<span class="keyword2"><span class="keyword">imports</span></span> <a href="#RatPower">RatPower</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">instance</span></span> rat <span class="main">::</span> <span class="quoted">ab_group_add</span> 
<span class="keyword1"><span class="command">by</span></span> <span class="operator">intro_classes</span>

<span class="keyword1"><span class="command">instance</span></span> rat <span class="main">::</span> <span class="quoted">field</span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">intro_classes</span>

<span class="keyword1"><span class="command">instance</span></span> rat <span class="main">::</span> <span class="quoted">comm_ring_1</span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">intro_classes</span>

<span class="keyword1"><span class="command">instantiation</span></span> rat <span class="main">::</span> <span class="quoted">dist</span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">definition</span></span> rat_dist_def<span class="main">:</span>
  <span class="quoted"><span class="quoted">"dist <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">=</span> of_rat <span class="main">(</span>abs<span class="main">(</span><span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">-</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command">..</span></span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">instantiation</span></span> rat <span class="main">::</span> <span class="quoted">dist_norm</span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">definition</span></span> rat_norm_def<span class="main">:</span>
  <span class="quoted"><span class="quoted">"norm <span class="main">(</span><span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">::</span>rat<span class="main">)</span> <span class="main">=</span> of_rat <span class="main">¦</span><span class="free"><span class="bound"><span class="entity">q</span></span></span><span class="main">¦</span>"</span></span>

<span class="keyword1"><span class="command">instance</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">intro_classes</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rat_dist_def rat_norm_def<span class="main">)</span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">instantiation</span></span> rat <span class="main">::</span> <span class="quoted">metric_space</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">definition</span></span> uniformity_rat_def <span class="main">[</span><span class="operator">code</span> <span class="quasi_keyword"><span class="quasi_keyword"><span class="quasi_keyword">del</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span>uniformity <span class="main">::</span> <span class="main">(</span>rat <span class="main">×</span> rat<span class="main">)</span> filter<span class="main">)</span> <span class="main">=</span> 
      <span class="main">(</span><span class="keyword1">INF</span> <span class="bound">e</span><span class="main">∈</span><span class="main">{</span><span class="main">0</span> <span class="main">&lt;..}</span><span class="main">.</span> principal <span class="main">{</span><span class="main">(</span><span class="main">(</span><span class="bound">x</span><span class="main">::</span>rat<span class="main">)</span><span class="main">,</span> <span class="bound">y</span><span class="main">)</span><span class="main">.</span> dist <span class="bound">x</span> <span class="bound">y</span> <span class="main">&lt;</span> <span class="bound">e</span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">definition</span></span> open_rat_def <span class="main">[</span><span class="operator">code</span> <span class="quasi_keyword"><span class="quasi_keyword"><span class="quasi_keyword">del</span></span></span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"open <span class="main">(</span><span class="free"><span class="bound"><span class="entity">U</span></span></span> <span class="main">::</span> rat set<span class="main">)</span> <span class="main">⟷</span> 
      <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">U</span></span></span><span class="main">.</span> eventually <span class="main">(</span><span class="main">λ</span><span class="main">(</span><span class="bound">x'</span><span class="main">,</span> <span class="bound">y</span><span class="main">)</span><span class="main">.</span> <span class="bound">x'</span> <span class="main">=</span> <span class="bound">x</span> <span class="main">⟶</span> <span class="bound">y</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">U</span></span></span><span class="main">)</span> uniformity<span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">instance</span></span> 
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"uniformity <span class="main">=</span> 
         <span class="main">(</span><span class="keyword1">INF</span> <span class="bound">e</span><span class="main">∈</span><span class="main">{</span><span class="main">0</span><span class="main">&lt;..}</span><span class="main">.</span> principal <span class="main">{</span><span class="main">(</span><span class="bound">x</span><span class="main">::</span>rat<span class="main">,</span> <span class="bound">y</span><span class="main">)</span><span class="main">.</span> dist <span class="bound">x</span> <span class="bound">y</span> <span class="main">&lt;</span> <span class="bound">e</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> uniformity_rat_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">U</span> 
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"open <span class="skolem">U</span> <span class="main">=</span> 
         <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="skolem">U</span><span class="main">.</span> <span class="keyword1">∀<span class="hidden">⇩</span><sub>F</sub></span> <span class="main">(</span><span class="bound">x'</span><span class="main">,</span> <span class="bound">y</span><span class="main">::</span>rat<span class="main">)</span> <span class="keyword1">in</span> uniformity<span class="main">.</span> <span class="bound">x'</span> <span class="main">=</span> <span class="bound">x</span> <span class="main">⟶</span> <span class="bound">y</span> <span class="main">∈</span> <span class="skolem">U</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> open_rat_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>dist <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">=</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">y</span><span class="main">::</span>rat<span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rat_dist_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">z</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"dist <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">≤</span> dist <span class="skolem">x</span> <span class="skolem">z</span> <span class="main">+</span> dist <span class="skolem">y</span> <span class="main">(</span><span class="skolem">z</span><span class="main">::</span>rat<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rat_dist_def of_rat_add <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> of_rat_less_eq<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">instance</span></span> rat <span class="main">::</span> <span class="quoted">topological_space</span>
<span class="keyword1"><span class="command">by</span></span> <span class="operator">intro_classes</span>

<span class="keyword1" id="RealPower-LIMSEQ_squeeze"><span class="command">lemma</span></span> LIMSEQ_squeeze<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> abc<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="bound">n</span> <span class="main">≤</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">∧</span> <span class="free">b</span> <span class="bound">n</span> <span class="main">≤</span> <span class="free">c</span> <span class="bound">n</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> alim<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">L</span><span class="main">::</span>real<span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> clim<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">⇢</span> <span class="free">L</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">⇢</span> <span class="free">L</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">r</span>
  <span class="keyword3"><span class="command">assume</span></span> r0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">::</span>real<span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">no</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">no</span><span class="main">.</span> <span class="main">¦</span><span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="free">L</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> LIMSEQ_def alim dist_real_def<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="skolem">p</span><span class="main">.</span> <span class="main">¦</span><span class="free">a</span> <span class="bound">n</span> <span class="main">-</span> <span class="free">L</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">no</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">no</span><span class="main">.</span> <span class="main">¦</span><span class="free">c</span> <span class="bound">n</span> <span class="main">-</span> <span class="free">L</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span>
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> LIMSEQ_def r0 clim dist_real_def<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="skolem">k</span><span class="main">.</span> <span class="main">¦</span><span class="free">c</span> <span class="bound">n</span> <span class="main">-</span> <span class="free">L</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">m</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">m</span><span class="main">.</span> <span class="main">¦</span><span class="free">b</span> <span class="bound">n</span> <span class="main">-</span> <span class="free">L</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span>  
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> 
      <span class="keyword3"><span class="command">assume</span></span> n_max<span class="main">:</span> <span class="quoted"><span class="quoted">"max <span class="skolem">p</span> <span class="skolem">k</span> <span class="main">≤</span> <span class="skolem">n</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> a_n<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="free">a</span> <span class="skolem">n</span> <span class="main">-</span> <span class="free">L</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">have</span></span> c_n<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="free">c</span> <span class="skolem">n</span> <span class="main">-</span> <span class="free">L</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> n_max 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="skolem">n</span> <span class="main">≤</span> <span class="free">b</span> <span class="skolem">n</span> <span class="main">∧</span> <span class="free">b</span> <span class="skolem">n</span> <span class="main">≤</span> <span class="free">c</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> abc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¦</span><span class="free">b</span> <span class="skolem">n</span> <span class="main">-</span> <span class="free">L</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> a_n c_n <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span>max <span class="skolem">p</span> <span class="skolem">k</span><span class="main">.</span> <span class="main">¦</span><span class="free">b</span> <span class="bound">n</span> <span class="main">-</span> <span class="free">L</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span>
       <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
     <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">r</span></span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∃</span><span class="bound">m</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">m</span><span class="main">.</span> <span class="main">¦</span><span class="free">b</span> <span class="bound">n</span> <span class="main">-</span> <span class="free">L</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="bound">r</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_real_def lim_sequentially<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">incratseq</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> nat <span class="main">⇒</span> rat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">incratseq</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">0</span> <span class="main">=</span> <span class="main">(</span><span class="main">ϵ</span><span class="bound">q</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> of_rat <span class="bound">q</span> <span class="main">∧</span> of_rat <span class="bound">q</span> <span class="main">&lt;</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">incratseq</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">(</span>Suc <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="main">=</span> 
       <span class="main">(</span><span class="main">ϵ</span><span class="bound">q</span><span class="main">.</span> max <span class="main">(</span>of_rat<span class="main">(</span><span class="free">incratseq</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">-</span> <span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> of_rat <span class="bound">q</span> <span class="main">∧</span> 
            of_rat <span class="bound">q</span> <span class="main">&lt;</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="RealPower-incratseq_0_gt"><span class="command">lemma</span></span> incratseq_0_gt <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> of_rat<span class="main">(</span>incratseq <span class="free">x</span> <span class="main">0</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">q</span><span class="main">.</span> <span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> real_of_rat <span class="bound">q</span> <span class="main">∧</span> real_of_rat <span class="bound">q</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> of_rat_dense
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">" <span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> real_of_rat <span class="skolem">q</span> <span class="main">∧</span> real_of_rat <span class="skolem">q</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> someI2<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-incratseq_0_less"><span class="command">lemma</span></span> incratseq_0_less <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"of_rat<span class="main">(</span>incratseq <span class="free">x</span> <span class="main">0</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">q</span><span class="main">.</span> <span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> real_of_rat <span class="bound">q</span> <span class="main">∧</span> real_of_rat <span class="bound">q</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> of_rat_dense
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">" <span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> real_of_rat <span class="skolem">q</span> <span class="main">∧</span> real_of_rat <span class="skolem">q</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> someI2<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">declare</span></span> incratseq.simps <span class="main">[</span><span class="operator">simp</span> <span class="quasi_keyword"><span class="quasi_keyword">del</span></span><span class="main">]</span>

<span class="keyword1" id="RealPower-incratseq_ub"><span class="command">lemma</span></span> incratseq_ub <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"real_of_rat <span class="main">(</span>incratseq <span class="free">x</span> <span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> 0
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> 
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"real_of_rat <span class="main">(</span>incratseq <span class="free">x</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">/</span><span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">/</span><span class="main">(</span>Suc<span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">q</span><span class="main">.</span> <span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> real <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span>
              <span class="main">&lt;</span> real_of_rat <span class="bound">q</span> <span class="main">∧</span>
              real_of_rat <span class="bound">q</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> of_rat_dense <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="main">(</span><span class="keyword1">if</span> True <span class="keyword1">then</span> <span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> real <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span>
                  <span class="keyword1">else</span> real_of_rat
                        <span class="main">(</span>incratseq <span class="free">x</span> <span class="skolem">n</span><span class="main">)</span><span class="main">)</span>
                 <span class="main">&lt;</span> real_of_rat <span class="bound">a</span> <span class="main">∧</span>
                 real_of_rat <span class="bound">a</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"real_of_rat
              <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">q</span><span class="main">.</span>
                  <span class="main">(</span><span class="keyword1">if</span> real_of_rat
                       <span class="main">(</span>incratseq <span class="free">x</span> <span class="skolem">n</span><span class="main">)</span>
                      <span class="main">≤</span> <span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> real <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span>
                   <span class="keyword1">then</span> <span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> real <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span>
                   <span class="keyword1">else</span> real_of_rat
                         <span class="main">(</span>incratseq <span class="free">x</span> <span class="skolem">n</span><span class="main">)</span><span class="main">)</span>
                  <span class="main">&lt;</span> real_of_rat <span class="bound">q</span> <span class="main">∧</span>
                  real_of_rat <span class="bound">q</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">)</span>
             <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> True <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> someI2_ex<span class="main">)</span> 
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> incratseq.simps max_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> real_of_rat <span class="main">(</span>incratseq <span class="free">x</span> <span class="skolem">n</span><span class="main">)</span>
                 <span class="main">&lt;</span> real_of_rat <span class="bound">a</span> <span class="main">∧</span>
                 real_of_rat <span class="bound">a</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Suc of_rat_dense <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"real_of_rat
              <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">q</span><span class="main">.</span>
                  <span class="main">(</span><span class="keyword1">if</span> real_of_rat
                       <span class="main">(</span>incratseq <span class="free">x</span> <span class="skolem">n</span><span class="main">)</span>
                      <span class="main">≤</span> <span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> real <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span>
                   <span class="keyword1">then</span> <span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> real <span class="main">(</span><span class="skolem">n</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span>
                   <span class="keyword1">else</span> real_of_rat
                         <span class="main">(</span>incratseq <span class="free">x</span> <span class="skolem">n</span><span class="main">)</span><span class="main">)</span>
                  <span class="main">&lt;</span> real_of_rat <span class="bound">q</span> <span class="main">∧</span>
                  real_of_rat <span class="bound">q</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">)</span>
             <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> False <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> someI2_ex<span class="main">)</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> incratseq.simps max_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1" id="RealPower-incratseq_incseq"><span class="command">lemma</span></span> incratseq_incseq <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
   <span class="quoted"><span class="quoted">"incratseq <span class="free">x</span> <span class="free">n</span> <span class="main">&lt;</span> incratseq <span class="free">x</span> <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"max <span class="main">(</span>real_of_rat <span class="main">(</span>incratseq <span class="free">x</span> <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> real <span class="main">(</span><span class="free">n</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">q</span><span class="main">.</span> max <span class="main">(</span>real_of_rat <span class="main">(</span>incratseq <span class="free">x</span> <span class="free">n</span><span class="main">)</span><span class="main">)</span>
          <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> real <span class="main">(</span><span class="free">n</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span><span class="main">)</span>
         <span class="main">&lt;</span> real_of_rat <span class="bound">q</span> <span class="main">∧</span>
         real_of_rat <span class="bound">q</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> of_rat_dense <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"incratseq <span class="free">x</span> <span class="free">n</span>
    <span class="main">&lt;</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">q</span><span class="main">.</span>
          max <span class="main">(</span>real_of_rat <span class="main">(</span>incratseq <span class="free">x</span> <span class="free">n</span><span class="main">)</span><span class="main">)</span>
           <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> real <span class="main">(</span><span class="free">n</span> <span class="main">+</span> <span class="numeral">2</span><span class="main">)</span><span class="main">)</span>
          <span class="main">&lt;</span> real_of_rat <span class="bound">q</span> <span class="main">∧</span>
          real_of_rat <span class="bound">q</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">)</span>"</span></span>
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">fastforce</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> someI2_ex <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> of_rat_less<span class="main">)</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> incratseq.simps<span class="main">)</span>
 <span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-incratseq_lb"><span class="command">lemma</span></span> incratseq_lb <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">/</span><span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> real_of_rat <span class="main">(</span>incratseq <span class="free">x</span> <span class="free">n</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="free">n</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> 0
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"real_of_rat <span class="main">(</span>incratseq <span class="free">x</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">/</span>Suc<span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>"</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">" <span class="main">1</span> <span class="main">/</span> Suc<span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">/</span> Suc <span class="skolem">n</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Suc.IH <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">/</span>Suc<span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span>Suc<span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="main">&lt;</span> real_of_rat <span class="bound">a</span> <span class="main">∧</span> real_of_rat <span class="bound">a</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> of_rat_dense <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> real <span class="main">(</span>Suc <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span>
             <span class="main">&lt;</span> real_of_rat
                <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">q</span><span class="main">.</span>
                    <span class="main">(</span><span class="keyword1">if</span> real_of_rat <span class="main">(</span>incratseq <span class="free">x</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> Suc<span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>
                     <span class="keyword1">then</span> <span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> Suc<span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span> <span class="keyword1">else</span> real_of_rat <span class="main">(</span>incratseq <span class="free">x</span> <span class="skolem">n</span><span class="main">)</span><span class="main">)</span>
                    <span class="main">&lt;</span> real_of_rat <span class="bound">q</span> <span class="main">∧</span>
                    real_of_rat <span class="bound">q</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> True <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> someI2_ex<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> True 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> incratseq.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> max_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> incratseq_incseq 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> less_trans not_less of_rat_less<span class="main">)</span> 
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-incseq_incratseq"><span class="command">lemma</span></span> incseq_incratseq <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
   <span class="quoted"><span class="quoted">"incseq <span class="main">(</span>incratseq <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> incseq_SucI less_imp_le<span class="main">)</span>


<span class="keyword1" id="RealPower-LIMSEQ_rat_real_ex"><span class="command">lemma</span></span> LIMSEQ_rat_real_ex<span class="main">:</span> 
    <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">r</span><span class="main">.</span> incseq <span class="bound">r</span> <span class="main">∧</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="bound">r</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> squeeze_left<span class="main">:</span>
       <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> real <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span>
        <span class="main">≤</span> real_of_rat <span class="main">(</span>incratseq <span class="free">x</span> <span class="bound">n</span><span class="main">)</span> <span class="main">∧</span> real_of_rat <span class="main">(</span>incratseq <span class="free">x</span> <span class="bound">n</span><span class="main">)</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> incratseq_lb less_imp_le
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> less_imp_le<span class="main">)</span> 
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> real <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> minus_real_def LIMSEQ_inverse_real_of_nat_add_minus 
           inverse_eq_divide <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> real_of_rat <span class="main">(</span>incratseq <span class="free">x</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span>  LIMSEQ_squeeze tendsto_const <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">using</span></span> incseq_incratseq <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
<span class="keyword1"><span class="command">qed</span></span>
 
<span class="keyword1" id="RealPower-incseq_incseq_powrat"><span class="command">lemma</span></span> incseq_incseq_powrat<span class="main">:</span> 
     <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">1</span> <span class="main">≤</span> <span class="free">a</span><span class="main">;</span> incseq <span class="free">r</span> <span class="main">⟧</span> <span class="main">⟹</span> incseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>lifting<span class="main"><span class="main">)</span></span> incseq_def powrat_le_mono<span class="main">)</span>

<span class="keyword1" id="RealPower-ex_less_of_rat"><span class="command">lemma</span></span> ex_less_of_rat<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">r</span><span class="main">.</span> <span class="main">(</span><span class="free">x</span> <span class="main">::</span> <span class="tfree">'a</span> <span class="main">::</span> archimedean_field<span class="main">)</span> <span class="main">&lt;</span> of_rat <span class="bound">r</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ex_less_of_int of_rat_of_int_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>  

<span class="keyword1" id="RealPower-powrat_incseq_bounded"><span class="command">lemma</span></span> powrat_incseq_bounded<span class="main">:</span> 
     <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">1</span> <span class="main">≤</span> <span class="free">a</span><span class="main">;</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="free">r</span> <span class="bound">n</span> <span class="main">&lt;</span> of_rat <span class="free">q</span><span class="main">;</span> incseq <span class="free">r</span> <span class="main">⟧</span> <span class="main">⟹</span>  <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="free">n</span><span class="main">)</span> <span class="main">≤</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">q</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> less_imp_le powrat_le_mono<span class="main">)</span>

<span class="keyword1" id="RealPower-Bseq_powrat_incseq"><span class="command">lemma</span></span> Bseq_powrat_incseq<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">a</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"incseq <span class="free">r</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> of_rat<span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span> <span class="main">≤</span> <span class="main">(</span><span class="free">x</span> <span class="main">::</span> <span class="tfree">'a</span> <span class="main">::</span> archimedean_field<span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Bseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> ex_less_of_rat 
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> xq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> of_rat <span class="skolem">q</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="main">0</span> <span class="main">≤</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="bound">n</span> <span class="main">∧</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="bound">n</span> <span class="main">≤</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> of_rat <span class="skolem">q</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">" <span class="free">r</span> <span class="skolem">m</span> <span class="main">&lt;</span> <span class="skolem">q</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> le_less_trans of_rat_less xq <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span> <span class="skolem">m</span> <span class="main">≤</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> of_rat <span class="skolem">q</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> powrat_le_mono<span class="main">)</span><span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> less_imp_le <span class="main">[</span><span class="operator">OF</span> powrat_gt_zero<span class="main">]</span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> BseqI2' abs_of_nonneg real_norm_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-convergent_powrat_incseq"><span class="command">lemma</span></span> convergent_powrat_incseq<span class="main">:</span> 
   <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">1</span> <span class="main">≤</span> <span class="free">a</span><span class="main">;</span> incseq <span class="free">r</span><span class="main">;</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="free">r</span> <span class="bound">n</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟧</span> <span class="main">⟹</span> convergent <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> Bseq_monoseq_convergent 
       <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> incseq_imp_monoseq incseq_incseq_powrat Bseq_powrat_incseq <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="free">x</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">definition</span></span> 
    <span class="entity">incseq_of</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"real <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> rat<span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">incseq_of</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">r</span><span class="main">.</span> incseq <span class="bound">r</span> <span class="main">∧</span>  <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="bound">r</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="RealPower-LIMSEQ_incseq_of"><span class="command">lemma</span></span> LIMSEQ_incseq_of <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
     <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span>incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> someI2_ex <span class="main"><span class="main">[</span></span><span class="operator">OF</span> LIMSEQ_rat_real_ex<span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> incseq_of_def<span class="main">)</span>

<span class="keyword1" id="RealPower-incseq_incseq_of"><span class="command">lemma</span></span> incseq_incseq_of <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
      <span class="quoted"><span class="quoted">"incseq <span class="main">(</span>incseq_of <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> someI2_ex <span class="main"><span class="main">[</span></span><span class="operator">OF</span> LIMSEQ_rat_real_ex<span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> incseq_of_def<span class="main">)</span>

<span class="keyword1" id="RealPower-incseq_of_Suc"><span class="command">lemma</span></span> incseq_of_Suc <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
      <span class="quoted"><span class="quoted">"incseq_of <span class="free">x</span> <span class="free">n</span> <span class="main">≤</span> incseq_of <span class="free">x</span> <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> incseq_def incseq_incseq_of le_SucI le_refl<span class="main">)</span>

<span class="keyword1" id="RealPower-incseq_of_rat_incseq_of"><span class="command">lemma</span></span> incseq_of_rat_incseq_of<span class="main">:</span>
      <span class="quoted"><span class="quoted">"incseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat<span class="main">(</span>incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span> <span class="main">::</span> <span class="tfree">'a</span><span class="main">::</span>linordered_field<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> incseq_def incseq_incseq_of of_rat_less_eq<span class="main">)</span>

<span class="keyword1" id="RealPower-incseq_of_rat"><span class="command">lemma</span></span> incseq_of_rat<span class="main">:</span>
      <span class="quoted"><span class="quoted">"incseq <span class="free">s</span> <span class="main">⟹</span> incseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat<span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span> <span class="main">::</span> <span class="tfree">'a</span> <span class="main">::</span> linordered_field<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> incseq_def of_rat_less_eq<span class="main">)</span>

<span class="keyword1" id="RealPower-incseq_rat_le_real"><span class="command">lemma</span></span> incseq_rat_le_real<span class="main">:</span>
      <span class="quoted"><span class="quoted">"<span class="main">⟦</span> incseq <span class="free">s</span><span class="main">;</span>  <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">x</span> <span class="main">⟧</span> <span class="main">⟹</span> of_rat <span class="main">(</span><span class="free">s</span> <span class="free">n</span><span class="main">)</span> <span class="main">≤</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> incseq_le incseq_of_rat<span class="main">)</span>

<span class="keyword1" id="RealPower-incseq_of_le_self"><span class="command">lemma</span></span> incseq_of_le_self<span class="main">:</span> <span class="quoted"><span class="quoted">"of_rat<span class="main">(</span>incseq_of <span class="free">x</span> <span class="free">n</span><span class="main">)</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> incseq_rat_le_real LIMSEQ_incseq_of<span class="main">)</span>

<span class="keyword1" id="RealPower-powrat_incseq_of_bounded"><span class="command">lemma</span></span> powrat_incseq_of_bounded<span class="main">:</span> 
     <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">1</span> <span class="main">≤</span> <span class="free">a</span><span class="main">;</span> <span class="free">x</span> <span class="main">&lt;</span> of_rat <span class="free">r</span> <span class="main">⟧</span> <span class="main">⟹</span>  <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>incseq_of <span class="free">x</span> <span class="free">n</span><span class="main">)</span> <span class="main">≤</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> incseq_of_le_self le_less le_less_trans of_rat_less powrat_le_mono<span class="main">)</span>

<span class="keyword1" id="RealPower-incseq_powrat_insec_of"><span class="command">lemma</span></span> incseq_powrat_insec_of<span class="main">:</span> 
     <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">a</span> <span class="main">⟹</span> incseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> incseq_incseq_powrat<span class="main">)</span>

<span class="keyword1" id="RealPower-Bseq_powrat_incseq_of"><span class="command">lemma</span></span> Bseq_powrat_incseq_of<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">a</span> <span class="main">⟹</span> Bseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> Bseq_powrat_incseq incseq_of_le_self<span class="main">)</span>

<span class="keyword1" id="RealPower-convergent_powrat_incseq_of"><span class="command">lemma</span></span> convergent_powrat_incseq_of<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">a</span> <span class="main">⟹</span> convergent <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> Bseq_monoseq_convergent Bseq_powrat_incseq_of incseq_imp_monoseq 
             incseq_powrat_insec_of<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We're now ready to define real exponentation.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
    <span class="entity">powa</span>  <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span>real<span class="main">,</span>real<span class="main">]</span> <span class="main">⇒</span> real"</span></span>      <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1">powa</span>"</span> 80<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
   <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="keyword1"><span class="free">powa</span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">THE</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>incseq_of <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="bound">y</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹real exponents.›</span></span>
<span class="keyword1"><span class="command">definition</span></span>
    <span class="entity">powreal</span>  <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span>real<span class="main">,</span>real<span class="main">]</span> <span class="main">⇒</span> real"</span></span>     <span class="main">(</span><span class="keyword2"><span class="keyword">infixr</span></span> <span class="quoted">"<span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span>"</span> 80<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
    <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="keyword1"><span class="free">pow<span class="hidden">⇩</span><sub>ℝ</sub></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="main">&lt;</span> <span class="main">1</span> <span class="keyword1">then</span> <span class="main">(</span>inverse <span class="free"><span class="bound"><span class="entity">a</span></span></span><span class="main">)</span> <span class="keyword1">powa</span> <span class="main">(</span><span class="main">-</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> 
                 <span class="keyword1">else</span> <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="main">≥</span> <span class="main">1</span> <span class="keyword1">then</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="keyword1">powa</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="keyword1">else</span> <span class="main">0</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="RealPower-powreal_eq_powa"><span class="command">lemma</span></span> powreal_eq_powa<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powreal_def<span class="main">)</span>

<span class="keyword1" id="RealPower-LIMSEQ_powrat_incseq_of_ex1"><span class="command">lemma</span></span> LIMSEQ_powrat_incseq_of_ex1<span class="main">:</span>
   <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">a</span> <span class="main">⟹</span> <span class="main">∃!</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">⇢</span> <span class="bound">y</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> LIMSEQ_unique convergentD convergent_powrat_incseq_of<span class="main">)</span>

<span class="keyword1" id="RealPower-LIMSEQ_powa"><span class="command">lemma</span></span> LIMSEQ_powa<span class="main">:</span>
   <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">a</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> powa_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">erule</span> theI' <span class="main"><span class="main">[</span></span><span class="operator">OF</span> LIMSEQ_powrat_incseq_of_ex1<span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1" id="RealPower-lemma_incseq_incseq_diff_inverse"><span class="command">lemma</span></span> lemma_incseq_incseq_diff_inverse<span class="main">:</span>
   <span class="quoted"><span class="quoted">"incseq <span class="free">s</span> <span class="main">⟹</span> incseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">s</span> <span class="bound">n</span> <span class="main">::</span> rat<span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">/</span>of_nat<span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> diff_mono <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> divide_inverse incseq_def<span class="main">)</span>

<span class="keyword1" id="RealPower-lemma_incseq_diff_inverse_ub"><span class="command">lemma</span></span> lemma_incseq_diff_inverse_ub<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"incseq <span class="free">s</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">x</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"of_rat<span class="main">(</span><span class="free">s</span> <span class="free">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">/</span>of_nat<span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"real_of_rat <span class="main">(</span><span class="free">s</span> <span class="free">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> real_of_rat <span class="main">(</span><span class="free">s</span> <span class="free">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> of_rat_diff<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms incseq_rat_le_real linorder_not_less order_trans<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-lemma_LIMSEQ_incseq_diff_inverse"><span class="command">lemma</span></span> lemma_LIMSEQ_incseq_diff_inverse<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">" <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat<span class="main">(</span><span class="free">s</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">/</span>of_nat<span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> real_of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">x</span><span class="main">)</span> <span class="main">-</span> inverse <span class="main">(</span>real <span class="main">(</span>Suc <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms tendsto_diff <span class="main">[</span><span class="operator">OF</span> _ LIMSEQ_inverse_real_of_nat<span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> divide_inverse  of_rat_diff of_rat_inverse of_rat_add<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-lemma_LIMSEQ_powrat_diff_inverse"><span class="command">lemma</span></span> lemma_LIMSEQ_powrat_diff_inverse<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">a</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">⇢</span> <span class="free">y</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">s</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">/</span>of_nat<span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>  
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> LIMSEQ_powrat_inverse_of_nat 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> LIMSEQ_Suc <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> divide_inverse mult_1_left<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">" <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">s</span> <span class="bound">n</span> <span class="main">/</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">y</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> tendsto_divide <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> powrat_diff assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-lemma_LIMSEQ_powrat_diff_inverse2"><span class="command">lemma</span></span> lemma_LIMSEQ_powrat_diff_inverse2<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">a</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">s</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">/</span>of_nat<span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">⇢</span> <span class="free">y</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> LIMSEQ_powrat_inverse_of_nat 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> LIMSEQ_Suc <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> divide_inverse mult_1_left<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> inverse <span class="main">(</span>rat_of_nat <span class="main">(</span>Suc <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> 
                  <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">s</span> <span class="bound">x</span> <span class="main">-</span> inverse<span class="main">(</span>rat_of_nat <span class="main">(</span>Suc <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
              <span class="main">⇢</span> <span class="main">1</span> <span class="main">*</span> <span class="free">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> tendsto_mult <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> inverse_eq_divide<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_add <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span>  <span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-lemma_seq_point_gt_ex"><span class="command">lemma</span></span> lemma_seq_point_gt_ex<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span><span class="main">;</span> <span class="free">y</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟧</span> 
   <span class="main">⟹</span> <span class="main">∃</span><span class="main">(</span><span class="bound">m</span><span class="main">::</span>nat<span class="main">)</span><span class="main">.</span>  <span class="free">y</span> <span class="main">&lt;</span> of_rat<span class="main">(</span><span class="free">r</span> <span class="bound">m</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> convergent_def limI lim_le not_less<span class="main">)</span>

<span class="keyword1" id="RealPower-lemma_seq_point_gt_ex2"><span class="command">lemma</span></span> lemma_seq_point_gt_ex2<span class="main">:</span> 
   <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span><span class="main">;</span> of_rat <span class="free">y</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟧</span> 
    <span class="main">⟹</span> <span class="main">(</span><span class="main">∃</span><span class="bound">m</span><span class="main">.</span> <span class="free">y</span> <span class="main">&lt;</span> <span class="free">r</span> <span class="bound">m</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> lemma_seq_point_gt_ex <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> of_rat_less<span class="main">)</span>

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">interlaced_index</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> rat<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> rat<span class="main">)</span> <span class="main">⇒</span> nat <span class="main">⇒</span> nat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">interlaced_index</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="main">0</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">"<span class="free">interlaced_index</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="main">(</span>Suc <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="main">=</span>  
          <span class="main">(</span><span class="keyword1">LEAST</span> <span class="bound">m</span><span class="main">.</span> <span class="keyword1">if</span> odd <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="keyword1">then</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">(</span><span class="free">interlaced_index</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="main">&lt;</span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="bound">m</span>
                    <span class="keyword1">else</span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="main">(</span><span class="free">interlaced_index</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> <span class="main">&lt;</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="bound">m</span><span class="main">)</span>"</span></span>


<span class="keyword1"><span class="command">definition</span></span> <span class="entity">interlaced_seq</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span>nat <span class="main">⇒</span> rat<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span>nat <span class="main">⇒</span> rat<span class="main">)</span> <span class="main">⇒</span> nat <span class="main">⇒</span> rat"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">interlaced_seq</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> odd <span class="free"><span class="bound"><span class="entity">n</span></span></span> <span class="keyword1">then</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">(</span>interlaced_index <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span> 
                           <span class="keyword1">else</span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="main">(</span>interlaced_index <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="free"><span class="bound"><span class="entity">s</span></span></span> <span class="free"><span class="bound"><span class="entity">n</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1" id="RealPower-incseq_interlaced_seq"><span class="command">lemma</span></span> incseq_interlaced_seq<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"incseq <span class="main">(</span>interlaced_seq <span class="free">r</span> <span class="free">s</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"interlaced_seq <span class="free">r</span> <span class="free">s</span> <span class="skolem">n</span> <span class="main">≤</span> interlaced_seq <span class="free">r</span> <span class="free">s</span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> assms 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> LeastI2_ex <span class="main"><span class="main">[</span></span><span class="operator">OF</span> lemma_seq_point_gt_ex2<span class="main"><span class="main">]</span></span> 
          <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> interlaced_seq_def<span class="main">)</span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> incseq_SucI<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-incseq_of_rat_interlaced_seq"><span class="command">lemma</span></span> incseq_of_rat_interlaced_seq<span class="main">:</span>
   <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span><span class="main">;</span> 
      <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span><span class="main">;</span>
      <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">;</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟧</span> 
    <span class="main">⟹</span> incseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> real_of_rat <span class="main">(</span>interlaced_seq <span class="free">r</span> <span class="free">s</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> incseq_interlaced_seq incseq_of_rat <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="RealPower-interlaced_seq_bounded"><span class="command">lemma</span></span> interlaced_seq_bounded<span class="main">:</span> 
   <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">;</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">⟧</span> 
    <span class="main">⟹</span> of_rat <span class="main">(</span>interlaced_seq <span class="free">r</span> <span class="free">s</span> <span class="free">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> interlaced_seq_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1" id="RealPower-convergent_interlaced_seq"><span class="command">lemma</span></span> convergent_interlaced_seq<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"convergent <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> real_of_rat <span class="main">(</span>interlaced_seq <span class="free">r</span> <span class="free">s</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">have</span></span> mono<span class="main">:</span> <span class="quoted"><span class="quoted">"monoseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> real_of_rat <span class="main">(</span>interlaced_seq <span class="free">r</span> <span class="free">s</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms incseq_interlaced_seq incseq_of_rat monoseq_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> 
     <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"interlaced_seq <span class="free">r</span> <span class="free">s</span> <span class="main">0</span> <span class="main">≤</span> interlaced_seq <span class="free">r</span> <span class="free">s</span> <span class="skolem">n</span>"</span></span>
     <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="skolem">n</span></span><span class="main">)</span>
       <span class="keyword3"><span class="command">case</span></span> 0
       <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
     <span class="keyword1"><span class="command">next</span></span>
       <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span>
       <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
         <span class="keyword1"><span class="command">using</span></span> assms incseq_def incseq_interlaced_seq <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
     <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> 
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span>
   <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"real_of_rat <span class="main">(</span>interlaced_seq <span class="free">r</span> <span class="free">s</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">,</span></span>4<span class="main"><span class="main">)</span></span> interlaced_seq_bounded le_less<span class="main">)</span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Bseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> real_of_rat <span class="main">(</span>interlaced_seq <span class="free">r</span> <span class="free">s</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> decseq_bounded incseq_bounded mono monoseq_iff of_rat_less_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> mono
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Bseq_monoseq_convergent<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-convergent_powrat_interlaced_seq"><span class="command">lemma</span></span> convergent_powrat_interlaced_seq<span class="main">:</span>
   <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">1</span> <span class="main">≤</span> <span class="free">a</span><span class="main">;</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span><span class="main">;</span> 
      <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span><span class="main">;</span>
      <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">;</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟧</span> 
    <span class="main">⟹</span> convergent <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>interlaced_seq <span class="free">r</span> <span class="free">s</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> Bseq_monoseq_convergent incseq_interlaced_seq 
            interlaced_seq_bounded less_imp_le incseq_imp_monoseq 
            incseq_incseq_powrat Bseq_powrat_incseq <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="main"><span class="main">_</span></span> <span class="main"><span class="main">_</span></span> <span class="quoted"><span class="free">x</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1" id="RealPower-LIMSEQ_even_odd_subseq_LIMSEQ"><span class="command">lemma</span></span> LIMSEQ_even_odd_subseq_LIMSEQ<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">X</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">X</span> <span class="main">(</span>Suc<span class="main">(</span><span class="numeral">2</span> <span class="main">*</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">a</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">a</span> <span class="main">::</span> <span class="tfree">'a</span><span class="main">::</span>real_normed_vector<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LIMSEQ_iff<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">r</span><span class="main">::</span><span class="quoted">real</span>
  <span class="keyword3"><span class="command">assume</span></span> e0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="keyword2"><span class="keyword">where</span></span> evenx<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="skolem">p</span><span class="main">.</span> norm <span class="main">(</span><span class="free">X</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">n</span><span class="main">)</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span>  e0 assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span>  LIMSEQ_iff<span class="main">)</span> 
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> oddx<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="skolem">q</span><span class="main">.</span> norm <span class="main">(</span><span class="free">X</span> <span class="main">(</span>Suc <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span>  e0 assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span>  LIMSEQ_iff<span class="main">)</span> 
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> 
    <span class="keyword3"><span class="command">assume</span></span> max<span class="main">:</span> <span class="quoted"><span class="quoted">"max <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">p</span><span class="main">)</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">q</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">n</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"norm <span class="main">(</span><span class="free">X</span> <span class="skolem">n</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"even <span class="skolem">n</span>"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> True
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
        <span class="keyword1"><span class="command">using</span></span> dvd_def evenx max 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> False
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> oddx max 
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">elim</span><span class="main"><span class="main">:</span></span> oddE<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">no</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">no</span><span class="main">.</span> norm <span class="main">(</span><span class="free">X</span> <span class="bound">n</span> <span class="main">-</span> <span class="free">a</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(* Not proved before? *)</span>
<span class="keyword1" id="RealPower-incseqD2"><span class="command">lemma</span></span> incseqD2<span class="main">:</span> <span class="quoted"><span class="quoted">"incseq <span class="free">r</span> <span class="main">⟹</span> <span class="free">r</span> <span class="free">m</span> <span class="main">&lt;</span> <span class="free">r</span> <span class="free">n</span> <span class="main">⟹</span> <span class="free">m</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> le_less mono_def not_le order.asym<span class="main">)</span>

<span class="keyword1" id="RealPower-subseq_interlaced_index_even"><span class="command">lemma</span></span> subseq_interlaced_index_even<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"incseq <span class="free">r</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"incseq <span class="free">s</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"strict_mono <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> interlaced_index <span class="free">r</span> <span class="free">s</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
 <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"interlaced_index <span class="free">r</span> <span class="free">s</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">n</span><span class="main">)</span>
         <span class="main">&lt;</span> <span class="main">(</span><span class="keyword1">LEAST</span> <span class="bound">m</span><span class="main">.</span> <span class="free">r</span> <span class="main">(</span><span class="keyword1">LEAST</span> <span class="bound">m</span><span class="main">.</span> <span class="free">s</span> <span class="main">(</span>interlaced_index <span class="free">r</span> <span class="free">s</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">r</span> <span class="bound">m</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">s</span> <span class="bound">m</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> LeastI2_ex <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">λ</span></span> <span class="bound"><span class="bound">m</span></span><span class="main"><span class="main">.</span></span> <span class="free"><span class="free">s</span></span> <span class="main"><span class="main">(</span></span>interlaced_index <span class="free"><span class="free">r</span></span> <span class="free"><span class="free">s</span></span> <span class="main"><span class="main">(</span></span><span class="numeral"><span class="numeral">2</span></span> <span class="main"><span class="main">*</span></span> <span class="skolem"><span class="skolem">n</span></span><span class="main"><span class="main">)</span></span><span class="main"><span class="main">)</span></span> <span class="main"><span class="main">&lt;</span></span> <span class="free"><span class="free">r</span></span> <span class="bound"><span class="bound">m</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="free">s</span> <span class="main">(</span>interlaced_index <span class="free">r</span> <span class="free">s</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">r</span> <span class="bound">a</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> assms<span class="main">(</span>6<span class="main">)</span> lemma_seq_point_gt_ex2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span>
    <span class="keyword3"><span class="command">assume</span></span> inter_s<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">(</span>interlaced_index <span class="free">r</span> <span class="free">s</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">r</span> <span class="skolem">m</span>"</span></span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"interlaced_index <span class="free">r</span> <span class="free">s</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="main">(</span><span class="keyword1">LEAST</span> <span class="bound">ma</span><span class="main">.</span> <span class="free">r</span> <span class="skolem">m</span> <span class="main">&lt;</span> <span class="free">s</span> <span class="bound">ma</span><span class="main">)</span> "</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> LeastI2_ex<span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="free">r</span> <span class="skolem">m</span> <span class="main">&lt;</span> <span class="free">s</span> <span class="bound">a</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">)</span> assms<span class="main">(</span>5<span class="main">)</span> lemma_seq_point_gt_ex2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">k</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="skolem">m</span> <span class="main">&lt;</span> <span class="free">s</span> <span class="skolem">k</span>"</span></span> 
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"interlaced_index <span class="free">r</span> <span class="free">s</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">k</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> inter_s assms<span class="main">(</span>2<span class="main">)</span> incseqD2 less_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> strict_mono_Suc_iff<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-subseq_interlaced_index_odd"><span class="command">lemma</span></span> subseq_interlaced_index_odd<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"incseq <span class="free">r</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"incseq <span class="free">s</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"strict_mono <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> interlaced_index <span class="free">r</span> <span class="free">s</span> <span class="main">(</span>Suc <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">LEAST</span> <span class="bound">m</span><span class="main">.</span> <span class="free">s</span> <span class="main">(</span>interlaced_index <span class="free">r</span> <span class="free">s</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">r</span> <span class="bound">m</span><span class="main">)</span>
             <span class="main">&lt;</span> <span class="main">(</span><span class="keyword1">LEAST</span> <span class="bound">m</span><span class="main">.</span>
                  <span class="free">s</span> <span class="main">(</span><span class="keyword1">LEAST</span> <span class="bound">m</span><span class="main">.</span> <span class="free">r</span> <span class="main">(</span><span class="keyword1">LEAST</span> <span class="bound">m</span><span class="main">.</span> <span class="free">s</span> <span class="main">(</span>interlaced_index <span class="free">r</span> <span class="free">s</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">r</span> <span class="bound">m</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">s</span> <span class="bound">m</span><span class="main">)</span>
                   <span class="main">&lt;</span> <span class="free">r</span> <span class="bound">m</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> LeastI2_ex <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">(</span></span><span class="main"><span class="main">λ</span></span> <span class="bound"><span class="bound">m</span></span><span class="main"><span class="main">.</span></span> <span class="free"><span class="free">s</span></span> <span class="main"><span class="main">(</span></span>interlaced_index <span class="free"><span class="free">r</span></span> <span class="free"><span class="free">s</span></span> <span class="main"><span class="main">(</span></span><span class="numeral"><span class="numeral">2</span></span> <span class="main"><span class="main">*</span></span> <span class="skolem"><span class="skolem">n</span></span><span class="main"><span class="main">)</span></span><span class="main"><span class="main">)</span></span> <span class="main"><span class="main">&lt;</span></span> <span class="free"><span class="free">r</span></span> <span class="bound"><span class="bound">m</span></span><span class="main"><span class="main">)</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="free">s</span> <span class="main">(</span>interlaced_index <span class="free">r</span> <span class="free">s</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">r</span> <span class="bound">a</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> assms<span class="main">(</span>6<span class="main">)</span> lemma_seq_point_gt_ex2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span>
      <span class="keyword3"><span class="command">assume</span></span> inter_s<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">(</span>interlaced_index <span class="free">r</span> <span class="free">s</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">r</span> <span class="skolem">m</span>"</span></span> 
      <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">&lt;</span> <span class="main">(</span><span class="keyword1">LEAST</span> <span class="bound">ma</span><span class="main">.</span> <span class="free">s</span> <span class="main">(</span><span class="keyword1">LEAST</span> <span class="bound">ma</span><span class="main">.</span> <span class="free">r</span> <span class="skolem">m</span> <span class="main">&lt;</span> <span class="free">s</span> <span class="bound">ma</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">r</span> <span class="bound">ma</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> LeastI2_ex <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main">λ</span></span><span class="bound"><span class="bound">ma</span></span><span class="main"><span class="main">.</span></span> <span class="free"><span class="free">r</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="main"><span class="main">&lt;</span></span> <span class="free"><span class="free">s</span></span> <span class="bound"><span class="bound">ma</span></span>"</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="free">r</span> <span class="skolem">m</span> <span class="main">&lt;</span> <span class="free">s</span> <span class="bound">a</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">)</span> assms<span class="main">(</span>5<span class="main">)</span> lemma_seq_point_gt_ex2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">k</span> 
        <span class="keyword3"><span class="command">assume</span></span> rs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="skolem">m</span> <span class="main">&lt;</span> <span class="free">s</span> <span class="skolem">k</span>"</span></span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">&lt;</span> <span class="main">(</span><span class="keyword1">LEAST</span> <span class="bound">ma</span><span class="main">.</span> <span class="free">s</span> <span class="skolem">k</span> <span class="main">&lt;</span> <span class="free">r</span> <span class="bound">ma</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> LeastI2_ex<span class="main">)</span>
          <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">.</span> <span class="free">s</span> <span class="skolem">k</span> <span class="main">&lt;</span> <span class="free">r</span> <span class="bound">a</span>"</span></span>
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> assms<span class="main">(</span>6<span class="main">)</span> lemma_seq_point_gt_ex2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">next</span></span>
          <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">l</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="skolem">k</span> <span class="main">&lt;</span> <span class="free">r</span> <span class="skolem">l</span>"</span></span> 
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">&lt;</span> <span class="skolem">l</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> rs
            <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> incseqD2 less_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> strict_mono_Suc_iff<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-interlaced_seq_even"><span class="command">lemma</span></span> interlaced_seq_even<span class="main">:</span>
      <span class="quoted"><span class="quoted">"interlaced_seq <span class="free">r</span> <span class="free">s</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">s</span> <span class="main">(</span>interlaced_index <span class="free">r</span> <span class="free">s</span> <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> interlaced_seq_def<span class="main">)</span>


<span class="keyword1" id="RealPower-interlaced_seq_odd"><span class="command">lemma</span></span> interlaced_seq_odd<span class="main">:</span>
      <span class="quoted"><span class="quoted">"interlaced_seq <span class="free">r</span> <span class="free">s</span> <span class="main">(</span>Suc <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">r</span> <span class="main">(</span>interlaced_index <span class="free">r</span> <span class="free">s</span> <span class="main">(</span>Suc <span class="main">(</span><span class="numeral">2</span><span class="main">*</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> interlaced_seq_def<span class="main">)</span>

<span class="keyword1" id="RealPower-powa_indep_incseq_of"><span class="command">lemma</span></span> powa_indep_incseq_of<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">a</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"incseq <span class="free">r</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"incseq <span class="free">s</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> real_of_rat <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> real_of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">y</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">s</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">z</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span> <span class="main">=</span> <span class="free">z</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> rx<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> real_of_rat <span class="main">(</span><span class="free">r</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">)</span> lemma_LIMSEQ_incseq_diff_inverse <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> sx<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> real_of_rat <span class="main">(</span><span class="free">s</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>5<span class="main">)</span> lemma_LIMSEQ_incseq_diff_inverse <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"convergent
      <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span>
           interlaced_seq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">r</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>
            <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">s</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> convergent_powrat_interlaced_seq  
             <span class="main">[</span><span class="operator">of</span> <span class="main">_</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">r</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
                 <span class="main">_</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">s</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span><span class="main">]</span>
               assms<span class="main">(</span>1<span class="main">,</span>2<span class="main">,</span>3<span class="main">,</span>4<span class="main">,</span>5<span class="main">)</span> lemma_incseq_diff_inverse_ub
               lemma_LIMSEQ_incseq_diff_inverse <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> 
    <span class="keyword2"><span class="keyword">where</span></span> converge<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> 
                interlaced_seq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">r</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>
                <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">s</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">L</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> convergent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span>
                interlaced_seq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">r</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>
                 <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">s</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="bound">n</span><span class="main">)</span> <span class="main">∘</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="numeral">2</span> <span class="main">*</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">L</span>"</span></span>  
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LIMSEQ_subseq_LIMSEQ strict_mono_Suc_iff<span class="main">)</span> 
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span>
                interlaced_seq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">r</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>
                 <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">s</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="bound">n</span><span class="main">)</span> <span class="main">∘</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> Suc <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">L</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> converge <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LIMSEQ_subseq_LIMSEQ strict_mono_Suc_iff<span class="main">)</span> 
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∘</span>
           <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> interlaced_index <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">r</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>
                 <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">s</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Suc <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> rx sx 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"strict_mono
            <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> interlaced_index <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">r</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>
              <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">s</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>Suc <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> subseq_interlaced_index_odd lemma_incseq_incseq_diff_inverse
                    lemma_incseq_diff_inverse_ub assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span>  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">y</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> assms<span class="main">(</span>6<span class="main">)</span> lemma_LIMSEQ_powrat_diff_inverse <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> LIMSEQ_subseq_LIMSEQ <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">s</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∘</span>
           <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> interlaced_index <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">r</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>
                 <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">s</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
          <span class="main">⇢</span> <span class="free">z</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> rx sx 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"strict_mono
     <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> interlaced_index <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">r</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>
           <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">s</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> subseq_interlaced_index_even lemma_incseq_incseq_diff_inverse
                    lemma_incseq_diff_inverse_ub assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">s</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span> <span class="main">/</span> rat_of_nat <span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">z</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> assms<span class="main">(</span>7<span class="main">)</span> lemma_LIMSEQ_powrat_diff_inverse <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> LIMSEQ_subseq_LIMSEQ <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> LIMSEQ_unique <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> o_def interlaced_seq_even interlaced_seq_odd<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-powa_indep_incseq_of'"><span class="command">lemma</span></span> powa_indep_incseq_of'<span class="main">:</span>
      <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">1</span> <span class="main">≤</span> <span class="free">a</span><span class="main">;</span> incseq <span class="free">r</span><span class="main">;</span>
         <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> real_of_rat <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">x</span><span class="main">;</span> 
         <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">r</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">y</span> <span class="main">⟧</span> 
       <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> powa_indep_incseq_of <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">r</span></span> <span class="quoted"><span class="quoted">"incseq_of <span class="free">x</span>"</span></span><span class="main">]</span> LIMSEQ_powa
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="comment1">(* Similar theorems as above, but specialized to incseq_of *)</span>
<span class="keyword1" id="RealPower-lemma_incseq_incseq_of_diff_inverse"><span class="command">lemma</span></span> lemma_incseq_incseq_of_diff_inverse<span class="main">:</span>
   <span class="quoted"><span class="quoted">"incseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> incseq_of <span class="free">x</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">/</span>of_nat<span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> lemma_incseq_incseq_diff_inverse incseq_incseq_of<span class="main">)</span>
 
<span class="keyword1" id="RealPower-lemma_incseq_of_diff_inverse_ub"><span class="command">lemma</span></span> lemma_incseq_of_diff_inverse_ub<span class="main">:</span>
   <span class="quoted"><span class="quoted">"of_rat<span class="main">(</span>incseq_of <span class="free">x</span> <span class="free">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">/</span>of_nat<span class="main">(</span>Suc <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> lemma_incseq_diff_inverse_ub incseq_incseq_of LIMSEQ_incseq_of<span class="main">)</span>

 <span class="keyword1" id="RealPower-lemma_LIMSEQ_incseq_of_diff_inverse"><span class="command">lemma</span></span> lemma_LIMSEQ_incseq_of_diff_inverse<span class="main">:</span> 
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> of_rat<span class="main">(</span>incseq_of <span class="free">x</span> <span class="bound">n</span> <span class="main">-</span> <span class="main">1</span><span class="main">/</span>of_nat<span class="main">(</span>Suc <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">blast</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> lemma_LIMSEQ_incseq_diff_inverse incseq_incseq_of LIMSEQ_incseq_of<span class="main">)</span>

<span class="keyword1" id="RealPower-powa_add"><span class="command">lemma</span></span> powa_add<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">a</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">powa</span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span> <span class="main">*</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">y</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">k</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> LIMSEQ_powrat_incseq_of_ex1 assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="keyword2"><span class="keyword">where</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">l</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> LIMSEQ_powrat_incseq_of_ex1 assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>incseq_of <span class="free">x</span> <span class="bound">n</span> <span class="main">+</span> incseq_of <span class="free">y</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">l</span> <span class="main">*</span> <span class="skolem">k</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span>  tendsto_mult <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_add <span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"incseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> incseq_of <span class="free">x</span> <span class="bound">n</span> <span class="main">+</span> incseq_of <span class="free">y</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span>  <span class="main">(</span><span class="operator">force</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> incseq_SucI add_mono<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> real_of_rat <span class="main">(</span>incseq_of <span class="free">x</span> <span class="bound">n</span> <span class="main">+</span> incseq_of <span class="free">y</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">x</span> <span class="main">+</span> <span class="free">y</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> of_rat_add <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> tendsto_add LIMSEQ_incseq_of<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="free">y</span><span class="main">)</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">l</span> <span class="main">*</span> <span class="skolem">k</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms powa_indep_incseq_of' <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> powa_def 1 2
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Lim_def limI<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-real_inverse_ge_one_lemma"><span class="command">lemma</span></span> real_inverse_ge_one_lemma<span class="main">:</span> 
      <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="main">(</span><span class="free">a</span><span class="main">::</span>real<span class="main">)</span><span class="main">;</span> <span class="free">a</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">⟧</span> <span class="main">⟹</span> inverse <span class="free">a</span> <span class="main">≥</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> less_eq_real_def one_le_inverse_iff<span class="main">)</span>

<span class="keyword1" id="RealPower-real_inverse_gt_one_lemma"><span class="command">lemma</span></span> real_inverse_gt_one_lemma<span class="main">:</span> 
      <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="main">(</span><span class="free">a</span><span class="main">::</span>real<span class="main">)</span><span class="main">;</span> <span class="free">a</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">⟧</span> <span class="main">⟹</span> inverse <span class="free">a</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> one_less_inverse_iff<span class="main">)</span>

<span class="keyword1" id="RealPower-real_inverse_bet_one_one_lemma"><span class="command">lemma</span></span> real_inverse_bet_one_one_lemma<span class="main">:</span> 
      <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="main">(</span><span class="free">a</span><span class="main">::</span>real<span class="main">)</span> <span class="main">⟹</span> <span class="main">0</span> <span class="main">&lt;</span> inverse <span class="free">a</span> <span class="main">∧</span> inverse <span class="free">a</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inverse_less_1_iff inverse_positive_iff_positive 
        le_less_trans zero_le_one<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_add"><span class="command">lemma</span></span> powreal_add<span class="main">:</span> 
   <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span> <span class="main">*</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> minus_add_distrib mult_zero_right powa_add 
       powreal_def real_inverse_ge_one_lemma<span class="main">)</span>

<span class="keyword1" id="RealPower-powa_one_eq_one"><span class="command">lemma</span></span> powa_one_eq_one <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="keyword1">powa</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">1</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">a</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Lim_def limI powa_def<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span> 

<span class="keyword1" id="RealPower-powreal_one_eq_one"><span class="command">lemma</span></span> powreal_one_eq_one <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powreal_def<span class="main">)</span>

<span class="keyword1" id="RealPower-powa_zero_eq_one"><span class="command">lemma</span></span> powa_zero_eq_one <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="main">0</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> the1_equality LIMSEQ_powrat_incseq_of_ex1 
            <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> powa_indep_incseq_of' <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">0</span>"</span></span><span class="main"><span class="main">]</span></span> incseq_SucI
            <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powa_def<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_zero_eq_one"><span class="command">lemma</span></span> powreal_zero_eq_one <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">0</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> real_inverse_ge_one_lemma <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powreal_def<span class="main">)</span>

<span class="keyword1" id="RealPower-powr_zero_eq_one_iff"><span class="command">lemma</span></span> powr_zero_eq_one_iff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">0</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="free">x</span> <span class="main">≤</span> <span class="main">0</span> <span class="keyword1">then</span> <span class="main">0</span> <span class="keyword1">else</span> <span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> powreal_def powreal_zero_eq_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>

<span class="keyword1" id="RealPower-powa_one_gt_zero"><span class="command">lemma</span></span> powa_one_gt_zero <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">a</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="main">1</span> <span class="main">=</span> <span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> LIMSEQ_powrat_incseq_of_ex1 the1_equality 
    powa_indep_incseq_of' <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">1</span>"</span></span><span class="main"><span class="main">]</span></span>  incseq_SucI <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powa_def<span class="main">)</span>

<span class="keyword1" id="RealPower-powa_minus_one"><span class="command">lemma</span></span> powa_minus_one<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">powa</span> <span class="main">-</span><span class="main">1</span> <span class="main">=</span> inverse <span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">⇢</span> inverse <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_minus<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="main">(</span><span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> inverse <span class="free">a</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> powa_indep_incseq_of' <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="quoted">"<span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">-</span><span class="main">1</span>"</span></span><span class="main">]</span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> powa_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Lim_def limI<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> 

<span class="keyword1" id="RealPower-powreal_minus_one"><span class="command">lemma</span></span> powreal_minus_one<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">a</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">-</span><span class="main">1</span> <span class="main">=</span> inverse <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powa_minus_one powreal_def real_inverse_ge_one_lemma<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_one"><span class="command">lemma</span></span> powreal_one <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">1</span> <span class="main">=</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powa_minus_one powreal_def real_inverse_ge_one_lemma<span class="main">)</span>

<span class="keyword1" id="RealPower-powa_gt_zero"><span class="command">lemma</span></span> powa_gt_zero<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> LIMSEQ_powrat_incseq_of_ex1 assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"incseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms incseq_powrat_insec_of<span class="main">)</span> 
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms incseq_le powrat_gt_zero
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> less_le_trans zero_less_one<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> powa_def 1
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Lim_def limI<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-powreal_gt_zero"><span class="command">lemma</span></span> powreal_gt_zero<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> powa_gt_zero real_inverse_ge_one_lemma 
        <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powreal_def not_less<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_not_zero"><span class="command">lemma</span></span> powreal_not_zero<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> order_less_imp_not_eq powreal_gt_zero<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_minus"><span class="command">lemma</span></span> powreal_minus<span class="main">:</span> 
    <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">-</span><span class="free">x</span> <span class="main">=</span> inverse <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> True
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> powreal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span> 
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span> <span class="main">*</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">-</span><span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> powreal_add <span class="keyword1"><span class="command">by</span></span> <span class="operator">presburger</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> inverse_unique powreal_def powreal_zero_eq_one 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-powreal_minus_base_ge_one"><span class="command">lemma</span></span> powreal_minus_base_ge_one<span class="main">:</span> 
   <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>inverse <span class="free">a</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">using</span></span> one_le_inverse_iff powreal_def  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="RealPower-powreal_inverse"><span class="command">lemma</span></span> powreal_inverse<span class="main">:</span>
     <span class="quoted"><span class="quoted">"inverse <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>inverse <span class="free">a</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> powreal_minus powreal_minus_base_ge_one 
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">presburger</span>

<span class="keyword1" id="RealPower-powa_minus"><span class="command">lemma</span></span> powa_minus<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="main">(</span><span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> inverse <span class="main">(</span><span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> powreal_eq_powa powreal_minus<span class="main">)</span>

<span class="keyword1" id="RealPower-powa_mult_base"><span class="command">lemma</span></span> powa_mult_base<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">b</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="main">*</span> <span class="free">b</span><span class="main">)</span> <span class="keyword1">powa</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">b</span> <span class="keyword1">powa</span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x'</span></span> <span class="keyword2"><span class="keyword">where</span></span> lim_a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">x'</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> LIMSEQ_powrat_incseq_of_ex1 assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> lim_a_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">THE</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">x'</span>"</span></span>
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Lim_def limI<span class="main">)</span> 
   <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y'</span></span> <span class="keyword2"><span class="keyword">where</span></span> lim_b<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">b</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">y'</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> LIMSEQ_powrat_incseq_of_ex1 assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> lim_b_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">THE</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">b</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">y'</span>"</span></span>
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Lim_def limI<span class="main">)</span> 
   <span class="keyword1"><span class="command">have</span></span> lim_ab<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">a</span> <span class="main">*</span> <span class="free">b</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">x'</span> <span class="main">*</span> <span class="skolem">y'</span>"</span></span>  
     <span class="keyword1"><span class="command">using</span></span> lim_a lim_b <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> tendsto_mult <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powrat_mult_base<span class="main">)</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">THE</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">a</span> <span class="main">*</span> <span class="free">b</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">x'</span> <span class="main">*</span> <span class="skolem">y'</span>"</span></span>
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Lim_def limI<span class="main">)</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> lim_a_eq lim_b_eq powa_def<span class="main">)</span>
 <span class="keyword1"><span class="command">qed</span></span>   


<span class="keyword1" id="RealPower-powreal_mult_base_lemma1"><span class="command">lemma</span></span> powreal_mult_base_lemma1<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">1</span> <span class="main">≤</span> <span class="free">a</span><span class="main">;</span> <span class="main">1</span> <span class="main">≤</span> <span class="free">b</span> <span class="main">⟧</span> 
   <span class="main">⟹</span> <span class="main">(</span><span class="free">a</span> <span class="main">*</span> <span class="free">b</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">b</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult.left_neutral mult_mono' powa_mult_base powreal_eq_powa zero_le_one<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_mult_base_lemma2"><span class="command">lemma</span></span> powreal_mult_base_lemma2<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">a</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">b</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="main">*</span> <span class="free">b</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">b</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">*</span> <span class="free">b</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> True
  <span class="keyword3"><span class="command">assume</span></span> ab1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">*</span> <span class="free">b</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">*</span> <span class="free">b</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> inv_ab1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> inverse <span class="main">(</span><span class="free">a</span> <span class="main">*</span> <span class="free">b</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ab1 real_inverse_ge_one_lemma <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="main">*</span> <span class="main">(</span>inverse <span class="free">a</span> <span class="main">*</span> inverse <span class="free">b</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">powa</span> <span class="main">-</span> <span class="free">x</span> <span class="main">=</span>
             <span class="free">a</span> <span class="keyword1">powa</span> <span class="main">-</span> <span class="free">x</span> <span class="main">*</span> <span class="main">(</span>inverse <span class="free">a</span> <span class="main">*</span> inverse <span class="free">b</span><span class="main">)</span> <span class="keyword1">powa</span> <span class="main">-</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> powa_mult_base<span class="main">)</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>inverse <span class="free">b</span><span class="main">)</span> <span class="keyword1">powa</span> <span class="main">-</span> <span class="free">x</span> <span class="main">=</span>
             <span class="free">a</span> <span class="keyword1">powa</span> <span class="main">-</span> <span class="free">x</span> <span class="main">*</span> <span class="main">(</span>inverse <span class="free">a</span> <span class="main">*</span> inverse <span class="free">b</span><span class="main">)</span> <span class="keyword1">powa</span> <span class="main">-</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult.assoc <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>inverse <span class="free">a</span> <span class="main">*</span> inverse <span class="free">b</span><span class="main">)</span> <span class="keyword1">powa</span> <span class="main">-</span> <span class="free">x</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span> <span class="main">*</span> inverse <span class="free">b</span> <span class="keyword1">powa</span> <span class="main">-</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  mult.assoc <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span>  powa_add <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> ab1 assms powreal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">have</span></span> inv_b<span class="main">:</span> <span class="quoted"><span class="quoted">"inverse <span class="free">b</span> <span class="main">≥</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms real_inverse_ge_one_lemma<span class="main">)</span> 
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">a</span> <span class="main">*</span> <span class="free">b</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">*</span> <span class="free">b</span> <span class="main">≥</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="main">*</span> <span class="free">b</span> <span class="main">*</span> inverse <span class="free">b</span><span class="main">)</span> <span class="keyword1">powa</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span> <span class="main">*</span> <span class="free">b</span><span class="main">)</span> <span class="keyword1">powa</span> <span class="free">x</span> <span class="main">*</span> inverse <span class="free">b</span> <span class="keyword1">powa</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> powa_mult_base real_inverse_ge_one_lemma<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span> <span class="main">*</span> <span class="free">b</span><span class="main">)</span> <span class="keyword1">powa</span> <span class="free">x</span> <span class="main">*</span> inverse <span class="free">b</span> <span class="keyword1">powa</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult.assoc<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="main">*</span> <span class="free">b</span><span class="main">)</span> <span class="keyword1">powa</span> <span class="free">x</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span> <span class="main">*</span> inverse <span class="free">b</span> <span class="keyword1">powa</span> <span class="main">-</span> <span class="free">x</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult.assoc powa_add <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span> assms inv_b<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> False assms powreal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-powreal_mult_base_lemma3"><span class="command">lemma</span></span> powreal_mult_base_lemma3<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">b</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="main">*</span> <span class="free">b</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">b</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">*</span> <span class="free">b</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> less_trans mult.left_neutral mult_less_cancel_right_disj<span class="main">)</span> 
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>inverse <span class="free">a</span> <span class="main">*</span> inverse <span class="free">b</span><span class="main">)</span> <span class="keyword1">powa</span> <span class="main">-</span> <span class="free">x</span> <span class="main">=</span> 
                   inverse <span class="free">a</span> <span class="keyword1">powa</span> <span class="main">-</span> <span class="free">x</span> <span class="main">*</span> inverse <span class="free">b</span> <span class="keyword1">powa</span> <span class="main">-</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms powa_mult_base real_inverse_ge_one_lemma<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> powreal_def assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-powreal_mult_base"><span class="command">lemma</span></span> powreal_mult_base<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">b</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="main">*</span> <span class="free">b</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="free">b</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span> <span class="main">∧</span> <span class="free">b</span> <span class="main">≥</span> <span class="main">1</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> True
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powreal_mult_base_lemma1<span class="main">)</span> 
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">using</span></span> powreal_mult_base_lemma3 powreal_mult_base_lemma2 assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>verit<span class="main"><span class="main">)</span></span> mult.commute mult_minus_left powreal_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-incseq_le_all"><span class="command">lemma</span></span> incseq_le_all<span class="main">:</span> <span class="quoted"><span class="quoted">"incseq <span class="free">X</span> <span class="main">⟹</span> <span class="free">X</span> <span class="main">⇢</span> <span class="free">L</span> <span class="main">⟹</span> <span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="free">X</span> <span class="bound">n</span> <span class="main">≤</span> <span class="main">(</span><span class="free">L</span><span class="main">::</span>real<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> incseq_le<span class="main">)</span>

<span class="keyword1" id="RealPower-powa_powrat_eq"><span class="command">lemma</span></span> powa_powrat_eq<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">powa</span> <span class="main">(</span>of_rat <span class="free">q</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">q</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="main">(</span>real_of_rat <span class="free">q</span><span class="main">)</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">q</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> powa_indep_incseq_of' assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> powa_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Lim_def limI<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1" id="RealPower-realpow_powrat_eq"><span class="command">lemma</span></span> realpow_powrat_eq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span>of_rat <span class="free">q</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">q</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> a1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">a</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">∨</span> <span class="main">1</span> <span class="main">≤</span> inverse <span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> real_inverse_ge_one_lemma <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> a1
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inverse_inverse_eq not_le powa_powrat_eq 
         powrat_inverse powreal_eq_powa powreal_inverse<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(* Move to NthRoot.thy *)</span>
<span class="keyword1" id="RealPower-LIMSEQ_real_root"><span class="command">lemma</span></span> LIMSEQ_real_root<span class="main">:</span> 
   <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">X</span> <span class="main">⇢</span> <span class="free">a</span><span class="main">;</span> <span class="free">m</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> root <span class="free">m</span> <span class="main">(</span><span class="free">X</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span>root <span class="free">m</span> <span class="free">a</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> isCont_tendsto_compose <span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> g<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main"><span class="main">λ</span></span></span><span class="bound"><span class="bound"><span class="bound">x</span></span></span><span class="main"><span class="main"><span class="main">.</span></span></span> root <span class="free"><span class="free"><span class="free">m</span></span></span> <span class="bound"><span class="bound"><span class="bound">x</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span> isCont_real_root<span class="main">)</span>

<span class="keyword1" id="RealPower-powa_powrat_lemma1"><span class="command">lemma</span></span> powa_powrat_lemma1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">p</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">powa</span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> of_rat <span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> lim_a<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">y</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> LIMSEQ_powrat_incseq_of_ex1 assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> the_lim<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1">THE</span> <span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="bound">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span>
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Lim_def limI<span class="main">)</span> 
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">p</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">y</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">p</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> LIMSEQ_powrat_base assms<span class="main">(</span>1<span class="main">)</span> lim_a powa_def powa_gt_zero <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> lim_ap<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span>incseq_of <span class="free">x</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">p</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">y</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">p</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> powrat_mult <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="main">(</span><span class="free">x</span> <span class="main">*</span> real_of_rat <span class="free">p</span><span class="main">)</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">y</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">p</span>"</span></span>
   <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
     <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"incseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> incseq_of <span class="free">x</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">p</span><span class="main">)</span>"</span></span>
       <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> incseq_SucI mult_right_mono<span class="main">)</span> 
     <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> real_of_rat <span class="main">(</span>incseq_of <span class="free">x</span> <span class="bound">n</span> <span class="main">*</span> <span class="free">p</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">x</span> <span class="main">*</span> real_of_rat <span class="free">p</span>"</span></span> 
       <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> tendsto_mult <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> of_rat_mult<span class="main">)</span>
     <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
       <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> lim_ap powa_indep_incseq_of' <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
   <span class="keyword1"><span class="command">qed</span></span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> powa_def
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Lim_def limI the_lim<span class="main">)</span>
 <span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-powa_powrat_lemma2"><span class="command">lemma</span></span> powa_powrat_lemma2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">p</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">powa</span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> of_rat <span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">-</span> <span class="free">p</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> real_of_rat <span class="main">(</span><span class="main">-</span> <span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> less_imp_le powa_powrat_lemma1<span class="main">)</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"inverse <span class="main">(</span><span class="main">(</span><span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">p</span><span class="main">)</span> <span class="main">=</span> inverse <span class="main">(</span><span class="free">a</span> <span class="keyword1">powa</span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> real_of_rat <span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> of_rat_minus powa_minus powrat_minus<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-powa_powrat_lemma"><span class="command">lemma</span></span> powa_powrat_lemma<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">p</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">powa</span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> of_rat <span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> linorder_not_less powa_powrat_lemma1 powa_powrat_lemma2<span class="main">)</span>

<span class="comment1">(* Didn't we use to have something similar proved? *)</span>
<span class="keyword1" id="RealPower-LIMSEQ_iff2"><span class="command">lemma</span></span> LIMSEQ_iff2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">L</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>metric_space"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">X</span> <span class="main">⇢</span> <span class="free">L</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">::</span>nat<span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∃</span><span class="bound">no</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">no</span><span class="main">.</span> dist <span class="main">(</span><span class="free">X</span> <span class="bound">n</span><span class="main">)</span>  <span class="free">L</span> <span class="main">&lt;</span> inverse <span class="bound">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span>  <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">⇢</span> <span class="free">L</span>"</span></span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∃</span><span class="bound">no</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">no</span><span class="main">.</span> dist <span class="main">(</span><span class="free">X</span> <span class="bound">n</span><span class="main">)</span> <span class="free">L</span> <span class="main">&lt;</span> inverse <span class="main">(</span>real <span class="bound">m</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LIMSEQ_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> 
  <span class="keyword3"><span class="command">assume</span></span> assm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∃</span><span class="bound">no</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">no</span><span class="main">.</span> dist <span class="main">(</span><span class="free">X</span> <span class="bound">n</span><span class="main">)</span> <span class="free">L</span> <span class="main">&lt;</span> inverse <span class="main">(</span>real <span class="bound">m</span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">r</span>
   <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">::</span>real<span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> 
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">" <span class="main">∃</span><span class="bound">no</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">no</span><span class="main">.</span> dist <span class="main">(</span><span class="free">X</span> <span class="bound">n</span><span class="main">)</span> <span class="free">L</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span> 
     <span class="keyword1"><span class="command">using</span></span> assm  
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ex_inverse_of_nat_less less_trans<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">⇢</span> <span class="free">L</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> metric_LIMSEQ_I<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-LIM_def2"><span class="command">lemma</span></span> LIM_def2<span class="main">:</span>
   <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">─</span><span class="free">a</span><span class="main">→</span> <span class="free">L</span>  <span class="main">=</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">::</span>nat<span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">s</span></span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="free">a</span> <span class="main">∧</span> dist <span class="bound">x</span> <span class="free">a</span> <span class="main">&lt;</span> <span class="bound">s</span> <span class="main">⟶</span> dist <span class="main">(</span><span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="free">L</span> <span class="main">&lt;</span> inverse <span class="bound">m</span><span class="main">)</span>"</span></span>
   <span class="keyword2"><span class="keyword">for</span></span> <span class="free">a</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>metric_space"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">L</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'b</span><span class="main">::</span>metric_space"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">─</span><span class="free">a</span><span class="main">→</span> <span class="free">L</span>"</span></span>  
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">::</span>nat<span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">s</span></span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="free">a</span> <span class="main">∧</span> dist <span class="bound">x</span> <span class="free">a</span> <span class="main">&lt;</span> <span class="bound">s</span> <span class="main">⟶</span> dist <span class="main">(</span><span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="free">L</span> <span class="main">&lt;</span> inverse <span class="bound">m</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LIM_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> assm<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">::</span>nat<span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">s</span></span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="free">a</span> <span class="main">∧</span> dist <span class="bound">x</span> <span class="free">a</span> <span class="main">&lt;</span> <span class="bound">s</span> <span class="main">⟶</span> dist <span class="main">(</span><span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="free">L</span> <span class="main">&lt;</span> inverse <span class="bound">m</span>"</span></span>
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">r</span>
    <span class="keyword3"><span class="command">assume</span></span> r0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">r</span><span class="main">::</span>real<span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> 
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"inverse <span class="main">(</span>real <span class="main">(</span>Suc <span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> reals_Archimedean <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">s</span></span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="free">a</span> <span class="main">∧</span> dist <span class="bound">x</span> <span class="free">a</span> <span class="main">&lt;</span> <span class="bound">s</span> <span class="main">⟶</span> dist <span class="main">(</span><span class="free">f</span> <span class="bound">x</span><span class="main">)</span> <span class="free">L</span> <span class="main">&lt;</span> <span class="skolem">r</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> assm r0 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> order_less_trans zero_less_Suc<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">─</span><span class="free">a</span><span class="main">→</span> <span class="free">L</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> metric_LIM_I<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-powa_ge_one"><span class="command">lemma</span></span> powa_ge_one<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span> <span class="main">≥</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> lima<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> LIMSEQ_powrat_incseq_of_ex1 assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"incseq <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">x</span> <span class="bound">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> incseq_powrat_insec_of <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">x</span> <span class="bound">n</span> <span class="main">≤</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> incseq_le_all <span class="keyword1"><span class="command">using</span></span> calculation <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="skolem">y</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> assms LIMSEQ_incseq_of LIMSEQ_powa LIMSEQ_powrat_incseq_of_ex1 
          lemma_seq_point_gt_ex2 powa_zero_eq_one powrat_ge_one
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> less_le  of_rat_0  less_eq_real_def xt1<span class="main"><span class="main">(</span></span>6<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> LIMSEQ_powa LIMSEQ_unique assms<span class="main">(</span>1<span class="main">)</span> lima <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-powreal_ge_one"><span class="command">lemma</span></span> powreal_ge_one<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">≥</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span> <span class="main">≥</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powreal_def powa_ge_one<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_ge_one2"><span class="command">lemma</span></span> powreal_ge_one2<span class="main">:</span>  
   <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span><span class="main">;</span> <span class="free">a</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">;</span> <span class="free">x</span> <span class="main">≤</span> <span class="main">0</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span> <span class="main">≥</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powa_ge_one powreal_def real_inverse_ge_one_lemma<span class="main">)</span>
  
<span class="keyword1" id="RealPower-inverse_of_real_nat_of_rat_of_nat"><span class="command">lemma</span></span> inverse_of_real_nat_of_rat_of_nat<span class="main">:</span> 
      <span class="quoted"><span class="quoted">"inverse <span class="main">(</span>real_of_nat <span class="free">n</span><span class="main">)</span> <span class="main">=</span>  of_rat<span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Ratreal_def of_rat_of_nat_eq real_inverse_code<span class="main">)</span>

<span class="keyword1" id="RealPower-LIMSEQ_powa_inverse_of_nat"><span class="command">lemma</span></span> LIMSEQ_powa_inverse_of_nat<span class="main">:</span> 
   <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">powa</span> inverse <span class="main">(</span>real_of_nat <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  inverse_of_real_nat_of_rat_of_nat powa_powrat_eq 
      LIMSEQ_powrat_inverse_of_nat<span class="main">)</span>

<span class="keyword1" id="RealPower-incseq_of_le_mono"><span class="command">lemma</span></span> incseq_of_le_mono<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">≤</span> <span class="free">s</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">N</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">N</span><span class="main">.</span> incseq_of <span class="free">r</span> <span class="bound">n</span> <span class="main">≤</span>  incseq_of <span class="free">s</span> <span class="bound">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> <span class="free">s</span> <span class="main">∨</span> <span class="free">r</span> <span class="main">&lt;</span> <span class="free">s</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> <span class="free">s</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> rs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">&lt;</span> <span class="free">s</span>"</span></span> 
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span> less_incseq<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">&lt;</span> real_of_rat <span class="main">(</span>incseq_of <span class="free">s</span> <span class="skolem">m</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> LIMSEQ_incseq_of lemma_seq_point_gt_ex <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> real_of_rat <span class="main">(</span>incseq_of <span class="free">r</span> <span class="bound">n</span><span class="main">)</span> <span class="main">≤</span> <span class="free">r</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> incseq_of_le_self <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> real_of_rat <span class="main">(</span>incseq_of <span class="free">r</span> <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> real_of_rat <span class="main">(</span>incseq_of <span class="free">s</span> <span class="skolem">m</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> le_less_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> incrs<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> incseq_of <span class="free">r</span> <span class="bound">n</span> <span class="main">≤</span> incseq_of <span class="free">s</span> <span class="skolem">m</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> less_imp_le of_rat_less<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> incseq_def incseq_incseq_of order_trans<span class="main">)</span> 
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-powa_le_mono"><span class="command">lemma</span></span> powa_le_mono<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">≤</span> <span class="free">s</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">powa</span> <span class="free">r</span> <span class="main">≤</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="free">s</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">s</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> LIMSEQ_powrat_incseq_of_ex1 assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">r</span> <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="skolem">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> LIMSEQ_powrat_incseq_of_ex1 assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">N</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">N</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">r</span> <span class="bound">n</span> <span class="main">≤</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="free">s</span> <span class="bound">n</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> incseq_of_le_mono powrat_le_mono<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">≤</span> <span class="skolem">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> LIMSEQ_le calculation <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Lim_def limI powa_def<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-powreal_le_mono"><span class="command">lemma</span></span> powreal_le_mono<span class="main">:</span>
   <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">r</span> <span class="main">≤</span> <span class="free">s</span><span class="main">;</span> <span class="free">a</span> <span class="main">≥</span> <span class="main">1</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span> <span class="main">≤</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">s</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> powa_le_mono powreal_eq_powa<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_le_anti_mono"><span class="command">lemma</span></span> powreal_le_anti_mono<span class="main">:</span>
   <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">r</span> <span class="main">≤</span> <span class="free">s</span><span class="main">;</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span><span class="main">;</span> <span class="free">a</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span> <span class="main">≥</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">s</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powa_le_mono powreal_def real_inverse_ge_one_lemma<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_less_cancel"><span class="command">lemma</span></span> powreal_less_cancel<span class="main">:</span>
   <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">s</span><span class="main">;</span> <span class="free">a</span> <span class="main">≥</span> <span class="main">1</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">r</span> <span class="main">&lt;</span> <span class="free">s</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> less_le_not_le linorder_not_less powreal_eq_powa powreal_le_mono<span class="main">)</span>

<span class="keyword1" id="RealPower-powa_less_mono"><span class="command">lemma</span></span> powa_less_mono<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">&lt;</span> <span class="free">s</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">powa</span> <span class="free">r</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="free">s</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">&lt;</span> real_of_rat <span class="skolem">q</span>"</span></span> <span class="quoted"><span class="quoted">"real_of_rat <span class="skolem">q</span> <span class="main">&lt;</span> <span class="free">s</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> of_rat_dense <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">qa</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"real_of_rat <span class="skolem">q</span> <span class="main">&lt;</span> real_of_rat <span class="skolem">qa</span>"</span></span> <span class="quoted"><span class="quoted">"real_of_rat <span class="skolem">qa</span> <span class="main">&lt;</span> <span class="free">s</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> of_rat_dense calculation<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> antisym less_eq_real_def less_imp_not_eq2 powa_le_mono 
        powa_powrat_eq powrat_inject_exp<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-powreal_less_anti_mono"><span class="command">lemma</span></span> powreal_less_anti_mono<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">&lt;</span> <span class="free">s</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span> <span class="main">&gt;</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">s</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"inverse <span class="free">a</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">,</span></span> 3<span class="main"><span class="main">)</span></span> one_less_inverse_iff<span class="main">)</span> 
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"inverse <span class="free">a</span> <span class="keyword1">powa</span> <span class="free">r</span> <span class="main">&lt;</span> inverse <span class="free">a</span> <span class="keyword1">powa</span> <span class="free">s</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> powa_less_mono
    <span class="keyword1"><span class="command">using</span></span> calculation <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">using</span></span> powreal_eq_powa powreal_inverse powreal_le_anti_mono powreal_less_cancel
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">,</span></span>3<span class="main"><span class="main">)</span></span> le_less less_irrefl<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-powreal_less_mono"><span class="command">lemma</span></span> powreal_less_mono<span class="main">:</span>
   <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">r</span> <span class="main">&lt;</span> <span class="free">s</span><span class="main">;</span> <span class="free">a</span> <span class="main">&gt;</span> <span class="main">1</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">s</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powreal_def powa_less_mono<span class="main">)</span>

<span class="keyword1" id="RealPower-powa_le_cancel"><span class="command">lemma</span></span> powa_le_cancel<span class="main">:</span>
   <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="free">r</span> <span class="main">≤</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="free">s</span><span class="main">;</span> <span class="free">a</span> <span class="main">&gt;</span> <span class="main">1</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">r</span> <span class="main">≤</span> <span class="free">s</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> not_le powa_less_mono<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_le_cancel"><span class="command">lemma</span></span> powreal_le_cancel<span class="main">:</span>
   <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span> <span class="main">≤</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">s</span><span class="main">;</span> <span class="free">a</span> <span class="main">&gt;</span> <span class="main">1</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">r</span> <span class="main">≤</span> <span class="free">s</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> not_le powreal_less_mono<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_less_cancel_iff"><span class="command">lemma</span></span> powreal_less_cancel_iff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">r</span> <span class="main">&lt;</span> <span class="free">s</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> less_imp_le powreal_less_cancel powreal_less_mono<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_le_cancel_iff"><span class="command">lemma</span></span> powreal_le_cancel_iff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span> <span class="main">≤</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">r</span> <span class="main">≤</span> <span class="free">s</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> linorder_not_less <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_inject_exp1"><span class="command">lemma</span></span> powreal_inject_exp1 <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span>  <span class="main">⟹</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">s</span> <span class="main">=</span> <span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> antisym_conv3 less_irrefl powreal_less_mono<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_eq_one_iff"><span class="command">lemma</span></span> powreal_eq_one_iff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span> <span class="main">=</span> <span class="main">1</span> <span class="main">⟷</span> <span class="free">x</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">if</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> powreal_inject_exp1 that <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1" id="RealPower-powreal_inject_base_less_one"><span class="command">lemma</span></span> powreal_inject_base_less_one <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">⟹</span> <span class="free">a</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">s</span> <span class="main">=</span> <span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> linorder_neq_iff order_less_imp_not_eq2 powreal_less_anti_mono<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_inject"><span class="command">lemma</span></span> powreal_inject <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">⟹</span> <span class="free">a</span> <span class="main">≠</span> <span class="main">1</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">s</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">s</span> <span class="main">=</span> <span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> powreal_inject_base_less_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1" id="RealPower-powreal_gt_one"><span class="command">lemma</span></span> powreal_gt_one<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">1</span> <span class="main">⟹</span> <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> less_eq_real_def powa_less_mono powa_zero_eq_one powreal_eq_powa<span class="main">)</span>

<span class="keyword1" id="RealPower-isCont_powa_exponent_at_zero"><span class="command">lemma</span></span> isCont_powa_exponent_at_zero<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"isCont <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="bound">x</span><span class="main">)</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> 
  <span class="keyword3"><span class="command">assume</span></span> m0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">m</span><span class="main">::</span>nat<span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> 
  <span class="keyword1"><span class="command">have</span></span> lim1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">powa</span> inverse <span class="main">(</span>real <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LIMSEQ_powa_inverse_of_nat assms less_imp_le<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">no</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">no</span><span class="main">.</span> <span class="main">¦</span><span class="free">a</span> <span class="keyword1">powa</span> inverse <span class="main">(</span>real <span class="bound">n</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">¦</span> <span class="main">&lt;</span> inverse <span class="main">(</span>real <span class="skolem">m</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> lim1 LIMSEQ_iff2  dist_real_def m0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>      
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="quoted">"<span class="skolem"><span class="skolem">no</span></span>"</span> 
    <span class="keyword2"><span class="keyword">where</span></span> pow1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="skolem">no</span><span class="main">.</span> <span class="main">¦</span><span class="free">a</span> <span class="keyword1">powa</span> inverse <span class="main">(</span>real <span class="bound">n</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">¦</span> <span class="main">&lt;</span> inverse <span class="main">(</span>real <span class="skolem">m</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

  <span class="keyword1"><span class="command">have</span></span> lim2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> inverse <span class="main">(</span><span class="free">a</span> <span class="keyword1">powa</span> inverse <span class="main">(</span>real <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> tendsto_inverse lim1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">k</span><span class="main">.</span> <span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="bound">k</span><span class="main">.</span> <span class="main">¦</span>inverse <span class="main">(</span><span class="free">a</span> <span class="keyword1">powa</span> inverse <span class="main">(</span>real <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">¦</span> <span class="main">&lt;</span> inverse <span class="main">(</span>real <span class="skolem">m</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> LIMSEQ_iff2 dist_real_def m0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="quoted">"<span class="skolem"><span class="skolem">k</span></span>"</span> 
    <span class="keyword2"><span class="keyword">where</span></span> pow2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">n</span></span><span class="main">≥</span><span class="skolem">k</span><span class="main">.</span> <span class="main">¦</span>inverse <span class="main">(</span><span class="free">a</span> <span class="keyword1">powa</span> inverse <span class="main">(</span>real <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">¦</span> <span class="main">&lt;</span> inverse <span class="main">(</span>real <span class="skolem">m</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound"><span class="bound">s</span></span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">¦</span><span class="bound">x</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="bound">s</span> <span class="main">⟶</span>  <span class="main">¦</span><span class="main">(</span><span class="free">a</span> <span class="keyword1">powa</span> <span class="bound">x</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span><span class="main">¦</span> <span class="main">&lt;</span> inverse <span class="main">(</span>real <span class="skolem">m</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?d</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"min <span class="main">(</span>inverse <span class="main">(</span>Suc <span class="skolem">no</span><span class="main">)</span><span class="main">)</span> <span class="main">(</span>inverse <span class="main">(</span>Suc <span class="skolem">k</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">{</span></span><span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"abs <span class="skolem">x</span> <span class="main">&lt;</span> <span class="var">?d</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> x_bounds<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span> inverse <span class="main">(</span>of_nat<span class="main">(</span>Suc <span class="skolem">k</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="skolem">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">&lt;</span> inverse <span class="main">(</span>of_nat<span class="main">(</span>Suc <span class="skolem">no</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">powa</span> <span class="main">-</span> inverse <span class="main">(</span>of_nat <span class="main">(</span>Suc <span class="skolem">k</span><span class="main">)</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms powa_less_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">-</span> inverse <span class="main">(</span>real <span class="skolem">m</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="main">-</span> inverse <span class="main">(</span>real <span class="main">(</span>Suc <span class="skolem">k</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms pow2 powa_minus
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> minus_diff_eq neg_less_iff_less abs_less_iff lessI less_imp_le<span class="main">)</span>  
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> lo<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span> inverse<span class="main">(</span>real <span class="skolem">m</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="skolem">x</span> <span class="main">-</span> <span class="main">1</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">powa</span> <span class="skolem">x</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="keyword1">powa</span> inverse <span class="main">(</span>of_nat<span class="main">(</span>Suc <span class="skolem">no</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms powa_less_mono x_bounds<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">powa</span> inverse <span class="main">(</span>real <span class="main">(</span>Suc <span class="skolem">no</span><span class="main">)</span><span class="main">)</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> inverse <span class="main">(</span>real <span class="skolem">m</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms pow1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> less_imp_le abs_less_iff lessI<span class="main">)</span> 
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">powa</span> <span class="skolem">x</span> <span class="main">-</span> <span class="main">1</span> <span class="main">&lt;</span> inverse<span class="main">(</span>real <span class="skolem">m</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"abs <span class="main">(</span><span class="free">a</span> <span class="keyword1">powa</span> <span class="skolem">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="main">&lt;</span> inverse<span class="main">(</span>real <span class="skolem">m</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> lo <span class="keyword1"><span class="command">by</span></span> <span class="operator">linarith</span><span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inverse_positive_iff_positive min_less_iff_conj of_nat_0_less_iff zero_less_Suc<span class="main">)</span> 
  <span class="keyword1"><span class="command">qed</span></span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound"><span class="bound">m</span></span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∃</span><span class="bound"><span class="bound">s</span></span><span class="main">&gt;</span><span class="main">0</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">∧</span> <span class="main">¦</span><span class="bound">x</span><span class="main">¦</span> <span class="main">&lt;</span> <span class="bound">s</span> <span class="main">⟶</span> <span class="main">¦</span><span class="free">a</span> <span class="keyword1">powa</span> <span class="bound">x</span> <span class="main">-</span> <span class="main">1</span><span class="main">¦</span> <span class="main">&lt;</span> inverse <span class="main">(</span>real <span class="bound">m</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms isCont_def LIM_def2 dist_real_def less_imp_le<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-LIM_powa_exponent_at_zero"><span class="command">lemma</span></span> LIM_powa_exponent_at_zero<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="bound">h</span><span class="main">)</span> <span class="main">─</span><span class="main">0</span><span class="main">→</span>  <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> isCont_def isCont_powa_exponent_at_zero less_eq_real_def powa_zero_eq_one<span class="main">)</span>

<span class="keyword1" id="RealPower-isCont_powa_exponent_gt_one"><span class="command">lemma</span></span> isCont_powa_exponent_gt_one<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"isCont <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="bound">x</span><span class="main">)</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span> <span class="main">*</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="bound">h</span><span class="main">)</span> <span class="main">─</span><span class="main">0</span><span class="main">→</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> LIM_powa_exponent_at_zero assms tendsto_mult_left <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">h</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="main">(</span><span class="free">x</span> <span class="main">+</span> <span class="bound">h</span><span class="main">)</span><span class="main">)</span> <span class="main">─</span><span class="main">0</span><span class="main">→</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms powa_add <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1">(powa)</span> <span class="free">a</span> <span class="main">─</span><span class="free">x</span><span class="main">→</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> LIM_offset_zero_cancel <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> isCont_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-isCont_powreal_exponent_gt_one"><span class="command">lemma</span></span> isCont_powreal_exponent_gt_one<span class="main">:</span> 
   <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">1</span> <span class="main">⟹</span> isCont <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="bound">x</span><span class="main">)</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ext isCont_powa_exponent_gt_one less_eq_real_def powreal_eq_powa<span class="main">)</span>

<span class="keyword1" id="RealPower-isCont_powreal_exponent_less_one"><span class="command">lemma</span></span> isCont_powreal_exponent_less_one<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"isCont <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="bound">x</span><span class="main">)</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> inverse <span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms one_less_inverse<span class="main">)</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"isCont <span class="main">(</span><span class="keyword1">(pow<span class="hidden">⇩</span><sub>ℝ</sub>)</span> <span class="main">(</span>inverse <span class="free">a</span><span class="main">)</span><span class="main">)</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> isCont_powreal_exponent_gt_one<span class="main">)</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"isCont <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> inverse <span class="main">(</span>inverse <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> continuous_at_within_inverse powreal_not_zero <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> powreal_inverse <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-isCont_powreal_exponent"><span class="command">lemma</span></span> isCont_powreal_exponent<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> a_gt_0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"isCont <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="bound">x</span><span class="main">)</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span> 
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">using</span></span> isCont_powreal_exponent_gt_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">next</span></span> 
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">a</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> 
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">∨</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">proof</span></span> 
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span>  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
        <span class="keyword1"><span class="command">using</span></span> a_gt_0 isCont_powreal_exponent_less_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span> 
     <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>
 
<span class="comment1">(* A little diversion *)</span>
<span class="keyword1" id="RealPower-real_of_rat_abs"><span class="command">lemma</span></span> real_of_rat_abs<span class="main">:</span> 
    <span class="quoted"><span class="quoted">"real_of_rat<span class="main">(</span>abs <span class="free">a</span><span class="main">)</span> <span class="main">=</span> abs<span class="main">(</span>of_rat <span class="free">a</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> abs_if of_rat_minus<span class="main">)</span>

<span class="keyword1" id="RealPower-isCont_powrat_exponent"><span class="command">lemma</span></span> isCont_powrat_exponent<span class="main">:</span>                                 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"isCont <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="bound">x</span><span class="main">)</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">have</span></span> isCont_of_rat<span class="main">:</span> <span class="quoted"><span class="quoted">"isCont real_of_rat <span class="free">x</span>"</span></span>  <span class="keyword1"><span class="command">using</span></span> isCont_def LIM_def dist_real_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> dist_commute of_rat_diff rat_dist_def real_of_rat_abs<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"isCont <span class="main">(</span><span class="keyword1">(pow<span class="hidden">⇩</span><sub>ℝ</sub>)</span> <span class="free">a</span><span class="main">)</span> <span class="main">(</span>real_of_rat <span class="free">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> isCont_powreal_exponent<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"isCont <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> real_of_rat <span class="bound">x</span><span class="main">)</span> <span class="free">x</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> isCont_of_rat
    <span class="keyword1"><span class="command">using</span></span> isCont_o2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> realpow_powrat_eq assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1" id="RealPower-LIMSEQ_powrat_exponent"><span class="command">lemma</span></span> LIMSEQ_powrat_exponent<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">X</span> <span class="main">⇢</span> <span class="free">x</span><span class="main">;</span> <span class="free">a</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="main">(</span><span class="free">X</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> isCont_tendsto_compose isCont_powrat_exponent<span class="main">)</span>

<span class="comment1">(* Now, back to business *)</span>
<span class="keyword1" id="RealPower-powa_mult"><span class="command">lemma</span></span> powa_mult<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> <span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">powa</span> <span class="free">y</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> a_gt_1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span> <span class="main">≥</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms powa_ge_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> lim1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> real_of_rat <span class="main">(</span>incseq_of <span class="free">y</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">powa</span> <span class="free">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> LIMSEQ_powa <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">powa</span> <span class="free">x</span>"</span></span> <span class="quoted"><span class="free">y</span></span><span class="main">]</span> powa_powrat_lemma assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"isCont <span class="main">(</span><span class="keyword1">(powa)</span> <span class="free">a</span><span class="main">)</span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> isCont_powa_exponent_gt_one a_gt_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">x</span> <span class="main">*</span> real_of_rat <span class="main">(</span>incseq_of <span class="free">y</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">x</span> <span class="main">*</span> <span class="free">y</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> tendsto_mult_left<span class="main">)</span> 
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> real_of_rat <span class="main">(</span>incseq_of <span class="free">y</span> <span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">a</span> <span class="keyword1">powa</span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">y</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> isCont_tendsto_compose <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> LIMSEQ_unique lim1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">a</span> <span class="main">≠</span> <span class="main">1</span>"</span></span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1" id="RealPower-powreal_mult1"><span class="command">lemma</span></span> powreal_mult1<span class="main">:</span> 
      <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">1</span> <span class="main">≤</span> <span class="free">a</span><span class="main">;</span> <span class="main">0</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">y</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> powa_mult powreal_eq_powa powreal_ge_one<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_mult2"><span class="command">lemma</span></span> powreal_mult2<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">y</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">≤</span> inverse <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">using</span></span> real_inverse_ge_one_lemma <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>inverse <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">y</span> <span class="main">=</span> inverse <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">y</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> powreal_mult1 assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"inverse<span class="main">(</span><span class="main">(</span>inverse <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span>  <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">y</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> powreal_inverse<span class="main">)</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> powreal_gt_zero powreal_inverse <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-powreal_mult3"><span class="command">lemma</span></span> powreal_mult3<span class="main">:</span> 
      <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span><span class="main">;</span> <span class="main">0</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">y</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> linorder_not_less powreal_mult1 powreal_mult2<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_mult4"><span class="command">lemma</span></span> powreal_mult4<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> a0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">≤</span> <span class="main">0</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">y</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> minux0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">-</span><span class="free">x</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x0  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">-</span><span class="free">x</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">y</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="main">-</span><span class="free">x</span> <span class="main">*</span> <span class="free">y</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> powreal_mult3 a0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"inverse <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">y</span> <span class="main">=</span> inverse <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powreal_minus<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"inverse <span class="main">(</span><span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> inverse <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">y</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> a0 powreal_gt_zero powreal_inverse<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> inverse_eq_iff_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(* At long last... *)</span>
<span class="keyword1" id="RealPower-powreal_mult"><span class="command">lemma</span></span> powreal_mult<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">y</span> <span class="main">=</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>verit<span class="main"><span class="main">,</span></span> best<span class="main"><span class="main">)</span></span> powreal_def powreal_mult3 powreal_mult4<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_divide"><span class="command">lemma</span></span> powreal_divide<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">0</span> <span class="main">≤</span> <span class="free">a</span><span class="main">;</span> <span class="main">0</span> <span class="main">≤</span> <span class="free">b</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">a</span><span class="main">/</span><span class="free">b</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="free">b</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> divide_inverse powreal_inverse powreal_mult_base<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_divide2"><span class="command">lemma</span></span> powreal_divide2<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">a</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="free">x</span> <span class="main">-</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> a1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> f2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x0</span><span class="main">.</span> <span class="main">-</span> <span class="main">(</span><span class="bound">x0</span><span class="main">::</span>real<span class="main">)</span> <span class="main">=</span> <span class="main">-</span> <span class="main">1</span> <span class="main">*</span> <span class="bound">x0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">-</span> <span class="free">y</span> <span class="main">=</span> <span class="free">x</span> <span class="main">+</span> <span class="main">-</span> <span class="main">1</span> <span class="main">*</span> <span class="free">y</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> f2 a1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> field_class.field_divide_inverse powreal_add powreal_minus<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-powreal_less_mono_base"><span class="command">lemma</span></span> powreal_less_mono_base<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> r0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> a0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ab<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&lt;</span> <span class="free">b</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span> <span class="main">&lt;</span> <span class="free">b</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">/</span><span class="free">a</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ab a0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">b</span><span class="main">/</span><span class="free">a</span><span class="main">)</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> powreal_gt_one r0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span> <span class="main">/</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ab a0 powreal_divide <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> a0 powreal_gt_zero<span class="main">)</span> 
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> less_divide_eq_1_pos <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
<span class="keyword1"><span class="command">qed</span></span>  

<span class="keyword1" id="RealPower-powreal_less_antimono_base"><span class="command">lemma</span></span> powreal_less_antimono_base<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&lt;</span> <span class="free">b</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span> <span class="main">&gt;</span> <span class="free">b</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="main">-</span><span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">-</span> <span class="free">r</span> <span class="main">&lt;</span> <span class="free">b</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">-</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> assms<span class="main">(</span>3<span class="main">)</span> powreal_less_mono_base <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> assms<span class="main">(</span>3<span class="main">)</span> powreal_gt_zero powreal_minus <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-powa_power_eq"><span class="command">lemma</span></span> powa_power_eq<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≥</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">powa</span> <span class="main">(</span>of_nat <span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span> <span class="main">^</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"incseq <span class="main">(</span><span class="main">λ</span><span class="bound">m</span><span class="main">.</span> rat_of_nat <span class="free">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">na</span><span class="main">.</span> real_of_rat <span class="main">(</span>rat_of_nat <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> real <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">na</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> rat_of_nat <span class="free">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">a</span> <span class="main">^</span> <span class="free">n</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> powrat_power_eq assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">na</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℚ</sub></span> incseq_of <span class="main">(</span>real <span class="free">n</span><span class="main">)</span> <span class="bound">na</span><span class="main">)</span> <span class="main">⇢</span> <span class="free">a</span> <span class="main">^</span> <span class="free">n</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> powa_indep_incseq_of' assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Lim_def limI powa_def<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-powreal_power_eq"><span class="command">lemma</span></span> powreal_power_eq<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span>of_nat <span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span> <span class="main">^</span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">unfolding</span></span> powreal_def
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powa_minus powa_power_eq power_inverse real_inverse_ge_one_lemma<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_power_eq2"><span class="command">lemma</span></span> powreal_power_eq2<span class="main">:</span> 
   <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">a</span> <span class="main">⟹</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">n</span> <span class="main">⟹</span> <span class="free">a</span> <span class="main">^</span> <span class="free">n</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="free">a</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">then</span> <span class="main">0</span> <span class="keyword1">else</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span>real <span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>  powreal_power_eq<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_mult_power"><span class="command">lemma</span></span> powreal_mult_power<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="free">n</span> <span class="main">*</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">x</span><span class="main">)</span> <span class="main">^</span> <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> mult.commute powreal_gt_zero powreal_mult powreal_power_eq<span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_int"><span class="command">lemma</span></span> powreal_int<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">i</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">if</span> <span class="free">i</span> <span class="main">≥</span> <span class="main">0</span> <span class="keyword1">then</span> <span class="free">x</span> <span class="main">^</span> nat <span class="free">i</span> <span class="keyword1">else</span> <span class="main">1</span> <span class="main">/</span> <span class="free">x</span> <span class="main">^</span> nat <span class="main">(</span><span class="main">-</span><span class="free">i</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">&lt;</span> <span class="main">0</span>"</span></span> 
  <span class="keyword1"><span class="command">have</span></span> r<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">i</span> <span class="main">=</span> <span class="main">1</span> <span class="main">/</span> <span class="free">x</span>  <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="main">-</span><span class="free">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms powreal_minus divide_inverse<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">`<span class="free">i</span> <span class="main">&lt;</span> <span class="main">0</span>`</span></span> <span class="quoted"><span class="quoted">`<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>`</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> r <span class="dynamic"><span class="dynamic">field_simps</span></span> powreal_power_eq <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>  
<span class="keyword1"><span class="command">qed</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms powreal_power_eq<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1" id="RealPower-powreal_numeral"><span class="command">lemma</span></span> powreal_numeral<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span> <span class="main">⟹</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> numeral <span class="free">n</span> <span class="main">=</span> <span class="free">x</span><span class="main">^</span>numeral <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> powreal_power_eq <span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">x</span></span> <span class="quoted"><span class="quoted">"numeral <span class="free">n</span>"</span></span><span class="main">]</span> powreal_def 
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1" id="RealPower-root_powreal_inverse"><span class="command">lemma</span></span> root_powreal_inverse<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≤</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"root <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="main">1</span><span class="main">/</span><span class="free">n</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"root <span class="free">n</span> <span class="free">x</span> <span class="main">=</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> real_of_rat <span class="main">(</span>inverse <span class="main">(</span>rat_of_nat <span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> assms real_root_eq_powrat_inverse realpow_powrat_eq <span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> powreal_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inverse_eq_divide of_rat_inverse of_rat_of_nat_eq<span class="main">)</span>  
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="RealPower-powreal_inverse_of_nat_gt_one"><span class="command">lemma</span></span> powreal_inverse_of_nat_gt_one<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span><span class="main">;</span> <span class="free">n</span> <span class="main">≠</span> <span class="main">0</span><span class="main">⟧</span>  <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span>inverse <span class="main">(</span>of_nat <span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> inverse_positive_iff_positive neq0_conv of_nat_0_less_iff powreal_gt_one<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span> </pre>
</div><div id="Log">
<div class="head">
<h1>Theory Log</h1>
</div>
<pre class="source"><span class="comment1">(*  Title:      RealPower/Log.thy
    Authors:    Jacques D. Fleuriot
                University of Edinburgh, 2021          
*)</span>  

<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">‹Real Logarithms (Redefined)›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Log
<span class="keyword2"><span class="keyword">imports</span></span> <a href="#RealPower">RealPower</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can now directly define real logarithm of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">x</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> to base <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">a</span></span></span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
    <span class="entity">Log</span>  <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">[</span>real<span class="main">,</span>real<span class="main">]</span> <span class="main">⇒</span> real"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
   <span class="quoted"><span class="quoted">"<span class="free">Log</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">THE</span> <span class="bound">y</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="bound">y</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1" id="Log-IVT_simple"><span class="command">lemma</span></span> IVT_simple<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span><span class="free">f</span> <span class="main">(</span><span class="free">a</span><span class="main">::</span>real<span class="main">)</span> <span class="main">≤</span> <span class="main">(</span><span class="free">y</span><span class="main">::</span>real<span class="main">)</span><span class="main">;</span> <span class="free">y</span> <span class="main">≤</span> <span class="free">f</span> <span class="free">b</span><span class="main">;</span> <span class="free">a</span> <span class="main">≤</span> <span class="free">b</span><span class="main">;</span> 
    <span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="free">a</span> <span class="main">≤</span> <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> <span class="free">b</span> <span class="main">⟶</span> isCont <span class="free">f</span> <span class="bound">x</span><span class="main">⟧</span>
   <span class="main">⟹</span> <span class="main">∃</span><span class="bound">x</span><span class="main">.</span> <span class="free">f</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">frule</span> IVT <span class="main"><span class="main">[</span></span><span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free">f</span></span></span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">auto</span>

<span class="keyword1" id="Log-inj_on_powreal"><span class="command">lemma</span></span> inj_on_powreal<span class="main">:</span> 
   <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">⟹</span> <span class="free">a</span> <span class="main">≠</span> <span class="main">1</span> <span class="main">⟹</span> inj_on <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="bound">x</span><span class="main">)</span> UNIV"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inj_on_def<span class="main">)</span>

<span class="keyword1" id="Log-LIMSEQ_powreal_minus_nat"><span class="command">lemma</span></span> LIMSEQ_powreal_minus_nat<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">1</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="main">-</span>real <span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powreal_minus powreal_power_eq  
        LIMSEQ_inverse_realpow_zero<span class="main">)</span>

<span class="keyword1" id="Log-LIMSEQ_less_Ex"><span class="command">lemma</span></span> LIMSEQ_less_Ex<span class="main">:</span>
   <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">X</span> <span class="main">⇢</span> <span class="main">(</span><span class="free">x</span><span class="main">::</span>real<span class="main">)</span><span class="main">;</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="free">y</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="free">X</span> <span class="bound">n</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> LIMSEQ_le_const not_less<span class="main">)</span>

<span class="keyword1" id="Log-powreal_IVT_upper_lemma"><span class="command">lemma</span></span> powreal_IVT_upper_lemma<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>real<span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span><span class="main">::</span>nat<span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="main">-</span>real <span class="bound">n</span><span class="main">)</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">λ</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">-</span> real <span class="bound">n</span><span class="main">)</span> <span class="main">⇢</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> LIMSEQ_powreal_minus_nat assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> LIMSEQ_less_Ex assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Log-powreal_IVT_lower_lemma"><span class="command">lemma</span></span> powreal_IVT_lower_lemma<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">(</span><span class="main">1</span><span class="main">::</span>real<span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span><span class="main">::</span>nat<span class="main">.</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span>real <span class="bound">n</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> invx0<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> inverse <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">-</span> real <span class="bound">n</span> <span class="main">&lt;</span> inverse <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> powreal_IVT_upper_lemma <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">dest</span><span class="main"><span class="main">:</span></span> inverse_less_imp_less 
         <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> powreal_minus powreal_gt_zero <span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Log-powreal_surj"><span class="command">lemma</span></span> powreal_surj<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">1</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="bound">y</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">-</span> real <span class="skolem">n</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms powreal_IVT_upper_lemma <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">na</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> real <span class="skolem">na</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms powreal_IVT_lower_lemma <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="main">-</span> real <span class="skolem">n</span> <span class="main">≤</span> <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">≤</span> real <span class="skolem">na</span> <span class="main">⟶</span> isCont <span class="main">(</span><span class="keyword1">(pow<span class="hidden">⇩</span><sub>ℝ</sub>)</span> <span class="free">a</span><span class="main">)</span> <span class="bound">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> isCont_powreal_exponent_gt_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">using</span></span> IVT_simple <span class="main">[</span><span class="operator">of</span> <span class="main">_</span> <span class="quoted"><span class="quoted">"<span class="main">-</span>real <span class="skolem">n</span>"</span></span> <span class="main">_</span> <span class="quoted"><span class="quoted">"real <span class="skolem">na</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Log-powreal_surj2"><span class="command">lemma</span></span> powreal_surj2<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span><span class="main">;</span> <span class="free">a</span> <span class="main">&lt;</span> <span class="main">1</span><span class="main">;</span> <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">y</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="bound">y</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> powreal_minus_base_ge_one powreal_surj real_inverse_gt_one_lemma 
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="Log-powreal_ex1_eq"><span class="command">lemma</span></span> powreal_ex1_eq<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="main">1</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃!</span> <span class="bound">y</span><span class="main">.</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="bound">y</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> True
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">using</span></span> assms powreal_inject powreal_surj2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> False
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> assms<span class="main">(</span>3<span class="main">)</span> powreal_surj <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Log-powreal_Log_cancel"><span class="command">lemma</span></span> powreal_Log_cancel <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
   <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">a</span> <span class="main">&gt;</span> <span class="main">0</span><span class="main">;</span> <span class="free">a</span> <span class="main">≠</span> <span class="main">1</span><span class="main">;</span> <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span>Log <span class="free">a</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> the1I2 <span class="main"><span class="main">[</span></span><span class="operator">OF</span> powreal_ex1_eq<span class="main"><span class="main">]</span></span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Log_def<span class="main">)</span>

<span class="keyword1" id="Log-Log_powreal_cancel"><span class="command">lemma</span></span> Log_powreal_cancel <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span><span class="main">;</span> <span class="free">a</span> <span class="main">≠</span> <span class="main">1</span> <span class="main">⟧</span> <span class="main">⟹</span> Log <span class="free">a</span> <span class="main">(</span><span class="free">a</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> powreal_ex1_eq powreal_gt_zero powreal_Log_cancel<span class="main">)</span>

<span class="keyword1" id="Log-Log_mult"><span class="command">lemma</span></span> Log_mult<span class="main">:</span> 
     <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span><span class="main">;</span> <span class="free">a</span> <span class="main">≠</span> <span class="main">1</span><span class="main">;</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">;</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">y</span> <span class="main">⟧</span>
      <span class="main">⟹</span> Log <span class="free">a</span> <span class="main">(</span><span class="free">x</span> <span class="main">*</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> Log <span class="free">a</span> <span class="free">x</span> <span class="main">+</span> Log <span class="free">a</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Log_powreal_cancel powreal_Log_cancel powreal_add<span class="main">)</span>

<span class="keyword1" id="Log-Log_one"><span class="command">lemma</span></span> Log_one <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span><span class="main">;</span> <span class="free">a</span> <span class="main">≠</span> <span class="main">1</span> <span class="main">⟧</span> <span class="main">⟹</span> Log <span class="free">a</span> <span class="main">1</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Log_powreal_cancel powreal_zero_eq_one<span class="main">)</span>

<span class="keyword1" id="Log-Log_eq_one"><span class="command">lemma</span></span> Log_eq_one <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span><span class="main">;</span> <span class="free">a</span> <span class="main">≠</span> <span class="main">1</span> <span class="main">⟧</span> <span class="main">⟹</span> Log <span class="free">a</span> <span class="free">a</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> powreal_inject <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1" id="Log-Log_inverse"><span class="command">lemma</span></span> Log_inverse<span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="free">a</span> <span class="main">&gt;</span> <span class="main">0</span><span class="main">;</span> <span class="free">a</span> <span class="main">≠</span> <span class="main">1</span><span class="main">;</span> <span class="free">x</span> <span class="main">&gt;</span> <span class="main">0</span> <span class="main">⟧</span> <span class="main">⟹</span> Log <span class="free">a</span> <span class="main">(</span>inverse <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">-</span> Log <span class="free">a</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Log_powreal_cancel powreal_Log_cancel powreal_minus<span class="main">)</span>

<span class="keyword1" id="Log-Log_divide"><span class="command">lemma</span></span> Log_divide<span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">a</span><span class="main">;</span> <span class="free">a</span> <span class="main">≠</span> <span class="main">1</span><span class="main">;</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">;</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">y</span> <span class="main">⟧</span>
   <span class="main">⟹</span> Log <span class="free">a</span> <span class="main">(</span><span class="free">x</span><span class="main">/</span><span class="free">y</span><span class="main">)</span> <span class="main">=</span> Log <span class="free">a</span> <span class="free">x</span> <span class="main">-</span> Log <span class="free">a</span> <span class="free">y</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Log_inverse Log_mult divide_real_def 
       inverse_positive_iff_positive minus_real_def<span class="main">)</span>

<span class="keyword1" id="Log-Log_less_cancel_iff"><span class="command">lemma</span></span> Log_less_cancel_iff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>Log <span class="free">a</span> <span class="free">x</span> <span class="main">&lt;</span> Log <span class="free">a</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">&lt;</span> <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"Log <span class="free">a</span> <span class="free">x</span> <span class="main">&lt;</span> Log <span class="free">a</span> <span class="free">y</span>"</span></span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> powreal_Log_cancel assms powreal_less_cancel_iff 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> less_irrefl real_inverse_bet_one_one_lemma 
          inverse_positive_iff_positive<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">&lt;</span> <span class="free">y</span>"</span></span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Log <span class="free">a</span> <span class="free">x</span> <span class="main">&lt;</span> Log <span class="free">a</span> <span class="free">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> assms<span class="main">(</span>2<span class="main">)</span> powreal_less_cancel_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Log-Log_inj"><span class="command">lemma</span></span> Log_inj<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"inj_on <span class="main">(</span>Log <span class="free">b</span><span class="main">)</span> <span class="main">{</span><span class="main">0</span> <span class="main">&lt;..}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> inj_onI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> pos<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">x</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="skolem">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> *<span class="main">:</span> <span class="quoted"><span class="quoted">"Log <span class="free">b</span> <span class="skolem">x</span> <span class="main">=</span> Log <span class="free">b</span> <span class="skolem">y</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> linorder_cases<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">&lt;</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"Log <span class="free">b</span> <span class="skolem">x</span> <span class="main">&lt;</span> Log <span class="free">b</span> <span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Log_less_cancel_iff<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">`<span class="main">1</span> <span class="main">&lt;</span> <span class="free">b</span>`</span></span><span class="main">]</span> pos <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> * <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">&lt;</span> <span class="skolem">x</span>"</span></span> <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"Log <span class="free">b</span> <span class="skolem">y</span> <span class="main">&lt;</span> Log <span class="free">b</span> <span class="skolem">x</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Log_less_cancel_iff<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">`<span class="main">1</span> <span class="main">&lt;</span> <span class="free">b</span>`</span></span><span class="main">]</span> pos <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> * <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Log-Log_le_cancel_iff"><span class="command">lemma</span></span> Log_le_cancel_iff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
     <span class="quoted"><span class="quoted">"<span class="main">⟦</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span><span class="main">;</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span><span class="main">;</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">y</span> <span class="main">⟧</span> <span class="main">⟹</span> <span class="main">(</span>Log <span class="free">a</span> <span class="free">x</span> <span class="main">≤</span> Log <span class="free">a</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">x</span> <span class="main">≤</span> <span class="free">y</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> linorder_not_less <span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>

<span class="keyword1" id="Log-zero_less_Log_cancel_iff"><span class="command">lemma</span></span> zero_less_Log_cancel_iff <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">⟹</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span> <span class="main">0</span> <span class="main">&lt;</span> Log <span class="free">a</span> <span class="free">x</span> <span class="main">⟷</span> <span class="main">1</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Log_less_cancel_iff<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="main">1</span></span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Log-zero_le_Log_cancel_iff"><span class="command">lemma</span></span> zero_le_Log_cancel_iff<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">⟹</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span> <span class="main">0</span> <span class="main">≤</span> Log <span class="free">a</span> <span class="free">x</span> <span class="main">⟷</span> <span class="main">1</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Log_le_cancel_iff<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="main">1</span></span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Log-Log_less_zero_cancel_iff"><span class="command">lemma</span></span> Log_less_zero_cancel_iff<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">⟹</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span> Log <span class="free">a</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="main">0</span> <span class="main">⟷</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Log_less_cancel_iff<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">x</span></span> <span class="quoted"><span class="main">1</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Log-Log_le_zero_cancel_iff"><span class="command">lemma</span></span> Log_le_zero_cancel_iff<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">⟹</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span> Log <span class="free">a</span> <span class="free">x</span> <span class="main">≤</span> <span class="main">0</span> <span class="main">⟷</span> <span class="free">x</span> <span class="main">≤</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Log_le_cancel_iff<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">x</span></span> <span class="quoted"><span class="main">1</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Log-one_less_Log_cancel_iff"><span class="command">lemma</span></span> one_less_Log_cancel_iff<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">⟹</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span> <span class="main">1</span> <span class="main">&lt;</span> Log <span class="free">a</span> <span class="free">x</span> <span class="main">⟷</span> <span class="free">a</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Log_less_cancel_iff<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Log-one_le_Log_cancel_iff"><span class="command">lemma</span></span> one_le_Log_cancel_iff<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">⟹</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span> <span class="main">1</span> <span class="main">≤</span> Log <span class="free">a</span> <span class="free">x</span> <span class="main">⟷</span> <span class="free">a</span> <span class="main">≤</span> <span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Log_le_cancel_iff<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">x</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Log-Log_less_one_cancel_iff"><span class="command">lemma</span></span> Log_less_one_cancel_iff<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">⟹</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span> Log <span class="free">a</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="main">1</span> <span class="main">⟷</span> <span class="free">x</span> <span class="main">&lt;</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Log_less_cancel_iff<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">x</span></span> <span class="quoted"><span class="free">a</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Log-Log_le_one_cancel_iff"><span class="command">lemma</span></span> Log_le_one_cancel_iff<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">a</span> <span class="main">⟹</span> <span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="main">⟹</span> Log <span class="free">a</span> <span class="free">x</span> <span class="main">≤</span> <span class="main">1</span> <span class="main">⟷</span> <span class="free">x</span> <span class="main">≤</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Log_le_cancel_iff<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">a</span></span> <span class="quoted"><span class="free">x</span></span> <span class="quoted"><span class="free">a</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="Log-Log_powreal"><span class="command">lemma</span></span> Log_powreal<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">≠</span> <span class="main">1</span>"</span></span> 
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Log <span class="free">b</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">y</span> <span class="main">*</span> Log <span class="free">b</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span>Log <span class="free">b</span> <span class="free">x</span> <span class="main">*</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms powreal_mult <span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">y</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> powreal_gt_zero<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="main">(</span><span class="free">y</span> <span class="main">*</span> Log <span class="free">b</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">b</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> Log <span class="free">b</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> <span class="free">y</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> powreal_Log_cancel assms powreal_Log_cancel
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mult.commute<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> powreal_inject_exp1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Log-Log_nat_power"><span class="command">lemma</span></span> Log_nat_power<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">&lt;</span> <span class="free">x</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">&lt;</span> <span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">≠</span> <span class="main">1</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">" Log <span class="free">b</span> <span class="main">(</span><span class="free">x</span> <span class="main">^</span> <span class="free">n</span><span class="main">)</span> <span class="main">=</span> real <span class="free">n</span> <span class="main">*</span> Log <span class="free">b</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Log <span class="free">b</span> <span class="main">(</span><span class="free">x</span> <span class="keyword1">pow<span class="hidden">⇩</span><sub>ℝ</sub></span> real <span class="free">n</span><span class="main">)</span> <span class="main">=</span> real <span class="free">n</span> <span class="main">*</span> Log <span class="free">b</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Log_powreal assms<span class="main">)</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> powreal_power_eq<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span></pre>
</div>